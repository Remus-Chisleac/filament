var __create = Object.create;
var __defProp = Object.defineProperty;
var __getProtoOf = Object.getPrototypeOf;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __markAsModule = (target) => __defProp(target, "__esModule", {value: true});
var __commonJS = (callback, module) => () => {
  if (!module) {
    module = {exports: {}};
    callback(module.exports, module);
  }
  return module.exports;
};
var __exportStar = (target, module, desc) => {
  if (module && typeof module === "object" || typeof module === "function") {
    for (let key of __getOwnPropNames(module))
      if (!__hasOwnProp.call(target, key) && key !== "default")
        __defProp(target, key, {get: () => module[key], enumerable: !(desc = __getOwnPropDesc(module, key)) || desc.enumerable});
  }
  return target;
};
var __toModule = (module) => {
  return __exportStar(__markAsModule(__defProp(module != null ? __create(__getProtoOf(module)) : {}, "default", module && module.__esModule && "default" in module ? {get: () => module.default, enumerable: true} : {value: module, enumerable: true})), module);
};

// node_modules/dayjs/plugin/customParseFormat.js
var require_customParseFormat = __commonJS((exports, module) => {
  !function(e, t) {
    typeof exports == "object" && typeof module != "undefined" ? module.exports = t() : typeof define == "function" && define.amd ? define(t) : (e = typeof globalThis != "undefined" ? globalThis : e || self).dayjs_plugin_customParseFormat = t();
  }(exports, function() {
    "use strict";
    var e = {LTS: "h:mm:ss A", LT: "h:mm A", L: "MM/DD/YYYY", LL: "MMMM D, YYYY", LLL: "MMMM D, YYYY h:mm A", LLLL: "dddd, MMMM D, YYYY h:mm A"}, t = /(\[[^[]*\])|([-:/.()\s]+)|(A|a|YYYY|YY?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g, n = /\d\d/, r = /\d\d?/, i = /\d*[^\s\d-_:/()]+/, o = {}, s = function(e2) {
      return (e2 = +e2) + (e2 > 68 ? 1900 : 2e3);
    };
    var a = function(e2) {
      return function(t2) {
        this[e2] = +t2;
      };
    }, f = [/[+-]\d\d:?(\d\d)?|Z/, function(e2) {
      (this.zone || (this.zone = {})).offset = function(e3) {
        if (!e3)
          return 0;
        if (e3 === "Z")
          return 0;
        var t2 = e3.match(/([+-]|\d\d)/g), n2 = 60 * t2[1] + (+t2[2] || 0);
        return n2 === 0 ? 0 : t2[0] === "+" ? -n2 : n2;
      }(e2);
    }], h = function(e2) {
      var t2 = o[e2];
      return t2 && (t2.indexOf ? t2 : t2.s.concat(t2.f));
    }, u = function(e2, t2) {
      var n2, r2 = o.meridiem;
      if (r2) {
        for (var i2 = 1; i2 <= 24; i2 += 1)
          if (e2.indexOf(r2(i2, 0, t2)) > -1) {
            n2 = i2 > 12;
            break;
          }
      } else
        n2 = e2 === (t2 ? "pm" : "PM");
      return n2;
    }, d = {A: [i, function(e2) {
      this.afternoon = u(e2, false);
    }], a: [i, function(e2) {
      this.afternoon = u(e2, true);
    }], S: [/\d/, function(e2) {
      this.milliseconds = 100 * +e2;
    }], SS: [n, function(e2) {
      this.milliseconds = 10 * +e2;
    }], SSS: [/\d{3}/, function(e2) {
      this.milliseconds = +e2;
    }], s: [r, a("seconds")], ss: [r, a("seconds")], m: [r, a("minutes")], mm: [r, a("minutes")], H: [r, a("hours")], h: [r, a("hours")], HH: [r, a("hours")], hh: [r, a("hours")], D: [r, a("day")], DD: [n, a("day")], Do: [i, function(e2) {
      var t2 = o.ordinal, n2 = e2.match(/\d+/);
      if (this.day = n2[0], t2)
        for (var r2 = 1; r2 <= 31; r2 += 1)
          t2(r2).replace(/\[|\]/g, "") === e2 && (this.day = r2);
    }], M: [r, a("month")], MM: [n, a("month")], MMM: [i, function(e2) {
      var t2 = h("months"), n2 = (h("monthsShort") || t2.map(function(e3) {
        return e3.slice(0, 3);
      })).indexOf(e2) + 1;
      if (n2 < 1)
        throw new Error();
      this.month = n2 % 12 || n2;
    }], MMMM: [i, function(e2) {
      var t2 = h("months").indexOf(e2) + 1;
      if (t2 < 1)
        throw new Error();
      this.month = t2 % 12 || t2;
    }], Y: [/[+-]?\d+/, a("year")], YY: [n, function(e2) {
      this.year = s(e2);
    }], YYYY: [/\d{4}/, a("year")], Z: f, ZZ: f};
    function c(n2) {
      var r2, i2;
      r2 = n2, i2 = o && o.formats;
      for (var s2 = (n2 = r2.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g, function(t2, n3, r3) {
        var o2 = r3 && r3.toUpperCase();
        return n3 || i2[r3] || e[r3] || i2[o2].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g, function(e2, t3, n4) {
          return t3 || n4.slice(1);
        });
      })).match(t), a2 = s2.length, f2 = 0; f2 < a2; f2 += 1) {
        var h2 = s2[f2], u2 = d[h2], c2 = u2 && u2[0], l = u2 && u2[1];
        s2[f2] = l ? {regex: c2, parser: l} : h2.replace(/^\[|\]$/g, "");
      }
      return function(e2) {
        for (var t2 = {}, n3 = 0, r3 = 0; n3 < a2; n3 += 1) {
          var i3 = s2[n3];
          if (typeof i3 == "string")
            r3 += i3.length;
          else {
            var o2 = i3.regex, f3 = i3.parser, h3 = e2.slice(r3), u3 = o2.exec(h3)[0];
            f3.call(t2, u3), e2 = e2.replace(u3, "");
          }
        }
        return function(e3) {
          var t3 = e3.afternoon;
          if (t3 !== void 0) {
            var n4 = e3.hours;
            t3 ? n4 < 12 && (e3.hours += 12) : n4 === 12 && (e3.hours = 0), delete e3.afternoon;
          }
        }(t2), t2;
      };
    }
    return function(e2, t2, n2) {
      n2.p.customParseFormat = true, e2 && e2.parseTwoDigitYear && (s = e2.parseTwoDigitYear);
      var r2 = t2.prototype, i2 = r2.parse;
      r2.parse = function(e3) {
        var t3 = e3.date, r3 = e3.utc, s2 = e3.args;
        this.$u = r3;
        var a2 = s2[1];
        if (typeof a2 == "string") {
          var f2 = s2[2] === true, h2 = s2[3] === true, u2 = f2 || h2, d2 = s2[2];
          h2 && (d2 = s2[2]), o = this.$locale(), !f2 && d2 && (o = n2.Ls[d2]), this.$d = function(e4, t4, n3) {
            try {
              if (["x", "X"].indexOf(t4) > -1)
                return new Date((t4 === "X" ? 1e3 : 1) * e4);
              var r4 = c(t4)(e4), i3 = r4.year, o2 = r4.month, s3 = r4.day, a3 = r4.hours, f3 = r4.minutes, h3 = r4.seconds, u3 = r4.milliseconds, d3 = r4.zone, l2 = new Date(), m2 = s3 || (i3 || o2 ? 1 : l2.getDate()), M3 = i3 || l2.getFullYear(), Y2 = 0;
              i3 && !o2 || (Y2 = o2 > 0 ? o2 - 1 : l2.getMonth());
              var p = a3 || 0, v = f3 || 0, D2 = h3 || 0, g = u3 || 0;
              return d3 ? new Date(Date.UTC(M3, Y2, m2, p, v, D2, g + 60 * d3.offset * 1e3)) : n3 ? new Date(Date.UTC(M3, Y2, m2, p, v, D2, g)) : new Date(M3, Y2, m2, p, v, D2, g);
            } catch (e5) {
              return new Date("");
            }
          }(t3, a2, r3), this.init(), d2 && d2 !== true && (this.$L = this.locale(d2).$L), u2 && t3 != this.format(a2) && (this.$d = new Date("")), o = {};
        } else if (a2 instanceof Array)
          for (var l = a2.length, m = 1; m <= l; m += 1) {
            s2[1] = a2[m - 1];
            var M2 = n2.apply(this, s2);
            if (M2.isValid()) {
              this.$d = M2.$d, this.$L = M2.$L, this.init();
              break;
            }
            m === l && (this.$d = new Date(""));
          }
        else
          i2.call(this, e3);
      };
    };
  });
});

// node_modules/dayjs/plugin/localeData.js
var require_localeData = __commonJS((exports, module) => {
  !function(n, e) {
    typeof exports == "object" && typeof module != "undefined" ? module.exports = e() : typeof define == "function" && define.amd ? define(e) : (n = typeof globalThis != "undefined" ? globalThis : n || self).dayjs_plugin_localeData = e();
  }(exports, function() {
    "use strict";
    return function(n, e, t) {
      var r = e.prototype, o = function(n2) {
        return n2 && (n2.indexOf ? n2 : n2.s);
      }, u = function(n2, e2, t2, r2, u2) {
        var i2 = n2.name ? n2 : n2.$locale(), a2 = o(i2[e2]), s2 = o(i2[t2]), f = a2 || s2.map(function(n3) {
          return n3.slice(0, r2);
        });
        if (!u2)
          return f;
        var d = i2.weekStart;
        return f.map(function(n3, e3) {
          return f[(e3 + (d || 0)) % 7];
        });
      }, i = function() {
        return t.Ls[t.locale()];
      }, a = function(n2, e2) {
        return n2.formats[e2] || function(n3) {
          return n3.replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g, function(n4, e3, t2) {
            return e3 || t2.slice(1);
          });
        }(n2.formats[e2.toUpperCase()]);
      }, s = function() {
        var n2 = this;
        return {months: function(e2) {
          return e2 ? e2.format("MMMM") : u(n2, "months");
        }, monthsShort: function(e2) {
          return e2 ? e2.format("MMM") : u(n2, "monthsShort", "months", 3);
        }, firstDayOfWeek: function() {
          return n2.$locale().weekStart || 0;
        }, weekdays: function(e2) {
          return e2 ? e2.format("dddd") : u(n2, "weekdays");
        }, weekdaysMin: function(e2) {
          return e2 ? e2.format("dd") : u(n2, "weekdaysMin", "weekdays", 2);
        }, weekdaysShort: function(e2) {
          return e2 ? e2.format("ddd") : u(n2, "weekdaysShort", "weekdays", 3);
        }, longDateFormat: function(e2) {
          return a(n2.$locale(), e2);
        }, meridiem: this.$locale().meridiem, ordinal: this.$locale().ordinal};
      };
      r.localeData = function() {
        return s.bind(this)();
      }, t.localeData = function() {
        var n2 = i();
        return {firstDayOfWeek: function() {
          return n2.weekStart || 0;
        }, weekdays: function() {
          return t.weekdays();
        }, weekdaysShort: function() {
          return t.weekdaysShort();
        }, weekdaysMin: function() {
          return t.weekdaysMin();
        }, months: function() {
          return t.months();
        }, monthsShort: function() {
          return t.monthsShort();
        }, longDateFormat: function(e2) {
          return a(n2, e2);
        }, meridiem: n2.meridiem, ordinal: n2.ordinal};
      }, t.months = function() {
        return u(i(), "months");
      }, t.monthsShort = function() {
        return u(i(), "monthsShort", "months", 3);
      }, t.weekdays = function(n2) {
        return u(i(), "weekdays", null, null, n2);
      }, t.weekdaysShort = function(n2) {
        return u(i(), "weekdaysShort", "weekdays", 3, n2);
      }, t.weekdaysMin = function(n2) {
        return u(i(), "weekdaysMin", "weekdays", 2, n2);
      };
    };
  });
});

// node_modules/dayjs/plugin/timezone.js
var require_timezone = __commonJS((exports, module) => {
  !function(t, e) {
    typeof exports == "object" && typeof module != "undefined" ? module.exports = e() : typeof define == "function" && define.amd ? define(e) : (t = typeof globalThis != "undefined" ? globalThis : t || self).dayjs_plugin_timezone = e();
  }(exports, function() {
    "use strict";
    var t = {year: 0, month: 1, day: 2, hour: 3, minute: 4, second: 5}, e = {};
    return function(n, i, o) {
      var r, a = function(t2, n2, i2) {
        i2 === void 0 && (i2 = {});
        var o2 = new Date(t2), r2 = function(t3, n3) {
          n3 === void 0 && (n3 = {});
          var i3 = n3.timeZoneName || "short", o3 = t3 + "|" + i3, r3 = e[o3];
          return r3 || (r3 = new Intl.DateTimeFormat("en-US", {hour12: false, timeZone: t3, year: "numeric", month: "2-digit", day: "2-digit", hour: "2-digit", minute: "2-digit", second: "2-digit", timeZoneName: i3}), e[o3] = r3), r3;
        }(n2, i2);
        return r2.formatToParts(o2);
      }, u = function(e2, n2) {
        for (var i2 = a(e2, n2), r2 = [], u2 = 0; u2 < i2.length; u2 += 1) {
          var f2 = i2[u2], s2 = f2.type, m = f2.value, c = t[s2];
          c >= 0 && (r2[c] = parseInt(m, 10));
        }
        var d = r2[3], l = d === 24 ? 0 : d, v = r2[0] + "-" + r2[1] + "-" + r2[2] + " " + l + ":" + r2[4] + ":" + r2[5] + ":000", h = +e2;
        return (o.utc(v).valueOf() - (h -= h % 1e3)) / 6e4;
      }, f = i.prototype;
      f.tz = function(t2, e2) {
        t2 === void 0 && (t2 = r);
        var n2 = this.utcOffset(), i2 = this.toDate(), a2 = i2.toLocaleString("en-US", {timeZone: t2}), u2 = Math.round((i2 - new Date(a2)) / 1e3 / 60), f2 = o(a2).$set("millisecond", this.$ms).utcOffset(15 * -Math.round(i2.getTimezoneOffset() / 15) - u2, true);
        if (e2) {
          var s2 = f2.utcOffset();
          f2 = f2.add(n2 - s2, "minute");
        }
        return f2.$x.$timezone = t2, f2;
      }, f.offsetName = function(t2) {
        var e2 = this.$x.$timezone || o.tz.guess(), n2 = a(this.valueOf(), e2, {timeZoneName: t2}).find(function(t3) {
          return t3.type.toLowerCase() === "timezonename";
        });
        return n2 && n2.value;
      };
      var s = f.startOf;
      f.startOf = function(t2, e2) {
        if (!this.$x || !this.$x.$timezone)
          return s.call(this, t2, e2);
        var n2 = o(this.format("YYYY-MM-DD HH:mm:ss:SSS"));
        return s.call(n2, t2, e2).tz(this.$x.$timezone, true);
      }, o.tz = function(t2, e2, n2) {
        var i2 = n2 && e2, a2 = n2 || e2 || r, f2 = u(+o(), a2);
        if (typeof t2 != "string")
          return o(t2).tz(a2);
        var s2 = function(t3, e3, n3) {
          var i3 = t3 - 60 * e3 * 1e3, o2 = u(i3, n3);
          if (e3 === o2)
            return [i3, e3];
          var r2 = u(i3 -= 60 * (o2 - e3) * 1e3, n3);
          return o2 === r2 ? [i3, o2] : [t3 - 60 * Math.min(o2, r2) * 1e3, Math.max(o2, r2)];
        }(o.utc(t2, i2).valueOf(), f2, a2), m = s2[0], c = s2[1], d = o(m).utcOffset(c);
        return d.$x.$timezone = a2, d;
      }, o.tz.guess = function() {
        return Intl.DateTimeFormat().resolvedOptions().timeZone;
      }, o.tz.setDefault = function(t2) {
        r = t2;
      };
    };
  });
});

// node_modules/dayjs/plugin/utc.js
var require_utc = __commonJS((exports, module) => {
  !function(t, i) {
    typeof exports == "object" && typeof module != "undefined" ? module.exports = i() : typeof define == "function" && define.amd ? define(i) : (t = typeof globalThis != "undefined" ? globalThis : t || self).dayjs_plugin_utc = i();
  }(exports, function() {
    "use strict";
    var t = "minute", i = /[+-]\d\d(?::?\d\d)?/g, e = /([+-]|\d\d)/g;
    return function(s, f, n) {
      var u = f.prototype;
      n.utc = function(t2) {
        var i2 = {date: t2, utc: true, args: arguments};
        return new f(i2);
      }, u.utc = function(i2) {
        var e2 = n(this.toDate(), {locale: this.$L, utc: true});
        return i2 ? e2.add(this.utcOffset(), t) : e2;
      }, u.local = function() {
        return n(this.toDate(), {locale: this.$L, utc: false});
      };
      var o = u.parse;
      u.parse = function(t2) {
        t2.utc && (this.$u = true), this.$utils().u(t2.$offset) || (this.$offset = t2.$offset), o.call(this, t2);
      };
      var r = u.init;
      u.init = function() {
        if (this.$u) {
          var t2 = this.$d;
          this.$y = t2.getUTCFullYear(), this.$M = t2.getUTCMonth(), this.$D = t2.getUTCDate(), this.$W = t2.getUTCDay(), this.$H = t2.getUTCHours(), this.$m = t2.getUTCMinutes(), this.$s = t2.getUTCSeconds(), this.$ms = t2.getUTCMilliseconds();
        } else
          r.call(this);
      };
      var a = u.utcOffset;
      u.utcOffset = function(s2, f2) {
        var n2 = this.$utils().u;
        if (n2(s2))
          return this.$u ? 0 : n2(this.$offset) ? a.call(this) : this.$offset;
        if (typeof s2 == "string" && (s2 = function(t2) {
          t2 === void 0 && (t2 = "");
          var s3 = t2.match(i);
          if (!s3)
            return null;
          var f3 = ("" + s3[0]).match(e) || ["-", 0, 0], n3 = f3[0], u3 = 60 * +f3[1] + +f3[2];
          return u3 === 0 ? 0 : n3 === "+" ? u3 : -u3;
        }(s2), s2 === null))
          return this;
        var u2 = Math.abs(s2) <= 16 ? 60 * s2 : s2, o2 = this;
        if (f2)
          return o2.$offset = u2, o2.$u = s2 === 0, o2;
        if (s2 !== 0) {
          var r2 = this.$u ? this.toDate().getTimezoneOffset() : -1 * this.utcOffset();
          (o2 = this.local().add(u2 + r2, t)).$offset = u2, o2.$x.$localOffset = r2;
        } else
          o2 = this.utc();
        return o2;
      };
      var h = u.format;
      u.format = function(t2) {
        var i2 = t2 || (this.$u ? "YYYY-MM-DDTHH:mm:ss[Z]" : "");
        return h.call(this, i2);
      }, u.valueOf = function() {
        var t2 = this.$utils().u(this.$offset) ? 0 : this.$offset + (this.$x.$localOffset || new Date().getTimezoneOffset());
        return this.$d.valueOf() - 6e4 * t2;
      }, u.isUTC = function() {
        return !!this.$u;
      }, u.toISOString = function() {
        return this.toDate().toISOString();
      }, u.toString = function() {
        return this.toDate().toUTCString();
      };
      var l = u.toDate;
      u.toDate = function(t2) {
        return t2 === "s" && this.$offset ? n(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate() : l.call(this);
      };
      var c = u.diff;
      u.diff = function(t2, i2, e2) {
        if (t2 && this.$u === t2.$u)
          return c.call(this, t2, i2, e2);
        var s2 = this.local(), f2 = n(t2).local();
        return c.call(s2, f2, i2, e2);
      };
    };
  });
});

// node_modules/filepond/dist/filepond.js
var require_filepond = __commonJS((exports, module) => {
  /*!
   * FilePond 4.30.3
   * Licensed under MIT, https://opensource.org/licenses/MIT/
   * Please visit https://pqina.nl/filepond/ for details.
   */
  (function(global2, factory) {
    typeof exports === "object" && typeof module !== "undefined" ? factory(exports) : typeof define === "function" && define.amd ? define(["exports"], factory) : (global2 = global2 || self, factory(global2.FilePond = {}));
  })(exports, function(exports2) {
    "use strict";
    var isNode = function isNode2(value) {
      return value instanceof HTMLElement;
    };
    var createStore = function createStore2(initialState) {
      var queries2 = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : [];
      var actions2 = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : [];
      var state2 = Object.assign({}, initialState);
      var actionQueue = [];
      var dispatchQueue = [];
      var getState = function getState2() {
        return Object.assign({}, state2);
      };
      var processActionQueue = function processActionQueue2() {
        var queue = [].concat(actionQueue);
        actionQueue.length = 0;
        return queue;
      };
      var processDispatchQueue = function processDispatchQueue2() {
        var queue = [].concat(dispatchQueue);
        dispatchQueue.length = 0;
        queue.forEach(function(_ref) {
          var type = _ref.type, data3 = _ref.data;
          dispatch2(type, data3);
        });
      };
      var dispatch2 = function dispatch3(type, data3, isBlocking) {
        if (isBlocking && !document.hidden) {
          dispatchQueue.push({type, data: data3});
          return;
        }
        if (actionHandlers[type]) {
          actionHandlers[type](data3);
        }
        actionQueue.push({
          type,
          data: data3
        });
      };
      var query = function query2(str) {
        var _queryHandles;
        for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
          args[_key - 1] = arguments[_key];
        }
        return queryHandles[str] ? (_queryHandles = queryHandles)[str].apply(_queryHandles, args) : null;
      };
      var api = {
        getState,
        processActionQueue,
        processDispatchQueue,
        dispatch: dispatch2,
        query
      };
      var queryHandles = {};
      queries2.forEach(function(query2) {
        queryHandles = Object.assign({}, query2(state2), {}, queryHandles);
      });
      var actionHandlers = {};
      actions2.forEach(function(action) {
        actionHandlers = Object.assign({}, action(dispatch2, query, state2), {}, actionHandlers);
      });
      return api;
    };
    var defineProperty = function defineProperty2(obj, property, definition) {
      if (typeof definition === "function") {
        obj[property] = definition;
        return;
      }
      Object.defineProperty(obj, property, Object.assign({}, definition));
    };
    var forin = function forin2(obj, cb) {
      for (var key in obj) {
        if (!obj.hasOwnProperty(key)) {
          continue;
        }
        cb(key, obj[key]);
      }
    };
    var createObject = function createObject2(definition) {
      var obj = {};
      forin(definition, function(property) {
        defineProperty(obj, property, definition[property]);
      });
      return obj;
    };
    var attr = function attr2(node, name2) {
      var value = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : null;
      if (value === null) {
        return node.getAttribute(name2) || node.hasAttribute(name2);
      }
      node.setAttribute(name2, value);
    };
    var ns = "http://www.w3.org/2000/svg";
    var svgElements = ["svg", "path"];
    var isSVGElement = function isSVGElement2(tag) {
      return svgElements.includes(tag);
    };
    var createElement = function createElement2(tag, className) {
      var attributes = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : {};
      if (typeof className === "object") {
        attributes = className;
        className = null;
      }
      var element = isSVGElement(tag) ? document.createElementNS(ns, tag) : document.createElement(tag);
      if (className) {
        if (isSVGElement(tag)) {
          attr(element, "class", className);
        } else {
          element.className = className;
        }
      }
      forin(attributes, function(name2, value) {
        attr(element, name2, value);
      });
      return element;
    };
    var appendChild = function appendChild2(parent) {
      return function(child, index) {
        if (typeof index !== "undefined" && parent.children[index]) {
          parent.insertBefore(child, parent.children[index]);
        } else {
          parent.appendChild(child);
        }
      };
    };
    var appendChildView = function appendChildView2(parent, childViews) {
      return function(view, index) {
        if (typeof index !== "undefined") {
          childViews.splice(index, 0, view);
        } else {
          childViews.push(view);
        }
        return view;
      };
    };
    var removeChildView = function removeChildView2(parent, childViews) {
      return function(view) {
        childViews.splice(childViews.indexOf(view), 1);
        if (view.element.parentNode) {
          parent.removeChild(view.element);
        }
        return view;
      };
    };
    var IS_BROWSER = function() {
      return typeof window !== "undefined" && typeof window.document !== "undefined";
    }();
    var isBrowser = function isBrowser2() {
      return IS_BROWSER;
    };
    var testElement = isBrowser() ? createElement("svg") : {};
    var getChildCount = "children" in testElement ? function(el) {
      return el.children.length;
    } : function(el) {
      return el.childNodes.length;
    };
    var getViewRect = function getViewRect2(elementRect, childViews, offset, scale) {
      var left = offset[0] || elementRect.left;
      var top = offset[1] || elementRect.top;
      var right = left + elementRect.width;
      var bottom = top + elementRect.height * (scale[1] || 1);
      var rect = {
        element: Object.assign({}, elementRect),
        inner: {
          left: elementRect.left,
          top: elementRect.top,
          right: elementRect.right,
          bottom: elementRect.bottom
        },
        outer: {
          left,
          top,
          right,
          bottom
        }
      };
      childViews.filter(function(childView) {
        return !childView.isRectIgnored();
      }).map(function(childView) {
        return childView.rect;
      }).forEach(function(childViewRect) {
        expandRect(rect.inner, Object.assign({}, childViewRect.inner));
        expandRect(rect.outer, Object.assign({}, childViewRect.outer));
      });
      calculateRectSize(rect.inner);
      rect.outer.bottom += rect.element.marginBottom;
      rect.outer.right += rect.element.marginRight;
      calculateRectSize(rect.outer);
      return rect;
    };
    var expandRect = function expandRect2(parent, child) {
      child.top += parent.top;
      child.right += parent.left;
      child.bottom += parent.top;
      child.left += parent.left;
      if (child.bottom > parent.bottom) {
        parent.bottom = child.bottom;
      }
      if (child.right > parent.right) {
        parent.right = child.right;
      }
    };
    var calculateRectSize = function calculateRectSize2(rect) {
      rect.width = rect.right - rect.left;
      rect.height = rect.bottom - rect.top;
    };
    var isNumber = function isNumber2(value) {
      return typeof value === "number";
    };
    var thereYet = function thereYet2(position, destination, velocity) {
      var errorMargin = arguments.length > 3 && arguments[3] !== void 0 ? arguments[3] : 1e-3;
      return Math.abs(position - destination) < errorMargin && Math.abs(velocity) < errorMargin;
    };
    var spring = function spring2() {
      var _ref = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : {}, _ref$stiffness = _ref.stiffness, stiffness = _ref$stiffness === void 0 ? 0.5 : _ref$stiffness, _ref$damping = _ref.damping, damping = _ref$damping === void 0 ? 0.75 : _ref$damping, _ref$mass = _ref.mass, mass = _ref$mass === void 0 ? 10 : _ref$mass;
      var target = null;
      var position = null;
      var velocity = 0;
      var resting = false;
      var interpolate = function interpolate2(ts, skipToEndState) {
        if (resting)
          return;
        if (!(isNumber(target) && isNumber(position))) {
          resting = true;
          velocity = 0;
          return;
        }
        var f = -(position - target) * stiffness;
        velocity += f / mass;
        position += velocity;
        velocity *= damping;
        if (thereYet(position, target, velocity) || skipToEndState) {
          position = target;
          velocity = 0;
          resting = true;
          api.onupdate(position);
          api.oncomplete(position);
        } else {
          api.onupdate(position);
        }
      };
      var setTarget = function setTarget2(value) {
        if (isNumber(value) && !isNumber(position)) {
          position = value;
        }
        if (target === null) {
          target = value;
          position = value;
        }
        target = value;
        if (position === target || typeof target === "undefined") {
          resting = true;
          velocity = 0;
          api.onupdate(position);
          api.oncomplete(position);
          return;
        }
        resting = false;
      };
      var api = createObject({
        interpolate,
        target: {
          set: setTarget,
          get: function get() {
            return target;
          }
        },
        resting: {
          get: function get() {
            return resting;
          }
        },
        onupdate: function onupdate(value) {
        },
        oncomplete: function oncomplete(value) {
        }
      });
      return api;
    };
    var easeLinear = function easeLinear2(t) {
      return t;
    };
    var easeInOutQuad = function easeInOutQuad2(t) {
      return t < 0.5 ? 2 * t * t : -1 + (4 - 2 * t) * t;
    };
    var tween = function tween2() {
      var _ref = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : {}, _ref$duration = _ref.duration, duration = _ref$duration === void 0 ? 500 : _ref$duration, _ref$easing = _ref.easing, easing = _ref$easing === void 0 ? easeInOutQuad : _ref$easing, _ref$delay = _ref.delay, delay = _ref$delay === void 0 ? 0 : _ref$delay;
      var start = null;
      var t;
      var p;
      var resting = true;
      var reverse = false;
      var target = null;
      var interpolate = function interpolate2(ts, skipToEndState) {
        if (resting || target === null)
          return;
        if (start === null) {
          start = ts;
        }
        if (ts - start < delay)
          return;
        t = ts - start - delay;
        if (t >= duration || skipToEndState) {
          t = 1;
          p = reverse ? 0 : 1;
          api.onupdate(p * target);
          api.oncomplete(p * target);
          resting = true;
        } else {
          p = t / duration;
          api.onupdate((t >= 0 ? easing(reverse ? 1 - p : p) : 0) * target);
        }
      };
      var api = createObject({
        interpolate,
        target: {
          get: function get() {
            return reverse ? 0 : target;
          },
          set: function set2(value) {
            if (target === null) {
              target = value;
              api.onupdate(value);
              api.oncomplete(value);
              return;
            }
            if (value < target) {
              target = 1;
              reverse = true;
            } else {
              reverse = false;
              target = value;
            }
            resting = false;
            start = null;
          }
        },
        resting: {
          get: function get() {
            return resting;
          }
        },
        onupdate: function onupdate(value) {
        },
        oncomplete: function oncomplete(value) {
        }
      });
      return api;
    };
    var animator = {
      spring,
      tween
    };
    var createAnimator = function createAnimator2(definition, category, property) {
      var def = definition[category] && typeof definition[category][property] === "object" ? definition[category][property] : definition[category] || definition;
      var type = typeof def === "string" ? def : def.type;
      var props = typeof def === "object" ? Object.assign({}, def) : {};
      return animator[type] ? animator[type](props) : null;
    };
    var addGetSet = function addGetSet2(keys, obj, props) {
      var overwrite = arguments.length > 3 && arguments[3] !== void 0 ? arguments[3] : false;
      obj = Array.isArray(obj) ? obj : [obj];
      obj.forEach(function(o) {
        keys.forEach(function(key) {
          var name2 = key;
          var getter = function getter2() {
            return props[key];
          };
          var setter = function setter2(value) {
            return props[key] = value;
          };
          if (typeof key === "object") {
            name2 = key.key;
            getter = key.getter || getter;
            setter = key.setter || setter;
          }
          if (o[name2] && !overwrite) {
            return;
          }
          o[name2] = {
            get: getter,
            set: setter
          };
        });
      });
    };
    var animations = function animations2(_ref) {
      var mixinConfig = _ref.mixinConfig, viewProps = _ref.viewProps, viewInternalAPI = _ref.viewInternalAPI, viewExternalAPI = _ref.viewExternalAPI;
      var initialProps = Object.assign({}, viewProps);
      var animations3 = [];
      forin(mixinConfig, function(property, animation) {
        var animator2 = createAnimator(animation);
        if (!animator2) {
          return;
        }
        animator2.onupdate = function(value) {
          viewProps[property] = value;
        };
        animator2.target = initialProps[property];
        var prop = {
          key: property,
          setter: function setter(value) {
            if (animator2.target === value) {
              return;
            }
            animator2.target = value;
          },
          getter: function getter() {
            return viewProps[property];
          }
        };
        addGetSet([prop], [viewInternalAPI, viewExternalAPI], viewProps, true);
        animations3.push(animator2);
      });
      return {
        write: function write2(ts) {
          var skipToEndState = document.hidden;
          var resting = true;
          animations3.forEach(function(animation) {
            if (!animation.resting)
              resting = false;
            animation.interpolate(ts, skipToEndState);
          });
          return resting;
        },
        destroy: function destroy() {
        }
      };
    };
    var addEvent = function addEvent2(element) {
      return function(type, fn2) {
        element.addEventListener(type, fn2);
      };
    };
    var removeEvent = function removeEvent2(element) {
      return function(type, fn2) {
        element.removeEventListener(type, fn2);
      };
    };
    var listeners = function listeners2(_ref) {
      var mixinConfig = _ref.mixinConfig, viewProps = _ref.viewProps, viewInternalAPI = _ref.viewInternalAPI, viewExternalAPI = _ref.viewExternalAPI, viewState = _ref.viewState, view = _ref.view;
      var events = [];
      var add = addEvent(view.element);
      var remove = removeEvent(view.element);
      viewExternalAPI.on = function(type, fn2) {
        events.push({
          type,
          fn: fn2
        });
        add(type, fn2);
      };
      viewExternalAPI.off = function(type, fn2) {
        events.splice(events.findIndex(function(event) {
          return event.type === type && event.fn === fn2;
        }), 1);
        remove(type, fn2);
      };
      return {
        write: function write2() {
          return true;
        },
        destroy: function destroy() {
          events.forEach(function(event) {
            remove(event.type, event.fn);
          });
        }
      };
    };
    var apis = function apis2(_ref) {
      var mixinConfig = _ref.mixinConfig, viewProps = _ref.viewProps, viewExternalAPI = _ref.viewExternalAPI;
      addGetSet(mixinConfig, viewExternalAPI, viewProps);
    };
    var isDefined = function isDefined2(value) {
      return value != null;
    };
    var defaults = {
      opacity: 1,
      scaleX: 1,
      scaleY: 1,
      translateX: 0,
      translateY: 0,
      rotateX: 0,
      rotateY: 0,
      rotateZ: 0,
      originX: 0,
      originY: 0
    };
    var styles2 = function styles3(_ref) {
      var mixinConfig = _ref.mixinConfig, viewProps = _ref.viewProps, viewInternalAPI = _ref.viewInternalAPI, viewExternalAPI = _ref.viewExternalAPI, view = _ref.view;
      var initialProps = Object.assign({}, viewProps);
      var currentProps = {};
      addGetSet(mixinConfig, [viewInternalAPI, viewExternalAPI], viewProps);
      var getOffset = function getOffset2() {
        return [viewProps["translateX"] || 0, viewProps["translateY"] || 0];
      };
      var getScale = function getScale2() {
        return [viewProps["scaleX"] || 0, viewProps["scaleY"] || 0];
      };
      var getRect = function getRect2() {
        return view.rect ? getViewRect(view.rect, view.childViews, getOffset(), getScale()) : null;
      };
      viewInternalAPI.rect = {get: getRect};
      viewExternalAPI.rect = {get: getRect};
      mixinConfig.forEach(function(key) {
        viewProps[key] = typeof initialProps[key] === "undefined" ? defaults[key] : initialProps[key];
      });
      return {
        write: function write2() {
          if (!propsHaveChanged(currentProps, viewProps)) {
            return;
          }
          applyStyles(view.element, viewProps);
          Object.assign(currentProps, Object.assign({}, viewProps));
          return true;
        },
        destroy: function destroy() {
        }
      };
    };
    var propsHaveChanged = function propsHaveChanged2(currentProps, newProps) {
      if (Object.keys(currentProps).length !== Object.keys(newProps).length) {
        return true;
      }
      for (var prop in newProps) {
        if (newProps[prop] !== currentProps[prop]) {
          return true;
        }
      }
      return false;
    };
    var applyStyles = function applyStyles2(element, _ref2) {
      var opacity = _ref2.opacity, perspective = _ref2.perspective, translateX = _ref2.translateX, translateY = _ref2.translateY, scaleX = _ref2.scaleX, scaleY = _ref2.scaleY, rotateX = _ref2.rotateX, rotateY = _ref2.rotateY, rotateZ = _ref2.rotateZ, originX = _ref2.originX, originY = _ref2.originY, width = _ref2.width, height = _ref2.height;
      var transforms = "";
      var styles3 = "";
      if (isDefined(originX) || isDefined(originY)) {
        styles3 += "transform-origin: " + (originX || 0) + "px " + (originY || 0) + "px;";
      }
      if (isDefined(perspective)) {
        transforms += "perspective(" + perspective + "px) ";
      }
      if (isDefined(translateX) || isDefined(translateY)) {
        transforms += "translate3d(" + (translateX || 0) + "px, " + (translateY || 0) + "px, 0) ";
      }
      if (isDefined(scaleX) || isDefined(scaleY)) {
        transforms += "scale3d(" + (isDefined(scaleX) ? scaleX : 1) + ", " + (isDefined(scaleY) ? scaleY : 1) + ", 1) ";
      }
      if (isDefined(rotateZ)) {
        transforms += "rotateZ(" + rotateZ + "rad) ";
      }
      if (isDefined(rotateX)) {
        transforms += "rotateX(" + rotateX + "rad) ";
      }
      if (isDefined(rotateY)) {
        transforms += "rotateY(" + rotateY + "rad) ";
      }
      if (transforms.length) {
        styles3 += "transform:" + transforms + ";";
      }
      if (isDefined(opacity)) {
        styles3 += "opacity:" + opacity + ";";
        if (opacity === 0) {
          styles3 += "visibility:hidden;";
        }
        if (opacity < 1) {
          styles3 += "pointer-events:none;";
        }
      }
      if (isDefined(height)) {
        styles3 += "height:" + height + "px;";
      }
      if (isDefined(width)) {
        styles3 += "width:" + width + "px;";
      }
      var elementCurrentStyle = element.elementCurrentStyle || "";
      if (styles3.length !== elementCurrentStyle.length || styles3 !== elementCurrentStyle) {
        element.style.cssText = styles3;
        element.elementCurrentStyle = styles3;
      }
    };
    var Mixins = {
      styles: styles2,
      listeners,
      animations,
      apis
    };
    var updateRect = function updateRect2() {
      var rect = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : {};
      var element = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : {};
      var style = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : {};
      if (!element.layoutCalculated) {
        rect.paddingTop = parseInt(style.paddingTop, 10) || 0;
        rect.marginTop = parseInt(style.marginTop, 10) || 0;
        rect.marginRight = parseInt(style.marginRight, 10) || 0;
        rect.marginBottom = parseInt(style.marginBottom, 10) || 0;
        rect.marginLeft = parseInt(style.marginLeft, 10) || 0;
        element.layoutCalculated = true;
      }
      rect.left = element.offsetLeft || 0;
      rect.top = element.offsetTop || 0;
      rect.width = element.offsetWidth || 0;
      rect.height = element.offsetHeight || 0;
      rect.right = rect.left + rect.width;
      rect.bottom = rect.top + rect.height;
      rect.scrollTop = element.scrollTop;
      rect.hidden = element.offsetParent === null;
      return rect;
    };
    var createView = function createView2() {
      var _ref = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : {}, _ref$tag = _ref.tag, tag = _ref$tag === void 0 ? "div" : _ref$tag, _ref$name = _ref.name, name2 = _ref$name === void 0 ? null : _ref$name, _ref$attributes = _ref.attributes, attributes = _ref$attributes === void 0 ? {} : _ref$attributes, _ref$read = _ref.read, read = _ref$read === void 0 ? function() {
      } : _ref$read, _ref$write = _ref.write, write2 = _ref$write === void 0 ? function() {
      } : _ref$write, _ref$create = _ref.create, create2 = _ref$create === void 0 ? function() {
      } : _ref$create, _ref$destroy = _ref.destroy, destroy = _ref$destroy === void 0 ? function() {
      } : _ref$destroy, _ref$filterFrameActio = _ref.filterFrameActionsForChild, filterFrameActionsForChild = _ref$filterFrameActio === void 0 ? function(child, actions2) {
        return actions2;
      } : _ref$filterFrameActio, _ref$didCreateView = _ref.didCreateView, didCreateView = _ref$didCreateView === void 0 ? function() {
      } : _ref$didCreateView, _ref$didWriteView = _ref.didWriteView, didWriteView = _ref$didWriteView === void 0 ? function() {
      } : _ref$didWriteView, _ref$ignoreRect = _ref.ignoreRect, ignoreRect = _ref$ignoreRect === void 0 ? false : _ref$ignoreRect, _ref$ignoreRectUpdate = _ref.ignoreRectUpdate, ignoreRectUpdate = _ref$ignoreRectUpdate === void 0 ? false : _ref$ignoreRectUpdate, _ref$mixins = _ref.mixins, mixins = _ref$mixins === void 0 ? [] : _ref$mixins;
      return function(store) {
        var props = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : {};
        var element = createElement(tag, "filepond--" + name2, attributes);
        var style = window.getComputedStyle(element, null);
        var rect = updateRect();
        var frameRect = null;
        var isResting = false;
        var childViews = [];
        var activeMixins = [];
        var ref = {};
        var state2 = {};
        var writers = [
          write2
        ];
        var readers = [
          read
        ];
        var destroyers = [
          destroy
        ];
        var getElement = function getElement2() {
          return element;
        };
        var getChildViews = function getChildViews2() {
          return childViews.concat();
        };
        var getReference = function getReference2() {
          return ref;
        };
        var createChildView = function createChildView2(store2) {
          return function(view, props2) {
            return view(store2, props2);
          };
        };
        var getRect = function getRect2() {
          if (frameRect) {
            return frameRect;
          }
          frameRect = getViewRect(rect, childViews, [0, 0], [1, 1]);
          return frameRect;
        };
        var getStyle = function getStyle2() {
          return style;
        };
        var _read = function _read2() {
          frameRect = null;
          childViews.forEach(function(child) {
            return child._read();
          });
          var shouldUpdate = !(ignoreRectUpdate && rect.width && rect.height);
          if (shouldUpdate) {
            updateRect(rect, element, style);
          }
          var api = {root: internalAPI, props, rect};
          readers.forEach(function(reader) {
            return reader(api);
          });
        };
        var _write = function _write2(ts, frameActions, shouldOptimize) {
          var resting = frameActions.length === 0;
          writers.forEach(function(writer) {
            var writerResting = writer({
              props,
              root: internalAPI,
              actions: frameActions,
              timestamp: ts,
              shouldOptimize
            });
            if (writerResting === false) {
              resting = false;
            }
          });
          activeMixins.forEach(function(mixin) {
            var mixinResting = mixin.write(ts);
            if (mixinResting === false) {
              resting = false;
            }
          });
          childViews.filter(function(child) {
            return !!child.element.parentNode;
          }).forEach(function(child) {
            var childResting = child._write(ts, filterFrameActionsForChild(child, frameActions), shouldOptimize);
            if (!childResting) {
              resting = false;
            }
          });
          childViews.forEach(function(child, index) {
            if (child.element.parentNode) {
              return;
            }
            internalAPI.appendChild(child.element, index);
            child._read();
            child._write(ts, filterFrameActionsForChild(child, frameActions), shouldOptimize);
            resting = false;
          });
          isResting = resting;
          didWriteView({
            props,
            root: internalAPI,
            actions: frameActions,
            timestamp: ts
          });
          return resting;
        };
        var _destroy = function _destroy2() {
          activeMixins.forEach(function(mixin) {
            return mixin.destroy();
          });
          destroyers.forEach(function(destroyer) {
            destroyer({root: internalAPI, props});
          });
          childViews.forEach(function(child) {
            return child._destroy();
          });
        };
        var sharedAPIDefinition = {
          element: {
            get: getElement
          },
          style: {
            get: getStyle
          },
          childViews: {
            get: getChildViews
          }
        };
        var internalAPIDefinition = Object.assign({}, sharedAPIDefinition, {
          rect: {
            get: getRect
          },
          ref: {
            get: getReference
          },
          is: function is(needle) {
            return name2 === needle;
          },
          appendChild: appendChild(element),
          createChildView: createChildView(store),
          linkView: function linkView(view) {
            childViews.push(view);
            return view;
          },
          unlinkView: function unlinkView(view) {
            childViews.splice(childViews.indexOf(view), 1);
          },
          appendChildView: appendChildView(element, childViews),
          removeChildView: removeChildView(element, childViews),
          registerWriter: function registerWriter(writer) {
            return writers.push(writer);
          },
          registerReader: function registerReader(reader) {
            return readers.push(reader);
          },
          registerDestroyer: function registerDestroyer(destroyer) {
            return destroyers.push(destroyer);
          },
          invalidateLayout: function invalidateLayout() {
            return element.layoutCalculated = false;
          },
          dispatch: store.dispatch,
          query: store.query
        });
        var externalAPIDefinition = {
          element: {
            get: getElement
          },
          childViews: {
            get: getChildViews
          },
          rect: {
            get: getRect
          },
          resting: {
            get: function get() {
              return isResting;
            }
          },
          isRectIgnored: function isRectIgnored() {
            return ignoreRect;
          },
          _read,
          _write,
          _destroy
        };
        var mixinAPIDefinition = Object.assign({}, sharedAPIDefinition, {
          rect: {
            get: function get() {
              return rect;
            }
          }
        });
        Object.keys(mixins).sort(function(a, b) {
          if (a === "styles") {
            return 1;
          } else if (b === "styles") {
            return -1;
          }
          return 0;
        }).forEach(function(key) {
          var mixinAPI = Mixins[key]({
            mixinConfig: mixins[key],
            viewProps: props,
            viewState: state2,
            viewInternalAPI: internalAPIDefinition,
            viewExternalAPI: externalAPIDefinition,
            view: createObject(mixinAPIDefinition)
          });
          if (mixinAPI) {
            activeMixins.push(mixinAPI);
          }
        });
        var internalAPI = createObject(internalAPIDefinition);
        create2({
          root: internalAPI,
          props
        });
        var childCount = getChildCount(element);
        childViews.forEach(function(child, index) {
          internalAPI.appendChild(child.element, childCount + index);
        });
        didCreateView(internalAPI);
        return createObject(externalAPIDefinition);
      };
    };
    var createPainter = function createPainter2(read, write2) {
      var fps = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : 60;
      var name2 = "__framePainter";
      if (window[name2]) {
        window[name2].readers.push(read);
        window[name2].writers.push(write2);
        return;
      }
      window[name2] = {
        readers: [read],
        writers: [write2]
      };
      var painter = window[name2];
      var interval = 1e3 / fps;
      var last = null;
      var id2 = null;
      var requestTick = null;
      var cancelTick = null;
      var setTimerType = function setTimerType2() {
        if (document.hidden) {
          requestTick = function requestTick2() {
            return window.setTimeout(function() {
              return tick(performance.now());
            }, interval);
          };
          cancelTick = function cancelTick2() {
            return window.clearTimeout(id2);
          };
        } else {
          requestTick = function requestTick2() {
            return window.requestAnimationFrame(tick);
          };
          cancelTick = function cancelTick2() {
            return window.cancelAnimationFrame(id2);
          };
        }
      };
      document.addEventListener("visibilitychange", function() {
        if (cancelTick)
          cancelTick();
        setTimerType();
        tick(performance.now());
      });
      var tick = function tick2(ts) {
        id2 = requestTick(tick2);
        if (!last) {
          last = ts;
        }
        var delta = ts - last;
        if (delta <= interval) {
          return;
        }
        last = ts - delta % interval;
        painter.readers.forEach(function(read2) {
          return read2();
        });
        painter.writers.forEach(function(write3) {
          return write3(ts);
        });
      };
      setTimerType();
      tick(performance.now());
      return {
        pause: function pause() {
          cancelTick(id2);
        }
      };
    };
    var createRoute = function createRoute2(routes, fn2) {
      return function(_ref) {
        var root2 = _ref.root, props = _ref.props, _ref$actions = _ref.actions, actions2 = _ref$actions === void 0 ? [] : _ref$actions, timestamp = _ref.timestamp, shouldOptimize = _ref.shouldOptimize;
        actions2.filter(function(action) {
          return routes[action.type];
        }).forEach(function(action) {
          return routes[action.type]({
            root: root2,
            props,
            action: action.data,
            timestamp,
            shouldOptimize
          });
        });
        if (fn2) {
          fn2({
            root: root2,
            props,
            actions: actions2,
            timestamp,
            shouldOptimize
          });
        }
      };
    };
    var insertBefore = function insertBefore2(newNode, referenceNode) {
      return referenceNode.parentNode.insertBefore(newNode, referenceNode);
    };
    var insertAfter = function insertAfter2(newNode, referenceNode) {
      return referenceNode.parentNode.insertBefore(newNode, referenceNode.nextSibling);
    };
    var isArray = function isArray2(value) {
      return Array.isArray(value);
    };
    var isEmpty = function isEmpty2(value) {
      return value == null;
    };
    var trim = function trim2(str) {
      return str.trim();
    };
    var toString = function toString2(value) {
      return "" + value;
    };
    var toArray = function toArray2(value) {
      var splitter = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : ",";
      if (isEmpty(value)) {
        return [];
      }
      if (isArray(value)) {
        return value;
      }
      return toString(value).split(splitter).map(trim).filter(function(str) {
        return str.length;
      });
    };
    var isBoolean = function isBoolean2(value) {
      return typeof value === "boolean";
    };
    var toBoolean = function toBoolean2(value) {
      return isBoolean(value) ? value : value === "true";
    };
    var isString = function isString2(value) {
      return typeof value === "string";
    };
    var toNumber = function toNumber2(value) {
      return isNumber(value) ? value : isString(value) ? toString(value).replace(/[a-z]+/gi, "") : 0;
    };
    var toInt = function toInt2(value) {
      return parseInt(toNumber(value), 10);
    };
    var toFloat = function toFloat2(value) {
      return parseFloat(toNumber(value));
    };
    var isInt = function isInt2(value) {
      return isNumber(value) && isFinite(value) && Math.floor(value) === value;
    };
    var toBytes = function toBytes2(value) {
      var base = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : 1e3;
      if (isInt(value)) {
        return value;
      }
      var naturalFileSize = toString(value).trim();
      if (/MB$/i.test(naturalFileSize)) {
        naturalFileSize = naturalFileSize.replace(/MB$i/, "").trim();
        return toInt(naturalFileSize) * base * base;
      }
      if (/KB/i.test(naturalFileSize)) {
        naturalFileSize = naturalFileSize.replace(/KB$i/, "").trim();
        return toInt(naturalFileSize) * base;
      }
      return toInt(naturalFileSize);
    };
    var isFunction = function isFunction2(value) {
      return typeof value === "function";
    };
    var toFunctionReference = function toFunctionReference2(string) {
      var ref = self;
      var levels = string.split(".");
      var level = null;
      while (level = levels.shift()) {
        ref = ref[level];
        if (!ref) {
          return null;
        }
      }
      return ref;
    };
    var methods = {
      process: "POST",
      patch: "PATCH",
      revert: "DELETE",
      fetch: "GET",
      restore: "GET",
      load: "GET"
    };
    var createServerAPI = function createServerAPI2(outline) {
      var api = {};
      api.url = isString(outline) ? outline : outline.url || "";
      api.timeout = outline.timeout ? parseInt(outline.timeout, 10) : 0;
      api.headers = outline.headers ? outline.headers : {};
      forin(methods, function(key) {
        api[key] = createAction(key, outline[key], methods[key], api.timeout, api.headers);
      });
      api.process = outline.process || isString(outline) || outline.url ? api.process : null;
      api.remove = outline.remove || null;
      delete api.headers;
      return api;
    };
    var createAction = function createAction2(name2, outline, method, timeout, headers) {
      if (outline === null) {
        return null;
      }
      if (typeof outline === "function") {
        return outline;
      }
      var action = {
        url: method === "GET" || method === "PATCH" ? "?" + name2 + "=" : "",
        method,
        headers,
        withCredentials: false,
        timeout,
        onload: null,
        ondata: null,
        onerror: null
      };
      if (isString(outline)) {
        action.url = outline;
        return action;
      }
      Object.assign(action, outline);
      if (isString(action.headers)) {
        var parts = action.headers.split(/:(.+)/);
        action.headers = {
          header: parts[0],
          value: parts[1]
        };
      }
      action.withCredentials = toBoolean(action.withCredentials);
      return action;
    };
    var toServerAPI = function toServerAPI2(value) {
      return createServerAPI(value);
    };
    var isNull = function isNull2(value) {
      return value === null;
    };
    var isObject = function isObject2(value) {
      return typeof value === "object" && value !== null;
    };
    var isAPI = function isAPI2(value) {
      return isObject(value) && isString(value.url) && isObject(value.process) && isObject(value.revert) && isObject(value.restore) && isObject(value.fetch);
    };
    var getType = function getType2(value) {
      if (isArray(value)) {
        return "array";
      }
      if (isNull(value)) {
        return "null";
      }
      if (isInt(value)) {
        return "int";
      }
      if (/^[0-9]+ ?(?:GB|MB|KB)$/gi.test(value)) {
        return "bytes";
      }
      if (isAPI(value)) {
        return "api";
      }
      return typeof value;
    };
    var replaceSingleQuotes = function replaceSingleQuotes2(str) {
      return str.replace(/{\s*'/g, '{"').replace(/'\s*}/g, '"}').replace(/'\s*:/g, '":').replace(/:\s*'/g, ':"').replace(/,\s*'/g, ',"').replace(/'\s*,/g, '",');
    };
    var conversionTable = {
      array: toArray,
      boolean: toBoolean,
      int: function int(value) {
        return getType(value) === "bytes" ? toBytes(value) : toInt(value);
      },
      number: toFloat,
      float: toFloat,
      bytes: toBytes,
      string: function string(value) {
        return isFunction(value) ? value : toString(value);
      },
      function: function _function(value) {
        return toFunctionReference(value);
      },
      serverapi: toServerAPI,
      object: function object(value) {
        try {
          return JSON.parse(replaceSingleQuotes(value));
        } catch (e) {
          return null;
        }
      }
    };
    var convertTo = function convertTo2(value, type) {
      return conversionTable[type](value);
    };
    var getValueByType = function getValueByType2(newValue, defaultValue, valueType) {
      if (newValue === defaultValue) {
        return newValue;
      }
      var newValueType = getType(newValue);
      if (newValueType !== valueType) {
        var convertedValue = convertTo(newValue, valueType);
        newValueType = getType(convertedValue);
        if (convertedValue === null) {
          throw 'Trying to assign value with incorrect type to "' + option + '", allowed type: "' + valueType + '"';
        } else {
          newValue = convertedValue;
        }
      }
      return newValue;
    };
    var createOption = function createOption2(defaultValue, valueType) {
      var currentValue = defaultValue;
      return {
        enumerable: true,
        get: function get() {
          return currentValue;
        },
        set: function set2(newValue) {
          currentValue = getValueByType(newValue, defaultValue, valueType);
        }
      };
    };
    var createOptions = function createOptions2(options) {
      var obj = {};
      forin(options, function(prop) {
        var optionDefinition = options[prop];
        obj[prop] = createOption(optionDefinition[0], optionDefinition[1]);
      });
      return createObject(obj);
    };
    var createInitialState = function createInitialState2(options) {
      return {
        items: [],
        listUpdateTimeout: null,
        itemUpdateTimeout: null,
        processingQueue: [],
        options: createOptions(options)
      };
    };
    var fromCamels = function fromCamels2(string) {
      var separator = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : "-";
      return string.split(/(?=[A-Z])/).map(function(part) {
        return part.toLowerCase();
      }).join(separator);
    };
    var createOptionAPI = function createOptionAPI2(store, options) {
      var obj = {};
      forin(options, function(key) {
        obj[key] = {
          get: function get() {
            return store.getState().options[key];
          },
          set: function set2(value) {
            store.dispatch("SET_" + fromCamels(key, "_").toUpperCase(), {
              value
            });
          }
        };
      });
      return obj;
    };
    var createOptionActions = function createOptionActions2(options) {
      return function(dispatch2, query, state2) {
        var obj = {};
        forin(options, function(key) {
          var name2 = fromCamels(key, "_").toUpperCase();
          obj["SET_" + name2] = function(action) {
            try {
              state2.options[key] = action.value;
            } catch (e) {
            }
            dispatch2("DID_SET_" + name2, {value: state2.options[key]});
          };
        });
        return obj;
      };
    };
    var createOptionQueries = function createOptionQueries2(options) {
      return function(state2) {
        var obj = {};
        forin(options, function(key) {
          obj["GET_" + fromCamels(key, "_").toUpperCase()] = function(action) {
            return state2.options[key];
          };
        });
        return obj;
      };
    };
    var InteractionMethod = {
      API: 1,
      DROP: 2,
      BROWSE: 3,
      PASTE: 4,
      NONE: 5
    };
    var getUniqueId = function getUniqueId2() {
      return Math.random().toString(36).substr(2, 9);
    };
    function _typeof(obj) {
      if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") {
        _typeof = function(obj2) {
          return typeof obj2;
        };
      } else {
        _typeof = function(obj2) {
          return obj2 && typeof Symbol === "function" && obj2.constructor === Symbol && obj2 !== Symbol.prototype ? "symbol" : typeof obj2;
        };
      }
      return _typeof(obj);
    }
    var REACT_ELEMENT_TYPE;
    function _jsx(type, props, key, children) {
      if (!REACT_ELEMENT_TYPE) {
        REACT_ELEMENT_TYPE = typeof Symbol === "function" && Symbol["for"] && Symbol["for"]("react.element") || 60103;
      }
      var defaultProps = type && type.defaultProps;
      var childrenLength = arguments.length - 3;
      if (!props && childrenLength !== 0) {
        props = {
          children: void 0
        };
      }
      if (props && defaultProps) {
        for (var propName in defaultProps) {
          if (props[propName] === void 0) {
            props[propName] = defaultProps[propName];
          }
        }
      } else if (!props) {
        props = defaultProps || {};
      }
      if (childrenLength === 1) {
        props.children = children;
      } else if (childrenLength > 1) {
        var childArray = new Array(childrenLength);
        for (var i = 0; i < childrenLength; i++) {
          childArray[i] = arguments[i + 3];
        }
        props.children = childArray;
      }
      return {
        $$typeof: REACT_ELEMENT_TYPE,
        type,
        key: key === void 0 ? null : "" + key,
        ref: null,
        props,
        _owner: null
      };
    }
    function _asyncIterator(iterable) {
      var method;
      if (typeof Symbol !== "undefined") {
        if (Symbol.asyncIterator) {
          method = iterable[Symbol.asyncIterator];
          if (method != null)
            return method.call(iterable);
        }
        if (Symbol.iterator) {
          method = iterable[Symbol.iterator];
          if (method != null)
            return method.call(iterable);
        }
      }
      throw new TypeError("Object is not async iterable");
    }
    function _AwaitValue(value) {
      this.wrapped = value;
    }
    function _AsyncGenerator(gen) {
      var front, back;
      function send(key, arg) {
        return new Promise(function(resolve, reject) {
          var request = {
            key,
            arg,
            resolve,
            reject,
            next: null
          };
          if (back) {
            back = back.next = request;
          } else {
            front = back = request;
            resume(key, arg);
          }
        });
      }
      function resume(key, arg) {
        try {
          var result = gen[key](arg);
          var value = result.value;
          var wrappedAwait = value instanceof _AwaitValue;
          Promise.resolve(wrappedAwait ? value.wrapped : value).then(function(arg2) {
            if (wrappedAwait) {
              resume("next", arg2);
              return;
            }
            settle(result.done ? "return" : "normal", arg2);
          }, function(err) {
            resume("throw", err);
          });
        } catch (err) {
          settle("throw", err);
        }
      }
      function settle(type, value) {
        switch (type) {
          case "return":
            front.resolve({
              value,
              done: true
            });
            break;
          case "throw":
            front.reject(value);
            break;
          default:
            front.resolve({
              value,
              done: false
            });
            break;
        }
        front = front.next;
        if (front) {
          resume(front.key, front.arg);
        } else {
          back = null;
        }
      }
      this._invoke = send;
      if (typeof gen.return !== "function") {
        this.return = void 0;
      }
    }
    if (typeof Symbol === "function" && Symbol.asyncIterator) {
      _AsyncGenerator.prototype[Symbol.asyncIterator] = function() {
        return this;
      };
    }
    _AsyncGenerator.prototype.next = function(arg) {
      return this._invoke("next", arg);
    };
    _AsyncGenerator.prototype.throw = function(arg) {
      return this._invoke("throw", arg);
    };
    _AsyncGenerator.prototype.return = function(arg) {
      return this._invoke("return", arg);
    };
    function _wrapAsyncGenerator(fn2) {
      return function() {
        return new _AsyncGenerator(fn2.apply(this, arguments));
      };
    }
    function _awaitAsyncGenerator(value) {
      return new _AwaitValue(value);
    }
    function _asyncGeneratorDelegate(inner, awaitWrap) {
      var iter = {}, waiting = false;
      function pump(key, value) {
        waiting = true;
        value = new Promise(function(resolve) {
          resolve(inner[key](value));
        });
        return {
          done: false,
          value: awaitWrap(value)
        };
      }
      if (typeof Symbol === "function" && Symbol.iterator) {
        iter[Symbol.iterator] = function() {
          return this;
        };
      }
      iter.next = function(value) {
        if (waiting) {
          waiting = false;
          return value;
        }
        return pump("next", value);
      };
      if (typeof inner.throw === "function") {
        iter.throw = function(value) {
          if (waiting) {
            waiting = false;
            throw value;
          }
          return pump("throw", value);
        };
      }
      if (typeof inner.return === "function") {
        iter.return = function(value) {
          return pump("return", value);
        };
      }
      return iter;
    }
    function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {
      try {
        var info = gen[key](arg);
        var value = info.value;
      } catch (error2) {
        reject(error2);
        return;
      }
      if (info.done) {
        resolve(value);
      } else {
        Promise.resolve(value).then(_next, _throw);
      }
    }
    function _asyncToGenerator(fn2) {
      return function() {
        var self2 = this, args = arguments;
        return new Promise(function(resolve, reject) {
          var gen = fn2.apply(self2, args);
          function _next(value) {
            asyncGeneratorStep(gen, resolve, reject, _next, _throw, "next", value);
          }
          function _throw(err) {
            asyncGeneratorStep(gen, resolve, reject, _next, _throw, "throw", err);
          }
          _next(void 0);
        });
      };
    }
    function _classCallCheck(instance, Constructor) {
      if (!(instance instanceof Constructor)) {
        throw new TypeError("Cannot call a class as a function");
      }
    }
    function _defineProperties(target, props) {
      for (var i = 0; i < props.length; i++) {
        var descriptor = props[i];
        descriptor.enumerable = descriptor.enumerable || false;
        descriptor.configurable = true;
        if ("value" in descriptor)
          descriptor.writable = true;
        Object.defineProperty(target, descriptor.key, descriptor);
      }
    }
    function _createClass(Constructor, protoProps, staticProps) {
      if (protoProps)
        _defineProperties(Constructor.prototype, protoProps);
      if (staticProps)
        _defineProperties(Constructor, staticProps);
      return Constructor;
    }
    function _defineEnumerableProperties(obj, descs) {
      for (var key in descs) {
        var desc = descs[key];
        desc.configurable = desc.enumerable = true;
        if ("value" in desc)
          desc.writable = true;
        Object.defineProperty(obj, key, desc);
      }
      if (Object.getOwnPropertySymbols) {
        var objectSymbols = Object.getOwnPropertySymbols(descs);
        for (var i = 0; i < objectSymbols.length; i++) {
          var sym = objectSymbols[i];
          var desc = descs[sym];
          desc.configurable = desc.enumerable = true;
          if ("value" in desc)
            desc.writable = true;
          Object.defineProperty(obj, sym, desc);
        }
      }
      return obj;
    }
    function _defaults(obj, defaults2) {
      var keys = Object.getOwnPropertyNames(defaults2);
      for (var i = 0; i < keys.length; i++) {
        var key = keys[i];
        var value = Object.getOwnPropertyDescriptor(defaults2, key);
        if (value && value.configurable && obj[key] === void 0) {
          Object.defineProperty(obj, key, value);
        }
      }
      return obj;
    }
    function _defineProperty(obj, key, value) {
      if (key in obj) {
        Object.defineProperty(obj, key, {
          value,
          enumerable: true,
          configurable: true,
          writable: true
        });
      } else {
        obj[key] = value;
      }
      return obj;
    }
    function _extends() {
      _extends = Object.assign || function(target) {
        for (var i = 1; i < arguments.length; i++) {
          var source = arguments[i];
          for (var key in source) {
            if (Object.prototype.hasOwnProperty.call(source, key)) {
              target[key] = source[key];
            }
          }
        }
        return target;
      };
      return _extends.apply(this, arguments);
    }
    function _objectSpread(target) {
      for (var i = 1; i < arguments.length; i++) {
        var source = arguments[i] != null ? arguments[i] : {};
        var ownKeys2 = Object.keys(source);
        if (typeof Object.getOwnPropertySymbols === "function") {
          ownKeys2 = ownKeys2.concat(Object.getOwnPropertySymbols(source).filter(function(sym) {
            return Object.getOwnPropertyDescriptor(source, sym).enumerable;
          }));
        }
        ownKeys2.forEach(function(key) {
          _defineProperty(target, key, source[key]);
        });
      }
      return target;
    }
    function ownKeys(object, enumerableOnly) {
      var keys = Object.keys(object);
      if (Object.getOwnPropertySymbols) {
        var symbols = Object.getOwnPropertySymbols(object);
        if (enumerableOnly)
          symbols = symbols.filter(function(sym) {
            return Object.getOwnPropertyDescriptor(object, sym).enumerable;
          });
        keys.push.apply(keys, symbols);
      }
      return keys;
    }
    function _objectSpread2(target) {
      for (var i = 1; i < arguments.length; i++) {
        var source = arguments[i] != null ? arguments[i] : {};
        if (i % 2) {
          ownKeys(source, true).forEach(function(key) {
            _defineProperty(target, key, source[key]);
          });
        } else if (Object.getOwnPropertyDescriptors) {
          Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));
        } else {
          ownKeys(source).forEach(function(key) {
            Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));
          });
        }
      }
      return target;
    }
    function _inherits(subClass, superClass) {
      if (typeof superClass !== "function" && superClass !== null) {
        throw new TypeError("Super expression must either be null or a function");
      }
      subClass.prototype = Object.create(superClass && superClass.prototype, {
        constructor: {
          value: subClass,
          writable: true,
          configurable: true
        }
      });
      if (superClass)
        _setPrototypeOf(subClass, superClass);
    }
    function _inheritsLoose(subClass, superClass) {
      subClass.prototype = Object.create(superClass.prototype);
      subClass.prototype.constructor = subClass;
      subClass.__proto__ = superClass;
    }
    function _getPrototypeOf(o) {
      _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf2(o2) {
        return o2.__proto__ || Object.getPrototypeOf(o2);
      };
      return _getPrototypeOf(o);
    }
    function _setPrototypeOf(o, p) {
      _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf2(o2, p2) {
        o2.__proto__ = p2;
        return o2;
      };
      return _setPrototypeOf(o, p);
    }
    function isNativeReflectConstruct() {
      if (typeof Reflect === "undefined" || !Reflect.construct)
        return false;
      if (Reflect.construct.sham)
        return false;
      if (typeof Proxy === "function")
        return true;
      try {
        Date.prototype.toString.call(Reflect.construct(Date, [], function() {
        }));
        return true;
      } catch (e) {
        return false;
      }
    }
    function _construct(Parent, args, Class) {
      if (isNativeReflectConstruct()) {
        _construct = Reflect.construct;
      } else {
        _construct = function _construct2(Parent2, args2, Class2) {
          var a = [null];
          a.push.apply(a, args2);
          var Constructor = Function.bind.apply(Parent2, a);
          var instance = new Constructor();
          if (Class2)
            _setPrototypeOf(instance, Class2.prototype);
          return instance;
        };
      }
      return _construct.apply(null, arguments);
    }
    function _isNativeFunction(fn2) {
      return Function.toString.call(fn2).indexOf("[native code]") !== -1;
    }
    function _wrapNativeSuper(Class) {
      var _cache = typeof Map === "function" ? new Map() : void 0;
      _wrapNativeSuper = function _wrapNativeSuper2(Class2) {
        if (Class2 === null || !_isNativeFunction(Class2))
          return Class2;
        if (typeof Class2 !== "function") {
          throw new TypeError("Super expression must either be null or a function");
        }
        if (typeof _cache !== "undefined") {
          if (_cache.has(Class2))
            return _cache.get(Class2);
          _cache.set(Class2, Wrapper);
        }
        function Wrapper() {
          return _construct(Class2, arguments, _getPrototypeOf(this).constructor);
        }
        Wrapper.prototype = Object.create(Class2.prototype, {
          constructor: {
            value: Wrapper,
            enumerable: false,
            writable: true,
            configurable: true
          }
        });
        return _setPrototypeOf(Wrapper, Class2);
      };
      return _wrapNativeSuper(Class);
    }
    function _instanceof(left, right) {
      if (right != null && typeof Symbol !== "undefined" && right[Symbol.hasInstance]) {
        return !!right[Symbol.hasInstance](left);
      } else {
        return left instanceof right;
      }
    }
    function _interopRequireDefault(obj) {
      return obj && obj.__esModule ? obj : {
        default: obj
      };
    }
    function _interopRequireWildcard(obj) {
      if (obj && obj.__esModule) {
        return obj;
      } else {
        var newObj = {};
        if (obj != null) {
          for (var key in obj) {
            if (Object.prototype.hasOwnProperty.call(obj, key)) {
              var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {};
              if (desc.get || desc.set) {
                Object.defineProperty(newObj, key, desc);
              } else {
                newObj[key] = obj[key];
              }
            }
          }
        }
        newObj.default = obj;
        return newObj;
      }
    }
    function _newArrowCheck(innerThis, boundThis) {
      if (innerThis !== boundThis) {
        throw new TypeError("Cannot instantiate an arrow function");
      }
    }
    function _objectDestructuringEmpty(obj) {
      if (obj == null)
        throw new TypeError("Cannot destructure undefined");
    }
    function _objectWithoutPropertiesLoose(source, excluded) {
      if (source == null)
        return {};
      var target = {};
      var sourceKeys = Object.keys(source);
      var key, i;
      for (i = 0; i < sourceKeys.length; i++) {
        key = sourceKeys[i];
        if (excluded.indexOf(key) >= 0)
          continue;
        target[key] = source[key];
      }
      return target;
    }
    function _objectWithoutProperties(source, excluded) {
      if (source == null)
        return {};
      var target = _objectWithoutPropertiesLoose(source, excluded);
      var key, i;
      if (Object.getOwnPropertySymbols) {
        var sourceSymbolKeys = Object.getOwnPropertySymbols(source);
        for (i = 0; i < sourceSymbolKeys.length; i++) {
          key = sourceSymbolKeys[i];
          if (excluded.indexOf(key) >= 0)
            continue;
          if (!Object.prototype.propertyIsEnumerable.call(source, key))
            continue;
          target[key] = source[key];
        }
      }
      return target;
    }
    function _assertThisInitialized(self2) {
      if (self2 === void 0) {
        throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
      }
      return self2;
    }
    function _possibleConstructorReturn(self2, call) {
      if (call && (typeof call === "object" || typeof call === "function")) {
        return call;
      }
      return _assertThisInitialized(self2);
    }
    function _superPropBase(object, property) {
      while (!Object.prototype.hasOwnProperty.call(object, property)) {
        object = _getPrototypeOf(object);
        if (object === null)
          break;
      }
      return object;
    }
    function _get(target, property, receiver) {
      if (typeof Reflect !== "undefined" && Reflect.get) {
        _get = Reflect.get;
      } else {
        _get = function _get2(target2, property2, receiver2) {
          var base = _superPropBase(target2, property2);
          if (!base)
            return;
          var desc = Object.getOwnPropertyDescriptor(base, property2);
          if (desc.get) {
            return desc.get.call(receiver2);
          }
          return desc.value;
        };
      }
      return _get(target, property, receiver || target);
    }
    function set(target, property, value, receiver) {
      if (typeof Reflect !== "undefined" && Reflect.set) {
        set = Reflect.set;
      } else {
        set = function set2(target2, property2, value2, receiver2) {
          var base = _superPropBase(target2, property2);
          var desc;
          if (base) {
            desc = Object.getOwnPropertyDescriptor(base, property2);
            if (desc.set) {
              desc.set.call(receiver2, value2);
              return true;
            } else if (!desc.writable) {
              return false;
            }
          }
          desc = Object.getOwnPropertyDescriptor(receiver2, property2);
          if (desc) {
            if (!desc.writable) {
              return false;
            }
            desc.value = value2;
            Object.defineProperty(receiver2, property2, desc);
          } else {
            _defineProperty(receiver2, property2, value2);
          }
          return true;
        };
      }
      return set(target, property, value, receiver);
    }
    function _set(target, property, value, receiver, isStrict) {
      var s = set(target, property, value, receiver || target);
      if (!s && isStrict) {
        throw new Error("failed to set property");
      }
      return value;
    }
    function _taggedTemplateLiteral(strings, raw) {
      if (!raw) {
        raw = strings.slice(0);
      }
      return Object.freeze(Object.defineProperties(strings, {
        raw: {
          value: Object.freeze(raw)
        }
      }));
    }
    function _taggedTemplateLiteralLoose(strings, raw) {
      if (!raw) {
        raw = strings.slice(0);
      }
      strings.raw = raw;
      return strings;
    }
    function _temporalRef(val, name2) {
      if (val === _temporalUndefined) {
        throw new ReferenceError(name2 + " is not defined - temporal dead zone");
      } else {
        return val;
      }
    }
    function _readOnlyError(name2) {
      throw new Error('"' + name2 + '" is read-only');
    }
    function _classNameTDZError(name2) {
      throw new Error('Class "' + name2 + '" cannot be referenced in computed property keys.');
    }
    var _temporalUndefined = {};
    function _slicedToArray(arr, i) {
      return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest();
    }
    function _slicedToArrayLoose(arr, i) {
      return _arrayWithHoles(arr) || _iterableToArrayLimitLoose(arr, i) || _nonIterableRest();
    }
    function _toArray(arr) {
      return _arrayWithHoles(arr) || _iterableToArray(arr) || _nonIterableRest();
    }
    function _toConsumableArray(arr) {
      return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread();
    }
    function _arrayWithoutHoles(arr) {
      if (Array.isArray(arr)) {
        for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++)
          arr2[i] = arr[i];
        return arr2;
      }
    }
    function _arrayWithHoles(arr) {
      if (Array.isArray(arr))
        return arr;
    }
    function _iterableToArray(iter) {
      if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === "[object Arguments]")
        return Array.from(iter);
    }
    function _iterableToArrayLimit(arr, i) {
      var _arr = [];
      var _n = true;
      var _d = false;
      var _e = void 0;
      try {
        for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {
          _arr.push(_s.value);
          if (i && _arr.length === i)
            break;
        }
      } catch (err) {
        _d = true;
        _e = err;
      } finally {
        try {
          if (!_n && _i["return"] != null)
            _i["return"]();
        } finally {
          if (_d)
            throw _e;
        }
      }
      return _arr;
    }
    function _iterableToArrayLimitLoose(arr, i) {
      var _arr = [];
      for (var _iterator = arr[Symbol.iterator](), _step; !(_step = _iterator.next()).done; ) {
        _arr.push(_step.value);
        if (i && _arr.length === i)
          break;
      }
      return _arr;
    }
    function _nonIterableSpread() {
      throw new TypeError("Invalid attempt to spread non-iterable instance");
    }
    function _nonIterableRest() {
      throw new TypeError("Invalid attempt to destructure non-iterable instance");
    }
    function _skipFirstGeneratorNext(fn2) {
      return function() {
        var it = fn2.apply(this, arguments);
        it.next();
        return it;
      };
    }
    function _toPrimitive(input, hint) {
      if (typeof input !== "object" || input === null)
        return input;
      var prim = input[Symbol.toPrimitive];
      if (prim !== void 0) {
        var res2 = prim.call(input, hint || "default");
        if (typeof res2 !== "object")
          return res2;
        throw new TypeError("@@toPrimitive must return a primitive value.");
      }
      return (hint === "string" ? String : Number)(input);
    }
    function _toPropertyKey(arg) {
      var key = _toPrimitive(arg, "string");
      return typeof key === "symbol" ? key : String(key);
    }
    function _initializerWarningHelper(descriptor, context) {
      throw new Error("Decorating class property failed. Please ensure that proposal-class-properties is enabled and set to use loose mode. To use proposal-class-properties in spec mode with decorators, wait for the next major version of decorators in stage 2.");
    }
    function _initializerDefineProperty(target, property, descriptor, context) {
      if (!descriptor)
        return;
      Object.defineProperty(target, property, {
        enumerable: descriptor.enumerable,
        configurable: descriptor.configurable,
        writable: descriptor.writable,
        value: descriptor.initializer ? descriptor.initializer.call(context) : void 0
      });
    }
    function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) {
      var desc = {};
      Object.keys(descriptor).forEach(function(key) {
        desc[key] = descriptor[key];
      });
      desc.enumerable = !!desc.enumerable;
      desc.configurable = !!desc.configurable;
      if ("value" in desc || desc.initializer) {
        desc.writable = true;
      }
      desc = decorators.slice().reverse().reduce(function(desc2, decorator) {
        return decorator(target, property, desc2) || desc2;
      }, desc);
      if (context && desc.initializer !== void 0) {
        desc.value = desc.initializer ? desc.initializer.call(context) : void 0;
        desc.initializer = void 0;
      }
      if (desc.initializer === void 0) {
        Object.defineProperty(target, property, desc);
        desc = null;
      }
      return desc;
    }
    var id = 0;
    function _classPrivateFieldLooseKey(name2) {
      return "__private_" + id++ + "_" + name2;
    }
    function _classPrivateFieldLooseBase(receiver, privateKey) {
      if (!Object.prototype.hasOwnProperty.call(receiver, privateKey)) {
        throw new TypeError("attempted to use private field on non-instance");
      }
      return receiver;
    }
    function _classPrivateFieldGet(receiver, privateMap) {
      var descriptor = privateMap.get(receiver);
      if (!descriptor) {
        throw new TypeError("attempted to get private field on non-instance");
      }
      if (descriptor.get) {
        return descriptor.get.call(receiver);
      }
      return descriptor.value;
    }
    function _classPrivateFieldSet(receiver, privateMap, value) {
      var descriptor = privateMap.get(receiver);
      if (!descriptor) {
        throw new TypeError("attempted to set private field on non-instance");
      }
      if (descriptor.set) {
        descriptor.set.call(receiver, value);
      } else {
        if (!descriptor.writable) {
          throw new TypeError("attempted to set read only private field");
        }
        descriptor.value = value;
      }
      return value;
    }
    function _classPrivateFieldDestructureSet(receiver, privateMap) {
      if (!privateMap.has(receiver)) {
        throw new TypeError("attempted to set private field on non-instance");
      }
      var descriptor = privateMap.get(receiver);
      if (descriptor.set) {
        if (!("__destrObj" in descriptor)) {
          descriptor.__destrObj = {
            set value(v) {
              descriptor.set.call(receiver, v);
            }
          };
        }
        return descriptor.__destrObj;
      } else {
        if (!descriptor.writable) {
          throw new TypeError("attempted to set read only private field");
        }
        return descriptor;
      }
    }
    function _classStaticPrivateFieldSpecGet(receiver, classConstructor, descriptor) {
      if (receiver !== classConstructor) {
        throw new TypeError("Private static access of wrong provenance");
      }
      return descriptor.value;
    }
    function _classStaticPrivateFieldSpecSet(receiver, classConstructor, descriptor, value) {
      if (receiver !== classConstructor) {
        throw new TypeError("Private static access of wrong provenance");
      }
      if (!descriptor.writable) {
        throw new TypeError("attempted to set read only private field");
      }
      descriptor.value = value;
      return value;
    }
    function _classStaticPrivateMethodGet(receiver, classConstructor, method) {
      if (receiver !== classConstructor) {
        throw new TypeError("Private static access of wrong provenance");
      }
      return method;
    }
    function _classStaticPrivateMethodSet() {
      throw new TypeError("attempted to set read only static private field");
    }
    function _decorate(decorators, factory, superClass, mixins) {
      var api = _getDecoratorsApi();
      if (mixins) {
        for (var i = 0; i < mixins.length; i++) {
          api = mixins[i](api);
        }
      }
      var r = factory(function initialize(O) {
        api.initializeInstanceElements(O, decorated.elements);
      }, superClass);
      var decorated = api.decorateClass(_coalesceClassElements(r.d.map(_createElementDescriptor)), decorators);
      api.initializeClassElements(r.F, decorated.elements);
      return api.runClassFinishers(r.F, decorated.finishers);
    }
    function _getDecoratorsApi() {
      _getDecoratorsApi = function() {
        return api;
      };
      var api = {
        elementsDefinitionOrder: [["method"], ["field"]],
        initializeInstanceElements: function(O, elements) {
          ["method", "field"].forEach(function(kind) {
            elements.forEach(function(element) {
              if (element.kind === kind && element.placement === "own") {
                this.defineClassElement(O, element);
              }
            }, this);
          }, this);
        },
        initializeClassElements: function(F, elements) {
          var proto2 = F.prototype;
          ["method", "field"].forEach(function(kind) {
            elements.forEach(function(element) {
              var placement = element.placement;
              if (element.kind === kind && (placement === "static" || placement === "prototype")) {
                var receiver = placement === "static" ? F : proto2;
                this.defineClassElement(receiver, element);
              }
            }, this);
          }, this);
        },
        defineClassElement: function(receiver, element) {
          var descriptor = element.descriptor;
          if (element.kind === "field") {
            var initializer = element.initializer;
            descriptor = {
              enumerable: descriptor.enumerable,
              writable: descriptor.writable,
              configurable: descriptor.configurable,
              value: initializer === void 0 ? void 0 : initializer.call(receiver)
            };
          }
          Object.defineProperty(receiver, element.key, descriptor);
        },
        decorateClass: function(elements, decorators) {
          var newElements = [];
          var finishers = [];
          var placements = {
            static: [],
            prototype: [],
            own: []
          };
          elements.forEach(function(element) {
            this.addElementPlacement(element, placements);
          }, this);
          elements.forEach(function(element) {
            if (!_hasDecorators(element))
              return newElements.push(element);
            var elementFinishersExtras = this.decorateElement(element, placements);
            newElements.push(elementFinishersExtras.element);
            newElements.push.apply(newElements, elementFinishersExtras.extras);
            finishers.push.apply(finishers, elementFinishersExtras.finishers);
          }, this);
          if (!decorators) {
            return {
              elements: newElements,
              finishers
            };
          }
          var result = this.decorateConstructor(newElements, decorators);
          finishers.push.apply(finishers, result.finishers);
          result.finishers = finishers;
          return result;
        },
        addElementPlacement: function(element, placements, silent) {
          var keys = placements[element.placement];
          if (!silent && keys.indexOf(element.key) !== -1) {
            throw new TypeError("Duplicated element (" + element.key + ")");
          }
          keys.push(element.key);
        },
        decorateElement: function(element, placements) {
          var extras = [];
          var finishers = [];
          for (var decorators = element.decorators, i = decorators.length - 1; i >= 0; i--) {
            var keys = placements[element.placement];
            keys.splice(keys.indexOf(element.key), 1);
            var elementObject = this.fromElementDescriptor(element);
            var elementFinisherExtras = this.toElementFinisherExtras((0, decorators[i])(elementObject) || elementObject);
            element = elementFinisherExtras.element;
            this.addElementPlacement(element, placements);
            if (elementFinisherExtras.finisher) {
              finishers.push(elementFinisherExtras.finisher);
            }
            var newExtras = elementFinisherExtras.extras;
            if (newExtras) {
              for (var j = 0; j < newExtras.length; j++) {
                this.addElementPlacement(newExtras[j], placements);
              }
              extras.push.apply(extras, newExtras);
            }
          }
          return {
            element,
            finishers,
            extras
          };
        },
        decorateConstructor: function(elements, decorators) {
          var finishers = [];
          for (var i = decorators.length - 1; i >= 0; i--) {
            var obj = this.fromClassDescriptor(elements);
            var elementsAndFinisher = this.toClassDescriptor((0, decorators[i])(obj) || obj);
            if (elementsAndFinisher.finisher !== void 0) {
              finishers.push(elementsAndFinisher.finisher);
            }
            if (elementsAndFinisher.elements !== void 0) {
              elements = elementsAndFinisher.elements;
              for (var j = 0; j < elements.length - 1; j++) {
                for (var k = j + 1; k < elements.length; k++) {
                  if (elements[j].key === elements[k].key && elements[j].placement === elements[k].placement) {
                    throw new TypeError("Duplicated element (" + elements[j].key + ")");
                  }
                }
              }
            }
          }
          return {
            elements,
            finishers
          };
        },
        fromElementDescriptor: function(element) {
          var obj = {
            kind: element.kind,
            key: element.key,
            placement: element.placement,
            descriptor: element.descriptor
          };
          var desc = {
            value: "Descriptor",
            configurable: true
          };
          Object.defineProperty(obj, Symbol.toStringTag, desc);
          if (element.kind === "field")
            obj.initializer = element.initializer;
          return obj;
        },
        toElementDescriptors: function(elementObjects) {
          if (elementObjects === void 0)
            return;
          return _toArray(elementObjects).map(function(elementObject) {
            var element = this.toElementDescriptor(elementObject);
            this.disallowProperty(elementObject, "finisher", "An element descriptor");
            this.disallowProperty(elementObject, "extras", "An element descriptor");
            return element;
          }, this);
        },
        toElementDescriptor: function(elementObject) {
          var kind = String(elementObject.kind);
          if (kind !== "method" && kind !== "field") {
            throw new TypeError(`An element descriptor's .kind property must be either "method" or "field", but a decorator created an element descriptor with .kind "` + kind + '"');
          }
          var key = _toPropertyKey(elementObject.key);
          var placement = String(elementObject.placement);
          if (placement !== "static" && placement !== "prototype" && placement !== "own") {
            throw new TypeError(`An element descriptor's .placement property must be one of "static", "prototype" or "own", but a decorator created an element descriptor with .placement "` + placement + '"');
          }
          var descriptor = elementObject.descriptor;
          this.disallowProperty(elementObject, "elements", "An element descriptor");
          var element = {
            kind,
            key,
            placement,
            descriptor: Object.assign({}, descriptor)
          };
          if (kind !== "field") {
            this.disallowProperty(elementObject, "initializer", "A method descriptor");
          } else {
            this.disallowProperty(descriptor, "get", "The property descriptor of a field descriptor");
            this.disallowProperty(descriptor, "set", "The property descriptor of a field descriptor");
            this.disallowProperty(descriptor, "value", "The property descriptor of a field descriptor");
            element.initializer = elementObject.initializer;
          }
          return element;
        },
        toElementFinisherExtras: function(elementObject) {
          var element = this.toElementDescriptor(elementObject);
          var finisher = _optionalCallableProperty(elementObject, "finisher");
          var extras = this.toElementDescriptors(elementObject.extras);
          return {
            element,
            finisher,
            extras
          };
        },
        fromClassDescriptor: function(elements) {
          var obj = {
            kind: "class",
            elements: elements.map(this.fromElementDescriptor, this)
          };
          var desc = {
            value: "Descriptor",
            configurable: true
          };
          Object.defineProperty(obj, Symbol.toStringTag, desc);
          return obj;
        },
        toClassDescriptor: function(obj) {
          var kind = String(obj.kind);
          if (kind !== "class") {
            throw new TypeError(`A class descriptor's .kind property must be "class", but a decorator created a class descriptor with .kind "` + kind + '"');
          }
          this.disallowProperty(obj, "key", "A class descriptor");
          this.disallowProperty(obj, "placement", "A class descriptor");
          this.disallowProperty(obj, "descriptor", "A class descriptor");
          this.disallowProperty(obj, "initializer", "A class descriptor");
          this.disallowProperty(obj, "extras", "A class descriptor");
          var finisher = _optionalCallableProperty(obj, "finisher");
          var elements = this.toElementDescriptors(obj.elements);
          return {
            elements,
            finisher
          };
        },
        runClassFinishers: function(constructor, finishers) {
          for (var i = 0; i < finishers.length; i++) {
            var newConstructor = (0, finishers[i])(constructor);
            if (newConstructor !== void 0) {
              if (typeof newConstructor !== "function") {
                throw new TypeError("Finishers must return a constructor.");
              }
              constructor = newConstructor;
            }
          }
          return constructor;
        },
        disallowProperty: function(obj, name2, objectType) {
          if (obj[name2] !== void 0) {
            throw new TypeError(objectType + " can't have a ." + name2 + " property.");
          }
        }
      };
      return api;
    }
    function _createElementDescriptor(def) {
      var key = _toPropertyKey(def.key);
      var descriptor;
      if (def.kind === "method") {
        descriptor = {
          value: def.value,
          writable: true,
          configurable: true,
          enumerable: false
        };
      } else if (def.kind === "get") {
        descriptor = {
          get: def.value,
          configurable: true,
          enumerable: false
        };
      } else if (def.kind === "set") {
        descriptor = {
          set: def.value,
          configurable: true,
          enumerable: false
        };
      } else if (def.kind === "field") {
        descriptor = {
          configurable: true,
          writable: true,
          enumerable: true
        };
      }
      var element = {
        kind: def.kind === "field" ? "field" : "method",
        key,
        placement: def.static ? "static" : def.kind === "field" ? "own" : "prototype",
        descriptor
      };
      if (def.decorators)
        element.decorators = def.decorators;
      if (def.kind === "field")
        element.initializer = def.value;
      return element;
    }
    function _coalesceGetterSetter(element, other) {
      if (element.descriptor.get !== void 0) {
        other.descriptor.get = element.descriptor.get;
      } else {
        other.descriptor.set = element.descriptor.set;
      }
    }
    function _coalesceClassElements(elements) {
      var newElements = [];
      var isSameElement = function(other2) {
        return other2.kind === "method" && other2.key === element.key && other2.placement === element.placement;
      };
      for (var i = 0; i < elements.length; i++) {
        var element = elements[i];
        var other;
        if (element.kind === "method" && (other = newElements.find(isSameElement))) {
          if (_isDataDescriptor(element.descriptor) || _isDataDescriptor(other.descriptor)) {
            if (_hasDecorators(element) || _hasDecorators(other)) {
              throw new ReferenceError("Duplicated methods (" + element.key + ") can't be decorated.");
            }
            other.descriptor = element.descriptor;
          } else {
            if (_hasDecorators(element)) {
              if (_hasDecorators(other)) {
                throw new ReferenceError("Decorators can't be placed on different accessors with for the same property (" + element.key + ").");
              }
              other.decorators = element.decorators;
            }
            _coalesceGetterSetter(element, other);
          }
        } else {
          newElements.push(element);
        }
      }
      return newElements;
    }
    function _hasDecorators(element) {
      return element.decorators && element.decorators.length;
    }
    function _isDataDescriptor(desc) {
      return desc !== void 0 && !(desc.value === void 0 && desc.writable === void 0);
    }
    function _optionalCallableProperty(obj, name2) {
      var value = obj[name2];
      if (value !== void 0 && typeof value !== "function") {
        throw new TypeError("Expected '" + name2 + "' to be a function");
      }
      return value;
    }
    function _classPrivateMethodGet(receiver, privateSet, fn2) {
      if (!privateSet.has(receiver)) {
        throw new TypeError("attempted to get private field on non-instance");
      }
      return fn2;
    }
    function _classPrivateMethodSet() {
      throw new TypeError("attempted to reassign private method");
    }
    function _wrapRegExp(re, groups) {
      _wrapRegExp = function(re2, groups2) {
        return new BabelRegExp(re2, groups2);
      };
      var _RegExp = _wrapNativeSuper(RegExp);
      var _super = RegExp.prototype;
      var _groups = new WeakMap();
      function BabelRegExp(re2, groups2) {
        var _this = _RegExp.call(this, re2);
        _groups.set(_this, groups2);
        return _this;
      }
      _inherits(BabelRegExp, _RegExp);
      BabelRegExp.prototype.exec = function(str) {
        var result = _super.exec.call(this, str);
        if (result)
          result.groups = buildGroups(result, this);
        return result;
      };
      BabelRegExp.prototype[Symbol.replace] = function(str, substitution) {
        if (typeof substitution === "string") {
          var groups2 = _groups.get(this);
          return _super[Symbol.replace].call(this, str, substitution.replace(/\$<([^>]+)>/g, function(_, name2) {
            return "$" + groups2[name2];
          }));
        } else if (typeof substitution === "function") {
          var _this = this;
          return _super[Symbol.replace].call(this, str, function() {
            var args = [];
            args.push.apply(args, arguments);
            if (typeof args[args.length - 1] !== "object") {
              args.push(buildGroups(args, _this));
            }
            return substitution.apply(this, args);
          });
        } else {
          return _super[Symbol.replace].call(this, str, substitution);
        }
      };
      function buildGroups(result, re2) {
        var g = _groups.get(re2);
        return Object.keys(g).reduce(function(groups2, name2) {
          groups2[name2] = result[g[name2]];
          return groups2;
        }, Object.create(null));
      }
      return _wrapRegExp.apply(this, arguments);
    }
    var arrayRemove = function arrayRemove2(arr, index) {
      return arr.splice(index, 1);
    };
    var run = function run2(cb, sync) {
      if (sync) {
        cb();
      } else if (document.hidden) {
        Promise.resolve(1).then(cb);
      } else {
        setTimeout(cb, 0);
      }
    };
    var on = function on2() {
      var listeners2 = [];
      var off = function off2(event, cb) {
        arrayRemove(listeners2, listeners2.findIndex(function(listener) {
          return listener.event === event && (listener.cb === cb || !cb);
        }));
      };
      var _fire = function fire2(event, args, sync) {
        listeners2.filter(function(listener) {
          return listener.event === event;
        }).map(function(listener) {
          return listener.cb;
        }).forEach(function(cb) {
          return run(function() {
            return cb.apply(void 0, _toConsumableArray(args));
          }, sync);
        });
      };
      return {
        fireSync: function fireSync(event) {
          for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
            args[_key - 1] = arguments[_key];
          }
          _fire(event, args, true);
        },
        fire: function fire2(event) {
          for (var _len2 = arguments.length, args = new Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {
            args[_key2 - 1] = arguments[_key2];
          }
          _fire(event, args, false);
        },
        on: function on3(event, cb) {
          listeners2.push({event, cb});
        },
        onOnce: function onOnce(event, _cb) {
          listeners2.push({
            event,
            cb: function cb() {
              off(event, _cb);
              _cb.apply(void 0, arguments);
            }
          });
        },
        off
      };
    };
    var copyObjectPropertiesToObject = function copyObjectPropertiesToObject2(src, target, excluded) {
      Object.getOwnPropertyNames(src).filter(function(property) {
        return !excluded.includes(property);
      }).forEach(function(key) {
        return Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(src, key));
      });
    };
    var PRIVATE = [
      "fire",
      "process",
      "revert",
      "load",
      "on",
      "off",
      "onOnce",
      "retryLoad",
      "extend",
      "archive",
      "archived",
      "release",
      "released",
      "requestProcessing",
      "freeze"
    ];
    var createItemAPI = function createItemAPI2(item2) {
      var api = {};
      copyObjectPropertiesToObject(item2, api, PRIVATE);
      return api;
    };
    var removeReleasedItems = function removeReleasedItems2(items) {
      items.forEach(function(item2, index) {
        if (item2.released) {
          arrayRemove(items, index);
        }
      });
    };
    var ItemStatus = {
      INIT: 1,
      IDLE: 2,
      PROCESSING_QUEUED: 9,
      PROCESSING: 3,
      PROCESSING_COMPLETE: 5,
      PROCESSING_ERROR: 6,
      PROCESSING_REVERT_ERROR: 10,
      LOADING: 7,
      LOAD_ERROR: 8
    };
    var FileOrigin = {
      INPUT: 1,
      LIMBO: 2,
      LOCAL: 3
    };
    var getNonNumeric = function getNonNumeric2(str) {
      return /[^0-9]+/.exec(str);
    };
    var getDecimalSeparator = function getDecimalSeparator2() {
      return getNonNumeric(1.1 .toLocaleString())[0];
    };
    var getThousandsSeparator = function getThousandsSeparator2() {
      var decimalSeparator = getDecimalSeparator();
      var thousandsStringWithSeparator = 1e3 .toLocaleString();
      var thousandsStringWithoutSeparator = 1e3 .toString();
      if (thousandsStringWithSeparator !== thousandsStringWithoutSeparator) {
        return getNonNumeric(thousandsStringWithSeparator)[0];
      }
      return decimalSeparator === "." ? "," : ".";
    };
    var Type = {
      BOOLEAN: "boolean",
      INT: "int",
      NUMBER: "number",
      STRING: "string",
      ARRAY: "array",
      OBJECT: "object",
      FUNCTION: "function",
      ACTION: "action",
      SERVER_API: "serverapi",
      REGEX: "regex"
    };
    var filters = [];
    var applyFilterChain = function applyFilterChain2(key, value, utils) {
      return new Promise(function(resolve, reject) {
        var matchingFilters = filters.filter(function(f) {
          return f.key === key;
        }).map(function(f) {
          return f.cb;
        });
        if (matchingFilters.length === 0) {
          resolve(value);
          return;
        }
        var initialFilter = matchingFilters.shift();
        matchingFilters.reduce(function(current, next) {
          return current.then(function(value2) {
            return next(value2, utils);
          });
        }, initialFilter(value, utils)).then(function(value2) {
          return resolve(value2);
        }).catch(function(error2) {
          return reject(error2);
        });
      });
    };
    var applyFilters = function applyFilters2(key, value, utils) {
      return filters.filter(function(f) {
        return f.key === key;
      }).map(function(f) {
        return f.cb(value, utils);
      });
    };
    var addFilter = function addFilter2(key, cb) {
      return filters.push({key, cb});
    };
    var extendDefaultOptions = function extendDefaultOptions2(additionalOptions) {
      return Object.assign(defaultOptions, additionalOptions);
    };
    var getOptions = function getOptions2() {
      return Object.assign({}, defaultOptions);
    };
    var setOptions = function setOptions2(opts) {
      forin(opts, function(key, value) {
        if (!defaultOptions[key]) {
          return;
        }
        defaultOptions[key][0] = getValueByType(value, defaultOptions[key][0], defaultOptions[key][1]);
      });
    };
    var defaultOptions = {
      id: [null, Type.STRING],
      name: ["filepond", Type.STRING],
      disabled: [false, Type.BOOLEAN],
      className: [null, Type.STRING],
      required: [false, Type.BOOLEAN],
      captureMethod: [null, Type.STRING],
      allowSyncAcceptAttribute: [true, Type.BOOLEAN],
      allowDrop: [true, Type.BOOLEAN],
      allowBrowse: [true, Type.BOOLEAN],
      allowPaste: [true, Type.BOOLEAN],
      allowMultiple: [false, Type.BOOLEAN],
      allowReplace: [true, Type.BOOLEAN],
      allowRevert: [true, Type.BOOLEAN],
      allowRemove: [true, Type.BOOLEAN],
      allowProcess: [true, Type.BOOLEAN],
      allowReorder: [false, Type.BOOLEAN],
      allowDirectoriesOnly: [false, Type.BOOLEAN],
      storeAsFile: [false, Type.BOOLEAN],
      forceRevert: [false, Type.BOOLEAN],
      maxFiles: [null, Type.INT],
      checkValidity: [false, Type.BOOLEAN],
      itemInsertLocationFreedom: [true, Type.BOOLEAN],
      itemInsertLocation: ["before", Type.STRING],
      itemInsertInterval: [75, Type.INT],
      dropOnPage: [false, Type.BOOLEAN],
      dropOnElement: [true, Type.BOOLEAN],
      dropValidation: [false, Type.BOOLEAN],
      ignoredFiles: [[".ds_store", "thumbs.db", "desktop.ini"], Type.ARRAY],
      instantUpload: [true, Type.BOOLEAN],
      maxParallelUploads: [2, Type.INT],
      allowMinimumUploadDuration: [true, Type.BOOLEAN],
      chunkUploads: [false, Type.BOOLEAN],
      chunkForce: [false, Type.BOOLEAN],
      chunkSize: [5e6, Type.INT],
      chunkRetryDelays: [[500, 1e3, 3e3], Type.ARRAY],
      server: [null, Type.SERVER_API],
      fileSizeBase: [1e3, Type.INT],
      labelFileSizeBytes: ["bytes", Type.STRING],
      labelFileSizeKilobytes: ["KB", Type.STRING],
      labelFileSizeMegabytes: ["MB", Type.STRING],
      labelFileSizeGigabytes: ["GB", Type.STRING],
      labelDecimalSeparator: [getDecimalSeparator(), Type.STRING],
      labelThousandsSeparator: [getThousandsSeparator(), Type.STRING],
      labelIdle: [
        'Drag & Drop your files or <span class="filepond--label-action">Browse</span>',
        Type.STRING
      ],
      labelInvalidField: ["Field contains invalid files", Type.STRING],
      labelFileWaitingForSize: ["Waiting for size", Type.STRING],
      labelFileSizeNotAvailable: ["Size not available", Type.STRING],
      labelFileCountSingular: ["file in list", Type.STRING],
      labelFileCountPlural: ["files in list", Type.STRING],
      labelFileLoading: ["Loading", Type.STRING],
      labelFileAdded: ["Added", Type.STRING],
      labelFileLoadError: ["Error during load", Type.STRING],
      labelFileRemoved: ["Removed", Type.STRING],
      labelFileRemoveError: ["Error during remove", Type.STRING],
      labelFileProcessing: ["Uploading", Type.STRING],
      labelFileProcessingComplete: ["Upload complete", Type.STRING],
      labelFileProcessingAborted: ["Upload cancelled", Type.STRING],
      labelFileProcessingError: ["Error during upload", Type.STRING],
      labelFileProcessingRevertError: ["Error during revert", Type.STRING],
      labelTapToCancel: ["tap to cancel", Type.STRING],
      labelTapToRetry: ["tap to retry", Type.STRING],
      labelTapToUndo: ["tap to undo", Type.STRING],
      labelButtonRemoveItem: ["Remove", Type.STRING],
      labelButtonAbortItemLoad: ["Abort", Type.STRING],
      labelButtonRetryItemLoad: ["Retry", Type.STRING],
      labelButtonAbortItemProcessing: ["Cancel", Type.STRING],
      labelButtonUndoItemProcessing: ["Undo", Type.STRING],
      labelButtonRetryItemProcessing: ["Retry", Type.STRING],
      labelButtonProcessItem: ["Upload", Type.STRING],
      iconRemove: [
        '<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path d="M11.586 13l-2.293 2.293a1 1 0 0 0 1.414 1.414L13 14.414l2.293 2.293a1 1 0 0 0 1.414-1.414L14.414 13l2.293-2.293a1 1 0 0 0-1.414-1.414L13 11.586l-2.293-2.293a1 1 0 0 0-1.414 1.414L11.586 13z" fill="currentColor" fill-rule="nonzero"/></svg>',
        Type.STRING
      ],
      iconProcess: [
        '<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path d="M14 10.414v3.585a1 1 0 0 1-2 0v-3.585l-1.293 1.293a1 1 0 0 1-1.414-1.415l3-3a1 1 0 0 1 1.414 0l3 3a1 1 0 0 1-1.414 1.415L14 10.414zM9 18a1 1 0 0 1 0-2h8a1 1 0 0 1 0 2H9z" fill="currentColor" fill-rule="evenodd"/></svg>',
        Type.STRING
      ],
      iconRetry: [
        '<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path d="M10.81 9.185l-.038.02A4.997 4.997 0 0 0 8 13.683a5 5 0 0 0 5 5 5 5 0 0 0 5-5 1 1 0 0 1 2 0A7 7 0 1 1 9.722 7.496l-.842-.21a.999.999 0 1 1 .484-1.94l3.23.806c.535.133.86.675.73 1.21l-.804 3.233a.997.997 0 0 1-1.21.73.997.997 0 0 1-.73-1.21l.23-.928v-.002z" fill="currentColor" fill-rule="nonzero"/></svg>',
        Type.STRING
      ],
      iconUndo: [
        '<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path d="M9.185 10.81l.02-.038A4.997 4.997 0 0 1 13.683 8a5 5 0 0 1 5 5 5 5 0 0 1-5 5 1 1 0 0 0 0 2A7 7 0 1 0 7.496 9.722l-.21-.842a.999.999 0 1 0-1.94.484l.806 3.23c.133.535.675.86 1.21.73l3.233-.803a.997.997 0 0 0 .73-1.21.997.997 0 0 0-1.21-.73l-.928.23-.002-.001z" fill="currentColor" fill-rule="nonzero"/></svg>',
        Type.STRING
      ],
      iconDone: [
        '<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path d="M18.293 9.293a1 1 0 0 1 1.414 1.414l-7.002 7a1 1 0 0 1-1.414 0l-3.998-4a1 1 0 1 1 1.414-1.414L12 15.586l6.294-6.293z" fill="currentColor" fill-rule="nonzero"/></svg>',
        Type.STRING
      ],
      oninit: [null, Type.FUNCTION],
      onwarning: [null, Type.FUNCTION],
      onerror: [null, Type.FUNCTION],
      onactivatefile: [null, Type.FUNCTION],
      oninitfile: [null, Type.FUNCTION],
      onaddfilestart: [null, Type.FUNCTION],
      onaddfileprogress: [null, Type.FUNCTION],
      onaddfile: [null, Type.FUNCTION],
      onprocessfilestart: [null, Type.FUNCTION],
      onprocessfileprogress: [null, Type.FUNCTION],
      onprocessfileabort: [null, Type.FUNCTION],
      onprocessfilerevert: [null, Type.FUNCTION],
      onprocessfile: [null, Type.FUNCTION],
      onprocessfiles: [null, Type.FUNCTION],
      onremovefile: [null, Type.FUNCTION],
      onpreparefile: [null, Type.FUNCTION],
      onupdatefiles: [null, Type.FUNCTION],
      onreorderfiles: [null, Type.FUNCTION],
      beforeDropFile: [null, Type.FUNCTION],
      beforeAddFile: [null, Type.FUNCTION],
      beforeRemoveFile: [null, Type.FUNCTION],
      beforePrepareFile: [null, Type.FUNCTION],
      stylePanelLayout: [null, Type.STRING],
      stylePanelAspectRatio: [null, Type.STRING],
      styleItemPanelAspectRatio: [null, Type.STRING],
      styleButtonRemoveItemPosition: ["left", Type.STRING],
      styleButtonProcessItemPosition: ["right", Type.STRING],
      styleLoadIndicatorPosition: ["right", Type.STRING],
      styleProgressIndicatorPosition: ["right", Type.STRING],
      styleButtonRemoveItemAlign: [false, Type.BOOLEAN],
      files: [[], Type.ARRAY],
      credits: [["https://pqina.nl/", "Powered by PQINA"], Type.ARRAY]
    };
    var getItemByQuery = function getItemByQuery2(items, query) {
      if (isEmpty(query)) {
        return items[0] || null;
      }
      if (isInt(query)) {
        return items[query] || null;
      }
      if (typeof query === "object") {
        query = query.id;
      }
      return items.find(function(item2) {
        return item2.id === query;
      }) || null;
    };
    var getNumericAspectRatioFromString = function getNumericAspectRatioFromString2(aspectRatio) {
      if (isEmpty(aspectRatio)) {
        return aspectRatio;
      }
      if (/:/.test(aspectRatio)) {
        var parts = aspectRatio.split(":");
        return parts[1] / parts[0];
      }
      return parseFloat(aspectRatio);
    };
    var getActiveItems = function getActiveItems2(items) {
      return items.filter(function(item2) {
        return !item2.archived;
      });
    };
    var Status = {
      EMPTY: 0,
      IDLE: 1,
      ERROR: 2,
      BUSY: 3,
      READY: 4
    };
    var res = null;
    var canUpdateFileInput = function canUpdateFileInput2() {
      if (res === null) {
        try {
          var dataTransfer = new DataTransfer();
          dataTransfer.items.add(new File(["hello world"], "This_Works.txt"));
          var el = document.createElement("input");
          el.setAttribute("type", "file");
          el.files = dataTransfer.files;
          res = el.files.length === 1;
        } catch (err) {
          res = false;
        }
      }
      return res;
    };
    var ITEM_ERROR = [
      ItemStatus.LOAD_ERROR,
      ItemStatus.PROCESSING_ERROR,
      ItemStatus.PROCESSING_REVERT_ERROR
    ];
    var ITEM_BUSY = [
      ItemStatus.LOADING,
      ItemStatus.PROCESSING,
      ItemStatus.PROCESSING_QUEUED,
      ItemStatus.INIT
    ];
    var ITEM_READY = [ItemStatus.PROCESSING_COMPLETE];
    var isItemInErrorState = function isItemInErrorState2(item2) {
      return ITEM_ERROR.includes(item2.status);
    };
    var isItemInBusyState = function isItemInBusyState2(item2) {
      return ITEM_BUSY.includes(item2.status);
    };
    var isItemInReadyState = function isItemInReadyState2(item2) {
      return ITEM_READY.includes(item2.status);
    };
    var isAsync = function isAsync2(state2) {
      return isObject(state2.options.server) && (isObject(state2.options.server.process) || isFunction(state2.options.server.process));
    };
    var queries = function queries2(state2) {
      return {
        GET_STATUS: function GET_STATUS() {
          var items = getActiveItems(state2.items);
          var EMPTY = Status.EMPTY, ERROR = Status.ERROR, BUSY = Status.BUSY, IDLE = Status.IDLE, READY = Status.READY;
          if (items.length === 0)
            return EMPTY;
          if (items.some(isItemInErrorState))
            return ERROR;
          if (items.some(isItemInBusyState))
            return BUSY;
          if (items.some(isItemInReadyState))
            return READY;
          return IDLE;
        },
        GET_ITEM: function GET_ITEM(query) {
          return getItemByQuery(state2.items, query);
        },
        GET_ACTIVE_ITEM: function GET_ACTIVE_ITEM(query) {
          return getItemByQuery(getActiveItems(state2.items), query);
        },
        GET_ACTIVE_ITEMS: function GET_ACTIVE_ITEMS() {
          return getActiveItems(state2.items);
        },
        GET_ITEMS: function GET_ITEMS() {
          return state2.items;
        },
        GET_ITEM_NAME: function GET_ITEM_NAME(query) {
          var item2 = getItemByQuery(state2.items, query);
          return item2 ? item2.filename : null;
        },
        GET_ITEM_SIZE: function GET_ITEM_SIZE(query) {
          var item2 = getItemByQuery(state2.items, query);
          return item2 ? item2.fileSize : null;
        },
        GET_STYLES: function GET_STYLES() {
          return Object.keys(state2.options).filter(function(key) {
            return /^style/.test(key);
          }).map(function(option2) {
            return {
              name: option2,
              value: state2.options[option2]
            };
          });
        },
        GET_PANEL_ASPECT_RATIO: function GET_PANEL_ASPECT_RATIO() {
          var isShapeCircle = /circle/.test(state2.options.stylePanelLayout);
          var aspectRatio = isShapeCircle ? 1 : getNumericAspectRatioFromString(state2.options.stylePanelAspectRatio);
          return aspectRatio;
        },
        GET_ITEM_PANEL_ASPECT_RATIO: function GET_ITEM_PANEL_ASPECT_RATIO() {
          return state2.options.styleItemPanelAspectRatio;
        },
        GET_ITEMS_BY_STATUS: function GET_ITEMS_BY_STATUS(status) {
          return getActiveItems(state2.items).filter(function(item2) {
            return item2.status === status;
          });
        },
        GET_TOTAL_ITEMS: function GET_TOTAL_ITEMS() {
          return getActiveItems(state2.items).length;
        },
        SHOULD_UPDATE_FILE_INPUT: function SHOULD_UPDATE_FILE_INPUT() {
          return state2.options.storeAsFile && canUpdateFileInput() && !isAsync(state2);
        },
        IS_ASYNC: function IS_ASYNC() {
          return isAsync(state2);
        },
        GET_FILE_SIZE_LABELS: function GET_FILE_SIZE_LABELS(query) {
          return {
            labelBytes: query("GET_LABEL_FILE_SIZE_BYTES") || void 0,
            labelKilobytes: query("GET_LABEL_FILE_SIZE_KILOBYTES") || void 0,
            labelMegabytes: query("GET_LABEL_FILE_SIZE_MEGABYTES") || void 0,
            labelGigabytes: query("GET_LABEL_FILE_SIZE_GIGABYTES") || void 0
          };
        }
      };
    };
    var hasRoomForItem = function hasRoomForItem2(state2) {
      var count = getActiveItems(state2.items).length;
      if (!state2.options.allowMultiple) {
        return count === 0;
      }
      var maxFileCount = state2.options.maxFiles;
      if (maxFileCount === null) {
        return true;
      }
      if (count < maxFileCount) {
        return true;
      }
      return false;
    };
    var limit = function limit2(value, min, max) {
      return Math.max(Math.min(max, value), min);
    };
    var arrayInsert = function arrayInsert2(arr, index, item2) {
      return arr.splice(index, 0, item2);
    };
    var insertItem = function insertItem2(items, item2, index) {
      if (isEmpty(item2)) {
        return null;
      }
      if (typeof index === "undefined") {
        items.push(item2);
        return item2;
      }
      index = limit(index, 0, items.length);
      arrayInsert(items, index, item2);
      return item2;
    };
    var isBase64DataURI = function isBase64DataURI2(str) {
      return /^\s*data:([a-z]+\/[a-z0-9-+.]+(;[a-z-]+=[a-z0-9-]+)?)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s]*)\s*$/i.test(str);
    };
    var getFilenameFromURL = function getFilenameFromURL2(url) {
      return url.split("/").pop().split("?").shift();
    };
    var getExtensionFromFilename = function getExtensionFromFilename2(name2) {
      return name2.split(".").pop();
    };
    var guesstimateExtension = function guesstimateExtension2(type) {
      if (typeof type !== "string") {
        return "";
      }
      var subtype = type.split("/").pop();
      if (/svg/.test(subtype)) {
        return "svg";
      }
      if (/zip|compressed/.test(subtype)) {
        return "zip";
      }
      if (/plain/.test(subtype)) {
        return "txt";
      }
      if (/msword/.test(subtype)) {
        return "doc";
      }
      if (/[a-z]+/.test(subtype)) {
        if (subtype === "jpeg") {
          return "jpg";
        }
        return subtype;
      }
      return "";
    };
    var leftPad = function leftPad2(value) {
      var padding = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : "";
      return (padding + value).slice(-padding.length);
    };
    var getDateString = function getDateString2() {
      var date = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : new Date();
      return date.getFullYear() + "-" + leftPad(date.getMonth() + 1, "00") + "-" + leftPad(date.getDate(), "00") + "_" + leftPad(date.getHours(), "00") + "-" + leftPad(date.getMinutes(), "00") + "-" + leftPad(date.getSeconds(), "00");
    };
    var getFileFromBlob = function getFileFromBlob2(blob2, filename) {
      var type = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : null;
      var extension = arguments.length > 3 && arguments[3] !== void 0 ? arguments[3] : null;
      var file2 = typeof type === "string" ? blob2.slice(0, blob2.size, type) : blob2.slice(0, blob2.size, blob2.type);
      file2.lastModifiedDate = new Date();
      if (blob2._relativePath)
        file2._relativePath = blob2._relativePath;
      if (!isString(filename)) {
        filename = getDateString();
      }
      if (filename && extension === null && getExtensionFromFilename(filename)) {
        file2.name = filename;
      } else {
        extension = extension || guesstimateExtension(file2.type);
        file2.name = filename + (extension ? "." + extension : "");
      }
      return file2;
    };
    var getBlobBuilder = function getBlobBuilder2() {
      return window.BlobBuilder = window.BlobBuilder || window.WebKitBlobBuilder || window.MozBlobBuilder || window.MSBlobBuilder;
    };
    var createBlob = function createBlob2(arrayBuffer, mimeType) {
      var BB = getBlobBuilder();
      if (BB) {
        var bb = new BB();
        bb.append(arrayBuffer);
        return bb.getBlob(mimeType);
      }
      return new Blob([arrayBuffer], {
        type: mimeType
      });
    };
    var getBlobFromByteStringWithMimeType = function getBlobFromByteStringWithMimeType2(byteString, mimeType) {
      var ab = new ArrayBuffer(byteString.length);
      var ia = new Uint8Array(ab);
      for (var i = 0; i < byteString.length; i++) {
        ia[i] = byteString.charCodeAt(i);
      }
      return createBlob(ab, mimeType);
    };
    var getMimeTypeFromBase64DataURI = function getMimeTypeFromBase64DataURI2(dataURI) {
      return (/^data:(.+);/.exec(dataURI) || [])[1] || null;
    };
    var getBase64DataFromBase64DataURI = function getBase64DataFromBase64DataURI2(dataURI) {
      var data3 = dataURI.split(",")[1];
      return data3.replace(/\s/g, "");
    };
    var getByteStringFromBase64DataURI = function getByteStringFromBase64DataURI2(dataURI) {
      return atob(getBase64DataFromBase64DataURI(dataURI));
    };
    var getBlobFromBase64DataURI = function getBlobFromBase64DataURI2(dataURI) {
      var mimeType = getMimeTypeFromBase64DataURI(dataURI);
      var byteString = getByteStringFromBase64DataURI(dataURI);
      return getBlobFromByteStringWithMimeType(byteString, mimeType);
    };
    var getFileFromBase64DataURI = function getFileFromBase64DataURI2(dataURI, filename, extension) {
      return getFileFromBlob(getBlobFromBase64DataURI(dataURI), filename, null, extension);
    };
    var getFileNameFromHeader = function getFileNameFromHeader2(header) {
      if (!/^content-disposition:/i.test(header))
        return null;
      var matches = header.split(/filename=|filename\*=.+''/).splice(1).map(function(name2) {
        return name2.trim().replace(/^["']|[;"']{0,2}$/g, "");
      }).filter(function(name2) {
        return name2.length;
      });
      return matches.length ? decodeURI(matches[matches.length - 1]) : null;
    };
    var getFileSizeFromHeader = function getFileSizeFromHeader2(header) {
      if (/content-length:/i.test(header)) {
        var size = header.match(/[0-9]+/)[0];
        return size ? parseInt(size, 10) : null;
      }
      return null;
    };
    var getTranfserIdFromHeader = function getTranfserIdFromHeader2(header) {
      if (/x-content-transfer-id:/i.test(header)) {
        var id2 = (header.split(":")[1] || "").trim();
        return id2 || null;
      }
      return null;
    };
    var getFileInfoFromHeaders = function getFileInfoFromHeaders2(headers) {
      var info = {
        source: null,
        name: null,
        size: null
      };
      var rows = headers.split("\n");
      var _iteratorNormalCompletion = true;
      var _didIteratorError = false;
      var _iteratorError = void 0;
      try {
        for (var _iterator = rows[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
          var header = _step.value;
          var name2 = getFileNameFromHeader(header);
          if (name2) {
            info.name = name2;
            continue;
          }
          var size = getFileSizeFromHeader(header);
          if (size) {
            info.size = size;
            continue;
          }
          var source = getTranfserIdFromHeader(header);
          if (source) {
            info.source = source;
            continue;
          }
        }
      } catch (err) {
        _didIteratorError = true;
        _iteratorError = err;
      } finally {
        try {
          if (!_iteratorNormalCompletion && _iterator.return != null) {
            _iterator.return();
          }
        } finally {
          if (_didIteratorError) {
            throw _iteratorError;
          }
        }
      }
      return info;
    };
    var createFileLoader = function createFileLoader2(fetchFn) {
      var state2 = {
        source: null,
        complete: false,
        progress: 0,
        size: null,
        timestamp: null,
        duration: 0,
        request: null
      };
      var getProgress = function getProgress2() {
        return state2.progress;
      };
      var abort = function abort2() {
        if (state2.request && state2.request.abort) {
          state2.request.abort();
        }
      };
      var load = function load2() {
        var source = state2.source;
        api.fire("init", source);
        if (source instanceof File) {
          api.fire("load", source);
        } else if (source instanceof Blob) {
          api.fire("load", getFileFromBlob(source, source.name));
        } else if (isBase64DataURI(source)) {
          api.fire("load", getFileFromBase64DataURI(source));
        } else {
          loadURL(source);
        }
      };
      var loadURL = function loadURL2(url) {
        if (!fetchFn) {
          api.fire("error", {
            type: "error",
            body: "Can't load URL",
            code: 400
          });
          return;
        }
        state2.timestamp = Date.now();
        state2.request = fetchFn(url, function(response) {
          state2.duration = Date.now() - state2.timestamp;
          state2.complete = true;
          if (response instanceof Blob) {
            response = getFileFromBlob(response, response.name || getFilenameFromURL(url));
          }
          api.fire("load", response instanceof Blob ? response : response ? response.body : null);
        }, function(error2) {
          api.fire("error", typeof error2 === "string" ? {
            type: "error",
            code: 0,
            body: error2
          } : error2);
        }, function(computable, current, total) {
          if (total) {
            state2.size = total;
          }
          state2.duration = Date.now() - state2.timestamp;
          if (!computable) {
            state2.progress = null;
            return;
          }
          state2.progress = current / total;
          api.fire("progress", state2.progress);
        }, function() {
          api.fire("abort");
        }, function(response) {
          var fileinfo = getFileInfoFromHeaders(typeof response === "string" ? response : response.headers);
          api.fire("meta", {
            size: state2.size || fileinfo.size,
            filename: fileinfo.name,
            source: fileinfo.source
          });
        });
      };
      var api = Object.assign({}, on(), {
        setSource: function setSource(source) {
          return state2.source = source;
        },
        getProgress,
        abort,
        load
      });
      return api;
    };
    var isGet = function isGet2(method) {
      return /GET|HEAD/.test(method);
    };
    var sendRequest = function sendRequest2(data3, url, options) {
      var api = {
        onheaders: function onheaders() {
        },
        onprogress: function onprogress() {
        },
        onload: function onload() {
        },
        ontimeout: function ontimeout() {
        },
        onerror: function onerror() {
        },
        onabort: function onabort() {
        },
        abort: function abort() {
          aborted = true;
          xhr.abort();
        }
      };
      var aborted = false;
      var headersReceived = false;
      options = Object.assign({
        method: "POST",
        headers: {},
        withCredentials: false
      }, options);
      url = encodeURI(url);
      if (isGet(options.method) && data3) {
        url = "" + url + encodeURIComponent(typeof data3 === "string" ? data3 : JSON.stringify(data3));
      }
      var xhr = new XMLHttpRequest();
      var process = isGet(options.method) ? xhr : xhr.upload;
      process.onprogress = function(e) {
        if (aborted) {
          return;
        }
        api.onprogress(e.lengthComputable, e.loaded, e.total);
      };
      xhr.onreadystatechange = function() {
        if (xhr.readyState < 2) {
          return;
        }
        if (xhr.readyState === 4 && xhr.status === 0) {
          return;
        }
        if (headersReceived) {
          return;
        }
        headersReceived = true;
        api.onheaders(xhr);
      };
      xhr.onload = function() {
        if (xhr.status >= 200 && xhr.status < 300) {
          api.onload(xhr);
        } else {
          api.onerror(xhr);
        }
      };
      xhr.onerror = function() {
        return api.onerror(xhr);
      };
      xhr.onabort = function() {
        aborted = true;
        api.onabort();
      };
      xhr.ontimeout = function() {
        return api.ontimeout(xhr);
      };
      xhr.open(options.method, url, true);
      if (isInt(options.timeout)) {
        xhr.timeout = options.timeout;
      }
      Object.keys(options.headers).forEach(function(key) {
        var value = unescape(encodeURIComponent(options.headers[key]));
        xhr.setRequestHeader(key, value);
      });
      if (options.responseType) {
        xhr.responseType = options.responseType;
      }
      if (options.withCredentials) {
        xhr.withCredentials = true;
      }
      xhr.send(data3);
      return api;
    };
    var createResponse = function createResponse2(type, code, body, headers) {
      return {
        type,
        code,
        body,
        headers
      };
    };
    var createTimeoutResponse = function createTimeoutResponse2(cb) {
      return function(xhr) {
        cb(createResponse("error", 0, "Timeout", xhr.getAllResponseHeaders()));
      };
    };
    var hasQS = function hasQS2(str) {
      return /\?/.test(str);
    };
    var buildURL = function buildURL2() {
      var url = "";
      for (var _len = arguments.length, parts = new Array(_len), _key = 0; _key < _len; _key++) {
        parts[_key] = arguments[_key];
      }
      parts.forEach(function(part) {
        url += hasQS(url) && hasQS(part) ? part.replace(/\?/, "&") : part;
      });
      return url;
    };
    var createFetchFunction = function createFetchFunction2() {
      var apiUrl = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : "";
      var action = arguments.length > 1 ? arguments[1] : void 0;
      if (typeof action === "function") {
        return action;
      }
      if (!action || !isString(action.url)) {
        return null;
      }
      var onload = action.onload || function(res2) {
        return res2;
      };
      var onerror = action.onerror || function(res2) {
        return null;
      };
      return function(url, load, error2, progress, abort, headers) {
        var request = sendRequest(url, buildURL(apiUrl, action.url), Object.assign({}, action, {
          responseType: "blob"
        }));
        request.onload = function(xhr) {
          var headers2 = xhr.getAllResponseHeaders();
          var filename = getFileInfoFromHeaders(headers2).name || getFilenameFromURL(url);
          load(createResponse("load", xhr.status, action.method === "HEAD" ? null : getFileFromBlob(onload(xhr.response), filename), headers2));
        };
        request.onerror = function(xhr) {
          error2(createResponse("error", xhr.status, onerror(xhr.response) || xhr.statusText, xhr.getAllResponseHeaders()));
        };
        request.onheaders = function(xhr) {
          headers(createResponse("headers", xhr.status, null, xhr.getAllResponseHeaders()));
        };
        request.ontimeout = createTimeoutResponse(error2);
        request.onprogress = progress;
        request.onabort = abort;
        return request;
      };
    };
    var ChunkStatus = {
      QUEUED: 0,
      COMPLETE: 1,
      PROCESSING: 2,
      ERROR: 3,
      WAITING: 4
    };
    var processFileChunked = function processFileChunked2(apiUrl, action, name2, file2, metadata, load, error2, progress, abort, transfer, options) {
      var chunks = [];
      var chunkTransferId = options.chunkTransferId, chunkServer = options.chunkServer, chunkSize = options.chunkSize, chunkRetryDelays = options.chunkRetryDelays;
      var state2 = {
        serverId: chunkTransferId,
        aborted: false
      };
      var ondata = action.ondata || function(fd) {
        return fd;
      };
      var onload = action.onload || function(xhr, method) {
        return method === "HEAD" ? xhr.getResponseHeader("Upload-Offset") : xhr.response;
      };
      var onerror = action.onerror || function(res2) {
        return null;
      };
      var requestTransferId = function requestTransferId2(cb) {
        var formData = new FormData();
        if (isObject(metadata))
          formData.append(name2, JSON.stringify(metadata));
        var headers = typeof action.headers === "function" ? action.headers(file2, metadata) : Object.assign({}, action.headers, {
          "Upload-Length": file2.size
        });
        var requestParams = Object.assign({}, action, {
          headers
        });
        var request = sendRequest(ondata(formData), buildURL(apiUrl, action.url), requestParams);
        request.onload = function(xhr) {
          return cb(onload(xhr, requestParams.method));
        };
        request.onerror = function(xhr) {
          return error2(createResponse("error", xhr.status, onerror(xhr.response) || xhr.statusText, xhr.getAllResponseHeaders()));
        };
        request.ontimeout = createTimeoutResponse(error2);
      };
      var requestTransferOffset = function requestTransferOffset2(cb) {
        var requestUrl = buildURL(apiUrl, chunkServer.url, state2.serverId);
        var headers = typeof action.headers === "function" ? action.headers(state2.serverId) : Object.assign({}, action.headers);
        var requestParams = {
          headers,
          method: "HEAD"
        };
        var request = sendRequest(null, requestUrl, requestParams);
        request.onload = function(xhr) {
          return cb(onload(xhr, requestParams.method));
        };
        request.onerror = function(xhr) {
          return error2(createResponse("error", xhr.status, onerror(xhr.response) || xhr.statusText, xhr.getAllResponseHeaders()));
        };
        request.ontimeout = createTimeoutResponse(error2);
      };
      var lastChunkIndex = Math.floor(file2.size / chunkSize);
      for (var i = 0; i <= lastChunkIndex; i++) {
        var offset = i * chunkSize;
        var data3 = file2.slice(offset, offset + chunkSize, "application/offset+octet-stream");
        chunks[i] = {
          index: i,
          size: data3.size,
          offset,
          data: data3,
          file: file2,
          progress: 0,
          retries: _toConsumableArray(chunkRetryDelays),
          status: ChunkStatus.QUEUED,
          error: null,
          request: null,
          timeout: null
        };
      }
      var completeProcessingChunks = function completeProcessingChunks2() {
        return load(state2.serverId);
      };
      var canProcessChunk = function canProcessChunk2(chunk) {
        return chunk.status === ChunkStatus.QUEUED || chunk.status === ChunkStatus.ERROR;
      };
      var processChunk = function processChunk2(chunk) {
        if (state2.aborted)
          return;
        chunk = chunk || chunks.find(canProcessChunk);
        if (!chunk) {
          if (chunks.every(function(chunk2) {
            return chunk2.status === ChunkStatus.COMPLETE;
          })) {
            completeProcessingChunks();
          }
          return;
        }
        chunk.status = ChunkStatus.PROCESSING;
        chunk.progress = null;
        var ondata2 = chunkServer.ondata || function(fd) {
          return fd;
        };
        var onerror2 = chunkServer.onerror || function(res2) {
          return null;
        };
        var requestUrl = buildURL(apiUrl, chunkServer.url, state2.serverId);
        var headers = typeof chunkServer.headers === "function" ? chunkServer.headers(chunk) : Object.assign({}, chunkServer.headers, {
          "Content-Type": "application/offset+octet-stream",
          "Upload-Offset": chunk.offset,
          "Upload-Length": file2.size,
          "Upload-Name": file2.name
        });
        var request = chunk.request = sendRequest(ondata2(chunk.data), requestUrl, Object.assign({}, chunkServer, {
          headers
        }));
        request.onload = function() {
          chunk.status = ChunkStatus.COMPLETE;
          chunk.request = null;
          processChunks();
        };
        request.onprogress = function(lengthComputable, loaded, total) {
          chunk.progress = lengthComputable ? loaded : null;
          updateTotalProgress();
        };
        request.onerror = function(xhr) {
          chunk.status = ChunkStatus.ERROR;
          chunk.request = null;
          chunk.error = onerror2(xhr.response) || xhr.statusText;
          if (!retryProcessChunk(chunk)) {
            error2(createResponse("error", xhr.status, onerror2(xhr.response) || xhr.statusText, xhr.getAllResponseHeaders()));
          }
        };
        request.ontimeout = function(xhr) {
          chunk.status = ChunkStatus.ERROR;
          chunk.request = null;
          if (!retryProcessChunk(chunk)) {
            createTimeoutResponse(error2)(xhr);
          }
        };
        request.onabort = function() {
          chunk.status = ChunkStatus.QUEUED;
          chunk.request = null;
          abort();
        };
      };
      var retryProcessChunk = function retryProcessChunk2(chunk) {
        if (chunk.retries.length === 0)
          return false;
        chunk.status = ChunkStatus.WAITING;
        clearTimeout(chunk.timeout);
        chunk.timeout = setTimeout(function() {
          processChunk(chunk);
        }, chunk.retries.shift());
        return true;
      };
      var updateTotalProgress = function updateTotalProgress2() {
        var totalBytesTransfered = chunks.reduce(function(p, chunk) {
          if (p === null || chunk.progress === null)
            return null;
          return p + chunk.progress;
        }, 0);
        if (totalBytesTransfered === null)
          return progress(false, 0, 0);
        var totalSize = chunks.reduce(function(total, chunk) {
          return total + chunk.size;
        }, 0);
        progress(true, totalBytesTransfered, totalSize);
      };
      var processChunks = function processChunks2() {
        var totalProcessing = chunks.filter(function(chunk) {
          return chunk.status === ChunkStatus.PROCESSING;
        }).length;
        if (totalProcessing >= 1)
          return;
        processChunk();
      };
      var abortChunks = function abortChunks2() {
        chunks.forEach(function(chunk) {
          clearTimeout(chunk.timeout);
          if (chunk.request) {
            chunk.request.abort();
          }
        });
      };
      if (!state2.serverId) {
        requestTransferId(function(serverId) {
          if (state2.aborted)
            return;
          transfer(serverId);
          state2.serverId = serverId;
          processChunks();
        });
      } else {
        requestTransferOffset(function(offset2) {
          if (state2.aborted)
            return;
          chunks.filter(function(chunk) {
            return chunk.offset < offset2;
          }).forEach(function(chunk) {
            chunk.status = ChunkStatus.COMPLETE;
            chunk.progress = chunk.size;
          });
          processChunks();
        });
      }
      return {
        abort: function abort2() {
          state2.aborted = true;
          abortChunks();
        }
      };
    };
    var createFileProcessorFunction = function createFileProcessorFunction2(apiUrl, action, name2, options) {
      return function(file2, metadata, load, error2, progress, abort, transfer) {
        if (!file2)
          return;
        var canChunkUpload = options.chunkUploads;
        var shouldChunkUpload = canChunkUpload && file2.size > options.chunkSize;
        var willChunkUpload = canChunkUpload && (shouldChunkUpload || options.chunkForce);
        if (file2 instanceof Blob && willChunkUpload)
          return processFileChunked(apiUrl, action, name2, file2, metadata, load, error2, progress, abort, transfer, options);
        var ondata = action.ondata || function(fd) {
          return fd;
        };
        var onload = action.onload || function(res2) {
          return res2;
        };
        var onerror = action.onerror || function(res2) {
          return null;
        };
        var headers = typeof action.headers === "function" ? action.headers(file2, metadata) || {} : Object.assign({}, action.headers);
        var requestParams = Object.assign({}, action, {
          headers
        });
        var formData = new FormData();
        if (isObject(metadata)) {
          formData.append(name2, JSON.stringify(metadata));
        }
        (file2 instanceof Blob ? [{name: null, file: file2}] : file2).forEach(function(item2) {
          formData.append(name2, item2.file, item2.name === null ? item2.file.name : "" + item2.name + item2.file.name);
        });
        var request = sendRequest(ondata(formData), buildURL(apiUrl, action.url), requestParams);
        request.onload = function(xhr) {
          load(createResponse("load", xhr.status, onload(xhr.response), xhr.getAllResponseHeaders()));
        };
        request.onerror = function(xhr) {
          error2(createResponse("error", xhr.status, onerror(xhr.response) || xhr.statusText, xhr.getAllResponseHeaders()));
        };
        request.ontimeout = createTimeoutResponse(error2);
        request.onprogress = progress;
        request.onabort = abort;
        return request;
      };
    };
    var createProcessorFunction = function createProcessorFunction2() {
      var apiUrl = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : "";
      var action = arguments.length > 1 ? arguments[1] : void 0;
      var name2 = arguments.length > 2 ? arguments[2] : void 0;
      var options = arguments.length > 3 ? arguments[3] : void 0;
      if (typeof action === "function")
        return function() {
          for (var _len = arguments.length, params = new Array(_len), _key = 0; _key < _len; _key++) {
            params[_key] = arguments[_key];
          }
          return action.apply(void 0, [name2].concat(params, [options]));
        };
      if (!action || !isString(action.url))
        return null;
      return createFileProcessorFunction(apiUrl, action, name2, options);
    };
    var createRevertFunction = function createRevertFunction2() {
      var apiUrl = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : "";
      var action = arguments.length > 1 ? arguments[1] : void 0;
      if (typeof action === "function") {
        return action;
      }
      if (!action || !isString(action.url)) {
        return function(uniqueFileId, load) {
          return load();
        };
      }
      var onload = action.onload || function(res2) {
        return res2;
      };
      var onerror = action.onerror || function(res2) {
        return null;
      };
      return function(uniqueFileId, load, error2) {
        var request = sendRequest(uniqueFileId, apiUrl + action.url, action);
        request.onload = function(xhr) {
          load(createResponse("load", xhr.status, onload(xhr.response), xhr.getAllResponseHeaders()));
        };
        request.onerror = function(xhr) {
          error2(createResponse("error", xhr.status, onerror(xhr.response) || xhr.statusText, xhr.getAllResponseHeaders()));
        };
        request.ontimeout = createTimeoutResponse(error2);
        return request;
      };
    };
    var getRandomNumber = function getRandomNumber2() {
      var min = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : 0;
      var max = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : 1;
      return min + Math.random() * (max - min);
    };
    var createPerceivedPerformanceUpdater = function createPerceivedPerformanceUpdater2(cb) {
      var duration = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : 1e3;
      var offset = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : 0;
      var tickMin = arguments.length > 3 && arguments[3] !== void 0 ? arguments[3] : 25;
      var tickMax = arguments.length > 4 && arguments[4] !== void 0 ? arguments[4] : 250;
      var timeout = null;
      var start = Date.now();
      var tick = function tick2() {
        var runtime = Date.now() - start;
        var delay = getRandomNumber(tickMin, tickMax);
        if (runtime + delay > duration) {
          delay = runtime + delay - duration;
        }
        var progress = runtime / duration;
        if (progress >= 1 || document.hidden) {
          cb(1);
          return;
        }
        cb(progress);
        timeout = setTimeout(tick2, delay);
      };
      if (duration > 0)
        tick();
      return {
        clear: function clear2() {
          clearTimeout(timeout);
        }
      };
    };
    var createFileProcessor = function createFileProcessor2(processFn, options) {
      var state2 = {
        complete: false,
        perceivedProgress: 0,
        perceivedPerformanceUpdater: null,
        progress: null,
        timestamp: null,
        perceivedDuration: 0,
        duration: 0,
        request: null,
        response: null
      };
      var allowMinimumUploadDuration = options.allowMinimumUploadDuration;
      var process = function process2(file2, metadata) {
        var progressFn = function progressFn2() {
          if (state2.duration === 0 || state2.progress === null)
            return;
          api.fire("progress", api.getProgress());
        };
        var completeFn = function completeFn2() {
          state2.complete = true;
          api.fire("load-perceived", state2.response.body);
        };
        api.fire("start");
        state2.timestamp = Date.now();
        state2.perceivedPerformanceUpdater = createPerceivedPerformanceUpdater(function(progress) {
          state2.perceivedProgress = progress;
          state2.perceivedDuration = Date.now() - state2.timestamp;
          progressFn();
          if (state2.response && state2.perceivedProgress === 1 && !state2.complete) {
            completeFn();
          }
        }, allowMinimumUploadDuration ? getRandomNumber(750, 1500) : 0);
        state2.request = processFn(file2, metadata, function(response) {
          state2.response = isObject(response) ? response : {
            type: "load",
            code: 200,
            body: "" + response,
            headers: {}
          };
          state2.duration = Date.now() - state2.timestamp;
          state2.progress = 1;
          api.fire("load", state2.response.body);
          if (!allowMinimumUploadDuration || allowMinimumUploadDuration && state2.perceivedProgress === 1) {
            completeFn();
          }
        }, function(error2) {
          state2.perceivedPerformanceUpdater.clear();
          api.fire("error", isObject(error2) ? error2 : {
            type: "error",
            code: 0,
            body: "" + error2
          });
        }, function(computable, current, total) {
          state2.duration = Date.now() - state2.timestamp;
          state2.progress = computable ? current / total : null;
          progressFn();
        }, function() {
          state2.perceivedPerformanceUpdater.clear();
          api.fire("abort", state2.response ? state2.response.body : null);
        }, function(transferId) {
          api.fire("transfer", transferId);
        });
      };
      var abort = function abort2() {
        if (!state2.request)
          return;
        state2.perceivedPerformanceUpdater.clear();
        if (state2.request.abort)
          state2.request.abort();
        state2.complete = true;
      };
      var reset = function reset2() {
        abort();
        state2.complete = false;
        state2.perceivedProgress = 0;
        state2.progress = 0;
        state2.timestamp = null;
        state2.perceivedDuration = 0;
        state2.duration = 0;
        state2.request = null;
        state2.response = null;
      };
      var getProgress = allowMinimumUploadDuration ? function() {
        return state2.progress ? Math.min(state2.progress, state2.perceivedProgress) : null;
      } : function() {
        return state2.progress || null;
      };
      var getDuration = allowMinimumUploadDuration ? function() {
        return Math.min(state2.duration, state2.perceivedDuration);
      } : function() {
        return state2.duration;
      };
      var api = Object.assign({}, on(), {
        process,
        abort,
        getProgress,
        getDuration,
        reset
      });
      return api;
    };
    var getFilenameWithoutExtension = function getFilenameWithoutExtension2(name2) {
      return name2.substr(0, name2.lastIndexOf(".")) || name2;
    };
    var createFileStub = function createFileStub2(source) {
      var data3 = [source.name, source.size, source.type];
      if (source instanceof Blob || isBase64DataURI(source)) {
        data3[0] = source.name || getDateString();
      } else if (isBase64DataURI(source)) {
        data3[1] = source.length;
        data3[2] = getMimeTypeFromBase64DataURI(source);
      } else if (isString(source)) {
        data3[0] = getFilenameFromURL(source);
        data3[1] = 0;
        data3[2] = "application/octet-stream";
      }
      return {
        name: data3[0],
        size: data3[1],
        type: data3[2]
      };
    };
    var isFile = function isFile2(value) {
      return !!(value instanceof File || value instanceof Blob && value.name);
    };
    var deepCloneObject = function deepCloneObject2(src) {
      if (!isObject(src))
        return src;
      var target = isArray(src) ? [] : {};
      for (var key in src) {
        if (!src.hasOwnProperty(key))
          continue;
        var v = src[key];
        target[key] = v && isObject(v) ? deepCloneObject2(v) : v;
      }
      return target;
    };
    var createItem = function createItem2() {
      var origin = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : null;
      var serverFileReference = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : null;
      var file2 = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : null;
      var id2 = getUniqueId();
      var state2 = {
        archived: false,
        frozen: false,
        released: false,
        source: null,
        file: file2,
        serverFileReference,
        transferId: null,
        processingAborted: false,
        status: serverFileReference ? ItemStatus.PROCESSING_COMPLETE : ItemStatus.INIT,
        activeLoader: null,
        activeProcessor: null
      };
      var abortProcessingRequestComplete = null;
      var metadata = {};
      var setStatus = function setStatus2(status) {
        return state2.status = status;
      };
      var fire2 = function fire3(event) {
        if (state2.released || state2.frozen)
          return;
        for (var _len = arguments.length, params = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
          params[_key - 1] = arguments[_key];
        }
        api.fire.apply(api, [event].concat(params));
      };
      var getFileExtension = function getFileExtension2() {
        return getExtensionFromFilename(state2.file.name);
      };
      var getFileType = function getFileType2() {
        return state2.file.type;
      };
      var getFileSize = function getFileSize2() {
        return state2.file.size;
      };
      var getFile = function getFile2() {
        return state2.file;
      };
      var load = function load2(source, loader, onload) {
        state2.source = source;
        api.fireSync("init");
        if (state2.file) {
          api.fireSync("load-skip");
          return;
        }
        state2.file = createFileStub(source);
        loader.on("init", function() {
          fire2("load-init");
        });
        loader.on("meta", function(meta) {
          state2.file.size = meta.size;
          state2.file.filename = meta.filename;
          if (meta.source) {
            origin = FileOrigin.LIMBO;
            state2.serverFileReference = meta.source;
            state2.status = ItemStatus.PROCESSING_COMPLETE;
          }
          fire2("load-meta");
        });
        loader.on("progress", function(progress) {
          setStatus(ItemStatus.LOADING);
          fire2("load-progress", progress);
        });
        loader.on("error", function(error2) {
          setStatus(ItemStatus.LOAD_ERROR);
          fire2("load-request-error", error2);
        });
        loader.on("abort", function() {
          setStatus(ItemStatus.INIT);
          fire2("load-abort");
        });
        loader.on("load", function(file3) {
          state2.activeLoader = null;
          var success = function success2(result) {
            state2.file = isFile(result) ? result : state2.file;
            if (origin === FileOrigin.LIMBO && state2.serverFileReference) {
              setStatus(ItemStatus.PROCESSING_COMPLETE);
            } else {
              setStatus(ItemStatus.IDLE);
            }
            fire2("load");
          };
          var error2 = function error3(result) {
            state2.file = file3;
            fire2("load-meta");
            setStatus(ItemStatus.LOAD_ERROR);
            fire2("load-file-error", result);
          };
          if (state2.serverFileReference) {
            success(file3);
            return;
          }
          onload(file3, success, error2);
        });
        loader.setSource(source);
        state2.activeLoader = loader;
        loader.load();
      };
      var retryLoad = function retryLoad2() {
        if (!state2.activeLoader) {
          return;
        }
        state2.activeLoader.load();
      };
      var abortLoad = function abortLoad2() {
        if (state2.activeLoader) {
          state2.activeLoader.abort();
          return;
        }
        setStatus(ItemStatus.INIT);
        fire2("load-abort");
      };
      var process = function process2(processor, onprocess) {
        if (state2.processingAborted) {
          state2.processingAborted = false;
          return;
        }
        setStatus(ItemStatus.PROCESSING);
        abortProcessingRequestComplete = null;
        if (!(state2.file instanceof Blob)) {
          api.on("load", function() {
            process2(processor, onprocess);
          });
          return;
        }
        processor.on("load", function(serverFileReference2) {
          state2.transferId = null;
          state2.serverFileReference = serverFileReference2;
        });
        processor.on("transfer", function(transferId) {
          state2.transferId = transferId;
        });
        processor.on("load-perceived", function(serverFileReference2) {
          state2.activeProcessor = null;
          state2.transferId = null;
          state2.serverFileReference = serverFileReference2;
          setStatus(ItemStatus.PROCESSING_COMPLETE);
          fire2("process-complete", serverFileReference2);
        });
        processor.on("start", function() {
          fire2("process-start");
        });
        processor.on("error", function(error3) {
          state2.activeProcessor = null;
          setStatus(ItemStatus.PROCESSING_ERROR);
          fire2("process-error", error3);
        });
        processor.on("abort", function(serverFileReference2) {
          state2.activeProcessor = null;
          state2.serverFileReference = serverFileReference2;
          setStatus(ItemStatus.IDLE);
          fire2("process-abort");
          if (abortProcessingRequestComplete) {
            abortProcessingRequestComplete();
          }
        });
        processor.on("progress", function(progress) {
          fire2("process-progress", progress);
        });
        var success = function success2(file3) {
          if (state2.archived)
            return;
          processor.process(file3, Object.assign({}, metadata));
        };
        var error2 = console.error;
        onprocess(state2.file, success, error2);
        state2.activeProcessor = processor;
      };
      var requestProcessing = function requestProcessing2() {
        state2.processingAborted = false;
        setStatus(ItemStatus.PROCESSING_QUEUED);
      };
      var abortProcessing = function abortProcessing2() {
        return new Promise(function(resolve) {
          if (!state2.activeProcessor) {
            state2.processingAborted = true;
            setStatus(ItemStatus.IDLE);
            fire2("process-abort");
            resolve();
            return;
          }
          abortProcessingRequestComplete = function abortProcessingRequestComplete2() {
            resolve();
          };
          state2.activeProcessor.abort();
        });
      };
      var revert = function revert2(revertFileUpload, forceRevert) {
        return new Promise(function(resolve, reject) {
          var serverTransferId = state2.serverFileReference !== null ? state2.serverFileReference : state2.transferId;
          if (serverTransferId === null) {
            resolve();
            return;
          }
          revertFileUpload(serverTransferId, function() {
            state2.serverFileReference = null;
            state2.transferId = null;
            resolve();
          }, function(error2) {
            if (!forceRevert) {
              resolve();
              return;
            }
            setStatus(ItemStatus.PROCESSING_REVERT_ERROR);
            fire2("process-revert-error");
            reject(error2);
          });
          setStatus(ItemStatus.IDLE);
          fire2("process-revert");
        });
      };
      var _setMetadata = function setMetadata(key, value, silent) {
        var keys = key.split(".");
        var root2 = keys[0];
        var last = keys.pop();
        var data3 = metadata;
        keys.forEach(function(key2) {
          return data3 = data3[key2];
        });
        if (JSON.stringify(data3[last]) === JSON.stringify(value))
          return;
        data3[last] = value;
        fire2("metadata-update", {
          key: root2,
          value: metadata[root2],
          silent
        });
      };
      var getMetadata = function getMetadata2(key) {
        return deepCloneObject(key ? metadata[key] : metadata);
      };
      var api = Object.assign({
        id: {
          get: function get() {
            return id2;
          }
        },
        origin: {
          get: function get() {
            return origin;
          },
          set: function set2(value) {
            return origin = value;
          }
        },
        serverId: {
          get: function get() {
            return state2.serverFileReference;
          }
        },
        transferId: {
          get: function get() {
            return state2.transferId;
          }
        },
        status: {
          get: function get() {
            return state2.status;
          }
        },
        filename: {
          get: function get() {
            return state2.file.name;
          }
        },
        filenameWithoutExtension: {
          get: function get() {
            return getFilenameWithoutExtension(state2.file.name);
          }
        },
        fileExtension: {get: getFileExtension},
        fileType: {get: getFileType},
        fileSize: {get: getFileSize},
        file: {get: getFile},
        relativePath: {
          get: function get() {
            return state2.file._relativePath;
          }
        },
        source: {
          get: function get() {
            return state2.source;
          }
        },
        getMetadata,
        setMetadata: function setMetadata(key, value, silent) {
          if (isObject(key)) {
            var data3 = key;
            Object.keys(data3).forEach(function(key2) {
              _setMetadata(key2, data3[key2], value);
            });
            return key;
          }
          _setMetadata(key, value, silent);
          return value;
        },
        extend: function extend(name2, handler) {
          return itemAPI[name2] = handler;
        },
        abortLoad,
        retryLoad,
        requestProcessing,
        abortProcessing,
        load,
        process,
        revert
      }, on(), {
        freeze: function freeze() {
          return state2.frozen = true;
        },
        release: function release() {
          return state2.released = true;
        },
        released: {
          get: function get() {
            return state2.released;
          }
        },
        archive: function archive() {
          return state2.archived = true;
        },
        archived: {
          get: function get() {
            return state2.archived;
          }
        }
      });
      var itemAPI = createObject(api);
      return itemAPI;
    };
    var getItemIndexByQuery = function getItemIndexByQuery2(items, query) {
      if (isEmpty(query)) {
        return 0;
      }
      if (!isString(query)) {
        return -1;
      }
      return items.findIndex(function(item2) {
        return item2.id === query;
      });
    };
    var getItemById = function getItemById2(items, itemId) {
      var index = getItemIndexByQuery(items, itemId);
      if (index < 0) {
        return;
      }
      return items[index] || null;
    };
    var fetchBlob = function fetchBlob2(url, load, error2, progress, abort, headers) {
      var request = sendRequest(null, url, {
        method: "GET",
        responseType: "blob"
      });
      request.onload = function(xhr) {
        var headers2 = xhr.getAllResponseHeaders();
        var filename = getFileInfoFromHeaders(headers2).name || getFilenameFromURL(url);
        load(createResponse("load", xhr.status, getFileFromBlob(xhr.response, filename), headers2));
      };
      request.onerror = function(xhr) {
        error2(createResponse("error", xhr.status, xhr.statusText, xhr.getAllResponseHeaders()));
      };
      request.onheaders = function(xhr) {
        headers(createResponse("headers", xhr.status, null, xhr.getAllResponseHeaders()));
      };
      request.ontimeout = createTimeoutResponse(error2);
      request.onprogress = progress;
      request.onabort = abort;
      return request;
    };
    var getDomainFromURL = function getDomainFromURL2(url) {
      if (url.indexOf("//") === 0) {
        url = location.protocol + url;
      }
      return url.toLowerCase().replace("blob:", "").replace(/([a-z])?:\/\//, "$1").split("/")[0];
    };
    var isExternalURL = function isExternalURL2(url) {
      return (url.indexOf(":") > -1 || url.indexOf("//") > -1) && getDomainFromURL(location.href) !== getDomainFromURL(url);
    };
    var dynamicLabel = function dynamicLabel2(label) {
      return function() {
        return isFunction(label) ? label.apply(void 0, arguments) : label;
      };
    };
    var isMockItem = function isMockItem2(item2) {
      return !isFile(item2.file);
    };
    var listUpdated = function listUpdated2(dispatch2, state2) {
      clearTimeout(state2.listUpdateTimeout);
      state2.listUpdateTimeout = setTimeout(function() {
        dispatch2("DID_UPDATE_ITEMS", {items: getActiveItems(state2.items)});
      }, 0);
    };
    var optionalPromise = function optionalPromise2(fn2) {
      for (var _len = arguments.length, params = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
        params[_key - 1] = arguments[_key];
      }
      return new Promise(function(resolve) {
        if (!fn2) {
          return resolve(true);
        }
        var result = fn2.apply(void 0, params);
        if (result == null) {
          return resolve(true);
        }
        if (typeof result === "boolean") {
          return resolve(result);
        }
        if (typeof result.then === "function") {
          result.then(resolve);
        }
      });
    };
    var sortItems = function sortItems2(state2, compare) {
      state2.items.sort(function(a, b) {
        return compare(createItemAPI(a), createItemAPI(b));
      });
    };
    var getItemByQueryFromState = function getItemByQueryFromState2(state2, itemHandler) {
      return function() {
        var _ref = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : {};
        var query = _ref.query, _ref$success = _ref.success, success = _ref$success === void 0 ? function() {
        } : _ref$success, _ref$failure = _ref.failure, failure = _ref$failure === void 0 ? function() {
        } : _ref$failure, options = _objectWithoutProperties(_ref, ["query", "success", "failure"]);
        var item2 = getItemByQuery(state2.items, query);
        if (!item2) {
          failure({
            error: createResponse("error", 0, "Item not found"),
            file: null
          });
          return;
        }
        itemHandler(item2, success, failure, options || {});
      };
    };
    var actions = function actions2(dispatch2, query, state2) {
      return {
        ABORT_ALL: function ABORT_ALL() {
          getActiveItems(state2.items).forEach(function(item2) {
            item2.freeze();
            item2.abortLoad();
            item2.abortProcessing();
          });
        },
        DID_SET_FILES: function DID_SET_FILES(_ref2) {
          var _ref2$value = _ref2.value, value = _ref2$value === void 0 ? [] : _ref2$value;
          var files = value.map(function(file2) {
            return {
              source: file2.source ? file2.source : file2,
              options: file2.options
            };
          });
          var activeItems = getActiveItems(state2.items);
          activeItems.forEach(function(item2) {
            if (!files.find(function(file2) {
              return file2.source === item2.source || file2.source === item2.file;
            })) {
              dispatch2("REMOVE_ITEM", {query: item2, remove: false});
            }
          });
          activeItems = getActiveItems(state2.items);
          files.forEach(function(file2, index) {
            if (activeItems.find(function(item2) {
              return item2.source === file2.source || item2.file === file2.source;
            }))
              return;
            dispatch2("ADD_ITEM", Object.assign({}, file2, {
              interactionMethod: InteractionMethod.NONE,
              index
            }));
          });
        },
        DID_UPDATE_ITEM_METADATA: function DID_UPDATE_ITEM_METADATA(_ref3) {
          var id2 = _ref3.id, action = _ref3.action, change = _ref3.change;
          if (change.silent)
            return;
          clearTimeout(state2.itemUpdateTimeout);
          state2.itemUpdateTimeout = setTimeout(function() {
            var item2 = getItemById(state2.items, id2);
            if (!query("IS_ASYNC")) {
              applyFilterChain("SHOULD_PREPARE_OUTPUT", false, {
                item: item2,
                query,
                action,
                change
              }).then(function(shouldPrepareOutput) {
                var beforePrepareFile = query("GET_BEFORE_PREPARE_FILE");
                if (beforePrepareFile)
                  shouldPrepareOutput = beforePrepareFile(item2, shouldPrepareOutput);
                if (!shouldPrepareOutput)
                  return;
                dispatch2("REQUEST_PREPARE_OUTPUT", {
                  query: id2,
                  item: item2,
                  success: function success(file2) {
                    dispatch2("DID_PREPARE_OUTPUT", {id: id2, file: file2});
                  }
                }, true);
              });
              return;
            }
            if (item2.origin === FileOrigin.LOCAL) {
              dispatch2("DID_LOAD_ITEM", {
                id: item2.id,
                error: null,
                serverFileReference: item2.source
              });
            }
            var upload = function upload2() {
              setTimeout(function() {
                dispatch2("REQUEST_ITEM_PROCESSING", {query: id2});
              }, 32);
            };
            var revert = function revert2(doUpload) {
              item2.revert(createRevertFunction(state2.options.server.url, state2.options.server.revert), query("GET_FORCE_REVERT")).then(doUpload ? upload : function() {
              }).catch(function() {
              });
            };
            var abort = function abort2(doUpload) {
              item2.abortProcessing().then(doUpload ? upload : function() {
              });
            };
            if (item2.status === ItemStatus.PROCESSING_COMPLETE) {
              return revert(state2.options.instantUpload);
            }
            if (item2.status === ItemStatus.PROCESSING) {
              return abort(state2.options.instantUpload);
            }
            if (state2.options.instantUpload) {
              upload();
            }
          }, 0);
        },
        MOVE_ITEM: function MOVE_ITEM(_ref4) {
          var query2 = _ref4.query, index = _ref4.index;
          var item2 = getItemByQuery(state2.items, query2);
          if (!item2)
            return;
          var currentIndex = state2.items.indexOf(item2);
          index = limit(index, 0, state2.items.length - 1);
          if (currentIndex === index)
            return;
          state2.items.splice(index, 0, state2.items.splice(currentIndex, 1)[0]);
        },
        SORT: function SORT(_ref5) {
          var compare = _ref5.compare;
          sortItems(state2, compare);
          dispatch2("DID_SORT_ITEMS", {
            items: query("GET_ACTIVE_ITEMS")
          });
        },
        ADD_ITEMS: function ADD_ITEMS(_ref6) {
          var items = _ref6.items, index = _ref6.index, interactionMethod = _ref6.interactionMethod, _ref6$success = _ref6.success, success = _ref6$success === void 0 ? function() {
          } : _ref6$success, _ref6$failure = _ref6.failure, failure = _ref6$failure === void 0 ? function() {
          } : _ref6$failure;
          var currentIndex = index;
          if (index === -1 || typeof index === "undefined") {
            var insertLocation = query("GET_ITEM_INSERT_LOCATION");
            var totalItems = query("GET_TOTAL_ITEMS");
            currentIndex = insertLocation === "before" ? 0 : totalItems;
          }
          var ignoredFiles = query("GET_IGNORED_FILES");
          var isValidFile = function isValidFile2(source) {
            return isFile(source) ? !ignoredFiles.includes(source.name.toLowerCase()) : !isEmpty(source);
          };
          var validItems = items.filter(isValidFile);
          var promises = validItems.map(function(source) {
            return new Promise(function(resolve, reject) {
              dispatch2("ADD_ITEM", {
                interactionMethod,
                source: source.source || source,
                success: resolve,
                failure: reject,
                index: currentIndex++,
                options: source.options || {}
              });
            });
          });
          Promise.all(promises).then(success).catch(failure);
        },
        ADD_ITEM: function ADD_ITEM(_ref7) {
          var source = _ref7.source, _ref7$index = _ref7.index, index = _ref7$index === void 0 ? -1 : _ref7$index, interactionMethod = _ref7.interactionMethod, _ref7$success = _ref7.success, success = _ref7$success === void 0 ? function() {
          } : _ref7$success, _ref7$failure = _ref7.failure, failure = _ref7$failure === void 0 ? function() {
          } : _ref7$failure, _ref7$options = _ref7.options, options = _ref7$options === void 0 ? {} : _ref7$options;
          if (isEmpty(source)) {
            failure({
              error: createResponse("error", 0, "No source"),
              file: null
            });
            return;
          }
          if (isFile(source) && state2.options.ignoredFiles.includes(source.name.toLowerCase())) {
            return;
          }
          if (!hasRoomForItem(state2)) {
            if (state2.options.allowMultiple || !state2.options.allowMultiple && !state2.options.allowReplace) {
              var error2 = createResponse("warning", 0, "Max files");
              dispatch2("DID_THROW_MAX_FILES", {
                source,
                error: error2
              });
              failure({error: error2, file: null});
              return;
            }
            var _item = getActiveItems(state2.items)[0];
            if (_item.status === ItemStatus.PROCESSING_COMPLETE || _item.status === ItemStatus.PROCESSING_REVERT_ERROR) {
              var forceRevert = query("GET_FORCE_REVERT");
              _item.revert(createRevertFunction(state2.options.server.url, state2.options.server.revert), forceRevert).then(function() {
                if (!forceRevert)
                  return;
                dispatch2("ADD_ITEM", {
                  source,
                  index,
                  interactionMethod,
                  success,
                  failure,
                  options
                });
              }).catch(function() {
              });
              if (forceRevert)
                return;
            }
            dispatch2("REMOVE_ITEM", {query: _item.id});
          }
          var origin = options.type === "local" ? FileOrigin.LOCAL : options.type === "limbo" ? FileOrigin.LIMBO : FileOrigin.INPUT;
          var item2 = createItem(origin, origin === FileOrigin.INPUT ? null : source, options.file);
          Object.keys(options.metadata || {}).forEach(function(key) {
            item2.setMetadata(key, options.metadata[key]);
          });
          applyFilters("DID_CREATE_ITEM", item2, {query, dispatch: dispatch2});
          var itemInsertLocation = query("GET_ITEM_INSERT_LOCATION");
          if (!state2.options.itemInsertLocationFreedom) {
            index = itemInsertLocation === "before" ? -1 : state2.items.length;
          }
          insertItem(state2.items, item2, index);
          if (isFunction(itemInsertLocation) && source) {
            sortItems(state2, itemInsertLocation);
          }
          var id2 = item2.id;
          item2.on("init", function() {
            dispatch2("DID_INIT_ITEM", {id: id2});
          });
          item2.on("load-init", function() {
            dispatch2("DID_START_ITEM_LOAD", {id: id2});
          });
          item2.on("load-meta", function() {
            dispatch2("DID_UPDATE_ITEM_META", {id: id2});
          });
          item2.on("load-progress", function(progress) {
            dispatch2("DID_UPDATE_ITEM_LOAD_PROGRESS", {id: id2, progress});
          });
          item2.on("load-request-error", function(error3) {
            var mainStatus = dynamicLabel(state2.options.labelFileLoadError)(error3);
            if (error3.code >= 400 && error3.code < 500) {
              dispatch2("DID_THROW_ITEM_INVALID", {
                id: id2,
                error: error3,
                status: {
                  main: mainStatus,
                  sub: error3.code + " (" + error3.body + ")"
                }
              });
              failure({error: error3, file: createItemAPI(item2)});
              return;
            }
            dispatch2("DID_THROW_ITEM_LOAD_ERROR", {
              id: id2,
              error: error3,
              status: {
                main: mainStatus,
                sub: state2.options.labelTapToRetry
              }
            });
          });
          item2.on("load-file-error", function(error3) {
            dispatch2("DID_THROW_ITEM_INVALID", {
              id: id2,
              error: error3.status,
              status: error3.status
            });
            failure({error: error3.status, file: createItemAPI(item2)});
          });
          item2.on("load-abort", function() {
            dispatch2("REMOVE_ITEM", {query: id2});
          });
          item2.on("load-skip", function() {
            dispatch2("COMPLETE_LOAD_ITEM", {
              query: id2,
              item: item2,
              data: {
                source,
                success
              }
            });
          });
          item2.on("load", function() {
            var handleAdd = function handleAdd2(shouldAdd) {
              if (!shouldAdd) {
                dispatch2("REMOVE_ITEM", {
                  query: id2
                });
                return;
              }
              item2.on("metadata-update", function(change) {
                dispatch2("DID_UPDATE_ITEM_METADATA", {id: id2, change});
              });
              applyFilterChain("SHOULD_PREPARE_OUTPUT", false, {
                item: item2,
                query
              }).then(function(shouldPrepareOutput) {
                var beforePrepareFile = query("GET_BEFORE_PREPARE_FILE");
                if (beforePrepareFile)
                  shouldPrepareOutput = beforePrepareFile(item2, shouldPrepareOutput);
                var loadComplete = function loadComplete2() {
                  dispatch2("COMPLETE_LOAD_ITEM", {
                    query: id2,
                    item: item2,
                    data: {
                      source,
                      success
                    }
                  });
                  listUpdated(dispatch2, state2);
                };
                if (shouldPrepareOutput) {
                  dispatch2("REQUEST_PREPARE_OUTPUT", {
                    query: id2,
                    item: item2,
                    success: function success2(file2) {
                      dispatch2("DID_PREPARE_OUTPUT", {id: id2, file: file2});
                      loadComplete();
                    }
                  }, true);
                  return;
                }
                loadComplete();
              });
            };
            applyFilterChain("DID_LOAD_ITEM", item2, {query, dispatch: dispatch2}).then(function() {
              optionalPromise(query("GET_BEFORE_ADD_FILE"), createItemAPI(item2)).then(handleAdd);
            }).catch(function(e) {
              if (!e || !e.error || !e.status)
                return handleAdd(false);
              dispatch2("DID_THROW_ITEM_INVALID", {
                id: id2,
                error: e.error,
                status: e.status
              });
            });
          });
          item2.on("process-start", function() {
            dispatch2("DID_START_ITEM_PROCESSING", {id: id2});
          });
          item2.on("process-progress", function(progress) {
            dispatch2("DID_UPDATE_ITEM_PROCESS_PROGRESS", {id: id2, progress});
          });
          item2.on("process-error", function(error3) {
            dispatch2("DID_THROW_ITEM_PROCESSING_ERROR", {
              id: id2,
              error: error3,
              status: {
                main: dynamicLabel(state2.options.labelFileProcessingError)(error3),
                sub: state2.options.labelTapToRetry
              }
            });
          });
          item2.on("process-revert-error", function(error3) {
            dispatch2("DID_THROW_ITEM_PROCESSING_REVERT_ERROR", {
              id: id2,
              error: error3,
              status: {
                main: dynamicLabel(state2.options.labelFileProcessingRevertError)(error3),
                sub: state2.options.labelTapToRetry
              }
            });
          });
          item2.on("process-complete", function(serverFileReference) {
            dispatch2("DID_COMPLETE_ITEM_PROCESSING", {
              id: id2,
              error: null,
              serverFileReference
            });
            dispatch2("DID_DEFINE_VALUE", {id: id2, value: serverFileReference});
          });
          item2.on("process-abort", function() {
            dispatch2("DID_ABORT_ITEM_PROCESSING", {id: id2});
          });
          item2.on("process-revert", function() {
            dispatch2("DID_REVERT_ITEM_PROCESSING", {id: id2});
            dispatch2("DID_DEFINE_VALUE", {id: id2, value: null});
          });
          dispatch2("DID_ADD_ITEM", {
            id: id2,
            index,
            interactionMethod
          });
          listUpdated(dispatch2, state2);
          var _ref8 = state2.options.server || {}, url = _ref8.url, load = _ref8.load, restore = _ref8.restore, fetch2 = _ref8.fetch;
          item2.load(source, createFileLoader(origin === FileOrigin.INPUT ? isString(source) && isExternalURL(source) ? fetch2 ? createFetchFunction(url, fetch2) : fetchBlob : fetchBlob : origin === FileOrigin.LIMBO ? createFetchFunction(url, restore) : createFetchFunction(url, load)), function(file2, success2, error3) {
            applyFilterChain("LOAD_FILE", file2, {query}).then(success2).catch(error3);
          });
        },
        REQUEST_PREPARE_OUTPUT: function REQUEST_PREPARE_OUTPUT(_ref9) {
          var item2 = _ref9.item, success = _ref9.success, _ref9$failure = _ref9.failure, failure = _ref9$failure === void 0 ? function() {
          } : _ref9$failure;
          var err = {
            error: createResponse("error", 0, "Item not found"),
            file: null
          };
          if (item2.archived)
            return failure(err);
          applyFilterChain("PREPARE_OUTPUT", item2.file, {query, item: item2}).then(function(result) {
            applyFilterChain("COMPLETE_PREPARE_OUTPUT", result, {
              query,
              item: item2
            }).then(function(result2) {
              if (item2.archived)
                return failure(err);
              success(result2);
            });
          });
        },
        COMPLETE_LOAD_ITEM: function COMPLETE_LOAD_ITEM(_ref10) {
          var item2 = _ref10.item, data3 = _ref10.data;
          var success = data3.success, source = data3.source;
          var itemInsertLocation = query("GET_ITEM_INSERT_LOCATION");
          if (isFunction(itemInsertLocation) && source) {
            sortItems(state2, itemInsertLocation);
          }
          dispatch2("DID_LOAD_ITEM", {
            id: item2.id,
            error: null,
            serverFileReference: item2.origin === FileOrigin.INPUT ? null : source
          });
          success(createItemAPI(item2));
          if (item2.origin === FileOrigin.LOCAL) {
            dispatch2("DID_LOAD_LOCAL_ITEM", {id: item2.id});
            return;
          }
          if (item2.origin === FileOrigin.LIMBO) {
            dispatch2("DID_COMPLETE_ITEM_PROCESSING", {
              id: item2.id,
              error: null,
              serverFileReference: source
            });
            dispatch2("DID_DEFINE_VALUE", {
              id: item2.id,
              value: item2.serverId || source
            });
            return;
          }
          if (query("IS_ASYNC") && state2.options.instantUpload) {
            dispatch2("REQUEST_ITEM_PROCESSING", {query: item2.id});
          }
        },
        RETRY_ITEM_LOAD: getItemByQueryFromState(state2, function(item2) {
          item2.retryLoad();
        }),
        REQUEST_ITEM_PREPARE: getItemByQueryFromState(state2, function(item2, _success, failure) {
          dispatch2("REQUEST_PREPARE_OUTPUT", {
            query: item2.id,
            item: item2,
            success: function success(file2) {
              dispatch2("DID_PREPARE_OUTPUT", {id: item2.id, file: file2});
              _success({
                file: item2,
                output: file2
              });
            },
            failure
          }, true);
        }),
        REQUEST_ITEM_PROCESSING: getItemByQueryFromState(state2, function(item2, success, failure) {
          var itemCanBeQueuedForProcessing = item2.status === ItemStatus.IDLE || item2.status === ItemStatus.PROCESSING_ERROR;
          if (!itemCanBeQueuedForProcessing) {
            var processNow = function processNow2() {
              return dispatch2("REQUEST_ITEM_PROCESSING", {
                query: item2,
                success,
                failure
              });
            };
            var process = function process2() {
              return document.hidden ? processNow() : setTimeout(processNow, 32);
            };
            if (item2.status === ItemStatus.PROCESSING_COMPLETE || item2.status === ItemStatus.PROCESSING_REVERT_ERROR) {
              item2.revert(createRevertFunction(state2.options.server.url, state2.options.server.revert), query("GET_FORCE_REVERT")).then(process).catch(function() {
              });
            } else if (item2.status === ItemStatus.PROCESSING) {
              item2.abortProcessing().then(process);
            }
            return;
          }
          if (item2.status === ItemStatus.PROCESSING_QUEUED)
            return;
          item2.requestProcessing();
          dispatch2("DID_REQUEST_ITEM_PROCESSING", {id: item2.id});
          dispatch2("PROCESS_ITEM", {query: item2, success, failure}, true);
        }),
        PROCESS_ITEM: getItemByQueryFromState(state2, function(item2, success, failure) {
          var maxParallelUploads = query("GET_MAX_PARALLEL_UPLOADS");
          var totalCurrentUploads = query("GET_ITEMS_BY_STATUS", ItemStatus.PROCESSING).length;
          if (totalCurrentUploads === maxParallelUploads) {
            state2.processingQueue.push({
              id: item2.id,
              success,
              failure
            });
            return;
          }
          if (item2.status === ItemStatus.PROCESSING)
            return;
          var processNext = function processNext2() {
            var queueEntry = state2.processingQueue.shift();
            if (!queueEntry)
              return;
            var id2 = queueEntry.id, success2 = queueEntry.success, failure2 = queueEntry.failure;
            var itemReference = getItemByQuery(state2.items, id2);
            if (!itemReference || itemReference.archived) {
              processNext2();
              return;
            }
            dispatch2("PROCESS_ITEM", {query: id2, success: success2, failure: failure2}, true);
          };
          item2.onOnce("process-complete", function() {
            success(createItemAPI(item2));
            processNext();
            var server = state2.options.server;
            var instantUpload = state2.options.instantUpload;
            if (instantUpload && item2.origin === FileOrigin.LOCAL && isFunction(server.remove)) {
              var noop = function noop2() {
              };
              item2.origin = FileOrigin.LIMBO;
              state2.options.server.remove(item2.source, noop, noop);
            }
            var allItemsProcessed = query("GET_ITEMS_BY_STATUS", ItemStatus.PROCESSING_COMPLETE).length === state2.items.length;
            if (allItemsProcessed) {
              dispatch2("DID_COMPLETE_ITEM_PROCESSING_ALL");
            }
          });
          item2.onOnce("process-error", function(error2) {
            failure({error: error2, file: createItemAPI(item2)});
            processNext();
          });
          var options = state2.options;
          item2.process(createFileProcessor(createProcessorFunction(options.server.url, options.server.process, options.name, {
            chunkTransferId: item2.transferId,
            chunkServer: options.server.patch,
            chunkUploads: options.chunkUploads,
            chunkForce: options.chunkForce,
            chunkSize: options.chunkSize,
            chunkRetryDelays: options.chunkRetryDelays
          }), {
            allowMinimumUploadDuration: query("GET_ALLOW_MINIMUM_UPLOAD_DURATION")
          }), function(file2, success2, error2) {
            applyFilterChain("PREPARE_OUTPUT", file2, {query, item: item2}).then(function(file3) {
              dispatch2("DID_PREPARE_OUTPUT", {id: item2.id, file: file3});
              success2(file3);
            }).catch(error2);
          });
        }),
        RETRY_ITEM_PROCESSING: getItemByQueryFromState(state2, function(item2) {
          dispatch2("REQUEST_ITEM_PROCESSING", {query: item2});
        }),
        REQUEST_REMOVE_ITEM: getItemByQueryFromState(state2, function(item2) {
          optionalPromise(query("GET_BEFORE_REMOVE_FILE"), createItemAPI(item2)).then(function(shouldRemove) {
            if (!shouldRemove) {
              return;
            }
            dispatch2("REMOVE_ITEM", {query: item2});
          });
        }),
        RELEASE_ITEM: getItemByQueryFromState(state2, function(item2) {
          item2.release();
        }),
        REMOVE_ITEM: getItemByQueryFromState(state2, function(item2, success, failure, options) {
          var removeFromView = function removeFromView2() {
            var id2 = item2.id;
            getItemById(state2.items, id2).archive();
            dispatch2("DID_REMOVE_ITEM", {error: null, id: id2, item: item2});
            listUpdated(dispatch2, state2);
            success(createItemAPI(item2));
          };
          var server = state2.options.server;
          if (item2.origin === FileOrigin.LOCAL && server && isFunction(server.remove) && options.remove !== false) {
            dispatch2("DID_START_ITEM_REMOVE", {id: item2.id});
            server.remove(item2.source, function() {
              return removeFromView();
            }, function(status) {
              dispatch2("DID_THROW_ITEM_REMOVE_ERROR", {
                id: item2.id,
                error: createResponse("error", 0, status, null),
                status: {
                  main: dynamicLabel(state2.options.labelFileRemoveError)(status),
                  sub: state2.options.labelTapToRetry
                }
              });
            });
          } else {
            if (options.revert && item2.origin !== FileOrigin.LOCAL && item2.serverId !== null || state2.options.chunkUploads && item2.file.size > state2.options.chunkSize || state2.options.chunkUploads && state2.options.chunkForce) {
              item2.revert(createRevertFunction(state2.options.server.url, state2.options.server.revert), query("GET_FORCE_REVERT"));
            }
            removeFromView();
          }
        }),
        ABORT_ITEM_LOAD: getItemByQueryFromState(state2, function(item2) {
          item2.abortLoad();
        }),
        ABORT_ITEM_PROCESSING: getItemByQueryFromState(state2, function(item2) {
          if (item2.serverId) {
            dispatch2("REVERT_ITEM_PROCESSING", {id: item2.id});
            return;
          }
          item2.abortProcessing().then(function() {
            var shouldRemove = state2.options.instantUpload;
            if (shouldRemove) {
              dispatch2("REMOVE_ITEM", {query: item2.id});
            }
          });
        }),
        REQUEST_REVERT_ITEM_PROCESSING: getItemByQueryFromState(state2, function(item2) {
          if (!state2.options.instantUpload) {
            dispatch2("REVERT_ITEM_PROCESSING", {query: item2});
            return;
          }
          var handleRevert2 = function handleRevert3(shouldRevert) {
            if (!shouldRevert)
              return;
            dispatch2("REVERT_ITEM_PROCESSING", {query: item2});
          };
          var fn2 = query("GET_BEFORE_REMOVE_FILE");
          if (!fn2) {
            return handleRevert2(true);
          }
          var requestRemoveResult = fn2(createItemAPI(item2));
          if (requestRemoveResult == null) {
            return handleRevert2(true);
          }
          if (typeof requestRemoveResult === "boolean") {
            return handleRevert2(requestRemoveResult);
          }
          if (typeof requestRemoveResult.then === "function") {
            requestRemoveResult.then(handleRevert2);
          }
        }),
        REVERT_ITEM_PROCESSING: getItemByQueryFromState(state2, function(item2) {
          item2.revert(createRevertFunction(state2.options.server.url, state2.options.server.revert), query("GET_FORCE_REVERT")).then(function() {
            var shouldRemove = state2.options.instantUpload || isMockItem(item2);
            if (shouldRemove) {
              dispatch2("REMOVE_ITEM", {query: item2.id});
            }
          }).catch(function() {
          });
        }),
        SET_OPTIONS: function SET_OPTIONS(_ref11) {
          var options = _ref11.options;
          var optionKeys = Object.keys(options);
          var prioritizedOptionKeys = PrioritizedOptions.filter(function(key) {
            return optionKeys.includes(key);
          });
          var orderedOptionKeys = [].concat(_toConsumableArray(prioritizedOptionKeys), _toConsumableArray(Object.keys(options).filter(function(key) {
            return !prioritizedOptionKeys.includes(key);
          })));
          orderedOptionKeys.forEach(function(key) {
            dispatch2("SET_" + fromCamels(key, "_").toUpperCase(), {
              value: options[key]
            });
          });
        }
      };
    };
    var PrioritizedOptions = ["server"];
    var formatFilename = function formatFilename2(name2) {
      return name2;
    };
    var createElement$1 = function createElement2(tagName) {
      return document.createElement(tagName);
    };
    var text = function text2(node, value) {
      var textNode = node.childNodes[0];
      if (!textNode) {
        textNode = document.createTextNode(value);
        node.appendChild(textNode);
      } else if (value !== textNode.nodeValue) {
        textNode.nodeValue = value;
      }
    };
    var polarToCartesian = function polarToCartesian2(centerX, centerY, radius, angleInDegrees) {
      var angleInRadians = (angleInDegrees % 360 - 90) * Math.PI / 180;
      return {
        x: centerX + radius * Math.cos(angleInRadians),
        y: centerY + radius * Math.sin(angleInRadians)
      };
    };
    var describeArc = function describeArc2(x, y, radius, startAngle, endAngle, arcSweep) {
      var start = polarToCartesian(x, y, radius, endAngle);
      var end = polarToCartesian(x, y, radius, startAngle);
      return ["M", start.x, start.y, "A", radius, radius, 0, arcSweep, 0, end.x, end.y].join(" ");
    };
    var percentageArc = function percentageArc2(x, y, radius, from, to) {
      var arcSweep = 1;
      if (to > from && to - from <= 0.5) {
        arcSweep = 0;
      }
      if (from > to && from - to >= 0.5) {
        arcSweep = 0;
      }
      return describeArc(x, y, radius, Math.min(0.9999, from) * 360, Math.min(0.9999, to) * 360, arcSweep);
    };
    var create = function create2(_ref) {
      var root2 = _ref.root, props = _ref.props;
      props.spin = false;
      props.progress = 0;
      props.opacity = 0;
      var svg = createElement("svg");
      root2.ref.path = createElement("path", {
        "stroke-width": 2,
        "stroke-linecap": "round"
      });
      svg.appendChild(root2.ref.path);
      root2.ref.svg = svg;
      root2.appendChild(svg);
    };
    var write = function write2(_ref2) {
      var root2 = _ref2.root, props = _ref2.props;
      if (props.opacity === 0) {
        return;
      }
      if (props.align) {
        root2.element.dataset.align = props.align;
      }
      var ringStrokeWidth = parseInt(attr(root2.ref.path, "stroke-width"), 10);
      var size = root2.rect.element.width * 0.5;
      var ringFrom = 0;
      var ringTo = 0;
      if (props.spin) {
        ringFrom = 0;
        ringTo = 0.5;
      } else {
        ringFrom = 0;
        ringTo = props.progress;
      }
      var coordinates = percentageArc(size, size, size - ringStrokeWidth, ringFrom, ringTo);
      attr(root2.ref.path, "d", coordinates);
      attr(root2.ref.path, "stroke-opacity", props.spin || props.progress > 0 ? 1 : 0);
    };
    var progressIndicator = createView({
      tag: "div",
      name: "progress-indicator",
      ignoreRectUpdate: true,
      ignoreRect: true,
      create,
      write,
      mixins: {
        apis: ["progress", "spin", "align"],
        styles: ["opacity"],
        animations: {
          opacity: {type: "tween", duration: 500},
          progress: {
            type: "spring",
            stiffness: 0.95,
            damping: 0.65,
            mass: 10
          }
        }
      }
    });
    var create$1 = function create2(_ref) {
      var root2 = _ref.root, props = _ref.props;
      root2.element.innerHTML = (props.icon || "") + ("<span>" + props.label + "</span>");
      props.isDisabled = false;
    };
    var write$1 = function write2(_ref2) {
      var root2 = _ref2.root, props = _ref2.props;
      var isDisabled = props.isDisabled;
      var shouldDisable = root2.query("GET_DISABLED") || props.opacity === 0;
      if (shouldDisable && !isDisabled) {
        props.isDisabled = true;
        attr(root2.element, "disabled", "disabled");
      } else if (!shouldDisable && isDisabled) {
        props.isDisabled = false;
        root2.element.removeAttribute("disabled");
      }
    };
    var fileActionButton = createView({
      tag: "button",
      attributes: {
        type: "button"
      },
      ignoreRect: true,
      ignoreRectUpdate: true,
      name: "file-action-button",
      mixins: {
        apis: ["label"],
        styles: ["translateX", "translateY", "scaleX", "scaleY", "opacity"],
        animations: {
          scaleX: "spring",
          scaleY: "spring",
          translateX: "spring",
          translateY: "spring",
          opacity: {type: "tween", duration: 250}
        },
        listeners: true
      },
      create: create$1,
      write: write$1
    });
    var toNaturalFileSize = function toNaturalFileSize2(bytes) {
      var decimalSeparator = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : ".";
      var base = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : 1e3;
      var options = arguments.length > 3 && arguments[3] !== void 0 ? arguments[3] : {};
      var _options$labelBytes = options.labelBytes, labelBytes = _options$labelBytes === void 0 ? "bytes" : _options$labelBytes, _options$labelKilobyt = options.labelKilobytes, labelKilobytes = _options$labelKilobyt === void 0 ? "KB" : _options$labelKilobyt, _options$labelMegabyt = options.labelMegabytes, labelMegabytes = _options$labelMegabyt === void 0 ? "MB" : _options$labelMegabyt, _options$labelGigabyt = options.labelGigabytes, labelGigabytes = _options$labelGigabyt === void 0 ? "GB" : _options$labelGigabyt;
      bytes = Math.round(Math.abs(bytes));
      var KB = base;
      var MB = base * base;
      var GB = base * base * base;
      if (bytes < KB) {
        return bytes + " " + labelBytes;
      }
      if (bytes < MB) {
        return Math.floor(bytes / KB) + " " + labelKilobytes;
      }
      if (bytes < GB) {
        return removeDecimalsWhenZero(bytes / MB, 1, decimalSeparator) + " " + labelMegabytes;
      }
      return removeDecimalsWhenZero(bytes / GB, 2, decimalSeparator) + " " + labelGigabytes;
    };
    var removeDecimalsWhenZero = function removeDecimalsWhenZero2(value, decimalCount, separator) {
      return value.toFixed(decimalCount).split(".").filter(function(part) {
        return part !== "0";
      }).join(separator);
    };
    var create$2 = function create2(_ref) {
      var root2 = _ref.root, props = _ref.props;
      var fileName = createElement$1("span");
      fileName.className = "filepond--file-info-main";
      attr(fileName, "aria-hidden", "true");
      root2.appendChild(fileName);
      root2.ref.fileName = fileName;
      var fileSize = createElement$1("span");
      fileSize.className = "filepond--file-info-sub";
      root2.appendChild(fileSize);
      root2.ref.fileSize = fileSize;
      text(fileSize, root2.query("GET_LABEL_FILE_WAITING_FOR_SIZE"));
      text(fileName, formatFilename(root2.query("GET_ITEM_NAME", props.id)));
    };
    var updateFile = function updateFile2(_ref2) {
      var root2 = _ref2.root, props = _ref2.props;
      text(root2.ref.fileSize, toNaturalFileSize(root2.query("GET_ITEM_SIZE", props.id), ".", root2.query("GET_FILE_SIZE_BASE"), root2.query("GET_FILE_SIZE_LABELS", root2.query)));
      text(root2.ref.fileName, formatFilename(root2.query("GET_ITEM_NAME", props.id)));
    };
    var updateFileSizeOnError = function updateFileSizeOnError2(_ref3) {
      var root2 = _ref3.root, props = _ref3.props;
      if (isInt(root2.query("GET_ITEM_SIZE", props.id))) {
        updateFile({root: root2, props});
        return;
      }
      text(root2.ref.fileSize, root2.query("GET_LABEL_FILE_SIZE_NOT_AVAILABLE"));
    };
    var fileInfo = createView({
      name: "file-info",
      ignoreRect: true,
      ignoreRectUpdate: true,
      write: createRoute({
        DID_LOAD_ITEM: updateFile,
        DID_UPDATE_ITEM_META: updateFile,
        DID_THROW_ITEM_LOAD_ERROR: updateFileSizeOnError,
        DID_THROW_ITEM_INVALID: updateFileSizeOnError
      }),
      didCreateView: function didCreateView(root2) {
        applyFilters("CREATE_VIEW", Object.assign({}, root2, {view: root2}));
      },
      create: create$2,
      mixins: {
        styles: ["translateX", "translateY"],
        animations: {
          translateX: "spring",
          translateY: "spring"
        }
      }
    });
    var toPercentage = function toPercentage2(value) {
      return Math.round(value * 100);
    };
    var create$3 = function create2(_ref) {
      var root2 = _ref.root;
      var main = createElement$1("span");
      main.className = "filepond--file-status-main";
      root2.appendChild(main);
      root2.ref.main = main;
      var sub = createElement$1("span");
      sub.className = "filepond--file-status-sub";
      root2.appendChild(sub);
      root2.ref.sub = sub;
      didSetItemLoadProgress({root: root2, action: {progress: null}});
    };
    var didSetItemLoadProgress = function didSetItemLoadProgress2(_ref2) {
      var root2 = _ref2.root, action = _ref2.action;
      var title = action.progress === null ? root2.query("GET_LABEL_FILE_LOADING") : root2.query("GET_LABEL_FILE_LOADING") + " " + toPercentage(action.progress) + "%";
      text(root2.ref.main, title);
      text(root2.ref.sub, root2.query("GET_LABEL_TAP_TO_CANCEL"));
    };
    var didSetItemProcessProgress = function didSetItemProcessProgress2(_ref3) {
      var root2 = _ref3.root, action = _ref3.action;
      var title = action.progress === null ? root2.query("GET_LABEL_FILE_PROCESSING") : root2.query("GET_LABEL_FILE_PROCESSING") + " " + toPercentage(action.progress) + "%";
      text(root2.ref.main, title);
      text(root2.ref.sub, root2.query("GET_LABEL_TAP_TO_CANCEL"));
    };
    var didRequestItemProcessing = function didRequestItemProcessing2(_ref4) {
      var root2 = _ref4.root;
      text(root2.ref.main, root2.query("GET_LABEL_FILE_PROCESSING"));
      text(root2.ref.sub, root2.query("GET_LABEL_TAP_TO_CANCEL"));
    };
    var didAbortItemProcessing = function didAbortItemProcessing2(_ref5) {
      var root2 = _ref5.root;
      text(root2.ref.main, root2.query("GET_LABEL_FILE_PROCESSING_ABORTED"));
      text(root2.ref.sub, root2.query("GET_LABEL_TAP_TO_RETRY"));
    };
    var didCompleteItemProcessing = function didCompleteItemProcessing2(_ref6) {
      var root2 = _ref6.root;
      text(root2.ref.main, root2.query("GET_LABEL_FILE_PROCESSING_COMPLETE"));
      text(root2.ref.sub, root2.query("GET_LABEL_TAP_TO_UNDO"));
    };
    var clear = function clear2(_ref7) {
      var root2 = _ref7.root;
      text(root2.ref.main, "");
      text(root2.ref.sub, "");
    };
    var error = function error2(_ref8) {
      var root2 = _ref8.root, action = _ref8.action;
      text(root2.ref.main, action.status.main);
      text(root2.ref.sub, action.status.sub);
    };
    var fileStatus = createView({
      name: "file-status",
      ignoreRect: true,
      ignoreRectUpdate: true,
      write: createRoute({
        DID_LOAD_ITEM: clear,
        DID_REVERT_ITEM_PROCESSING: clear,
        DID_REQUEST_ITEM_PROCESSING: didRequestItemProcessing,
        DID_ABORT_ITEM_PROCESSING: didAbortItemProcessing,
        DID_COMPLETE_ITEM_PROCESSING: didCompleteItemProcessing,
        DID_UPDATE_ITEM_PROCESS_PROGRESS: didSetItemProcessProgress,
        DID_UPDATE_ITEM_LOAD_PROGRESS: didSetItemLoadProgress,
        DID_THROW_ITEM_LOAD_ERROR: error,
        DID_THROW_ITEM_INVALID: error,
        DID_THROW_ITEM_PROCESSING_ERROR: error,
        DID_THROW_ITEM_PROCESSING_REVERT_ERROR: error,
        DID_THROW_ITEM_REMOVE_ERROR: error
      }),
      didCreateView: function didCreateView(root2) {
        applyFilters("CREATE_VIEW", Object.assign({}, root2, {view: root2}));
      },
      create: create$3,
      mixins: {
        styles: ["translateX", "translateY", "opacity"],
        animations: {
          opacity: {type: "tween", duration: 250},
          translateX: "spring",
          translateY: "spring"
        }
      }
    });
    var Buttons = {
      AbortItemLoad: {
        label: "GET_LABEL_BUTTON_ABORT_ITEM_LOAD",
        action: "ABORT_ITEM_LOAD",
        className: "filepond--action-abort-item-load",
        align: "LOAD_INDICATOR_POSITION"
      },
      RetryItemLoad: {
        label: "GET_LABEL_BUTTON_RETRY_ITEM_LOAD",
        action: "RETRY_ITEM_LOAD",
        icon: "GET_ICON_RETRY",
        className: "filepond--action-retry-item-load",
        align: "BUTTON_PROCESS_ITEM_POSITION"
      },
      RemoveItem: {
        label: "GET_LABEL_BUTTON_REMOVE_ITEM",
        action: "REQUEST_REMOVE_ITEM",
        icon: "GET_ICON_REMOVE",
        className: "filepond--action-remove-item",
        align: "BUTTON_REMOVE_ITEM_POSITION"
      },
      ProcessItem: {
        label: "GET_LABEL_BUTTON_PROCESS_ITEM",
        action: "REQUEST_ITEM_PROCESSING",
        icon: "GET_ICON_PROCESS",
        className: "filepond--action-process-item",
        align: "BUTTON_PROCESS_ITEM_POSITION"
      },
      AbortItemProcessing: {
        label: "GET_LABEL_BUTTON_ABORT_ITEM_PROCESSING",
        action: "ABORT_ITEM_PROCESSING",
        className: "filepond--action-abort-item-processing",
        align: "BUTTON_PROCESS_ITEM_POSITION"
      },
      RetryItemProcessing: {
        label: "GET_LABEL_BUTTON_RETRY_ITEM_PROCESSING",
        action: "RETRY_ITEM_PROCESSING",
        icon: "GET_ICON_RETRY",
        className: "filepond--action-retry-item-processing",
        align: "BUTTON_PROCESS_ITEM_POSITION"
      },
      RevertItemProcessing: {
        label: "GET_LABEL_BUTTON_UNDO_ITEM_PROCESSING",
        action: "REQUEST_REVERT_ITEM_PROCESSING",
        icon: "GET_ICON_UNDO",
        className: "filepond--action-revert-item-processing",
        align: "BUTTON_PROCESS_ITEM_POSITION"
      }
    };
    var ButtonKeys = [];
    forin(Buttons, function(key) {
      ButtonKeys.push(key);
    });
    var calculateFileInfoOffset = function calculateFileInfoOffset2(root2) {
      if (getRemoveIndicatorAligment(root2) === "right")
        return 0;
      var buttonRect = root2.ref.buttonRemoveItem.rect.element;
      return buttonRect.hidden ? null : buttonRect.width + buttonRect.left;
    };
    var calculateButtonWidth = function calculateButtonWidth2(root2) {
      var buttonRect = root2.ref.buttonAbortItemLoad.rect.element;
      return buttonRect.width;
    };
    var calculateFileVerticalCenterOffset = function calculateFileVerticalCenterOffset2(root2) {
      return Math.floor(root2.ref.buttonRemoveItem.rect.element.height / 4);
    };
    var calculateFileHorizontalCenterOffset = function calculateFileHorizontalCenterOffset2(root2) {
      return Math.floor(root2.ref.buttonRemoveItem.rect.element.left / 2);
    };
    var getLoadIndicatorAlignment = function getLoadIndicatorAlignment2(root2) {
      return root2.query("GET_STYLE_LOAD_INDICATOR_POSITION");
    };
    var getProcessIndicatorAlignment = function getProcessIndicatorAlignment2(root2) {
      return root2.query("GET_STYLE_PROGRESS_INDICATOR_POSITION");
    };
    var getRemoveIndicatorAligment = function getRemoveIndicatorAligment2(root2) {
      return root2.query("GET_STYLE_BUTTON_REMOVE_ITEM_POSITION");
    };
    var DefaultStyle = {
      buttonAbortItemLoad: {opacity: 0},
      buttonRetryItemLoad: {opacity: 0},
      buttonRemoveItem: {opacity: 0},
      buttonProcessItem: {opacity: 0},
      buttonAbortItemProcessing: {opacity: 0},
      buttonRetryItemProcessing: {opacity: 0},
      buttonRevertItemProcessing: {opacity: 0},
      loadProgressIndicator: {opacity: 0, align: getLoadIndicatorAlignment},
      processProgressIndicator: {opacity: 0, align: getProcessIndicatorAlignment},
      processingCompleteIndicator: {opacity: 0, scaleX: 0.75, scaleY: 0.75},
      info: {translateX: 0, translateY: 0, opacity: 0},
      status: {translateX: 0, translateY: 0, opacity: 0}
    };
    var IdleStyle = {
      buttonRemoveItem: {opacity: 1},
      buttonProcessItem: {opacity: 1},
      info: {translateX: calculateFileInfoOffset},
      status: {translateX: calculateFileInfoOffset}
    };
    var ProcessingStyle = {
      buttonAbortItemProcessing: {opacity: 1},
      processProgressIndicator: {opacity: 1},
      status: {opacity: 1}
    };
    var StyleMap = {
      DID_THROW_ITEM_INVALID: {
        buttonRemoveItem: {opacity: 1},
        info: {translateX: calculateFileInfoOffset},
        status: {translateX: calculateFileInfoOffset, opacity: 1}
      },
      DID_START_ITEM_LOAD: {
        buttonAbortItemLoad: {opacity: 1},
        loadProgressIndicator: {opacity: 1},
        status: {opacity: 1}
      },
      DID_THROW_ITEM_LOAD_ERROR: {
        buttonRetryItemLoad: {opacity: 1},
        buttonRemoveItem: {opacity: 1},
        info: {translateX: calculateFileInfoOffset},
        status: {opacity: 1}
      },
      DID_START_ITEM_REMOVE: {
        processProgressIndicator: {opacity: 1, align: getRemoveIndicatorAligment},
        info: {translateX: calculateFileInfoOffset},
        status: {opacity: 0}
      },
      DID_THROW_ITEM_REMOVE_ERROR: {
        processProgressIndicator: {opacity: 0, align: getRemoveIndicatorAligment},
        buttonRemoveItem: {opacity: 1},
        info: {translateX: calculateFileInfoOffset},
        status: {opacity: 1, translateX: calculateFileInfoOffset}
      },
      DID_LOAD_ITEM: IdleStyle,
      DID_LOAD_LOCAL_ITEM: {
        buttonRemoveItem: {opacity: 1},
        info: {translateX: calculateFileInfoOffset},
        status: {translateX: calculateFileInfoOffset}
      },
      DID_START_ITEM_PROCESSING: ProcessingStyle,
      DID_REQUEST_ITEM_PROCESSING: ProcessingStyle,
      DID_UPDATE_ITEM_PROCESS_PROGRESS: ProcessingStyle,
      DID_COMPLETE_ITEM_PROCESSING: {
        buttonRevertItemProcessing: {opacity: 1},
        info: {opacity: 1},
        status: {opacity: 1}
      },
      DID_THROW_ITEM_PROCESSING_ERROR: {
        buttonRemoveItem: {opacity: 1},
        buttonRetryItemProcessing: {opacity: 1},
        status: {opacity: 1},
        info: {translateX: calculateFileInfoOffset}
      },
      DID_THROW_ITEM_PROCESSING_REVERT_ERROR: {
        buttonRevertItemProcessing: {opacity: 1},
        status: {opacity: 1},
        info: {opacity: 1}
      },
      DID_ABORT_ITEM_PROCESSING: {
        buttonRemoveItem: {opacity: 1},
        buttonProcessItem: {opacity: 1},
        info: {translateX: calculateFileInfoOffset},
        status: {opacity: 1}
      },
      DID_REVERT_ITEM_PROCESSING: IdleStyle
    };
    var processingCompleteIndicatorView = createView({
      create: function create2(_ref) {
        var root2 = _ref.root;
        root2.element.innerHTML = root2.query("GET_ICON_DONE");
      },
      name: "processing-complete-indicator",
      ignoreRect: true,
      mixins: {
        styles: ["scaleX", "scaleY", "opacity"],
        animations: {
          scaleX: "spring",
          scaleY: "spring",
          opacity: {type: "tween", duration: 250}
        }
      }
    });
    var create$4 = function create2(_ref2) {
      var root2 = _ref2.root, props = _ref2.props;
      var LocalButtons = Object.keys(Buttons).reduce(function(prev, curr) {
        prev[curr] = Object.assign({}, Buttons[curr]);
        return prev;
      }, {});
      var id2 = props.id;
      var allowRevert = root2.query("GET_ALLOW_REVERT");
      var allowRemove = root2.query("GET_ALLOW_REMOVE");
      var allowProcess = root2.query("GET_ALLOW_PROCESS");
      var instantUpload = root2.query("GET_INSTANT_UPLOAD");
      var isAsync2 = root2.query("IS_ASYNC");
      var alignRemoveItemButton = root2.query("GET_STYLE_BUTTON_REMOVE_ITEM_ALIGN");
      var buttonFilter;
      if (isAsync2) {
        if (allowProcess && !allowRevert) {
          buttonFilter = function buttonFilter2(key) {
            return !/RevertItemProcessing/.test(key);
          };
        } else if (!allowProcess && allowRevert) {
          buttonFilter = function buttonFilter2(key) {
            return !/ProcessItem|RetryItemProcessing|AbortItemProcessing/.test(key);
          };
        } else if (!allowProcess && !allowRevert) {
          buttonFilter = function buttonFilter2(key) {
            return !/Process/.test(key);
          };
        }
      } else {
        buttonFilter = function buttonFilter2(key) {
          return !/Process/.test(key);
        };
      }
      var enabledButtons = buttonFilter ? ButtonKeys.filter(buttonFilter) : ButtonKeys.concat();
      if (instantUpload && allowRevert) {
        LocalButtons["RevertItemProcessing"].label = "GET_LABEL_BUTTON_REMOVE_ITEM";
        LocalButtons["RevertItemProcessing"].icon = "GET_ICON_REMOVE";
      }
      if (isAsync2 && !allowRevert) {
        var map2 = StyleMap["DID_COMPLETE_ITEM_PROCESSING"];
        map2.info.translateX = calculateFileHorizontalCenterOffset;
        map2.info.translateY = calculateFileVerticalCenterOffset;
        map2.status.translateY = calculateFileVerticalCenterOffset;
        map2.processingCompleteIndicator = {opacity: 1, scaleX: 1, scaleY: 1};
      }
      if (isAsync2 && !allowProcess) {
        [
          "DID_START_ITEM_PROCESSING",
          "DID_REQUEST_ITEM_PROCESSING",
          "DID_UPDATE_ITEM_PROCESS_PROGRESS",
          "DID_THROW_ITEM_PROCESSING_ERROR"
        ].forEach(function(key) {
          StyleMap[key].status.translateY = calculateFileVerticalCenterOffset;
        });
        StyleMap["DID_THROW_ITEM_PROCESSING_ERROR"].status.translateX = calculateButtonWidth;
      }
      if (alignRemoveItemButton && allowRevert) {
        LocalButtons["RevertItemProcessing"].align = "BUTTON_REMOVE_ITEM_POSITION";
        var _map = StyleMap["DID_COMPLETE_ITEM_PROCESSING"];
        _map.info.translateX = calculateFileInfoOffset;
        _map.status.translateY = calculateFileVerticalCenterOffset;
        _map.processingCompleteIndicator = {opacity: 1, scaleX: 1, scaleY: 1};
      }
      if (!allowRemove) {
        LocalButtons["RemoveItem"].disabled = true;
      }
      forin(LocalButtons, function(key, definition) {
        var buttonView = root2.createChildView(fileActionButton, {
          label: root2.query(definition.label),
          icon: root2.query(definition.icon),
          opacity: 0
        });
        if (enabledButtons.includes(key)) {
          root2.appendChildView(buttonView);
        }
        if (definition.disabled) {
          buttonView.element.setAttribute("disabled", "disabled");
          buttonView.element.setAttribute("hidden", "hidden");
        }
        buttonView.element.dataset.align = root2.query("GET_STYLE_" + definition.align);
        buttonView.element.classList.add(definition.className);
        buttonView.on("click", function(e) {
          e.stopPropagation();
          if (definition.disabled)
            return;
          root2.dispatch(definition.action, {query: id2});
        });
        root2.ref["button" + key] = buttonView;
      });
      root2.ref.processingCompleteIndicator = root2.appendChildView(root2.createChildView(processingCompleteIndicatorView));
      root2.ref.processingCompleteIndicator.element.dataset.align = root2.query("GET_STYLE_BUTTON_PROCESS_ITEM_POSITION");
      root2.ref.info = root2.appendChildView(root2.createChildView(fileInfo, {id: id2}));
      root2.ref.status = root2.appendChildView(root2.createChildView(fileStatus, {id: id2}));
      var loadIndicatorView = root2.appendChildView(root2.createChildView(progressIndicator, {
        opacity: 0,
        align: root2.query("GET_STYLE_LOAD_INDICATOR_POSITION")
      }));
      loadIndicatorView.element.classList.add("filepond--load-indicator");
      root2.ref.loadProgressIndicator = loadIndicatorView;
      var progressIndicatorView = root2.appendChildView(root2.createChildView(progressIndicator, {
        opacity: 0,
        align: root2.query("GET_STYLE_PROGRESS_INDICATOR_POSITION")
      }));
      progressIndicatorView.element.classList.add("filepond--process-indicator");
      root2.ref.processProgressIndicator = progressIndicatorView;
      root2.ref.activeStyles = [];
    };
    var write$2 = function write2(_ref3) {
      var root2 = _ref3.root, actions2 = _ref3.actions, props = _ref3.props;
      route({root: root2, actions: actions2, props});
      var action = actions2.concat().filter(function(action2) {
        return /^DID_/.test(action2.type);
      }).reverse().find(function(action2) {
        return StyleMap[action2.type];
      });
      if (action) {
        root2.ref.activeStyles = [];
        var stylesToApply = StyleMap[action.type];
        forin(DefaultStyle, function(name2, defaultStyles) {
          var control = root2.ref[name2];
          forin(defaultStyles, function(key, defaultValue) {
            var value = stylesToApply[name2] && typeof stylesToApply[name2][key] !== "undefined" ? stylesToApply[name2][key] : defaultValue;
            root2.ref.activeStyles.push({control, key, value});
          });
        });
      }
      root2.ref.activeStyles.forEach(function(_ref4) {
        var control = _ref4.control, key = _ref4.key, value = _ref4.value;
        control[key] = typeof value === "function" ? value(root2) : value;
      });
    };
    var route = createRoute({
      DID_SET_LABEL_BUTTON_ABORT_ITEM_PROCESSING: function DID_SET_LABEL_BUTTON_ABORT_ITEM_PROCESSING(_ref5) {
        var root2 = _ref5.root, action = _ref5.action;
        root2.ref.buttonAbortItemProcessing.label = action.value;
      },
      DID_SET_LABEL_BUTTON_ABORT_ITEM_LOAD: function DID_SET_LABEL_BUTTON_ABORT_ITEM_LOAD(_ref6) {
        var root2 = _ref6.root, action = _ref6.action;
        root2.ref.buttonAbortItemLoad.label = action.value;
      },
      DID_SET_LABEL_BUTTON_ABORT_ITEM_REMOVAL: function DID_SET_LABEL_BUTTON_ABORT_ITEM_REMOVAL(_ref7) {
        var root2 = _ref7.root, action = _ref7.action;
        root2.ref.buttonAbortItemRemoval.label = action.value;
      },
      DID_REQUEST_ITEM_PROCESSING: function DID_REQUEST_ITEM_PROCESSING(_ref8) {
        var root2 = _ref8.root;
        root2.ref.processProgressIndicator.spin = true;
        root2.ref.processProgressIndicator.progress = 0;
      },
      DID_START_ITEM_LOAD: function DID_START_ITEM_LOAD(_ref9) {
        var root2 = _ref9.root;
        root2.ref.loadProgressIndicator.spin = true;
        root2.ref.loadProgressIndicator.progress = 0;
      },
      DID_START_ITEM_REMOVE: function DID_START_ITEM_REMOVE(_ref10) {
        var root2 = _ref10.root;
        root2.ref.processProgressIndicator.spin = true;
        root2.ref.processProgressIndicator.progress = 0;
      },
      DID_UPDATE_ITEM_LOAD_PROGRESS: function DID_UPDATE_ITEM_LOAD_PROGRESS(_ref11) {
        var root2 = _ref11.root, action = _ref11.action;
        root2.ref.loadProgressIndicator.spin = false;
        root2.ref.loadProgressIndicator.progress = action.progress;
      },
      DID_UPDATE_ITEM_PROCESS_PROGRESS: function DID_UPDATE_ITEM_PROCESS_PROGRESS(_ref12) {
        var root2 = _ref12.root, action = _ref12.action;
        root2.ref.processProgressIndicator.spin = false;
        root2.ref.processProgressIndicator.progress = action.progress;
      }
    });
    var file = createView({
      create: create$4,
      write: write$2,
      didCreateView: function didCreateView(root2) {
        applyFilters("CREATE_VIEW", Object.assign({}, root2, {view: root2}));
      },
      name: "file"
    });
    var create$5 = function create2(_ref) {
      var root2 = _ref.root, props = _ref.props;
      root2.ref.fileName = createElement$1("legend");
      root2.appendChild(root2.ref.fileName);
      root2.ref.file = root2.appendChildView(root2.createChildView(file, {id: props.id}));
      root2.ref.data = false;
    };
    var didLoadItem = function didLoadItem2(_ref2) {
      var root2 = _ref2.root, props = _ref2.props;
      text(root2.ref.fileName, formatFilename(root2.query("GET_ITEM_NAME", props.id)));
    };
    var fileWrapper = createView({
      create: create$5,
      ignoreRect: true,
      write: createRoute({
        DID_LOAD_ITEM: didLoadItem
      }),
      didCreateView: function didCreateView(root2) {
        applyFilters("CREATE_VIEW", Object.assign({}, root2, {view: root2}));
      },
      tag: "fieldset",
      name: "file-wrapper"
    });
    var PANEL_SPRING_PROPS = {type: "spring", damping: 0.6, mass: 7};
    var create$6 = function create2(_ref) {
      var root2 = _ref.root, props = _ref.props;
      [
        {
          name: "top"
        },
        {
          name: "center",
          props: {
            translateY: null,
            scaleY: null
          },
          mixins: {
            animations: {
              scaleY: PANEL_SPRING_PROPS
            },
            styles: ["translateY", "scaleY"]
          }
        },
        {
          name: "bottom",
          props: {
            translateY: null
          },
          mixins: {
            animations: {
              translateY: PANEL_SPRING_PROPS
            },
            styles: ["translateY"]
          }
        }
      ].forEach(function(section) {
        createSection(root2, section, props.name);
      });
      root2.element.classList.add("filepond--" + props.name);
      root2.ref.scalable = null;
    };
    var createSection = function createSection2(root2, section, className) {
      var viewConstructor = createView({
        name: "panel-" + section.name + " filepond--" + className,
        mixins: section.mixins,
        ignoreRectUpdate: true
      });
      var view = root2.createChildView(viewConstructor, section.props);
      root2.ref[section.name] = root2.appendChildView(view);
    };
    var write$3 = function write2(_ref2) {
      var root2 = _ref2.root, props = _ref2.props;
      if (root2.ref.scalable === null || props.scalable !== root2.ref.scalable) {
        root2.ref.scalable = isBoolean(props.scalable) ? props.scalable : true;
        root2.element.dataset.scalable = root2.ref.scalable;
      }
      if (!props.height)
        return;
      var topRect = root2.ref.top.rect.element;
      var bottomRect = root2.ref.bottom.rect.element;
      var height = Math.max(topRect.height + bottomRect.height, props.height);
      root2.ref.center.translateY = topRect.height;
      root2.ref.center.scaleY = (height - topRect.height - bottomRect.height) / 100;
      root2.ref.bottom.translateY = height - bottomRect.height;
    };
    var panel = createView({
      name: "panel",
      read: function read(_ref3) {
        var root2 = _ref3.root, props = _ref3.props;
        return props.heightCurrent = root2.ref.bottom.translateY;
      },
      write: write$3,
      create: create$6,
      ignoreRect: true,
      mixins: {
        apis: ["height", "heightCurrent", "scalable"]
      }
    });
    var createDragHelper = function createDragHelper2(items) {
      var itemIds = items.map(function(item2) {
        return item2.id;
      });
      var prevIndex = void 0;
      return {
        setIndex: function setIndex(index) {
          prevIndex = index;
        },
        getIndex: function getIndex() {
          return prevIndex;
        },
        getItemIndex: function getItemIndex(item2) {
          return itemIds.indexOf(item2.id);
        }
      };
    };
    var ITEM_TRANSLATE_SPRING = {
      type: "spring",
      stiffness: 0.75,
      damping: 0.45,
      mass: 10
    };
    var ITEM_SCALE_SPRING = "spring";
    var StateMap = {
      DID_START_ITEM_LOAD: "busy",
      DID_UPDATE_ITEM_LOAD_PROGRESS: "loading",
      DID_THROW_ITEM_INVALID: "load-invalid",
      DID_THROW_ITEM_LOAD_ERROR: "load-error",
      DID_LOAD_ITEM: "idle",
      DID_THROW_ITEM_REMOVE_ERROR: "remove-error",
      DID_START_ITEM_REMOVE: "busy",
      DID_START_ITEM_PROCESSING: "busy processing",
      DID_REQUEST_ITEM_PROCESSING: "busy processing",
      DID_UPDATE_ITEM_PROCESS_PROGRESS: "processing",
      DID_COMPLETE_ITEM_PROCESSING: "processing-complete",
      DID_THROW_ITEM_PROCESSING_ERROR: "processing-error",
      DID_THROW_ITEM_PROCESSING_REVERT_ERROR: "processing-revert-error",
      DID_ABORT_ITEM_PROCESSING: "cancelled",
      DID_REVERT_ITEM_PROCESSING: "idle"
    };
    var create$7 = function create2(_ref) {
      var root2 = _ref.root, props = _ref.props;
      root2.ref.handleClick = function(e) {
        return root2.dispatch("DID_ACTIVATE_ITEM", {id: props.id});
      };
      root2.element.id = "filepond--item-" + props.id;
      root2.element.addEventListener("click", root2.ref.handleClick);
      root2.ref.container = root2.appendChildView(root2.createChildView(fileWrapper, {id: props.id}));
      root2.ref.panel = root2.appendChildView(root2.createChildView(panel, {name: "item-panel"}));
      root2.ref.panel.height = null;
      props.markedForRemoval = false;
      if (!root2.query("GET_ALLOW_REORDER"))
        return;
      root2.element.dataset.dragState = "idle";
      var grab = function grab2(e) {
        if (!e.isPrimary)
          return;
        var removedActivateListener = false;
        var origin = {
          x: e.pageX,
          y: e.pageY
        };
        props.dragOrigin = {
          x: root2.translateX,
          y: root2.translateY
        };
        props.dragCenter = {
          x: e.offsetX,
          y: e.offsetY
        };
        var dragState = createDragHelper(root2.query("GET_ACTIVE_ITEMS"));
        root2.dispatch("DID_GRAB_ITEM", {id: props.id, dragState});
        var drag = function drag2(e2) {
          if (!e2.isPrimary)
            return;
          e2.stopPropagation();
          e2.preventDefault();
          props.dragOffset = {
            x: e2.pageX - origin.x,
            y: e2.pageY - origin.y
          };
          var dist = props.dragOffset.x * props.dragOffset.x + props.dragOffset.y * props.dragOffset.y;
          if (dist > 16 && !removedActivateListener) {
            removedActivateListener = true;
            root2.element.removeEventListener("click", root2.ref.handleClick);
          }
          root2.dispatch("DID_DRAG_ITEM", {id: props.id, dragState});
        };
        var drop2 = function drop3(e2) {
          if (!e2.isPrimary)
            return;
          document.removeEventListener("pointermove", drag);
          document.removeEventListener("pointerup", drop3);
          props.dragOffset = {
            x: e2.pageX - origin.x,
            y: e2.pageY - origin.y
          };
          root2.dispatch("DID_DROP_ITEM", {id: props.id, dragState});
          if (removedActivateListener) {
            setTimeout(function() {
              return root2.element.addEventListener("click", root2.ref.handleClick);
            }, 0);
          }
        };
        document.addEventListener("pointermove", drag);
        document.addEventListener("pointerup", drop2);
      };
      root2.element.addEventListener("pointerdown", grab);
    };
    var route$1 = createRoute({
      DID_UPDATE_PANEL_HEIGHT: function DID_UPDATE_PANEL_HEIGHT(_ref2) {
        var root2 = _ref2.root, action = _ref2.action;
        root2.height = action.height;
      }
    });
    var write$4 = createRoute({
      DID_GRAB_ITEM: function DID_GRAB_ITEM(_ref3) {
        var root2 = _ref3.root, props = _ref3.props;
        props.dragOrigin = {
          x: root2.translateX,
          y: root2.translateY
        };
      },
      DID_DRAG_ITEM: function DID_DRAG_ITEM(_ref4) {
        var root2 = _ref4.root;
        root2.element.dataset.dragState = "drag";
      },
      DID_DROP_ITEM: function DID_DROP_ITEM(_ref5) {
        var root2 = _ref5.root, props = _ref5.props;
        props.dragOffset = null;
        props.dragOrigin = null;
        root2.element.dataset.dragState = "drop";
      }
    }, function(_ref6) {
      var root2 = _ref6.root, actions2 = _ref6.actions, props = _ref6.props, shouldOptimize = _ref6.shouldOptimize;
      if (root2.element.dataset.dragState === "drop") {
        if (root2.scaleX <= 1) {
          root2.element.dataset.dragState = "idle";
        }
      }
      var action = actions2.concat().filter(function(action2) {
        return /^DID_/.test(action2.type);
      }).reverse().find(function(action2) {
        return StateMap[action2.type];
      });
      if (action && action.type !== props.currentState) {
        props.currentState = action.type;
        root2.element.dataset.filepondItemState = StateMap[props.currentState] || "";
      }
      var aspectRatio = root2.query("GET_ITEM_PANEL_ASPECT_RATIO") || root2.query("GET_PANEL_ASPECT_RATIO");
      if (!aspectRatio) {
        route$1({root: root2, actions: actions2, props});
        if (!root2.height && root2.ref.container.rect.element.height > 0) {
          root2.height = root2.ref.container.rect.element.height;
        }
      } else if (!shouldOptimize) {
        root2.height = root2.rect.element.width * aspectRatio;
      }
      if (shouldOptimize) {
        root2.ref.panel.height = null;
      }
      root2.ref.panel.height = root2.height;
    });
    var item = createView({
      create: create$7,
      write: write$4,
      destroy: function destroy(_ref7) {
        var root2 = _ref7.root, props = _ref7.props;
        root2.element.removeEventListener("click", root2.ref.handleClick);
        root2.dispatch("RELEASE_ITEM", {query: props.id});
      },
      tag: "li",
      name: "item",
      mixins: {
        apis: [
          "id",
          "interactionMethod",
          "markedForRemoval",
          "spawnDate",
          "dragCenter",
          "dragOrigin",
          "dragOffset"
        ],
        styles: ["translateX", "translateY", "scaleX", "scaleY", "opacity", "height"],
        animations: {
          scaleX: ITEM_SCALE_SPRING,
          scaleY: ITEM_SCALE_SPRING,
          translateX: ITEM_TRANSLATE_SPRING,
          translateY: ITEM_TRANSLATE_SPRING,
          opacity: {type: "tween", duration: 150}
        }
      }
    });
    var getItemsPerRow = function(horizontalSpace, itemWidth) {
      return Math.max(1, Math.floor((horizontalSpace + 1) / itemWidth));
    };
    var getItemIndexByPosition = function getItemIndexByPosition2(view, children, positionInView) {
      if (!positionInView)
        return;
      var horizontalSpace = view.rect.element.width;
      var l = children.length;
      var last = null;
      if (l === 0 || positionInView.top < children[0].rect.element.top)
        return -1;
      var item2 = children[0];
      var itemRect = item2.rect.element;
      var itemHorizontalMargin = itemRect.marginLeft + itemRect.marginRight;
      var itemWidth = itemRect.width + itemHorizontalMargin;
      var itemsPerRow = getItemsPerRow(horizontalSpace, itemWidth);
      if (itemsPerRow === 1) {
        for (var index = 0; index < l; index++) {
          var child = children[index];
          var childMid = child.rect.outer.top + child.rect.element.height * 0.5;
          if (positionInView.top < childMid) {
            return index;
          }
        }
        return l;
      }
      var itemVerticalMargin = itemRect.marginTop + itemRect.marginBottom;
      var itemHeight = itemRect.height + itemVerticalMargin;
      for (var _index = 0; _index < l; _index++) {
        var indexX = _index % itemsPerRow;
        var indexY = Math.floor(_index / itemsPerRow);
        var offsetX = indexX * itemWidth;
        var offsetY = indexY * itemHeight;
        var itemTop = offsetY - itemRect.marginTop;
        var itemRight = offsetX + itemWidth;
        var itemBottom = offsetY + itemHeight + itemRect.marginBottom;
        if (positionInView.top < itemBottom && positionInView.top > itemTop) {
          if (positionInView.left < itemRight) {
            return _index;
          } else if (_index !== l - 1) {
            last = _index;
          } else {
            last = null;
          }
        }
      }
      if (last !== null) {
        return last;
      }
      return l;
    };
    var dropAreaDimensions = {
      height: 0,
      width: 0,
      get getHeight() {
        return this.height;
      },
      set setHeight(val) {
        if (this.height === 0 || val === 0)
          this.height = val;
      },
      get getWidth() {
        return this.width;
      },
      set setWidth(val) {
        if (this.width === 0 || val === 0)
          this.width = val;
      },
      setDimensions: function setDimensions(height, width) {
        if (this.height === 0 || height === 0)
          this.height = height;
        if (this.width === 0 || width === 0)
          this.width = width;
      }
    };
    var create$8 = function create2(_ref) {
      var root2 = _ref.root;
      attr(root2.element, "role", "list");
      root2.ref.lastItemSpanwDate = Date.now();
    };
    var addItemView = function addItemView2(_ref2) {
      var root2 = _ref2.root, action = _ref2.action;
      var id2 = action.id, index = action.index, interactionMethod = action.interactionMethod;
      root2.ref.addIndex = index;
      var now = Date.now();
      var spawnDate = now;
      var opacity = 1;
      if (interactionMethod !== InteractionMethod.NONE) {
        opacity = 0;
        var cooldown = root2.query("GET_ITEM_INSERT_INTERVAL");
        var dist = now - root2.ref.lastItemSpanwDate;
        spawnDate = dist < cooldown ? now + (cooldown - dist) : now;
      }
      root2.ref.lastItemSpanwDate = spawnDate;
      root2.appendChildView(root2.createChildView(item, {
        spawnDate,
        id: id2,
        opacity,
        interactionMethod
      }), index);
    };
    var moveItem = function moveItem2(item2, x, y) {
      var vx = arguments.length > 3 && arguments[3] !== void 0 ? arguments[3] : 0;
      var vy = arguments.length > 4 && arguments[4] !== void 0 ? arguments[4] : 1;
      if (item2.dragOffset) {
        item2.translateX = null;
        item2.translateY = null;
        item2.translateX = item2.dragOrigin.x + item2.dragOffset.x;
        item2.translateY = item2.dragOrigin.y + item2.dragOffset.y;
        item2.scaleX = 1.025;
        item2.scaleY = 1.025;
      } else {
        item2.translateX = x;
        item2.translateY = y;
        if (Date.now() > item2.spawnDate) {
          if (item2.opacity === 0) {
            introItemView(item2, x, y, vx, vy);
          }
          item2.scaleX = 1;
          item2.scaleY = 1;
          item2.opacity = 1;
        }
      }
    };
    var introItemView = function introItemView2(item2, x, y, vx, vy) {
      if (item2.interactionMethod === InteractionMethod.NONE) {
        item2.translateX = null;
        item2.translateX = x;
        item2.translateY = null;
        item2.translateY = y;
      } else if (item2.interactionMethod === InteractionMethod.DROP) {
        item2.translateX = null;
        item2.translateX = x - vx * 20;
        item2.translateY = null;
        item2.translateY = y - vy * 10;
        item2.scaleX = 0.8;
        item2.scaleY = 0.8;
      } else if (item2.interactionMethod === InteractionMethod.BROWSE) {
        item2.translateY = null;
        item2.translateY = y - 30;
      } else if (item2.interactionMethod === InteractionMethod.API) {
        item2.translateX = null;
        item2.translateX = x - 30;
        item2.translateY = null;
      }
    };
    var removeItemView = function removeItemView2(_ref3) {
      var root2 = _ref3.root, action = _ref3.action;
      var id2 = action.id;
      var view = root2.childViews.find(function(child) {
        return child.id === id2;
      });
      if (!view) {
        return;
      }
      view.scaleX = 0.9;
      view.scaleY = 0.9;
      view.opacity = 0;
      view.markedForRemoval = true;
    };
    var getItemHeight = function getItemHeight2(child) {
      return child.rect.element.height + child.rect.element.marginBottom * 0.5 + child.rect.element.marginTop * 0.5;
    };
    var getItemWidth = function getItemWidth2(child) {
      return child.rect.element.width + child.rect.element.marginLeft * 0.5 + child.rect.element.marginRight * 0.5;
    };
    var dragItem = function dragItem2(_ref4) {
      var root2 = _ref4.root, action = _ref4.action;
      var id2 = action.id, dragState = action.dragState;
      var item2 = root2.query("GET_ITEM", {id: id2});
      var view = root2.childViews.find(function(child) {
        return child.id === id2;
      });
      var numItems = root2.childViews.length;
      var oldIndex = dragState.getItemIndex(item2);
      if (!view)
        return;
      var dragPosition = {
        x: view.dragOrigin.x + view.dragOffset.x + view.dragCenter.x,
        y: view.dragOrigin.y + view.dragOffset.y + view.dragCenter.y
      };
      var dragHeight = getItemHeight(view);
      var dragWidth = getItemWidth(view);
      var cols = Math.floor(root2.rect.outer.width / dragWidth);
      if (cols > numItems)
        cols = numItems;
      var rows = Math.floor(numItems / cols + 1);
      dropAreaDimensions.setHeight = dragHeight * rows;
      dropAreaDimensions.setWidth = dragWidth * cols;
      var location2 = {
        y: Math.floor(dragPosition.y / dragHeight),
        x: Math.floor(dragPosition.x / dragWidth),
        getGridIndex: function getGridIndex() {
          if (dragPosition.y > dropAreaDimensions.getHeight || dragPosition.y < 0 || dragPosition.x > dropAreaDimensions.getWidth || dragPosition.x < 0)
            return oldIndex;
          return this.y * cols + this.x;
        },
        getColIndex: function getColIndex() {
          var items = root2.query("GET_ACTIVE_ITEMS");
          var visibleChildren = root2.childViews.filter(function(child) {
            return child.rect.element.height;
          });
          var children = items.map(function(item3) {
            return visibleChildren.find(function(childView) {
              return childView.id === item3.id;
            });
          });
          var currentIndex2 = children.findIndex(function(child) {
            return child === view;
          });
          var dragHeight2 = getItemHeight(view);
          var l = children.length;
          var idx = l;
          var childHeight = 0;
          var childBottom = 0;
          var childTop = 0;
          for (var i = 0; i < l; i++) {
            childHeight = getItemHeight(children[i]);
            childTop = childBottom;
            childBottom = childTop + childHeight;
            if (dragPosition.y < childBottom) {
              if (currentIndex2 > i) {
                if (dragPosition.y < childTop + dragHeight2) {
                  idx = i;
                  break;
                }
                continue;
              }
              idx = i;
              break;
            }
          }
          return idx;
        }
      };
      var index = cols > 1 ? location2.getGridIndex() : location2.getColIndex();
      root2.dispatch("MOVE_ITEM", {query: view, index});
      var currentIndex = dragState.getIndex();
      if (currentIndex === void 0 || currentIndex !== index) {
        dragState.setIndex(index);
        if (currentIndex === void 0)
          return;
        root2.dispatch("DID_REORDER_ITEMS", {
          items: root2.query("GET_ACTIVE_ITEMS"),
          origin: oldIndex,
          target: index
        });
      }
    };
    var route$2 = createRoute({
      DID_ADD_ITEM: addItemView,
      DID_REMOVE_ITEM: removeItemView,
      DID_DRAG_ITEM: dragItem
    });
    var write$5 = function write2(_ref5) {
      var root2 = _ref5.root, props = _ref5.props, actions2 = _ref5.actions, shouldOptimize = _ref5.shouldOptimize;
      route$2({root: root2, props, actions: actions2});
      var dragCoordinates = props.dragCoordinates;
      var horizontalSpace = root2.rect.element.width;
      var visibleChildren = root2.childViews.filter(function(child) {
        return child.rect.element.height;
      });
      var children = root2.query("GET_ACTIVE_ITEMS").map(function(item2) {
        return visibleChildren.find(function(child) {
          return child.id === item2.id;
        });
      }).filter(function(item2) {
        return item2;
      });
      var dragIndex = dragCoordinates ? getItemIndexByPosition(root2, children, dragCoordinates) : null;
      var addIndex = root2.ref.addIndex || null;
      root2.ref.addIndex = null;
      var dragIndexOffset = 0;
      var removeIndexOffset = 0;
      var addIndexOffset = 0;
      if (children.length === 0)
        return;
      var childRect = children[0].rect.element;
      var itemVerticalMargin = childRect.marginTop + childRect.marginBottom;
      var itemHorizontalMargin = childRect.marginLeft + childRect.marginRight;
      var itemWidth = childRect.width + itemHorizontalMargin;
      var itemHeight = childRect.height + itemVerticalMargin;
      var itemsPerRow = getItemsPerRow(horizontalSpace, itemWidth);
      if (itemsPerRow === 1) {
        var offsetY = 0;
        var dragOffset = 0;
        children.forEach(function(child, index) {
          if (dragIndex) {
            var dist = index - dragIndex;
            if (dist === -2) {
              dragOffset = -itemVerticalMargin * 0.25;
            } else if (dist === -1) {
              dragOffset = -itemVerticalMargin * 0.75;
            } else if (dist === 0) {
              dragOffset = itemVerticalMargin * 0.75;
            } else if (dist === 1) {
              dragOffset = itemVerticalMargin * 0.25;
            } else {
              dragOffset = 0;
            }
          }
          if (shouldOptimize) {
            child.translateX = null;
            child.translateY = null;
          }
          if (!child.markedForRemoval) {
            moveItem(child, 0, offsetY + dragOffset);
          }
          var itemHeight2 = child.rect.element.height + itemVerticalMargin;
          var visualHeight = itemHeight2 * (child.markedForRemoval ? child.opacity : 1);
          offsetY += visualHeight;
        });
      } else {
        var prevX = 0;
        var prevY = 0;
        children.forEach(function(child, index) {
          if (index === dragIndex) {
            dragIndexOffset = 1;
          }
          if (index === addIndex) {
            addIndexOffset += 1;
          }
          if (child.markedForRemoval && child.opacity < 0.5) {
            removeIndexOffset -= 1;
          }
          var visualIndex = index + addIndexOffset + dragIndexOffset + removeIndexOffset;
          var indexX = visualIndex % itemsPerRow;
          var indexY = Math.floor(visualIndex / itemsPerRow);
          var offsetX = indexX * itemWidth;
          var offsetY2 = indexY * itemHeight;
          var vectorX = Math.sign(offsetX - prevX);
          var vectorY = Math.sign(offsetY2 - prevY);
          prevX = offsetX;
          prevY = offsetY2;
          if (child.markedForRemoval)
            return;
          if (shouldOptimize) {
            child.translateX = null;
            child.translateY = null;
          }
          moveItem(child, offsetX, offsetY2, vectorX, vectorY);
        });
      }
    };
    var filterSetItemActions = function filterSetItemActions2(child, actions2) {
      return actions2.filter(function(action) {
        if (action.data && action.data.id) {
          return child.id === action.data.id;
        }
        return true;
      });
    };
    var list = createView({
      create: create$8,
      write: write$5,
      tag: "ul",
      name: "list",
      didWriteView: function didWriteView(_ref6) {
        var root2 = _ref6.root;
        root2.childViews.filter(function(view) {
          return view.markedForRemoval && view.opacity === 0 && view.resting;
        }).forEach(function(view) {
          view._destroy();
          root2.removeChildView(view);
        });
      },
      filterFrameActionsForChild: filterSetItemActions,
      mixins: {
        apis: ["dragCoordinates"]
      }
    });
    var create$9 = function create2(_ref) {
      var root2 = _ref.root, props = _ref.props;
      root2.ref.list = root2.appendChildView(root2.createChildView(list));
      props.dragCoordinates = null;
      props.overflowing = false;
    };
    var storeDragCoordinates = function storeDragCoordinates2(_ref2) {
      var root2 = _ref2.root, props = _ref2.props, action = _ref2.action;
      if (!root2.query("GET_ITEM_INSERT_LOCATION_FREEDOM"))
        return;
      props.dragCoordinates = {
        left: action.position.scopeLeft - root2.ref.list.rect.element.left,
        top: action.position.scopeTop - (root2.rect.outer.top + root2.rect.element.marginTop + root2.rect.element.scrollTop)
      };
    };
    var clearDragCoordinates = function clearDragCoordinates2(_ref3) {
      var props = _ref3.props;
      props.dragCoordinates = null;
    };
    var route$3 = createRoute({
      DID_DRAG: storeDragCoordinates,
      DID_END_DRAG: clearDragCoordinates
    });
    var write$6 = function write2(_ref4) {
      var root2 = _ref4.root, props = _ref4.props, actions2 = _ref4.actions;
      route$3({root: root2, props, actions: actions2});
      root2.ref.list.dragCoordinates = props.dragCoordinates;
      if (props.overflowing && !props.overflow) {
        props.overflowing = false;
        root2.element.dataset.state = "";
        root2.height = null;
      }
      if (props.overflow) {
        var newHeight = Math.round(props.overflow);
        if (newHeight !== root2.height) {
          props.overflowing = true;
          root2.element.dataset.state = "overflow";
          root2.height = newHeight;
        }
      }
    };
    var listScroller = createView({
      create: create$9,
      write: write$6,
      name: "list-scroller",
      mixins: {
        apis: ["overflow", "dragCoordinates"],
        styles: ["height", "translateY"],
        animations: {
          translateY: "spring"
        }
      }
    });
    var attrToggle = function attrToggle2(element, name2, state2) {
      var enabledValue = arguments.length > 3 && arguments[3] !== void 0 ? arguments[3] : "";
      if (state2) {
        attr(element, name2, enabledValue);
      } else {
        element.removeAttribute(name2);
      }
    };
    var resetFileInput = function resetFileInput2(input) {
      if (!input || input.value === "") {
        return;
      }
      try {
        input.value = "";
      } catch (err) {
      }
      if (input.value) {
        var form = createElement$1("form");
        var parentNode = input.parentNode;
        var ref = input.nextSibling;
        form.appendChild(input);
        form.reset();
        if (ref) {
          parentNode.insertBefore(input, ref);
        } else {
          parentNode.appendChild(input);
        }
      }
    };
    var create$a = function create2(_ref) {
      var root2 = _ref.root, props = _ref.props;
      root2.element.id = "filepond--browser-" + props.id;
      attr(root2.element, "name", root2.query("GET_NAME"));
      attr(root2.element, "aria-controls", "filepond--assistant-" + props.id);
      attr(root2.element, "aria-labelledby", "filepond--drop-label-" + props.id);
      setAcceptedFileTypes({
        root: root2,
        action: {value: root2.query("GET_ACCEPTED_FILE_TYPES")}
      });
      toggleAllowMultiple({root: root2, action: {value: root2.query("GET_ALLOW_MULTIPLE")}});
      toggleDirectoryFilter({
        root: root2,
        action: {value: root2.query("GET_ALLOW_DIRECTORIES_ONLY")}
      });
      toggleDisabled({root: root2});
      toggleRequired({root: root2, action: {value: root2.query("GET_REQUIRED")}});
      setCaptureMethod({root: root2, action: {value: root2.query("GET_CAPTURE_METHOD")}});
      root2.ref.handleChange = function(e) {
        if (!root2.element.value) {
          return;
        }
        var files = Array.from(root2.element.files).map(function(file2) {
          file2._relativePath = file2.webkitRelativePath;
          return file2;
        });
        setTimeout(function() {
          props.onload(files);
          resetFileInput(root2.element);
        }, 250);
      };
      root2.element.addEventListener("change", root2.ref.handleChange);
    };
    var setAcceptedFileTypes = function setAcceptedFileTypes2(_ref2) {
      var root2 = _ref2.root, action = _ref2.action;
      if (!root2.query("GET_ALLOW_SYNC_ACCEPT_ATTRIBUTE"))
        return;
      attrToggle(root2.element, "accept", !!action.value, action.value ? action.value.join(",") : "");
    };
    var toggleAllowMultiple = function toggleAllowMultiple2(_ref3) {
      var root2 = _ref3.root, action = _ref3.action;
      attrToggle(root2.element, "multiple", action.value);
    };
    var toggleDirectoryFilter = function toggleDirectoryFilter2(_ref4) {
      var root2 = _ref4.root, action = _ref4.action;
      attrToggle(root2.element, "webkitdirectory", action.value);
    };
    var toggleDisabled = function toggleDisabled2(_ref5) {
      var root2 = _ref5.root;
      var isDisabled = root2.query("GET_DISABLED");
      var doesAllowBrowse = root2.query("GET_ALLOW_BROWSE");
      var disableField = isDisabled || !doesAllowBrowse;
      attrToggle(root2.element, "disabled", disableField);
    };
    var toggleRequired = function toggleRequired2(_ref6) {
      var root2 = _ref6.root, action = _ref6.action;
      if (!action.value) {
        attrToggle(root2.element, "required", false);
      } else if (root2.query("GET_TOTAL_ITEMS") === 0) {
        attrToggle(root2.element, "required", true);
      }
    };
    var setCaptureMethod = function setCaptureMethod2(_ref7) {
      var root2 = _ref7.root, action = _ref7.action;
      attrToggle(root2.element, "capture", !!action.value, action.value === true ? "" : action.value);
    };
    var updateRequiredStatus = function updateRequiredStatus2(_ref8) {
      var root2 = _ref8.root;
      var element = root2.element;
      if (root2.query("GET_TOTAL_ITEMS") > 0) {
        attrToggle(element, "required", false);
        attrToggle(element, "name", false);
      } else {
        attrToggle(element, "name", true, root2.query("GET_NAME"));
        var shouldCheckValidity = root2.query("GET_CHECK_VALIDITY");
        if (shouldCheckValidity) {
          element.setCustomValidity("");
        }
        if (root2.query("GET_REQUIRED")) {
          attrToggle(element, "required", true);
        }
      }
    };
    var updateFieldValidityStatus = function updateFieldValidityStatus2(_ref9) {
      var root2 = _ref9.root;
      var shouldCheckValidity = root2.query("GET_CHECK_VALIDITY");
      if (!shouldCheckValidity)
        return;
      root2.element.setCustomValidity(root2.query("GET_LABEL_INVALID_FIELD"));
    };
    var browser = createView({
      tag: "input",
      name: "browser",
      ignoreRect: true,
      ignoreRectUpdate: true,
      attributes: {
        type: "file"
      },
      create: create$a,
      destroy: function destroy(_ref10) {
        var root2 = _ref10.root;
        root2.element.removeEventListener("change", root2.ref.handleChange);
      },
      write: createRoute({
        DID_LOAD_ITEM: updateRequiredStatus,
        DID_REMOVE_ITEM: updateRequiredStatus,
        DID_THROW_ITEM_INVALID: updateFieldValidityStatus,
        DID_SET_DISABLED: toggleDisabled,
        DID_SET_ALLOW_BROWSE: toggleDisabled,
        DID_SET_ALLOW_DIRECTORIES_ONLY: toggleDirectoryFilter,
        DID_SET_ALLOW_MULTIPLE: toggleAllowMultiple,
        DID_SET_ACCEPTED_FILE_TYPES: setAcceptedFileTypes,
        DID_SET_CAPTURE_METHOD: setCaptureMethod,
        DID_SET_REQUIRED: toggleRequired
      })
    });
    var Key = {
      ENTER: 13,
      SPACE: 32
    };
    var create$b = function create2(_ref) {
      var root2 = _ref.root, props = _ref.props;
      var label = createElement$1("label");
      attr(label, "for", "filepond--browser-" + props.id);
      attr(label, "id", "filepond--drop-label-" + props.id);
      attr(label, "aria-hidden", "true");
      root2.ref.handleKeyDown = function(e) {
        var isActivationKey = e.keyCode === Key.ENTER || e.keyCode === Key.SPACE;
        if (!isActivationKey)
          return;
        e.preventDefault();
        root2.ref.label.click();
      };
      root2.ref.handleClick = function(e) {
        var isLabelClick = e.target === label || label.contains(e.target);
        if (isLabelClick)
          return;
        root2.ref.label.click();
      };
      label.addEventListener("keydown", root2.ref.handleKeyDown);
      root2.element.addEventListener("click", root2.ref.handleClick);
      updateLabelValue(label, props.caption);
      root2.appendChild(label);
      root2.ref.label = label;
    };
    var updateLabelValue = function updateLabelValue2(label, value) {
      label.innerHTML = value;
      var clickable = label.querySelector(".filepond--label-action");
      if (clickable) {
        attr(clickable, "tabindex", "0");
      }
      return value;
    };
    var dropLabel = createView({
      name: "drop-label",
      ignoreRect: true,
      create: create$b,
      destroy: function destroy(_ref2) {
        var root2 = _ref2.root;
        root2.ref.label.addEventListener("keydown", root2.ref.handleKeyDown);
        root2.element.removeEventListener("click", root2.ref.handleClick);
      },
      write: createRoute({
        DID_SET_LABEL_IDLE: function DID_SET_LABEL_IDLE(_ref3) {
          var root2 = _ref3.root, action = _ref3.action;
          updateLabelValue(root2.ref.label, action.value);
        }
      }),
      mixins: {
        styles: ["opacity", "translateX", "translateY"],
        animations: {
          opacity: {type: "tween", duration: 150},
          translateX: "spring",
          translateY: "spring"
        }
      }
    });
    var blob = createView({
      name: "drip-blob",
      ignoreRect: true,
      mixins: {
        styles: ["translateX", "translateY", "scaleX", "scaleY", "opacity"],
        animations: {
          scaleX: "spring",
          scaleY: "spring",
          translateX: "spring",
          translateY: "spring",
          opacity: {type: "tween", duration: 250}
        }
      }
    });
    var addBlob = function addBlob2(_ref) {
      var root2 = _ref.root;
      var centerX = root2.rect.element.width * 0.5;
      var centerY = root2.rect.element.height * 0.5;
      root2.ref.blob = root2.appendChildView(root2.createChildView(blob, {
        opacity: 0,
        scaleX: 2.5,
        scaleY: 2.5,
        translateX: centerX,
        translateY: centerY
      }));
    };
    var moveBlob = function moveBlob2(_ref2) {
      var root2 = _ref2.root, action = _ref2.action;
      if (!root2.ref.blob) {
        addBlob({root: root2});
        return;
      }
      root2.ref.blob.translateX = action.position.scopeLeft;
      root2.ref.blob.translateY = action.position.scopeTop;
      root2.ref.blob.scaleX = 1;
      root2.ref.blob.scaleY = 1;
      root2.ref.blob.opacity = 1;
    };
    var hideBlob = function hideBlob2(_ref3) {
      var root2 = _ref3.root;
      if (!root2.ref.blob) {
        return;
      }
      root2.ref.blob.opacity = 0;
    };
    var explodeBlob = function explodeBlob2(_ref4) {
      var root2 = _ref4.root;
      if (!root2.ref.blob) {
        return;
      }
      root2.ref.blob.scaleX = 2.5;
      root2.ref.blob.scaleY = 2.5;
      root2.ref.blob.opacity = 0;
    };
    var write$7 = function write2(_ref5) {
      var root2 = _ref5.root, props = _ref5.props, actions2 = _ref5.actions;
      route$4({root: root2, props, actions: actions2});
      var blob2 = root2.ref.blob;
      if (actions2.length === 0 && blob2 && blob2.opacity === 0) {
        root2.removeChildView(blob2);
        root2.ref.blob = null;
      }
    };
    var route$4 = createRoute({
      DID_DRAG: moveBlob,
      DID_DROP: explodeBlob,
      DID_END_DRAG: hideBlob
    });
    var drip = createView({
      ignoreRect: true,
      ignoreRectUpdate: true,
      name: "drip",
      write: write$7
    });
    var setInputFiles = function setInputFiles2(element, files) {
      try {
        var dataTransfer = new DataTransfer();
        files.forEach(function(file2) {
          if (file2 instanceof File) {
            dataTransfer.items.add(file2);
          } else {
            dataTransfer.items.add(new File([file2], file2.name, {
              type: file2.type
            }));
          }
        });
        element.files = dataTransfer.files;
      } catch (err) {
        return false;
      }
      return true;
    };
    var create$c = function create2(_ref) {
      var root2 = _ref.root;
      return root2.ref.fields = {};
    };
    var getField = function getField2(root2, id2) {
      return root2.ref.fields[id2];
    };
    var syncFieldPositionsWithItems = function syncFieldPositionsWithItems2(root2) {
      root2.query("GET_ACTIVE_ITEMS").forEach(function(item2) {
        if (!root2.ref.fields[item2.id])
          return;
        root2.element.appendChild(root2.ref.fields[item2.id]);
      });
    };
    var didReorderItems = function didReorderItems2(_ref2) {
      var root2 = _ref2.root;
      return syncFieldPositionsWithItems(root2);
    };
    var didAddItem = function didAddItem2(_ref3) {
      var root2 = _ref3.root, action = _ref3.action;
      var fileItem = root2.query("GET_ITEM", action.id);
      var isLocalFile = fileItem.origin === FileOrigin.LOCAL;
      var shouldUseFileInput = !isLocalFile && root2.query("SHOULD_UPDATE_FILE_INPUT");
      var dataContainer = createElement$1("input");
      dataContainer.type = shouldUseFileInput ? "file" : "hidden";
      dataContainer.name = root2.query("GET_NAME");
      dataContainer.disabled = root2.query("GET_DISABLED");
      root2.ref.fields[action.id] = dataContainer;
      syncFieldPositionsWithItems(root2);
    };
    var didLoadItem$1 = function didLoadItem2(_ref4) {
      var root2 = _ref4.root, action = _ref4.action;
      var field = getField(root2, action.id);
      if (!field)
        return;
      if (action.serverFileReference !== null)
        field.value = action.serverFileReference;
      if (!root2.query("SHOULD_UPDATE_FILE_INPUT"))
        return;
      var fileItem = root2.query("GET_ITEM", action.id);
      setInputFiles(field, [fileItem.file]);
    };
    var didPrepareOutput = function didPrepareOutput2(_ref5) {
      var root2 = _ref5.root, action = _ref5.action;
      if (!root2.query("SHOULD_UPDATE_FILE_INPUT"))
        return;
      setTimeout(function() {
        var field = getField(root2, action.id);
        if (!field)
          return;
        setInputFiles(field, [action.file]);
      }, 0);
    };
    var didSetDisabled = function didSetDisabled2(_ref6) {
      var root2 = _ref6.root;
      root2.element.disabled = root2.query("GET_DISABLED");
    };
    var didRemoveItem = function didRemoveItem2(_ref7) {
      var root2 = _ref7.root, action = _ref7.action;
      var field = getField(root2, action.id);
      if (!field)
        return;
      if (field.parentNode)
        field.parentNode.removeChild(field);
      delete root2.ref.fields[action.id];
    };
    var didDefineValue = function didDefineValue2(_ref8) {
      var root2 = _ref8.root, action = _ref8.action;
      var field = getField(root2, action.id);
      if (!field)
        return;
      if (action.value === null) {
        field.removeAttribute("value");
      } else {
        field.value = action.value;
      }
      syncFieldPositionsWithItems(root2);
    };
    var write$8 = createRoute({
      DID_SET_DISABLED: didSetDisabled,
      DID_ADD_ITEM: didAddItem,
      DID_LOAD_ITEM: didLoadItem$1,
      DID_REMOVE_ITEM: didRemoveItem,
      DID_DEFINE_VALUE: didDefineValue,
      DID_PREPARE_OUTPUT: didPrepareOutput,
      DID_REORDER_ITEMS: didReorderItems,
      DID_SORT_ITEMS: didReorderItems
    });
    var data2 = createView({
      tag: "fieldset",
      name: "data",
      create: create$c,
      write: write$8,
      ignoreRect: true
    });
    var getRootNode = function getRootNode2(element) {
      return "getRootNode" in element ? element.getRootNode() : document;
    };
    var images = ["jpg", "jpeg", "png", "gif", "bmp", "webp", "svg", "tiff"];
    var text$1 = ["css", "csv", "html", "txt"];
    var map = {
      zip: "zip|compressed",
      epub: "application/epub+zip"
    };
    var guesstimateMimeType = function guesstimateMimeType2() {
      var extension = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : "";
      extension = extension.toLowerCase();
      if (images.includes(extension)) {
        return "image/" + (extension === "jpg" ? "jpeg" : extension === "svg" ? "svg+xml" : extension);
      }
      if (text$1.includes(extension)) {
        return "text/" + extension;
      }
      return map[extension] || "";
    };
    var requestDataTransferItems = function requestDataTransferItems2(dataTransfer) {
      return new Promise(function(resolve, reject) {
        var links = getLinks(dataTransfer);
        if (links.length && !hasFiles(dataTransfer)) {
          return resolve(links);
        }
        getFiles(dataTransfer).then(resolve);
      });
    };
    var hasFiles = function hasFiles2(dataTransfer) {
      if (dataTransfer.files)
        return dataTransfer.files.length > 0;
      return false;
    };
    var getFiles = function getFiles2(dataTransfer) {
      return new Promise(function(resolve, reject) {
        var promisedFiles = (dataTransfer.items ? Array.from(dataTransfer.items) : []).filter(function(item2) {
          return isFileSystemItem(item2);
        }).map(function(item2) {
          return getFilesFromItem(item2);
        });
        if (!promisedFiles.length) {
          resolve(dataTransfer.files ? Array.from(dataTransfer.files) : []);
          return;
        }
        Promise.all(promisedFiles).then(function(returnedFileGroups) {
          var files = [];
          returnedFileGroups.forEach(function(group) {
            files.push.apply(files, group);
          });
          resolve(files.filter(function(file2) {
            return file2;
          }).map(function(file2) {
            if (!file2._relativePath)
              file2._relativePath = file2.webkitRelativePath;
            return file2;
          }));
        }).catch(console.error);
      });
    };
    var isFileSystemItem = function isFileSystemItem2(item2) {
      if (isEntry(item2)) {
        var entry = getAsEntry(item2);
        if (entry) {
          return entry.isFile || entry.isDirectory;
        }
      }
      return item2.kind === "file";
    };
    var getFilesFromItem = function getFilesFromItem2(item2) {
      return new Promise(function(resolve, reject) {
        if (isDirectoryEntry(item2)) {
          getFilesInDirectory(getAsEntry(item2)).then(resolve).catch(reject);
          return;
        }
        resolve([item2.getAsFile()]);
      });
    };
    var getFilesInDirectory = function getFilesInDirectory2(entry) {
      return new Promise(function(resolve, reject) {
        var files = [];
        var dirCounter = 0;
        var fileCounter = 0;
        var resolveIfDone = function resolveIfDone2() {
          if (fileCounter === 0 && dirCounter === 0) {
            resolve(files);
          }
        };
        var readEntries = function readEntries2(dirEntry) {
          dirCounter++;
          var directoryReader = dirEntry.createReader();
          var readBatch = function readBatch2() {
            directoryReader.readEntries(function(entries) {
              if (entries.length === 0) {
                dirCounter--;
                resolveIfDone();
                return;
              }
              entries.forEach(function(entry2) {
                if (entry2.isDirectory) {
                  readEntries2(entry2);
                } else {
                  fileCounter++;
                  entry2.file(function(file2) {
                    var correctedFile = correctMissingFileType(file2);
                    if (entry2.fullPath)
                      correctedFile._relativePath = entry2.fullPath;
                    files.push(correctedFile);
                    fileCounter--;
                    resolveIfDone();
                  });
                }
              });
              readBatch2();
            }, reject);
          };
          readBatch();
        };
        readEntries(entry);
      });
    };
    var correctMissingFileType = function correctMissingFileType2(file2) {
      if (file2.type.length)
        return file2;
      var date = file2.lastModifiedDate;
      var name2 = file2.name;
      var type = guesstimateMimeType(getExtensionFromFilename(file2.name));
      if (!type.length)
        return file2;
      file2 = file2.slice(0, file2.size, type);
      file2.name = name2;
      file2.lastModifiedDate = date;
      return file2;
    };
    var isDirectoryEntry = function isDirectoryEntry2(item2) {
      return isEntry(item2) && (getAsEntry(item2) || {}).isDirectory;
    };
    var isEntry = function isEntry2(item2) {
      return "webkitGetAsEntry" in item2;
    };
    var getAsEntry = function getAsEntry2(item2) {
      return item2.webkitGetAsEntry();
    };
    var getLinks = function getLinks2(dataTransfer) {
      var links = [];
      try {
        links = getLinksFromTransferMetaData(dataTransfer);
        if (links.length) {
          return links;
        }
        links = getLinksFromTransferURLData(dataTransfer);
      } catch (e) {
      }
      return links;
    };
    var getLinksFromTransferURLData = function getLinksFromTransferURLData2(dataTransfer) {
      var data3 = dataTransfer.getData("url");
      if (typeof data3 === "string" && data3.length) {
        return [data3];
      }
      return [];
    };
    var getLinksFromTransferMetaData = function getLinksFromTransferMetaData2(dataTransfer) {
      var data3 = dataTransfer.getData("text/html");
      if (typeof data3 === "string" && data3.length) {
        var matches = data3.match(/src\s*=\s*"(.+?)"/);
        if (matches) {
          return [matches[1]];
        }
      }
      return [];
    };
    var dragNDropObservers = [];
    var eventPosition = function eventPosition2(e) {
      return {
        pageLeft: e.pageX,
        pageTop: e.pageY,
        scopeLeft: e.offsetX || e.layerX,
        scopeTop: e.offsetY || e.layerY
      };
    };
    var createDragNDropClient = function createDragNDropClient2(element, scopeToObserve, filterElement) {
      var observer = getDragNDropObserver(scopeToObserve);
      var client = {
        element,
        filterElement,
        state: null,
        ondrop: function ondrop() {
        },
        onenter: function onenter() {
        },
        ondrag: function ondrag() {
        },
        onexit: function onexit() {
        },
        onload: function onload() {
        },
        allowdrop: function allowdrop() {
        }
      };
      client.destroy = observer.addListener(client);
      return client;
    };
    var getDragNDropObserver = function getDragNDropObserver2(element) {
      var observer = dragNDropObservers.find(function(item2) {
        return item2.element === element;
      });
      if (observer) {
        return observer;
      }
      var newObserver = createDragNDropObserver(element);
      dragNDropObservers.push(newObserver);
      return newObserver;
    };
    var createDragNDropObserver = function createDragNDropObserver2(element) {
      var clients = [];
      var routes = {
        dragenter,
        dragover,
        dragleave,
        drop
      };
      var handlers = {};
      forin(routes, function(event, createHandler) {
        handlers[event] = createHandler(element, clients);
        element.addEventListener(event, handlers[event], false);
      });
      var observer = {
        element,
        addListener: function addListener(client) {
          clients.push(client);
          return function() {
            clients.splice(clients.indexOf(client), 1);
            if (clients.length === 0) {
              dragNDropObservers.splice(dragNDropObservers.indexOf(observer), 1);
              forin(routes, function(event) {
                element.removeEventListener(event, handlers[event], false);
              });
            }
          };
        }
      };
      return observer;
    };
    var elementFromPoint = function elementFromPoint2(root2, point) {
      if (!("elementFromPoint" in root2)) {
        root2 = document;
      }
      return root2.elementFromPoint(point.x, point.y);
    };
    var isEventTarget = function isEventTarget2(e, target) {
      var root2 = getRootNode(target);
      var elementAtPosition = elementFromPoint(root2, {
        x: e.pageX - window.pageXOffset,
        y: e.pageY - window.pageYOffset
      });
      return elementAtPosition === target || target.contains(elementAtPosition);
    };
    var initialTarget = null;
    var setDropEffect = function setDropEffect2(dataTransfer, effect) {
      try {
        dataTransfer.dropEffect = effect;
      } catch (e) {
      }
    };
    var dragenter = function dragenter2(root2, clients) {
      return function(e) {
        e.preventDefault();
        initialTarget = e.target;
        clients.forEach(function(client) {
          var element = client.element, onenter = client.onenter;
          if (isEventTarget(e, element)) {
            client.state = "enter";
            onenter(eventPosition(e));
          }
        });
      };
    };
    var dragover = function dragover2(root2, clients) {
      return function(e) {
        e.preventDefault();
        var dataTransfer = e.dataTransfer;
        requestDataTransferItems(dataTransfer).then(function(items) {
          var overDropTarget = false;
          clients.some(function(client) {
            var filterElement = client.filterElement, element = client.element, onenter = client.onenter, onexit = client.onexit, ondrag = client.ondrag, allowdrop = client.allowdrop;
            setDropEffect(dataTransfer, "copy");
            var allowsTransfer = allowdrop(items);
            if (!allowsTransfer) {
              setDropEffect(dataTransfer, "none");
              return;
            }
            if (isEventTarget(e, element)) {
              overDropTarget = true;
              if (client.state === null) {
                client.state = "enter";
                onenter(eventPosition(e));
                return;
              }
              client.state = "over";
              if (filterElement && !allowsTransfer) {
                setDropEffect(dataTransfer, "none");
                return;
              }
              ondrag(eventPosition(e));
            } else {
              if (filterElement && !overDropTarget) {
                setDropEffect(dataTransfer, "none");
              }
              if (client.state) {
                client.state = null;
                onexit(eventPosition(e));
              }
            }
          });
        });
      };
    };
    var drop = function drop2(root2, clients) {
      return function(e) {
        e.preventDefault();
        var dataTransfer = e.dataTransfer;
        requestDataTransferItems(dataTransfer).then(function(items) {
          clients.forEach(function(client) {
            var filterElement = client.filterElement, element = client.element, ondrop = client.ondrop, onexit = client.onexit, allowdrop = client.allowdrop;
            client.state = null;
            if (filterElement && !isEventTarget(e, element))
              return;
            if (!allowdrop(items))
              return onexit(eventPosition(e));
            ondrop(eventPosition(e), items);
          });
        });
      };
    };
    var dragleave = function dragleave2(root2, clients) {
      return function(e) {
        if (initialTarget !== e.target) {
          return;
        }
        clients.forEach(function(client) {
          var onexit = client.onexit;
          client.state = null;
          onexit(eventPosition(e));
        });
      };
    };
    var createHopper = function createHopper2(scope, validateItems, options) {
      scope.classList.add("filepond--hopper");
      var catchesDropsOnPage = options.catchesDropsOnPage, requiresDropOnElement = options.requiresDropOnElement, _options$filterItems = options.filterItems, filterItems = _options$filterItems === void 0 ? function(items) {
        return items;
      } : _options$filterItems;
      var client = createDragNDropClient(scope, catchesDropsOnPage ? document.documentElement : scope, requiresDropOnElement);
      var lastState = "";
      var currentState = "";
      client.allowdrop = function(items) {
        return validateItems(filterItems(items));
      };
      client.ondrop = function(position, items) {
        var filteredItems = filterItems(items);
        if (!validateItems(filteredItems)) {
          api.ondragend(position);
          return;
        }
        currentState = "drag-drop";
        api.onload(filteredItems, position);
      };
      client.ondrag = function(position) {
        api.ondrag(position);
      };
      client.onenter = function(position) {
        currentState = "drag-over";
        api.ondragstart(position);
      };
      client.onexit = function(position) {
        currentState = "drag-exit";
        api.ondragend(position);
      };
      var api = {
        updateHopperState: function updateHopperState() {
          if (lastState !== currentState) {
            scope.dataset.hopperState = currentState;
            lastState = currentState;
          }
        },
        onload: function onload() {
        },
        ondragstart: function ondragstart() {
        },
        ondrag: function ondrag() {
        },
        ondragend: function ondragend() {
        },
        destroy: function destroy() {
          client.destroy();
        }
      };
      return api;
    };
    var listening = false;
    var listeners$1 = [];
    var handlePaste = function handlePaste2(e) {
      var activeEl = document.activeElement;
      if (activeEl && /textarea|input/i.test(activeEl.nodeName)) {
        var inScope = false;
        var element = activeEl;
        while (element !== document.body) {
          if (element.classList.contains("filepond--root")) {
            inScope = true;
            break;
          }
          element = element.parentNode;
        }
        if (!inScope)
          return;
      }
      requestDataTransferItems(e.clipboardData).then(function(files) {
        if (!files.length) {
          return;
        }
        listeners$1.forEach(function(listener) {
          return listener(files);
        });
      });
    };
    var listen = function listen2(cb) {
      if (listeners$1.includes(cb)) {
        return;
      }
      listeners$1.push(cb);
      if (listening) {
        return;
      }
      listening = true;
      document.addEventListener("paste", handlePaste);
    };
    var unlisten = function unlisten2(listener) {
      arrayRemove(listeners$1, listeners$1.indexOf(listener));
      if (listeners$1.length === 0) {
        document.removeEventListener("paste", handlePaste);
        listening = false;
      }
    };
    var createPaster = function createPaster2() {
      var cb = function cb2(files) {
        api.onload(files);
      };
      var api = {
        destroy: function destroy() {
          unlisten(cb);
        },
        onload: function onload() {
        }
      };
      listen(cb);
      return api;
    };
    var create$d = function create2(_ref) {
      var root2 = _ref.root, props = _ref.props;
      root2.element.id = "filepond--assistant-" + props.id;
      attr(root2.element, "role", "status");
      attr(root2.element, "aria-live", "polite");
      attr(root2.element, "aria-relevant", "additions");
    };
    var addFilesNotificationTimeout = null;
    var notificationClearTimeout = null;
    var filenames = [];
    var assist = function assist2(root2, message) {
      root2.element.textContent = message;
    };
    var clear$1 = function clear2(root2) {
      root2.element.textContent = "";
    };
    var listModified = function listModified2(root2, filename, label) {
      var total = root2.query("GET_TOTAL_ITEMS");
      assist(root2, label + " " + filename + ", " + total + " " + (total === 1 ? root2.query("GET_LABEL_FILE_COUNT_SINGULAR") : root2.query("GET_LABEL_FILE_COUNT_PLURAL")));
      clearTimeout(notificationClearTimeout);
      notificationClearTimeout = setTimeout(function() {
        clear$1(root2);
      }, 1500);
    };
    var isUsingFilePond = function isUsingFilePond2(root2) {
      return root2.element.parentNode.contains(document.activeElement);
    };
    var itemAdded = function itemAdded2(_ref2) {
      var root2 = _ref2.root, action = _ref2.action;
      if (!isUsingFilePond(root2)) {
        return;
      }
      root2.element.textContent = "";
      var item2 = root2.query("GET_ITEM", action.id);
      filenames.push(item2.filename);
      clearTimeout(addFilesNotificationTimeout);
      addFilesNotificationTimeout = setTimeout(function() {
        listModified(root2, filenames.join(", "), root2.query("GET_LABEL_FILE_ADDED"));
        filenames.length = 0;
      }, 750);
    };
    var itemRemoved = function itemRemoved2(_ref3) {
      var root2 = _ref3.root, action = _ref3.action;
      if (!isUsingFilePond(root2)) {
        return;
      }
      var item2 = action.item;
      listModified(root2, item2.filename, root2.query("GET_LABEL_FILE_REMOVED"));
    };
    var itemProcessed = function itemProcessed2(_ref4) {
      var root2 = _ref4.root, action = _ref4.action;
      var item2 = root2.query("GET_ITEM", action.id);
      var filename = item2.filename;
      var label = root2.query("GET_LABEL_FILE_PROCESSING_COMPLETE");
      assist(root2, filename + " " + label);
    };
    var itemProcessedUndo = function itemProcessedUndo2(_ref5) {
      var root2 = _ref5.root, action = _ref5.action;
      var item2 = root2.query("GET_ITEM", action.id);
      var filename = item2.filename;
      var label = root2.query("GET_LABEL_FILE_PROCESSING_ABORTED");
      assist(root2, filename + " " + label);
    };
    var itemError = function itemError2(_ref6) {
      var root2 = _ref6.root, action = _ref6.action;
      var item2 = root2.query("GET_ITEM", action.id);
      var filename = item2.filename;
      assist(root2, action.status.main + " " + filename + " " + action.status.sub);
    };
    var assistant = createView({
      create: create$d,
      ignoreRect: true,
      ignoreRectUpdate: true,
      write: createRoute({
        DID_LOAD_ITEM: itemAdded,
        DID_REMOVE_ITEM: itemRemoved,
        DID_COMPLETE_ITEM_PROCESSING: itemProcessed,
        DID_ABORT_ITEM_PROCESSING: itemProcessedUndo,
        DID_REVERT_ITEM_PROCESSING: itemProcessedUndo,
        DID_THROW_ITEM_REMOVE_ERROR: itemError,
        DID_THROW_ITEM_LOAD_ERROR: itemError,
        DID_THROW_ITEM_INVALID: itemError,
        DID_THROW_ITEM_PROCESSING_ERROR: itemError
      }),
      tag: "span",
      name: "assistant"
    });
    var toCamels = function toCamels2(string) {
      var separator = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : "-";
      return string.replace(new RegExp(separator + ".", "g"), function(sub) {
        return sub.charAt(1).toUpperCase();
      });
    };
    var debounce = function debounce2(func) {
      var interval = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : 16;
      var immidiateOnly = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : true;
      var last = Date.now();
      var timeout = null;
      return function() {
        for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
          args[_key] = arguments[_key];
        }
        clearTimeout(timeout);
        var dist = Date.now() - last;
        var fn2 = function fn3() {
          last = Date.now();
          func.apply(void 0, args);
        };
        if (dist < interval) {
          if (!immidiateOnly) {
            timeout = setTimeout(fn2, interval - dist);
          }
        } else {
          fn2();
        }
      };
    };
    var MAX_FILES_LIMIT = 1e6;
    var prevent = function prevent2(e) {
      return e.preventDefault();
    };
    var create$e = function create2(_ref) {
      var root2 = _ref.root, props = _ref.props;
      var id2 = root2.query("GET_ID");
      if (id2) {
        root2.element.id = id2;
      }
      var className = root2.query("GET_CLASS_NAME");
      if (className) {
        className.split(" ").filter(function(name2) {
          return name2.length;
        }).forEach(function(name2) {
          root2.element.classList.add(name2);
        });
      }
      root2.ref.label = root2.appendChildView(root2.createChildView(dropLabel, Object.assign({}, props, {
        translateY: null,
        caption: root2.query("GET_LABEL_IDLE")
      })));
      root2.ref.list = root2.appendChildView(root2.createChildView(listScroller, {translateY: null}));
      root2.ref.panel = root2.appendChildView(root2.createChildView(panel, {name: "panel-root"}));
      root2.ref.assistant = root2.appendChildView(root2.createChildView(assistant, Object.assign({}, props)));
      root2.ref.data = root2.appendChildView(root2.createChildView(data2, Object.assign({}, props)));
      root2.ref.measure = createElement$1("div");
      root2.ref.measure.style.height = "100%";
      root2.element.appendChild(root2.ref.measure);
      root2.ref.bounds = null;
      root2.query("GET_STYLES").filter(function(style) {
        return !isEmpty(style.value);
      }).map(function(_ref2) {
        var name2 = _ref2.name, value = _ref2.value;
        root2.element.dataset[name2] = value;
      });
      root2.ref.widthPrevious = null;
      root2.ref.widthUpdated = debounce(function() {
        root2.ref.updateHistory = [];
        root2.dispatch("DID_RESIZE_ROOT");
      }, 250);
      root2.ref.previousAspectRatio = null;
      root2.ref.updateHistory = [];
      var canHover = window.matchMedia("(pointer: fine) and (hover: hover)").matches;
      var hasPointerEvents = "PointerEvent" in window;
      if (root2.query("GET_ALLOW_REORDER") && hasPointerEvents && !canHover) {
        root2.element.addEventListener("touchmove", prevent, {passive: false});
        root2.element.addEventListener("gesturestart", prevent);
      }
      var credits = root2.query("GET_CREDITS");
      var hasCredits = credits.length === 2;
      if (hasCredits) {
        var frag = document.createElement("a");
        frag.className = "filepond--credits";
        frag.setAttribute("aria-hidden", "true");
        frag.href = credits[0];
        frag.tabindex = -1;
        frag.target = "_blank";
        frag.rel = "noopener noreferrer";
        frag.textContent = credits[1];
        root2.element.appendChild(frag);
        root2.ref.credits = frag;
      }
    };
    var write$9 = function write2(_ref3) {
      var root2 = _ref3.root, props = _ref3.props, actions2 = _ref3.actions;
      route$5({root: root2, props, actions: actions2});
      actions2.filter(function(action) {
        return /^DID_SET_STYLE_/.test(action.type);
      }).filter(function(action) {
        return !isEmpty(action.data.value);
      }).map(function(_ref4) {
        var type = _ref4.type, data3 = _ref4.data;
        var name2 = toCamels(type.substr(8).toLowerCase(), "_");
        root2.element.dataset[name2] = data3.value;
        root2.invalidateLayout();
      });
      if (root2.rect.element.hidden)
        return;
      if (root2.rect.element.width !== root2.ref.widthPrevious) {
        root2.ref.widthPrevious = root2.rect.element.width;
        root2.ref.widthUpdated();
      }
      var bounds = root2.ref.bounds;
      if (!bounds) {
        bounds = root2.ref.bounds = calculateRootBoundingBoxHeight(root2);
        root2.element.removeChild(root2.ref.measure);
        root2.ref.measure = null;
      }
      var _root$ref = root2.ref, hopper = _root$ref.hopper, label = _root$ref.label, list2 = _root$ref.list, panel2 = _root$ref.panel;
      if (hopper) {
        hopper.updateHopperState();
      }
      var aspectRatio = root2.query("GET_PANEL_ASPECT_RATIO");
      var isMultiItem = root2.query("GET_ALLOW_MULTIPLE");
      var totalItems = root2.query("GET_TOTAL_ITEMS");
      var maxItems = isMultiItem ? root2.query("GET_MAX_FILES") || MAX_FILES_LIMIT : 1;
      var atMaxCapacity = totalItems === maxItems;
      var addAction = actions2.find(function(action) {
        return action.type === "DID_ADD_ITEM";
      });
      if (atMaxCapacity && addAction) {
        var interactionMethod = addAction.data.interactionMethod;
        label.opacity = 0;
        if (isMultiItem) {
          label.translateY = -40;
        } else {
          if (interactionMethod === InteractionMethod.API) {
            label.translateX = 40;
          } else if (interactionMethod === InteractionMethod.BROWSE) {
            label.translateY = 40;
          } else {
            label.translateY = 30;
          }
        }
      } else if (!atMaxCapacity) {
        label.opacity = 1;
        label.translateX = 0;
        label.translateY = 0;
      }
      var listItemMargin = calculateListItemMargin(root2);
      var listHeight = calculateListHeight(root2);
      var labelHeight = label.rect.element.height;
      var currentLabelHeight = !isMultiItem || atMaxCapacity ? 0 : labelHeight;
      var listMarginTop = atMaxCapacity ? list2.rect.element.marginTop : 0;
      var listMarginBottom = totalItems === 0 ? 0 : list2.rect.element.marginBottom;
      var visualHeight = currentLabelHeight + listMarginTop + listHeight.visual + listMarginBottom;
      var boundsHeight = currentLabelHeight + listMarginTop + listHeight.bounds + listMarginBottom;
      list2.translateY = Math.max(0, currentLabelHeight - list2.rect.element.marginTop) - listItemMargin.top;
      if (aspectRatio) {
        var width = root2.rect.element.width;
        var height = width * aspectRatio;
        if (aspectRatio !== root2.ref.previousAspectRatio) {
          root2.ref.previousAspectRatio = aspectRatio;
          root2.ref.updateHistory = [];
        }
        var history = root2.ref.updateHistory;
        history.push(width);
        var MAX_BOUNCES = 2;
        if (history.length > MAX_BOUNCES * 2) {
          var l = history.length;
          var bottom = l - 10;
          var bounces = 0;
          for (var i = l; i >= bottom; i--) {
            if (history[i] === history[i - 2]) {
              bounces++;
            }
            if (bounces >= MAX_BOUNCES) {
              return;
            }
          }
        }
        panel2.scalable = false;
        panel2.height = height;
        var listAvailableHeight = height - currentLabelHeight - (listMarginBottom - listItemMargin.bottom) - (atMaxCapacity ? listMarginTop : 0);
        if (listHeight.visual > listAvailableHeight) {
          list2.overflow = listAvailableHeight;
        } else {
          list2.overflow = null;
        }
        root2.height = height;
      } else if (bounds.fixedHeight) {
        panel2.scalable = false;
        var _listAvailableHeight = bounds.fixedHeight - currentLabelHeight - (listMarginBottom - listItemMargin.bottom) - (atMaxCapacity ? listMarginTop : 0);
        if (listHeight.visual > _listAvailableHeight) {
          list2.overflow = _listAvailableHeight;
        } else {
          list2.overflow = null;
        }
      } else if (bounds.cappedHeight) {
        var isCappedHeight = visualHeight >= bounds.cappedHeight;
        var panelHeight = Math.min(bounds.cappedHeight, visualHeight);
        panel2.scalable = true;
        panel2.height = isCappedHeight ? panelHeight : panelHeight - listItemMargin.top - listItemMargin.bottom;
        var _listAvailableHeight2 = panelHeight - currentLabelHeight - (listMarginBottom - listItemMargin.bottom) - (atMaxCapacity ? listMarginTop : 0);
        if (visualHeight > bounds.cappedHeight && listHeight.visual > _listAvailableHeight2) {
          list2.overflow = _listAvailableHeight2;
        } else {
          list2.overflow = null;
        }
        root2.height = Math.min(bounds.cappedHeight, boundsHeight - listItemMargin.top - listItemMargin.bottom);
      } else {
        var itemMargin = totalItems > 0 ? listItemMargin.top + listItemMargin.bottom : 0;
        panel2.scalable = true;
        panel2.height = Math.max(labelHeight, visualHeight - itemMargin);
        root2.height = Math.max(labelHeight, boundsHeight - itemMargin);
      }
      if (root2.ref.credits && panel2.heightCurrent)
        root2.ref.credits.style.transform = "translateY(" + panel2.heightCurrent + "px)";
    };
    var calculateListItemMargin = function calculateListItemMargin2(root2) {
      var item2 = root2.ref.list.childViews[0].childViews[0];
      return item2 ? {
        top: item2.rect.element.marginTop,
        bottom: item2.rect.element.marginBottom
      } : {
        top: 0,
        bottom: 0
      };
    };
    var calculateListHeight = function calculateListHeight2(root2) {
      var visual = 0;
      var bounds = 0;
      var scrollList = root2.ref.list;
      var itemList = scrollList.childViews[0];
      var visibleChildren = itemList.childViews.filter(function(child) {
        return child.rect.element.height;
      });
      var children = root2.query("GET_ACTIVE_ITEMS").map(function(item2) {
        return visibleChildren.find(function(child) {
          return child.id === item2.id;
        });
      }).filter(function(item2) {
        return item2;
      });
      if (children.length === 0)
        return {visual, bounds};
      var horizontalSpace = itemList.rect.element.width;
      var dragIndex = getItemIndexByPosition(itemList, children, scrollList.dragCoordinates);
      var childRect = children[0].rect.element;
      var itemVerticalMargin = childRect.marginTop + childRect.marginBottom;
      var itemHorizontalMargin = childRect.marginLeft + childRect.marginRight;
      var itemWidth = childRect.width + itemHorizontalMargin;
      var itemHeight = childRect.height + itemVerticalMargin;
      var newItem = typeof dragIndex !== "undefined" && dragIndex >= 0 ? 1 : 0;
      var removedItem = children.find(function(child) {
        return child.markedForRemoval && child.opacity < 0.45;
      }) ? -1 : 0;
      var verticalItemCount = children.length + newItem + removedItem;
      var itemsPerRow = getItemsPerRow(horizontalSpace, itemWidth);
      if (itemsPerRow === 1) {
        children.forEach(function(item2) {
          var height = item2.rect.element.height + itemVerticalMargin;
          bounds += height;
          visual += height * item2.opacity;
        });
      } else {
        bounds = Math.ceil(verticalItemCount / itemsPerRow) * itemHeight;
        visual = bounds;
      }
      return {visual, bounds};
    };
    var calculateRootBoundingBoxHeight = function calculateRootBoundingBoxHeight2(root2) {
      var height = root2.ref.measureHeight || null;
      var cappedHeight = parseInt(root2.style.maxHeight, 10) || null;
      var fixedHeight = height === 0 ? null : height;
      return {
        cappedHeight,
        fixedHeight
      };
    };
    var exceedsMaxFiles = function exceedsMaxFiles2(root2, items) {
      var allowReplace = root2.query("GET_ALLOW_REPLACE");
      var allowMultiple = root2.query("GET_ALLOW_MULTIPLE");
      var totalItems = root2.query("GET_TOTAL_ITEMS");
      var maxItems = root2.query("GET_MAX_FILES");
      var totalBrowseItems = items.length;
      if (!allowMultiple && totalBrowseItems > 1) {
        return true;
      }
      maxItems = allowMultiple ? maxItems : allowReplace ? maxItems : 1;
      var hasMaxItems = isInt(maxItems);
      if (hasMaxItems && totalItems + totalBrowseItems > maxItems) {
        root2.dispatch("DID_THROW_MAX_FILES", {
          source: items,
          error: createResponse("warning", 0, "Max files")
        });
        return true;
      }
      return false;
    };
    var getDragIndex = function getDragIndex2(list2, children, position) {
      var itemList = list2.childViews[0];
      return getItemIndexByPosition(itemList, children, {
        left: position.scopeLeft - itemList.rect.element.left,
        top: position.scopeTop - (list2.rect.outer.top + list2.rect.element.marginTop + list2.rect.element.scrollTop)
      });
    };
    var toggleDrop = function toggleDrop2(root2) {
      var isAllowed = root2.query("GET_ALLOW_DROP");
      var isDisabled = root2.query("GET_DISABLED");
      var enabled = isAllowed && !isDisabled;
      if (enabled && !root2.ref.hopper) {
        var hopper = createHopper(root2.element, function(items) {
          var beforeDropFile = root2.query("GET_BEFORE_DROP_FILE") || function() {
            return true;
          };
          var dropValidation = root2.query("GET_DROP_VALIDATION");
          return dropValidation ? items.every(function(item2) {
            return applyFilters("ALLOW_HOPPER_ITEM", item2, {
              query: root2.query
            }).every(function(result) {
              return result === true;
            }) && beforeDropFile(item2);
          }) : true;
        }, {
          filterItems: function filterItems(items) {
            var ignoredFiles = root2.query("GET_IGNORED_FILES");
            return items.filter(function(item2) {
              if (isFile(item2)) {
                return !ignoredFiles.includes(item2.name.toLowerCase());
              }
              return true;
            });
          },
          catchesDropsOnPage: root2.query("GET_DROP_ON_PAGE"),
          requiresDropOnElement: root2.query("GET_DROP_ON_ELEMENT")
        });
        hopper.onload = function(items, position) {
          var list2 = root2.ref.list.childViews[0];
          var visibleChildren = list2.childViews.filter(function(child) {
            return child.rect.element.height;
          });
          var children = root2.query("GET_ACTIVE_ITEMS").map(function(item2) {
            return visibleChildren.find(function(child) {
              return child.id === item2.id;
            });
          }).filter(function(item2) {
            return item2;
          });
          applyFilterChain("ADD_ITEMS", items, {dispatch: root2.dispatch}).then(function(queue) {
            if (exceedsMaxFiles(root2, queue))
              return false;
            root2.dispatch("ADD_ITEMS", {
              items: queue,
              index: getDragIndex(root2.ref.list, children, position),
              interactionMethod: InteractionMethod.DROP
            });
          });
          root2.dispatch("DID_DROP", {position});
          root2.dispatch("DID_END_DRAG", {position});
        };
        hopper.ondragstart = function(position) {
          root2.dispatch("DID_START_DRAG", {position});
        };
        hopper.ondrag = debounce(function(position) {
          root2.dispatch("DID_DRAG", {position});
        });
        hopper.ondragend = function(position) {
          root2.dispatch("DID_END_DRAG", {position});
        };
        root2.ref.hopper = hopper;
        root2.ref.drip = root2.appendChildView(root2.createChildView(drip));
      } else if (!enabled && root2.ref.hopper) {
        root2.ref.hopper.destroy();
        root2.ref.hopper = null;
        root2.removeChildView(root2.ref.drip);
      }
    };
    var toggleBrowse = function toggleBrowse2(root2, props) {
      var isAllowed = root2.query("GET_ALLOW_BROWSE");
      var isDisabled = root2.query("GET_DISABLED");
      var enabled = isAllowed && !isDisabled;
      if (enabled && !root2.ref.browser) {
        root2.ref.browser = root2.appendChildView(root2.createChildView(browser, Object.assign({}, props, {
          onload: function onload(items) {
            applyFilterChain("ADD_ITEMS", items, {
              dispatch: root2.dispatch
            }).then(function(queue) {
              if (exceedsMaxFiles(root2, queue))
                return false;
              root2.dispatch("ADD_ITEMS", {
                items: queue,
                index: -1,
                interactionMethod: InteractionMethod.BROWSE
              });
            });
          }
        })), 0);
      } else if (!enabled && root2.ref.browser) {
        root2.removeChildView(root2.ref.browser);
        root2.ref.browser = null;
      }
    };
    var togglePaste = function togglePaste2(root2) {
      var isAllowed = root2.query("GET_ALLOW_PASTE");
      var isDisabled = root2.query("GET_DISABLED");
      var enabled = isAllowed && !isDisabled;
      if (enabled && !root2.ref.paster) {
        root2.ref.paster = createPaster();
        root2.ref.paster.onload = function(items) {
          applyFilterChain("ADD_ITEMS", items, {dispatch: root2.dispatch}).then(function(queue) {
            if (exceedsMaxFiles(root2, queue))
              return false;
            root2.dispatch("ADD_ITEMS", {
              items: queue,
              index: -1,
              interactionMethod: InteractionMethod.PASTE
            });
          });
        };
      } else if (!enabled && root2.ref.paster) {
        root2.ref.paster.destroy();
        root2.ref.paster = null;
      }
    };
    var route$5 = createRoute({
      DID_SET_ALLOW_BROWSE: function DID_SET_ALLOW_BROWSE(_ref5) {
        var root2 = _ref5.root, props = _ref5.props;
        toggleBrowse(root2, props);
      },
      DID_SET_ALLOW_DROP: function DID_SET_ALLOW_DROP(_ref6) {
        var root2 = _ref6.root;
        toggleDrop(root2);
      },
      DID_SET_ALLOW_PASTE: function DID_SET_ALLOW_PASTE(_ref7) {
        var root2 = _ref7.root;
        togglePaste(root2);
      },
      DID_SET_DISABLED: function DID_SET_DISABLED(_ref8) {
        var root2 = _ref8.root, props = _ref8.props;
        toggleDrop(root2);
        togglePaste(root2);
        toggleBrowse(root2, props);
        var isDisabled = root2.query("GET_DISABLED");
        if (isDisabled) {
          root2.element.dataset.disabled = "disabled";
        } else {
          root2.element.removeAttribute("data-disabled");
        }
      }
    });
    var root = createView({
      name: "root",
      read: function read(_ref9) {
        var root2 = _ref9.root;
        if (root2.ref.measure) {
          root2.ref.measureHeight = root2.ref.measure.offsetHeight;
        }
      },
      create: create$e,
      write: write$9,
      destroy: function destroy(_ref10) {
        var root2 = _ref10.root;
        if (root2.ref.paster) {
          root2.ref.paster.destroy();
        }
        if (root2.ref.hopper) {
          root2.ref.hopper.destroy();
        }
        root2.element.removeEventListener("touchmove", prevent);
        root2.element.removeEventListener("gesturestart", prevent);
      },
      mixins: {
        styles: ["height"]
      }
    });
    var createApp = function createApp2() {
      var initialOptions = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : {};
      var originalElement = null;
      var defaultOptions2 = getOptions();
      var store = createStore(createInitialState(defaultOptions2), [queries, createOptionQueries(defaultOptions2)], [actions, createOptionActions(defaultOptions2)]);
      store.dispatch("SET_OPTIONS", {options: initialOptions});
      var visibilityHandler = function visibilityHandler2() {
        if (document.hidden)
          return;
        store.dispatch("KICK");
      };
      document.addEventListener("visibilitychange", visibilityHandler);
      var resizeDoneTimer = null;
      var isResizing = false;
      var isResizingHorizontally = false;
      var initialWindowWidth = null;
      var currentWindowWidth = null;
      var resizeHandler = function resizeHandler2() {
        if (!isResizing) {
          isResizing = true;
        }
        clearTimeout(resizeDoneTimer);
        resizeDoneTimer = setTimeout(function() {
          isResizing = false;
          initialWindowWidth = null;
          currentWindowWidth = null;
          if (isResizingHorizontally) {
            isResizingHorizontally = false;
            store.dispatch("DID_STOP_RESIZE");
          }
        }, 500);
      };
      window.addEventListener("resize", resizeHandler);
      var view = root(store, {id: getUniqueId()});
      var isResting = false;
      var isHidden = false;
      var readWriteApi = {
        _read: function _read() {
          if (isResizing) {
            currentWindowWidth = window.innerWidth;
            if (!initialWindowWidth) {
              initialWindowWidth = currentWindowWidth;
            }
            if (!isResizingHorizontally && currentWindowWidth !== initialWindowWidth) {
              store.dispatch("DID_START_RESIZE");
              isResizingHorizontally = true;
            }
          }
          if (isHidden && isResting) {
            isResting = view.element.offsetParent === null;
          }
          if (isResting)
            return;
          view._read();
          isHidden = view.rect.element.hidden;
        },
        _write: function _write(ts) {
          var actions2 = store.processActionQueue().filter(function(action) {
            return !/^SET_/.test(action.type);
          });
          if (isResting && !actions2.length)
            return;
          routeActionsToEvents(actions2);
          isResting = view._write(ts, actions2, isResizingHorizontally);
          removeReleasedItems(store.query("GET_ITEMS"));
          if (isResting) {
            store.processDispatchQueue();
          }
        }
      };
      var createEvent = function createEvent2(name2) {
        return function(data3) {
          var event = {
            type: name2
          };
          if (!data3) {
            return event;
          }
          if (data3.hasOwnProperty("error")) {
            event.error = data3.error ? Object.assign({}, data3.error) : null;
          }
          if (data3.status) {
            event.status = Object.assign({}, data3.status);
          }
          if (data3.file) {
            event.output = data3.file;
          }
          if (data3.source) {
            event.file = data3.source;
          } else if (data3.item || data3.id) {
            var item2 = data3.item ? data3.item : store.query("GET_ITEM", data3.id);
            event.file = item2 ? createItemAPI(item2) : null;
          }
          if (data3.items) {
            event.items = data3.items.map(createItemAPI);
          }
          if (/progress/.test(name2)) {
            event.progress = data3.progress;
          }
          if (data3.hasOwnProperty("origin") && data3.hasOwnProperty("target")) {
            event.origin = data3.origin;
            event.target = data3.target;
          }
          return event;
        };
      };
      var eventRoutes = {
        DID_DESTROY: createEvent("destroy"),
        DID_INIT: createEvent("init"),
        DID_THROW_MAX_FILES: createEvent("warning"),
        DID_INIT_ITEM: createEvent("initfile"),
        DID_START_ITEM_LOAD: createEvent("addfilestart"),
        DID_UPDATE_ITEM_LOAD_PROGRESS: createEvent("addfileprogress"),
        DID_LOAD_ITEM: createEvent("addfile"),
        DID_THROW_ITEM_INVALID: [createEvent("error"), createEvent("addfile")],
        DID_THROW_ITEM_LOAD_ERROR: [createEvent("error"), createEvent("addfile")],
        DID_THROW_ITEM_REMOVE_ERROR: [createEvent("error"), createEvent("removefile")],
        DID_PREPARE_OUTPUT: createEvent("preparefile"),
        DID_START_ITEM_PROCESSING: createEvent("processfilestart"),
        DID_UPDATE_ITEM_PROCESS_PROGRESS: createEvent("processfileprogress"),
        DID_ABORT_ITEM_PROCESSING: createEvent("processfileabort"),
        DID_COMPLETE_ITEM_PROCESSING: createEvent("processfile"),
        DID_COMPLETE_ITEM_PROCESSING_ALL: createEvent("processfiles"),
        DID_REVERT_ITEM_PROCESSING: createEvent("processfilerevert"),
        DID_THROW_ITEM_PROCESSING_ERROR: [createEvent("error"), createEvent("processfile")],
        DID_REMOVE_ITEM: createEvent("removefile"),
        DID_UPDATE_ITEMS: createEvent("updatefiles"),
        DID_ACTIVATE_ITEM: createEvent("activatefile"),
        DID_REORDER_ITEMS: createEvent("reorderfiles")
      };
      var exposeEvent = function exposeEvent2(event) {
        var detail = Object.assign({pond: exports3}, event);
        delete detail.type;
        view.element.dispatchEvent(new CustomEvent("FilePond:" + event.type, {
          detail,
          bubbles: true,
          cancelable: true,
          composed: true
        }));
        var params = [];
        if (event.hasOwnProperty("error")) {
          params.push(event.error);
        }
        if (event.hasOwnProperty("file")) {
          params.push(event.file);
        }
        var filtered = ["type", "error", "file"];
        Object.keys(event).filter(function(key) {
          return !filtered.includes(key);
        }).forEach(function(key) {
          return params.push(event[key]);
        });
        exports3.fire.apply(exports3, [event.type].concat(params));
        var handler = store.query("GET_ON" + event.type.toUpperCase());
        if (handler) {
          handler.apply(void 0, params);
        }
      };
      var routeActionsToEvents = function routeActionsToEvents2(actions2) {
        if (!actions2.length)
          return;
        actions2.filter(function(action) {
          return eventRoutes[action.type];
        }).forEach(function(action) {
          var routes = eventRoutes[action.type];
          (Array.isArray(routes) ? routes : [routes]).forEach(function(route2) {
            if (action.type === "DID_INIT_ITEM") {
              exposeEvent(route2(action.data));
            } else {
              setTimeout(function() {
                exposeEvent(route2(action.data));
              }, 0);
            }
          });
        });
      };
      var setOptions2 = function setOptions3(options) {
        return store.dispatch("SET_OPTIONS", {options});
      };
      var getFile = function getFile2(query) {
        return store.query("GET_ACTIVE_ITEM", query);
      };
      var prepareFile = function prepareFile2(query) {
        return new Promise(function(resolve, reject) {
          store.dispatch("REQUEST_ITEM_PREPARE", {
            query,
            success: function success(item2) {
              resolve(item2);
            },
            failure: function failure(error2) {
              reject(error2);
            }
          });
        });
      };
      var addFile = function addFile2(source) {
        var options = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : {};
        return new Promise(function(resolve, reject) {
          addFiles([{source, options}], {index: options.index}).then(function(items) {
            return resolve(items && items[0]);
          }).catch(reject);
        });
      };
      var isFilePondFile = function isFilePondFile2(obj) {
        return obj.file && obj.id;
      };
      var removeFile = function removeFile2(query, options) {
        if (typeof query === "object" && !isFilePondFile(query) && !options) {
          options = query;
          query = void 0;
        }
        store.dispatch("REMOVE_ITEM", Object.assign({}, options, {query}));
        return store.query("GET_ACTIVE_ITEM", query) === null;
      };
      var addFiles = function addFiles2() {
        for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
          args[_key] = arguments[_key];
        }
        return new Promise(function(resolve, reject) {
          var sources = [];
          var options = {};
          if (isArray(args[0])) {
            sources.push.apply(sources, args[0]);
            Object.assign(options, args[1] || {});
          } else {
            var lastArgument = args[args.length - 1];
            if (typeof lastArgument === "object" && !(lastArgument instanceof Blob)) {
              Object.assign(options, args.pop());
            }
            sources.push.apply(sources, args);
          }
          store.dispatch("ADD_ITEMS", {
            items: sources,
            index: options.index,
            interactionMethod: InteractionMethod.API,
            success: resolve,
            failure: reject
          });
        });
      };
      var getFiles2 = function getFiles3() {
        return store.query("GET_ACTIVE_ITEMS");
      };
      var processFile = function processFile2(query) {
        return new Promise(function(resolve, reject) {
          store.dispatch("REQUEST_ITEM_PROCESSING", {
            query,
            success: function success(item2) {
              resolve(item2);
            },
            failure: function failure(error2) {
              reject(error2);
            }
          });
        });
      };
      var prepareFiles = function prepareFiles2() {
        for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
          args[_key2] = arguments[_key2];
        }
        var queries2 = Array.isArray(args[0]) ? args[0] : args;
        var items = queries2.length ? queries2 : getFiles2();
        return Promise.all(items.map(prepareFile));
      };
      var processFiles = function processFiles2() {
        for (var _len3 = arguments.length, args = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {
          args[_key3] = arguments[_key3];
        }
        var queries2 = Array.isArray(args[0]) ? args[0] : args;
        if (!queries2.length) {
          var files = getFiles2().filter(function(item2) {
            return !(item2.status === ItemStatus.IDLE && item2.origin === FileOrigin.LOCAL) && item2.status !== ItemStatus.PROCESSING && item2.status !== ItemStatus.PROCESSING_COMPLETE && item2.status !== ItemStatus.PROCESSING_REVERT_ERROR;
          });
          return Promise.all(files.map(processFile));
        }
        return Promise.all(queries2.map(processFile));
      };
      var removeFiles = function removeFiles2() {
        for (var _len4 = arguments.length, args = new Array(_len4), _key4 = 0; _key4 < _len4; _key4++) {
          args[_key4] = arguments[_key4];
        }
        var queries2 = Array.isArray(args[0]) ? args[0] : args;
        var options;
        if (typeof queries2[queries2.length - 1] === "object") {
          options = queries2.pop();
        } else if (Array.isArray(args[0])) {
          options = args[1];
        }
        var files = getFiles2();
        if (!queries2.length)
          return Promise.all(files.map(function(file2) {
            return removeFile(file2, options);
          }));
        var mappedQueries = queries2.map(function(query) {
          return isNumber(query) ? files[query] ? files[query].id : null : query;
        }).filter(function(query) {
          return query;
        });
        return mappedQueries.map(function(q) {
          return removeFile(q, options);
        });
      };
      var exports3 = Object.assign({}, on(), {}, readWriteApi, {}, createOptionAPI(store, defaultOptions2), {
        setOptions: setOptions2,
        addFile,
        addFiles,
        getFile,
        processFile,
        prepareFile,
        removeFile,
        moveFile: function moveFile(query, index) {
          return store.dispatch("MOVE_ITEM", {query, index});
        },
        getFiles: getFiles2,
        processFiles,
        removeFiles,
        prepareFiles,
        sort: function sort(compare) {
          return store.dispatch("SORT", {compare});
        },
        browse: function browse() {
          var input = view.element.querySelector("input[type=file]");
          if (input) {
            input.click();
          }
        },
        destroy: function destroy() {
          exports3.fire("destroy", view.element);
          store.dispatch("ABORT_ALL");
          view._destroy();
          window.removeEventListener("resize", resizeHandler);
          document.removeEventListener("visibilitychange", visibilityHandler);
          store.dispatch("DID_DESTROY");
        },
        insertBefore: function insertBefore$1(element) {
          return insertBefore(view.element, element);
        },
        insertAfter: function insertAfter$1(element) {
          return insertAfter(view.element, element);
        },
        appendTo: function appendTo(element) {
          return element.appendChild(view.element);
        },
        replaceElement: function replaceElement(element) {
          insertBefore(view.element, element);
          element.parentNode.removeChild(element);
          originalElement = element;
        },
        restoreElement: function restoreElement() {
          if (!originalElement) {
            return;
          }
          insertAfter(originalElement, view.element);
          view.element.parentNode.removeChild(view.element);
          originalElement = null;
        },
        isAttachedTo: function isAttachedTo(element) {
          return view.element === element || originalElement === element;
        },
        element: {
          get: function get() {
            return view.element;
          }
        },
        status: {
          get: function get() {
            return store.query("GET_STATUS");
          }
        }
      });
      store.dispatch("DID_INIT");
      return createObject(exports3);
    };
    var createAppObject = function createAppObject2() {
      var customOptions = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : {};
      var defaultOptions2 = {};
      forin(getOptions(), function(key, value) {
        defaultOptions2[key] = value[0];
      });
      var app = createApp(Object.assign({}, defaultOptions2, {}, customOptions));
      return app;
    };
    var lowerCaseFirstLetter = function lowerCaseFirstLetter2(string) {
      return string.charAt(0).toLowerCase() + string.slice(1);
    };
    var attributeNameToPropertyName = function attributeNameToPropertyName2(attributeName) {
      return toCamels(attributeName.replace(/^data-/, ""));
    };
    var mapObject = function mapObject2(object, propertyMap) {
      forin(propertyMap, function(selector, mapping) {
        forin(object, function(property, value) {
          var selectorRegExp = new RegExp(selector);
          var matches = selectorRegExp.test(property);
          if (!matches) {
            return;
          }
          delete object[property];
          if (mapping === false) {
            return;
          }
          if (isString(mapping)) {
            object[mapping] = value;
            return;
          }
          var group = mapping.group;
          if (isObject(mapping) && !object[group]) {
            object[group] = {};
          }
          object[group][lowerCaseFirstLetter(property.replace(selectorRegExp, ""))] = value;
        });
        if (mapping.mapping) {
          mapObject2(object[mapping.group], mapping.mapping);
        }
      });
    };
    var getAttributesAsObject = function getAttributesAsObject2(node) {
      var attributeMapping = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : {};
      var attributes = [];
      forin(node.attributes, function(index) {
        attributes.push(node.attributes[index]);
      });
      var output = attributes.filter(function(attribute) {
        return attribute.name;
      }).reduce(function(obj, attribute) {
        var value = attr(node, attribute.name);
        obj[attributeNameToPropertyName(attribute.name)] = value === attribute.name ? true : value;
        return obj;
      }, {});
      mapObject(output, attributeMapping);
      return output;
    };
    var createAppAtElement = function createAppAtElement2(element) {
      var options = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : {};
      var attributeMapping = {
        "^class$": "className",
        "^multiple$": "allowMultiple",
        "^capture$": "captureMethod",
        "^webkitdirectory$": "allowDirectoriesOnly",
        "^server": {
          group: "server",
          mapping: {
            "^process": {
              group: "process"
            },
            "^revert": {
              group: "revert"
            },
            "^fetch": {
              group: "fetch"
            },
            "^restore": {
              group: "restore"
            },
            "^load": {
              group: "load"
            }
          }
        },
        "^type$": false,
        "^files$": false
      };
      applyFilters("SET_ATTRIBUTE_TO_OPTION_MAP", attributeMapping);
      var mergedOptions = Object.assign({}, options);
      var attributeOptions = getAttributesAsObject(element.nodeName === "FIELDSET" ? element.querySelector("input[type=file]") : element, attributeMapping);
      Object.keys(attributeOptions).forEach(function(key) {
        if (isObject(attributeOptions[key])) {
          if (!isObject(mergedOptions[key])) {
            mergedOptions[key] = {};
          }
          Object.assign(mergedOptions[key], attributeOptions[key]);
        } else {
          mergedOptions[key] = attributeOptions[key];
        }
      });
      mergedOptions.files = (options.files || []).concat(Array.from(element.querySelectorAll("input:not([type=file])")).map(function(input) {
        return {
          source: input.value,
          options: {
            type: input.dataset.type
          }
        };
      }));
      var app = createAppObject(mergedOptions);
      if (element.files) {
        Array.from(element.files).forEach(function(file2) {
          app.addFile(file2);
        });
      }
      app.replaceElement(element);
      return app;
    };
    var createApp$1 = function createApp2() {
      return isNode(arguments.length <= 0 ? void 0 : arguments[0]) ? createAppAtElement.apply(void 0, arguments) : createAppObject.apply(void 0, arguments);
    };
    var PRIVATE_METHODS = ["fire", "_read", "_write"];
    var createAppAPI = function createAppAPI2(app) {
      var api = {};
      copyObjectPropertiesToObject(app, api, PRIVATE_METHODS);
      return api;
    };
    var replaceInString = function replaceInString2(string, replacements) {
      return string.replace(/(?:{([a-zA-Z]+)})/g, function(match, group) {
        return replacements[group];
      });
    };
    var createWorker = function createWorker2(fn2) {
      var workerBlob = new Blob(["(", fn2.toString(), ")()"], {
        type: "application/javascript"
      });
      var workerURL = URL.createObjectURL(workerBlob);
      var worker = new Worker(workerURL);
      return {
        transfer: function transfer(message, cb) {
        },
        post: function post(message, cb, transferList) {
          var id2 = getUniqueId();
          worker.onmessage = function(e) {
            if (e.data.id === id2) {
              cb(e.data.message);
            }
          };
          worker.postMessage({
            id: id2,
            message
          }, transferList);
        },
        terminate: function terminate() {
          worker.terminate();
          URL.revokeObjectURL(workerURL);
        }
      };
    };
    var loadImage = function loadImage2(url) {
      return new Promise(function(resolve, reject) {
        var img = new Image();
        img.onload = function() {
          resolve(img);
        };
        img.onerror = function(e) {
          reject(e);
        };
        img.src = url;
      });
    };
    var renameFile = function renameFile2(file2, name2) {
      var renamedFile = file2.slice(0, file2.size, file2.type);
      renamedFile.lastModifiedDate = file2.lastModifiedDate;
      renamedFile.name = name2;
      return renamedFile;
    };
    var copyFile = function copyFile2(file2) {
      return renameFile(file2, file2.name);
    };
    var registeredPlugins = [];
    var createAppPlugin = function createAppPlugin2(plugin) {
      if (registeredPlugins.includes(plugin)) {
        return;
      }
      registeredPlugins.push(plugin);
      var pluginOutline = plugin({
        addFilter,
        utils: {
          Type,
          forin,
          isString,
          isFile,
          toNaturalFileSize,
          replaceInString,
          getExtensionFromFilename,
          getFilenameWithoutExtension,
          guesstimateMimeType,
          getFileFromBlob,
          getFilenameFromURL,
          createRoute,
          createWorker,
          createView,
          createItemAPI,
          loadImage,
          copyFile,
          renameFile,
          createBlob,
          applyFilterChain,
          text,
          getNumericAspectRatioFromString
        },
        views: {
          fileActionButton
        }
      });
      extendDefaultOptions(pluginOutline.options);
    };
    var isOperaMini = function isOperaMini2() {
      return Object.prototype.toString.call(window.operamini) === "[object OperaMini]";
    };
    var hasPromises = function hasPromises2() {
      return "Promise" in window;
    };
    var hasBlobSlice = function hasBlobSlice2() {
      return "slice" in Blob.prototype;
    };
    var hasCreateObjectURL = function hasCreateObjectURL2() {
      return "URL" in window && "createObjectURL" in window.URL;
    };
    var hasVisibility = function hasVisibility2() {
      return "visibilityState" in document;
    };
    var hasTiming = function hasTiming2() {
      return "performance" in window;
    };
    var hasCSSSupports = function hasCSSSupports2() {
      return "supports" in (window.CSS || {});
    };
    var isIE11 = function isIE112() {
      return /MSIE|Trident/.test(window.navigator.userAgent);
    };
    var supported = function() {
      var isSupported = isBrowser() && !isOperaMini() && hasVisibility() && hasPromises() && hasBlobSlice() && hasCreateObjectURL() && hasTiming() && (hasCSSSupports() || isIE11());
      return function() {
        return isSupported;
      };
    }();
    var state = {
      apps: []
    };
    var name = "filepond";
    var fn = function fn2() {
    };
    exports2.Status = {};
    exports2.FileStatus = {};
    exports2.FileOrigin = {};
    exports2.OptionTypes = {};
    exports2.create = fn;
    exports2.destroy = fn;
    exports2.parse = fn;
    exports2.find = fn;
    exports2.registerPlugin = fn;
    exports2.getOptions = fn;
    exports2.setOptions = fn;
    if (supported()) {
      createPainter(function() {
        state.apps.forEach(function(app) {
          return app._read();
        });
      }, function(ts) {
        state.apps.forEach(function(app) {
          return app._write(ts);
        });
      });
      var dispatch = function dispatch2() {
        document.dispatchEvent(new CustomEvent("FilePond:loaded", {
          detail: {
            supported,
            create: exports2.create,
            destroy: exports2.destroy,
            parse: exports2.parse,
            find: exports2.find,
            registerPlugin: exports2.registerPlugin,
            setOptions: exports2.setOptions
          }
        }));
        document.removeEventListener("DOMContentLoaded", dispatch2);
      };
      if (document.readyState !== "loading") {
        setTimeout(function() {
          return dispatch();
        }, 0);
      } else {
        document.addEventListener("DOMContentLoaded", dispatch);
      }
      var updateOptionTypes = function updateOptionTypes2() {
        return forin(getOptions(), function(key, value) {
          exports2.OptionTypes[key] = value[1];
        });
      };
      exports2.Status = Object.assign({}, Status);
      exports2.FileOrigin = Object.assign({}, FileOrigin);
      exports2.FileStatus = Object.assign({}, ItemStatus);
      exports2.OptionTypes = {};
      updateOptionTypes();
      exports2.create = function create2() {
        var app = createApp$1.apply(void 0, arguments);
        app.on("destroy", exports2.destroy);
        state.apps.push(app);
        return createAppAPI(app);
      };
      exports2.destroy = function destroy(hook) {
        var indexToRemove = state.apps.findIndex(function(app2) {
          return app2.isAttachedTo(hook);
        });
        if (indexToRemove >= 0) {
          var app = state.apps.splice(indexToRemove, 1)[0];
          app.restoreElement();
          return true;
        }
        return false;
      };
      exports2.parse = function parse(context) {
        var matchedHooks = Array.from(context.querySelectorAll("." + name));
        var newHooks = matchedHooks.filter(function(newHook) {
          return !state.apps.find(function(app) {
            return app.isAttachedTo(newHook);
          });
        });
        return newHooks.map(function(hook) {
          return exports2.create(hook);
        });
      };
      exports2.find = function find(hook) {
        var app = state.apps.find(function(app2) {
          return app2.isAttachedTo(hook);
        });
        if (!app) {
          return null;
        }
        return createAppAPI(app);
      };
      exports2.registerPlugin = function registerPlugin() {
        for (var _len = arguments.length, plugins = new Array(_len), _key = 0; _key < _len; _key++) {
          plugins[_key] = arguments[_key];
        }
        plugins.forEach(createAppPlugin);
        updateOptionTypes();
      };
      exports2.getOptions = function getOptions$1() {
        var opts = {};
        forin(getOptions(), function(key, value) {
          opts[key] = value[0];
        });
        return opts;
      };
      exports2.setOptions = function setOptions$1(opts) {
        if (isObject(opts)) {
          state.apps.forEach(function(app) {
            app.setOptions(opts);
          });
          setOptions(opts);
        }
        return exports2.getOptions();
      };
    }
    exports2.supported = supported;
    Object.defineProperty(exports2, "__esModule", {value: true});
  });
});

// node_modules/filepond-plugin-file-validate-size/dist/filepond-plugin-file-validate-size.js
var require_filepond_plugin_file_validate_size = __commonJS((exports, module) => {
  /*!
   * FilePondPluginFileValidateSize 2.2.6
   * Licensed under MIT, https://opensource.org/licenses/MIT/
   * Please visit https://pqina.nl/filepond/ for details.
   */
  (function(global2, factory) {
    typeof exports === "object" && typeof module !== "undefined" ? module.exports = factory() : typeof define === "function" && define.amd ? define(factory) : (global2 = global2 || self, global2.FilePondPluginFileValidateSize = factory());
  })(exports, function() {
    "use strict";
    var plugin = function plugin2(_ref) {
      var addFilter = _ref.addFilter, utils = _ref.utils;
      var Type = utils.Type, replaceInString = utils.replaceInString, toNaturalFileSize = utils.toNaturalFileSize;
      addFilter("ALLOW_HOPPER_ITEM", function(file, _ref2) {
        var query = _ref2.query;
        if (!query("GET_ALLOW_FILE_SIZE_VALIDATION")) {
          return true;
        }
        var sizeMax = query("GET_MAX_FILE_SIZE");
        if (sizeMax !== null && file.size >= sizeMax) {
          return false;
        }
        var sizeMin = query("GET_MIN_FILE_SIZE");
        if (sizeMin !== null && file.size <= sizeMin) {
          return false;
        }
        return true;
      });
      addFilter("LOAD_FILE", function(file, _ref3) {
        var query = _ref3.query;
        return new Promise(function(resolve, reject) {
          if (!query("GET_ALLOW_FILE_SIZE_VALIDATION")) {
            return resolve(file);
          }
          var fileFilter = query("GET_FILE_VALIDATE_SIZE_FILTER");
          if (fileFilter && !fileFilter(file)) {
            return resolve(file);
          }
          var sizeMax = query("GET_MAX_FILE_SIZE");
          if (sizeMax !== null && file.size >= sizeMax) {
            reject({
              status: {
                main: query("GET_LABEL_MAX_FILE_SIZE_EXCEEDED"),
                sub: replaceInString(query("GET_LABEL_MAX_FILE_SIZE"), {
                  filesize: toNaturalFileSize(sizeMax, ".", query("GET_FILE_SIZE_BASE"), query("GET_FILE_SIZE_LABELS", query))
                })
              }
            });
            return;
          }
          var sizeMin = query("GET_MIN_FILE_SIZE");
          if (sizeMin !== null && file.size <= sizeMin) {
            reject({
              status: {
                main: query("GET_LABEL_MIN_FILE_SIZE_EXCEEDED"),
                sub: replaceInString(query("GET_LABEL_MIN_FILE_SIZE"), {
                  filesize: toNaturalFileSize(sizeMin, ".", query("GET_FILE_SIZE_BASE"), query("GET_FILE_SIZE_LABELS", query))
                })
              }
            });
            return;
          }
          var totalSizeMax = query("GET_MAX_TOTAL_FILE_SIZE");
          if (totalSizeMax !== null) {
            var currentTotalSize = query("GET_ACTIVE_ITEMS").reduce(function(total, item) {
              return total + item.fileSize;
            }, 0);
            if (currentTotalSize > totalSizeMax) {
              reject({
                status: {
                  main: query("GET_LABEL_MAX_TOTAL_FILE_SIZE_EXCEEDED"),
                  sub: replaceInString(query("GET_LABEL_MAX_TOTAL_FILE_SIZE"), {
                    filesize: toNaturalFileSize(totalSizeMax, ".", query("GET_FILE_SIZE_BASE"), query("GET_FILE_SIZE_LABELS", query))
                  })
                }
              });
              return;
            }
          }
          resolve(file);
        });
      });
      return {
        options: {
          allowFileSizeValidation: [true, Type.BOOLEAN],
          maxFileSize: [null, Type.INT],
          minFileSize: [null, Type.INT],
          maxTotalFileSize: [null, Type.INT],
          fileValidateSizeFilter: [null, Type.FUNCTION],
          labelMinFileSizeExceeded: ["File is too small", Type.STRING],
          labelMinFileSize: ["Minimum file size is {filesize}", Type.STRING],
          labelMaxFileSizeExceeded: ["File is too large", Type.STRING],
          labelMaxFileSize: ["Maximum file size is {filesize}", Type.STRING],
          labelMaxTotalFileSizeExceeded: ["Maximum total size exceeded", Type.STRING],
          labelMaxTotalFileSize: ["Maximum total file size is {filesize}", Type.STRING]
        }
      };
    };
    var isBrowser = typeof window !== "undefined" && typeof window.document !== "undefined";
    if (isBrowser) {
      document.dispatchEvent(new CustomEvent("FilePond:pluginloaded", {detail: plugin}));
    }
    return plugin;
  });
});

// node_modules/filepond-plugin-file-validate-type/dist/filepond-plugin-file-validate-type.js
var require_filepond_plugin_file_validate_type = __commonJS((exports, module) => {
  /*!
   * FilePondPluginFileValidateType 1.2.7
   * Licensed under MIT, https://opensource.org/licenses/MIT/
   * Please visit https://pqina.nl/filepond/ for details.
   */
  (function(global2, factory) {
    typeof exports === "object" && typeof module !== "undefined" ? module.exports = factory() : typeof define === "function" && define.amd ? define(factory) : (global2 = global2 || self, global2.FilePondPluginFileValidateType = factory());
  })(exports, function() {
    "use strict";
    var plugin = function plugin2(_ref) {
      var addFilter = _ref.addFilter, utils = _ref.utils;
      var Type = utils.Type, isString = utils.isString, replaceInString = utils.replaceInString, guesstimateMimeType = utils.guesstimateMimeType, getExtensionFromFilename = utils.getExtensionFromFilename, getFilenameFromURL = utils.getFilenameFromURL;
      var mimeTypeMatchesWildCard = function mimeTypeMatchesWildCard2(mimeType, wildcard) {
        var mimeTypeGroup = (/^[^/]+/.exec(mimeType) || []).pop();
        var wildcardGroup = wildcard.slice(0, -2);
        return mimeTypeGroup === wildcardGroup;
      };
      var isValidMimeType = function isValidMimeType2(acceptedTypes, userInputType) {
        return acceptedTypes.some(function(acceptedType) {
          if (/\*$/.test(acceptedType)) {
            return mimeTypeMatchesWildCard(userInputType, acceptedType);
          }
          return acceptedType === userInputType;
        });
      };
      var getItemType = function getItemType2(item) {
        var type = "";
        if (isString(item)) {
          var filename = getFilenameFromURL(item);
          var extension = getExtensionFromFilename(filename);
          if (extension) {
            type = guesstimateMimeType(extension);
          }
        } else {
          type = item.type;
        }
        return type;
      };
      var validateFile = function validateFile2(item, acceptedFileTypes, typeDetector) {
        if (acceptedFileTypes.length === 0) {
          return true;
        }
        var type = getItemType(item);
        if (!typeDetector) {
          return isValidMimeType(acceptedFileTypes, type);
        }
        return new Promise(function(resolve, reject) {
          typeDetector(item, type).then(function(detectedType) {
            if (isValidMimeType(acceptedFileTypes, detectedType)) {
              resolve();
            } else {
              reject();
            }
          }).catch(reject);
        });
      };
      var applyMimeTypeMap = function applyMimeTypeMap2(map) {
        return function(acceptedFileType) {
          return map[acceptedFileType] === null ? false : map[acceptedFileType] || acceptedFileType;
        };
      };
      addFilter("SET_ATTRIBUTE_TO_OPTION_MAP", function(map) {
        return Object.assign(map, {
          accept: "acceptedFileTypes"
        });
      });
      addFilter("ALLOW_HOPPER_ITEM", function(file, _ref2) {
        var query = _ref2.query;
        if (!query("GET_ALLOW_FILE_TYPE_VALIDATION")) {
          return true;
        }
        return validateFile(file, query("GET_ACCEPTED_FILE_TYPES"));
      });
      addFilter("LOAD_FILE", function(file, _ref3) {
        var query = _ref3.query;
        return new Promise(function(resolve, reject) {
          if (!query("GET_ALLOW_FILE_TYPE_VALIDATION")) {
            resolve(file);
            return;
          }
          var acceptedFileTypes = query("GET_ACCEPTED_FILE_TYPES");
          var typeDetector = query("GET_FILE_VALIDATE_TYPE_DETECT_TYPE");
          var validationResult = validateFile(file, acceptedFileTypes, typeDetector);
          var handleRejection = function handleRejection2() {
            var acceptedFileTypesMapped = acceptedFileTypes.map(applyMimeTypeMap(query("GET_FILE_VALIDATE_TYPE_LABEL_EXPECTED_TYPES_MAP"))).filter(function(label) {
              return label !== false;
            });
            reject({
              status: {
                main: query("GET_LABEL_FILE_TYPE_NOT_ALLOWED"),
                sub: replaceInString(query("GET_FILE_VALIDATE_TYPE_LABEL_EXPECTED_TYPES"), {
                  allTypes: acceptedFileTypesMapped.join(", "),
                  allButLastType: acceptedFileTypesMapped.slice(0, -1).join(", "),
                  lastType: acceptedFileTypesMapped[acceptedFileTypesMapped.length - 1]
                })
              }
            });
          };
          if (typeof validationResult === "boolean") {
            if (!validationResult) {
              return handleRejection();
            }
            return resolve(file);
          }
          validationResult.then(function() {
            resolve(file);
          }).catch(handleRejection);
        });
      });
      return {
        options: {
          allowFileTypeValidation: [true, Type.BOOLEAN],
          acceptedFileTypes: [[], Type.ARRAY],
          labelFileTypeNotAllowed: ["File is of invalid type", Type.STRING],
          fileValidateTypeLabelExpectedTypes: [
            "Expects {allButLastType} or {lastType}",
            Type.STRING
          ],
          fileValidateTypeLabelExpectedTypesMap: [{}, Type.OBJECT],
          fileValidateTypeDetectType: [null, Type.FUNCTION]
        }
      };
    };
    var isBrowser = typeof window !== "undefined" && typeof window.document !== "undefined";
    if (isBrowser) {
      document.dispatchEvent(new CustomEvent("FilePond:pluginloaded", {detail: plugin}));
    }
    return plugin;
  });
});

// node_modules/filepond-plugin-image-crop/dist/filepond-plugin-image-crop.js
var require_filepond_plugin_image_crop = __commonJS((exports, module) => {
  /*!
   * FilePondPluginImageCrop 2.0.6
   * Licensed under MIT, https://opensource.org/licenses/MIT/
   * Please visit https://pqina.nl/filepond/ for details.
   */
  (function(global2, factory) {
    typeof exports === "object" && typeof module !== "undefined" ? module.exports = factory() : typeof define === "function" && define.amd ? define(factory) : (global2 = global2 || self, global2.FilePondPluginImageCrop = factory());
  })(exports, function() {
    "use strict";
    var isImage = function isImage2(file) {
      return /^image/.test(file.type);
    };
    var plugin = function plugin2(_ref) {
      var addFilter = _ref.addFilter, utils = _ref.utils;
      var Type = utils.Type, isFile = utils.isFile, getNumericAspectRatioFromString = utils.getNumericAspectRatioFromString;
      var allowCrop = function allowCrop2(item, query) {
        return !(!isImage(item.file) || !query("GET_ALLOW_IMAGE_CROP"));
      };
      var isObject = function isObject2(value) {
        return typeof value === "object";
      };
      var isNumber = function isNumber2(value) {
        return typeof value === "number";
      };
      var updateCrop = function updateCrop2(item, obj) {
        return item.setMetadata("crop", Object.assign({}, item.getMetadata("crop"), obj));
      };
      addFilter("DID_CREATE_ITEM", function(item, _ref2) {
        var query = _ref2.query;
        item.extend("setImageCrop", function(crop) {
          if (!allowCrop(item, query) || !isObject(center))
            return;
          item.setMetadata("crop", crop);
          return crop;
        });
        item.extend("setImageCropCenter", function(center2) {
          if (!allowCrop(item, query) || !isObject(center2))
            return;
          return updateCrop(item, {center: center2});
        });
        item.extend("setImageCropZoom", function(zoom) {
          if (!allowCrop(item, query) || !isNumber(zoom))
            return;
          return updateCrop(item, {zoom: Math.max(1, zoom)});
        });
        item.extend("setImageCropRotation", function(rotation) {
          if (!allowCrop(item, query) || !isNumber(rotation))
            return;
          return updateCrop(item, {rotation});
        });
        item.extend("setImageCropFlip", function(flip) {
          if (!allowCrop(item, query) || !isObject(flip))
            return;
          return updateCrop(item, {flip});
        });
        item.extend("setImageCropAspectRatio", function(newAspectRatio) {
          if (!allowCrop(item, query) || typeof newAspectRatio === "undefined")
            return;
          var currentCrop = item.getMetadata("crop");
          var aspectRatio = getNumericAspectRatioFromString(newAspectRatio);
          var newCrop = {
            center: {
              x: 0.5,
              y: 0.5
            },
            flip: currentCrop ? Object.assign({}, currentCrop.flip) : {
              horizontal: false,
              vertical: false
            },
            rotation: 0,
            zoom: 1,
            aspectRatio
          };
          item.setMetadata("crop", newCrop);
          return newCrop;
        });
      });
      addFilter("DID_LOAD_ITEM", function(item, _ref3) {
        var query = _ref3.query;
        return new Promise(function(resolve, reject) {
          var file = item.file;
          if (!isFile(file) || !isImage(file) || !query("GET_ALLOW_IMAGE_CROP")) {
            return resolve(item);
          }
          var crop = item.getMetadata("crop");
          if (crop) {
            return resolve(item);
          }
          var humanAspectRatio = query("GET_IMAGE_CROP_ASPECT_RATIO");
          item.setMetadata("crop", {
            center: {
              x: 0.5,
              y: 0.5
            },
            flip: {
              horizontal: false,
              vertical: false
            },
            rotation: 0,
            zoom: 1,
            aspectRatio: humanAspectRatio ? getNumericAspectRatioFromString(humanAspectRatio) : null
          });
          resolve(item);
        });
      });
      return {
        options: {
          allowImageCrop: [true, Type.BOOLEAN],
          imageCropAspectRatio: [null, Type.STRING]
        }
      };
    };
    var isBrowser = typeof window !== "undefined" && typeof window.document !== "undefined";
    if (isBrowser) {
      document.dispatchEvent(new CustomEvent("FilePond:pluginloaded", {detail: plugin}));
    }
    return plugin;
  });
});

// node_modules/filepond-plugin-image-exif-orientation/dist/filepond-plugin-image-exif-orientation.js
var require_filepond_plugin_image_exif_orientation = __commonJS((exports, module) => {
  /*!
   * FilePondPluginImageExifOrientation 1.0.11
   * Licensed under MIT, https://opensource.org/licenses/MIT/
   * Please visit https://pqina.nl/filepond/ for details.
   */
  (function(global2, factory) {
    typeof exports === "object" && typeof module !== "undefined" ? module.exports = factory() : typeof define === "function" && define.amd ? define(factory) : (global2 = global2 || self, global2.FilePondPluginImageExifOrientation = factory());
  })(exports, function() {
    "use strict";
    var isJPEG = function isJPEG2(file) {
      return /^image\/jpeg/.test(file.type);
    };
    var Marker = {
      JPEG: 65496,
      APP1: 65505,
      EXIF: 1165519206,
      TIFF: 18761,
      Orientation: 274,
      Unknown: 65280
    };
    var getUint16 = function getUint162(view, offset) {
      var little = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : false;
      return view.getUint16(offset, little);
    };
    var getUint32 = function getUint322(view, offset) {
      var little = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : false;
      return view.getUint32(offset, little);
    };
    var getImageOrientation = function getImageOrientation2(file) {
      return new Promise(function(resolve, reject) {
        var reader = new FileReader();
        reader.onload = function(e) {
          var view = new DataView(e.target.result);
          if (getUint16(view, 0) !== Marker.JPEG) {
            resolve(-1);
            return;
          }
          var length = view.byteLength;
          var offset = 2;
          while (offset < length) {
            var marker = getUint16(view, offset);
            offset += 2;
            if (marker === Marker.APP1) {
              if (getUint32(view, offset += 2) !== Marker.EXIF) {
                break;
              }
              var little = getUint16(view, offset += 6) === Marker.TIFF;
              offset += getUint32(view, offset + 4, little);
              var tags = getUint16(view, offset, little);
              offset += 2;
              for (var i = 0; i < tags; i++) {
                if (getUint16(view, offset + i * 12, little) === Marker.Orientation) {
                  resolve(getUint16(view, offset + i * 12 + 8, little));
                  return;
                }
              }
            } else if ((marker & Marker.Unknown) !== Marker.Unknown) {
              break;
            } else {
              offset += getUint16(view, offset);
            }
          }
          resolve(-1);
        };
        reader.readAsArrayBuffer(file.slice(0, 64 * 1024));
      });
    };
    var IS_BROWSER = function() {
      return typeof window !== "undefined" && typeof window.document !== "undefined";
    }();
    var isBrowser = function isBrowser2() {
      return IS_BROWSER;
    };
    var testSrc = "data:image/jpg;base64,/9j/4AAQSkZJRgABAQEASABIAAD/4QA6RXhpZgAATU0AKgAAAAgAAwESAAMAAAABAAYAAAEoAAMAAAABAAIAAAITAAMAAAABAAEAAAAAAAD/2wBDAP//////////////////////////////////////////////////////////////////////////////////////wAALCAABAAIBASIA/8QAJgABAAAAAAAAAAAAAAAAAAAAAxABAAAAAAAAAAAAAAAAAAAAAP/aAAgBAQAAPwBH/9k=";
    var shouldCorrect = void 0;
    var testImage = isBrowser() ? new Image() : {};
    testImage.onload = function() {
      return shouldCorrect = testImage.naturalWidth > testImage.naturalHeight;
    };
    testImage.src = testSrc;
    var shouldCorrectImageExifOrientation = function shouldCorrectImageExifOrientation2() {
      return shouldCorrect;
    };
    var plugin = function plugin2(_ref) {
      var addFilter = _ref.addFilter, utils = _ref.utils;
      var Type = utils.Type, isFile = utils.isFile;
      addFilter("DID_LOAD_ITEM", function(item, _ref2) {
        var query = _ref2.query;
        return new Promise(function(resolve, reject) {
          var file = item.file;
          if (!isFile(file) || !isJPEG(file) || !query("GET_ALLOW_IMAGE_EXIF_ORIENTATION") || !shouldCorrectImageExifOrientation()) {
            return resolve(item);
          }
          getImageOrientation(file).then(function(orientation) {
            item.setMetadata("exif", {orientation});
            resolve(item);
          });
        });
      });
      return {
        options: {
          allowImageExifOrientation: [true, Type.BOOLEAN]
        }
      };
    };
    var isBrowser$1 = typeof window !== "undefined" && typeof window.document !== "undefined";
    if (isBrowser$1) {
      document.dispatchEvent(new CustomEvent("FilePond:pluginloaded", {detail: plugin}));
    }
    return plugin;
  });
});

// node_modules/filepond-plugin-image-preview/dist/filepond-plugin-image-preview.js
var require_filepond_plugin_image_preview = __commonJS((exports, module) => {
  /*!
   * FilePondPluginImagePreview 4.6.11
   * Licensed under MIT, https://opensource.org/licenses/MIT/
   * Please visit https://pqina.nl/filepond/ for details.
   */
  (function(global2, factory) {
    typeof exports === "object" && typeof module !== "undefined" ? module.exports = factory() : typeof define === "function" && define.amd ? define(factory) : (global2 = global2 || self, global2.FilePondPluginImagePreview = factory());
  })(exports, function() {
    "use strict";
    var isPreviewableImage = function isPreviewableImage2(file) {
      return /^image/.test(file.type);
    };
    function _typeof(obj) {
      if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") {
        _typeof = function(obj2) {
          return typeof obj2;
        };
      } else {
        _typeof = function(obj2) {
          return obj2 && typeof Symbol === "function" && obj2.constructor === Symbol && obj2 !== Symbol.prototype ? "symbol" : typeof obj2;
        };
      }
      return _typeof(obj);
    }
    var REACT_ELEMENT_TYPE;
    function _jsx(type, props, key, children) {
      if (!REACT_ELEMENT_TYPE) {
        REACT_ELEMENT_TYPE = typeof Symbol === "function" && Symbol.for && Symbol.for("react.element") || 60103;
      }
      var defaultProps = type && type.defaultProps;
      var childrenLength = arguments.length - 3;
      if (!props && childrenLength !== 0) {
        props = {
          children: void 0
        };
      }
      if (props && defaultProps) {
        for (var propName in defaultProps) {
          if (props[propName] === void 0) {
            props[propName] = defaultProps[propName];
          }
        }
      } else if (!props) {
        props = defaultProps || {};
      }
      if (childrenLength === 1) {
        props.children = children;
      } else if (childrenLength > 1) {
        var childArray = new Array(childrenLength);
        for (var i = 0; i < childrenLength; i++) {
          childArray[i] = arguments[i + 3];
        }
        props.children = childArray;
      }
      return {
        $$typeof: REACT_ELEMENT_TYPE,
        type,
        key: key === void 0 ? null : "" + key,
        ref: null,
        props,
        _owner: null
      };
    }
    function _asyncIterator(iterable) {
      var method;
      if (typeof Symbol === "function") {
        if (Symbol.asyncIterator) {
          method = iterable[Symbol.asyncIterator];
          if (method != null)
            return method.call(iterable);
        }
        if (Symbol.iterator) {
          method = iterable[Symbol.iterator];
          if (method != null)
            return method.call(iterable);
        }
      }
      throw new TypeError("Object is not async iterable");
    }
    function _AwaitValue(value) {
      this.wrapped = value;
    }
    function _AsyncGenerator(gen) {
      var front, back;
      function send(key, arg) {
        return new Promise(function(resolve, reject) {
          var request = {
            key,
            arg,
            resolve,
            reject,
            next: null
          };
          if (back) {
            back = back.next = request;
          } else {
            front = back = request;
            resume(key, arg);
          }
        });
      }
      function resume(key, arg) {
        try {
          var result = gen[key](arg);
          var value = result.value;
          var wrappedAwait = value instanceof _AwaitValue;
          Promise.resolve(wrappedAwait ? value.wrapped : value).then(function(arg2) {
            if (wrappedAwait) {
              resume("next", arg2);
              return;
            }
            settle(result.done ? "return" : "normal", arg2);
          }, function(err) {
            resume("throw", err);
          });
        } catch (err) {
          settle("throw", err);
        }
      }
      function settle(type, value) {
        switch (type) {
          case "return":
            front.resolve({
              value,
              done: true
            });
            break;
          case "throw":
            front.reject(value);
            break;
          default:
            front.resolve({
              value,
              done: false
            });
            break;
        }
        front = front.next;
        if (front) {
          resume(front.key, front.arg);
        } else {
          back = null;
        }
      }
      this._invoke = send;
      if (typeof gen.return !== "function") {
        this.return = void 0;
      }
    }
    if (typeof Symbol === "function" && Symbol.asyncIterator) {
      _AsyncGenerator.prototype[Symbol.asyncIterator] = function() {
        return this;
      };
    }
    _AsyncGenerator.prototype.next = function(arg) {
      return this._invoke("next", arg);
    };
    _AsyncGenerator.prototype.throw = function(arg) {
      return this._invoke("throw", arg);
    };
    _AsyncGenerator.prototype.return = function(arg) {
      return this._invoke("return", arg);
    };
    function _wrapAsyncGenerator(fn) {
      return function() {
        return new _AsyncGenerator(fn.apply(this, arguments));
      };
    }
    function _awaitAsyncGenerator(value) {
      return new _AwaitValue(value);
    }
    function _asyncGeneratorDelegate(inner, awaitWrap) {
      var iter = {}, waiting = false;
      function pump(key, value) {
        waiting = true;
        value = new Promise(function(resolve) {
          resolve(inner[key](value));
        });
        return {
          done: false,
          value: awaitWrap(value)
        };
      }
      if (typeof Symbol === "function" && Symbol.iterator) {
        iter[Symbol.iterator] = function() {
          return this;
        };
      }
      iter.next = function(value) {
        if (waiting) {
          waiting = false;
          return value;
        }
        return pump("next", value);
      };
      if (typeof inner.throw === "function") {
        iter.throw = function(value) {
          if (waiting) {
            waiting = false;
            throw value;
          }
          return pump("throw", value);
        };
      }
      if (typeof inner.return === "function") {
        iter.return = function(value) {
          return pump("return", value);
        };
      }
      return iter;
    }
    function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {
      try {
        var info = gen[key](arg);
        var value = info.value;
      } catch (error) {
        reject(error);
        return;
      }
      if (info.done) {
        resolve(value);
      } else {
        Promise.resolve(value).then(_next, _throw);
      }
    }
    function _asyncToGenerator(fn) {
      return function() {
        var self2 = this, args = arguments;
        return new Promise(function(resolve, reject) {
          var gen = fn.apply(self2, args);
          function _next(value) {
            asyncGeneratorStep(gen, resolve, reject, _next, _throw, "next", value);
          }
          function _throw(err) {
            asyncGeneratorStep(gen, resolve, reject, _next, _throw, "throw", err);
          }
          _next(void 0);
        });
      };
    }
    function _classCallCheck(instance, Constructor) {
      if (!(instance instanceof Constructor)) {
        throw new TypeError("Cannot call a class as a function");
      }
    }
    function _defineProperties(target, props) {
      for (var i = 0; i < props.length; i++) {
        var descriptor = props[i];
        descriptor.enumerable = descriptor.enumerable || false;
        descriptor.configurable = true;
        if ("value" in descriptor)
          descriptor.writable = true;
        Object.defineProperty(target, descriptor.key, descriptor);
      }
    }
    function _createClass(Constructor, protoProps, staticProps) {
      if (protoProps)
        _defineProperties(Constructor.prototype, protoProps);
      if (staticProps)
        _defineProperties(Constructor, staticProps);
      return Constructor;
    }
    function _defineEnumerableProperties(obj, descs) {
      for (var key in descs) {
        var desc = descs[key];
        desc.configurable = desc.enumerable = true;
        if ("value" in desc)
          desc.writable = true;
        Object.defineProperty(obj, key, desc);
      }
      if (Object.getOwnPropertySymbols) {
        var objectSymbols = Object.getOwnPropertySymbols(descs);
        for (var i = 0; i < objectSymbols.length; i++) {
          var sym = objectSymbols[i];
          var desc = descs[sym];
          desc.configurable = desc.enumerable = true;
          if ("value" in desc)
            desc.writable = true;
          Object.defineProperty(obj, sym, desc);
        }
      }
      return obj;
    }
    function _defaults(obj, defaults) {
      var keys = Object.getOwnPropertyNames(defaults);
      for (var i = 0; i < keys.length; i++) {
        var key = keys[i];
        var value = Object.getOwnPropertyDescriptor(defaults, key);
        if (value && value.configurable && obj[key] === void 0) {
          Object.defineProperty(obj, key, value);
        }
      }
      return obj;
    }
    function _defineProperty(obj, key, value) {
      if (key in obj) {
        Object.defineProperty(obj, key, {
          value,
          enumerable: true,
          configurable: true,
          writable: true
        });
      } else {
        obj[key] = value;
      }
      return obj;
    }
    function _extends() {
      _extends = Object.assign || function(target) {
        for (var i = 1; i < arguments.length; i++) {
          var source = arguments[i];
          for (var key in source) {
            if (Object.prototype.hasOwnProperty.call(source, key)) {
              target[key] = source[key];
            }
          }
        }
        return target;
      };
      return _extends.apply(this, arguments);
    }
    function _objectSpread(target) {
      for (var i = 1; i < arguments.length; i++) {
        var source = arguments[i] != null ? arguments[i] : {};
        var ownKeys = Object.keys(source);
        if (typeof Object.getOwnPropertySymbols === "function") {
          ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function(sym) {
            return Object.getOwnPropertyDescriptor(source, sym).enumerable;
          }));
        }
        ownKeys.forEach(function(key) {
          _defineProperty(target, key, source[key]);
        });
      }
      return target;
    }
    function _inherits(subClass, superClass) {
      if (typeof superClass !== "function" && superClass !== null) {
        throw new TypeError("Super expression must either be null or a function");
      }
      subClass.prototype = Object.create(superClass && superClass.prototype, {
        constructor: {
          value: subClass,
          writable: true,
          configurable: true
        }
      });
      if (superClass)
        _setPrototypeOf(subClass, superClass);
    }
    function _inheritsLoose(subClass, superClass) {
      subClass.prototype = Object.create(superClass.prototype);
      subClass.prototype.constructor = subClass;
      subClass.__proto__ = superClass;
    }
    function _getPrototypeOf(o) {
      _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf2(o2) {
        return o2.__proto__ || Object.getPrototypeOf(o2);
      };
      return _getPrototypeOf(o);
    }
    function _setPrototypeOf(o, p) {
      _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf2(o2, p2) {
        o2.__proto__ = p2;
        return o2;
      };
      return _setPrototypeOf(o, p);
    }
    function isNativeReflectConstruct() {
      if (typeof Reflect === "undefined" || !Reflect.construct)
        return false;
      if (Reflect.construct.sham)
        return false;
      if (typeof Proxy === "function")
        return true;
      try {
        Date.prototype.toString.call(Reflect.construct(Date, [], function() {
        }));
        return true;
      } catch (e) {
        return false;
      }
    }
    function _construct(Parent, args, Class) {
      if (isNativeReflectConstruct()) {
        _construct = Reflect.construct;
      } else {
        _construct = function _construct2(Parent2, args2, Class2) {
          var a = [null];
          a.push.apply(a, args2);
          var Constructor = Function.bind.apply(Parent2, a);
          var instance = new Constructor();
          if (Class2)
            _setPrototypeOf(instance, Class2.prototype);
          return instance;
        };
      }
      return _construct.apply(null, arguments);
    }
    function _isNativeFunction(fn) {
      return Function.toString.call(fn).indexOf("[native code]") !== -1;
    }
    function _wrapNativeSuper(Class) {
      var _cache = typeof Map === "function" ? new Map() : void 0;
      _wrapNativeSuper = function _wrapNativeSuper2(Class2) {
        if (Class2 === null || !_isNativeFunction(Class2))
          return Class2;
        if (typeof Class2 !== "function") {
          throw new TypeError("Super expression must either be null or a function");
        }
        if (typeof _cache !== "undefined") {
          if (_cache.has(Class2))
            return _cache.get(Class2);
          _cache.set(Class2, Wrapper);
        }
        function Wrapper() {
          return _construct(Class2, arguments, _getPrototypeOf(this).constructor);
        }
        Wrapper.prototype = Object.create(Class2.prototype, {
          constructor: {
            value: Wrapper,
            enumerable: false,
            writable: true,
            configurable: true
          }
        });
        return _setPrototypeOf(Wrapper, Class2);
      };
      return _wrapNativeSuper(Class);
    }
    function _instanceof(left, right) {
      if (right != null && typeof Symbol !== "undefined" && right[Symbol.hasInstance]) {
        return right[Symbol.hasInstance](left);
      } else {
        return left instanceof right;
      }
    }
    function _interopRequireDefault(obj) {
      return obj && obj.__esModule ? obj : {
        default: obj
      };
    }
    function _interopRequireWildcard(obj) {
      if (obj && obj.__esModule) {
        return obj;
      } else {
        var newObj = {};
        if (obj != null) {
          for (var key in obj) {
            if (Object.prototype.hasOwnProperty.call(obj, key)) {
              var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {};
              if (desc.get || desc.set) {
                Object.defineProperty(newObj, key, desc);
              } else {
                newObj[key] = obj[key];
              }
            }
          }
        }
        newObj.default = obj;
        return newObj;
      }
    }
    function _newArrowCheck(innerThis, boundThis) {
      if (innerThis !== boundThis) {
        throw new TypeError("Cannot instantiate an arrow function");
      }
    }
    function _objectDestructuringEmpty(obj) {
      if (obj == null)
        throw new TypeError("Cannot destructure undefined");
    }
    function _objectWithoutPropertiesLoose(source, excluded) {
      if (source == null)
        return {};
      var target = {};
      var sourceKeys = Object.keys(source);
      var key, i;
      for (i = 0; i < sourceKeys.length; i++) {
        key = sourceKeys[i];
        if (excluded.indexOf(key) >= 0)
          continue;
        target[key] = source[key];
      }
      return target;
    }
    function _objectWithoutProperties(source, excluded) {
      if (source == null)
        return {};
      var target = _objectWithoutPropertiesLoose(source, excluded);
      var key, i;
      if (Object.getOwnPropertySymbols) {
        var sourceSymbolKeys = Object.getOwnPropertySymbols(source);
        for (i = 0; i < sourceSymbolKeys.length; i++) {
          key = sourceSymbolKeys[i];
          if (excluded.indexOf(key) >= 0)
            continue;
          if (!Object.prototype.propertyIsEnumerable.call(source, key))
            continue;
          target[key] = source[key];
        }
      }
      return target;
    }
    function _assertThisInitialized(self2) {
      if (self2 === void 0) {
        throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
      }
      return self2;
    }
    function _possibleConstructorReturn(self2, call) {
      if (call && (typeof call === "object" || typeof call === "function")) {
        return call;
      }
      return _assertThisInitialized(self2);
    }
    function _superPropBase(object, property) {
      while (!Object.prototype.hasOwnProperty.call(object, property)) {
        object = _getPrototypeOf(object);
        if (object === null)
          break;
      }
      return object;
    }
    function _get(target, property, receiver) {
      if (typeof Reflect !== "undefined" && Reflect.get) {
        _get = Reflect.get;
      } else {
        _get = function _get2(target2, property2, receiver2) {
          var base = _superPropBase(target2, property2);
          if (!base)
            return;
          var desc = Object.getOwnPropertyDescriptor(base, property2);
          if (desc.get) {
            return desc.get.call(receiver2);
          }
          return desc.value;
        };
      }
      return _get(target, property, receiver || target);
    }
    function set(target, property, value, receiver) {
      if (typeof Reflect !== "undefined" && Reflect.set) {
        set = Reflect.set;
      } else {
        set = function set2(target2, property2, value2, receiver2) {
          var base = _superPropBase(target2, property2);
          var desc;
          if (base) {
            desc = Object.getOwnPropertyDescriptor(base, property2);
            if (desc.set) {
              desc.set.call(receiver2, value2);
              return true;
            } else if (!desc.writable) {
              return false;
            }
          }
          desc = Object.getOwnPropertyDescriptor(receiver2, property2);
          if (desc) {
            if (!desc.writable) {
              return false;
            }
            desc.value = value2;
            Object.defineProperty(receiver2, property2, desc);
          } else {
            _defineProperty(receiver2, property2, value2);
          }
          return true;
        };
      }
      return set(target, property, value, receiver);
    }
    function _set(target, property, value, receiver, isStrict) {
      var s = set(target, property, value, receiver || target);
      if (!s && isStrict) {
        throw new Error("failed to set property");
      }
      return value;
    }
    function _taggedTemplateLiteral(strings, raw) {
      if (!raw) {
        raw = strings.slice(0);
      }
      return Object.freeze(Object.defineProperties(strings, {
        raw: {
          value: Object.freeze(raw)
        }
      }));
    }
    function _taggedTemplateLiteralLoose(strings, raw) {
      if (!raw) {
        raw = strings.slice(0);
      }
      strings.raw = raw;
      return strings;
    }
    function _temporalRef(val, name) {
      if (val === _temporalUndefined) {
        throw new ReferenceError(name + " is not defined - temporal dead zone");
      } else {
        return val;
      }
    }
    function _readOnlyError(name) {
      throw new Error('"' + name + '" is read-only');
    }
    function _classNameTDZError(name) {
      throw new Error('Class "' + name + '" cannot be referenced in computed property keys.');
    }
    var _temporalUndefined = {};
    function _slicedToArray(arr, i) {
      return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest();
    }
    function _slicedToArrayLoose(arr, i) {
      return _arrayWithHoles(arr) || _iterableToArrayLimitLoose(arr, i) || _nonIterableRest();
    }
    function _toArray(arr) {
      return _arrayWithHoles(arr) || _iterableToArray(arr) || _nonIterableRest();
    }
    function _toConsumableArray(arr) {
      return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread();
    }
    function _arrayWithoutHoles(arr) {
      if (Array.isArray(arr)) {
        for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++)
          arr2[i] = arr[i];
        return arr2;
      }
    }
    function _arrayWithHoles(arr) {
      if (Array.isArray(arr))
        return arr;
    }
    function _iterableToArray(iter) {
      if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === "[object Arguments]")
        return Array.from(iter);
    }
    function _iterableToArrayLimit(arr, i) {
      var _arr = [];
      var _n = true;
      var _d = false;
      var _e = void 0;
      try {
        for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {
          _arr.push(_s.value);
          if (i && _arr.length === i)
            break;
        }
      } catch (err) {
        _d = true;
        _e = err;
      } finally {
        try {
          if (!_n && _i["return"] != null)
            _i["return"]();
        } finally {
          if (_d)
            throw _e;
        }
      }
      return _arr;
    }
    function _iterableToArrayLimitLoose(arr, i) {
      var _arr = [];
      for (var _iterator = arr[Symbol.iterator](), _step; !(_step = _iterator.next()).done; ) {
        _arr.push(_step.value);
        if (i && _arr.length === i)
          break;
      }
      return _arr;
    }
    function _nonIterableSpread() {
      throw new TypeError("Invalid attempt to spread non-iterable instance");
    }
    function _nonIterableRest() {
      throw new TypeError("Invalid attempt to destructure non-iterable instance");
    }
    function _skipFirstGeneratorNext(fn) {
      return function() {
        var it = fn.apply(this, arguments);
        it.next();
        return it;
      };
    }
    function _toPrimitive(input, hint) {
      if (typeof input !== "object" || input === null)
        return input;
      var prim = input[Symbol.toPrimitive];
      if (prim !== void 0) {
        var res = prim.call(input, hint || "default");
        if (typeof res !== "object")
          return res;
        throw new TypeError("@@toPrimitive must return a primitive value.");
      }
      return (hint === "string" ? String : Number)(input);
    }
    function _toPropertyKey(arg) {
      var key = _toPrimitive(arg, "string");
      return typeof key === "symbol" ? key : String(key);
    }
    function _initializerWarningHelper(descriptor, context) {
      throw new Error("Decorating class property failed. Please ensure that proposal-class-properties is enabled and set to use loose mode. To use proposal-class-properties in spec mode with decorators, wait for the next major version of decorators in stage 2.");
    }
    function _initializerDefineProperty(target, property, descriptor, context) {
      if (!descriptor)
        return;
      Object.defineProperty(target, property, {
        enumerable: descriptor.enumerable,
        configurable: descriptor.configurable,
        writable: descriptor.writable,
        value: descriptor.initializer ? descriptor.initializer.call(context) : void 0
      });
    }
    function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) {
      var desc = {};
      Object.keys(descriptor).forEach(function(key) {
        desc[key] = descriptor[key];
      });
      desc.enumerable = !!desc.enumerable;
      desc.configurable = !!desc.configurable;
      if ("value" in desc || desc.initializer) {
        desc.writable = true;
      }
      desc = decorators.slice().reverse().reduce(function(desc2, decorator) {
        return decorator(target, property, desc2) || desc2;
      }, desc);
      if (context && desc.initializer !== void 0) {
        desc.value = desc.initializer ? desc.initializer.call(context) : void 0;
        desc.initializer = void 0;
      }
      if (desc.initializer === void 0) {
        Object.defineProperty(target, property, desc);
        desc = null;
      }
      return desc;
    }
    var id = 0;
    function _classPrivateFieldLooseKey(name) {
      return "__private_" + id++ + "_" + name;
    }
    function _classPrivateFieldLooseBase(receiver, privateKey) {
      if (!Object.prototype.hasOwnProperty.call(receiver, privateKey)) {
        throw new TypeError("attempted to use private field on non-instance");
      }
      return receiver;
    }
    function _classPrivateFieldGet(receiver, privateMap) {
      if (!privateMap.has(receiver)) {
        throw new TypeError("attempted to get private field on non-instance");
      }
      var descriptor = privateMap.get(receiver);
      if (descriptor.get) {
        return descriptor.get.call(receiver);
      }
      return descriptor.value;
    }
    function _classPrivateFieldSet(receiver, privateMap, value) {
      if (!privateMap.has(receiver)) {
        throw new TypeError("attempted to set private field on non-instance");
      }
      var descriptor = privateMap.get(receiver);
      if (descriptor.set) {
        descriptor.set.call(receiver, value);
      } else {
        if (!descriptor.writable) {
          throw new TypeError("attempted to set read only private field");
        }
        descriptor.value = value;
      }
      return value;
    }
    function _classStaticPrivateFieldSpecGet(receiver, classConstructor, descriptor) {
      if (receiver !== classConstructor) {
        throw new TypeError("Private static access of wrong provenance");
      }
      return descriptor.value;
    }
    function _classStaticPrivateFieldSpecSet(receiver, classConstructor, descriptor, value) {
      if (receiver !== classConstructor) {
        throw new TypeError("Private static access of wrong provenance");
      }
      if (!descriptor.writable) {
        throw new TypeError("attempted to set read only private field");
      }
      descriptor.value = value;
      return value;
    }
    function _classStaticPrivateMethodGet(receiver, classConstructor, method) {
      if (receiver !== classConstructor) {
        throw new TypeError("Private static access of wrong provenance");
      }
      return method;
    }
    function _classStaticPrivateMethodSet() {
      throw new TypeError("attempted to set read only static private field");
    }
    function _decorate(decorators, factory, superClass, mixins) {
      var api = _getDecoratorsApi();
      if (mixins) {
        for (var i = 0; i < mixins.length; i++) {
          api = mixins[i](api);
        }
      }
      var r = factory(function initialize(O) {
        api.initializeInstanceElements(O, decorated.elements);
      }, superClass);
      var decorated = api.decorateClass(_coalesceClassElements(r.d.map(_createElementDescriptor)), decorators);
      api.initializeClassElements(r.F, decorated.elements);
      return api.runClassFinishers(r.F, decorated.finishers);
    }
    function _getDecoratorsApi() {
      _getDecoratorsApi = function() {
        return api;
      };
      var api = {
        elementsDefinitionOrder: [["method"], ["field"]],
        initializeInstanceElements: function(O, elements) {
          ["method", "field"].forEach(function(kind) {
            elements.forEach(function(element) {
              if (element.kind === kind && element.placement === "own") {
                this.defineClassElement(O, element);
              }
            }, this);
          }, this);
        },
        initializeClassElements: function(F, elements) {
          var proto2 = F.prototype;
          ["method", "field"].forEach(function(kind) {
            elements.forEach(function(element) {
              var placement = element.placement;
              if (element.kind === kind && (placement === "static" || placement === "prototype")) {
                var receiver = placement === "static" ? F : proto2;
                this.defineClassElement(receiver, element);
              }
            }, this);
          }, this);
        },
        defineClassElement: function(receiver, element) {
          var descriptor = element.descriptor;
          if (element.kind === "field") {
            var initializer = element.initializer;
            descriptor = {
              enumerable: descriptor.enumerable,
              writable: descriptor.writable,
              configurable: descriptor.configurable,
              value: initializer === void 0 ? void 0 : initializer.call(receiver)
            };
          }
          Object.defineProperty(receiver, element.key, descriptor);
        },
        decorateClass: function(elements, decorators) {
          var newElements = [];
          var finishers = [];
          var placements = {
            static: [],
            prototype: [],
            own: []
          };
          elements.forEach(function(element) {
            this.addElementPlacement(element, placements);
          }, this);
          elements.forEach(function(element) {
            if (!_hasDecorators(element))
              return newElements.push(element);
            var elementFinishersExtras = this.decorateElement(element, placements);
            newElements.push(elementFinishersExtras.element);
            newElements.push.apply(newElements, elementFinishersExtras.extras);
            finishers.push.apply(finishers, elementFinishersExtras.finishers);
          }, this);
          if (!decorators) {
            return {
              elements: newElements,
              finishers
            };
          }
          var result = this.decorateConstructor(newElements, decorators);
          finishers.push.apply(finishers, result.finishers);
          result.finishers = finishers;
          return result;
        },
        addElementPlacement: function(element, placements, silent) {
          var keys = placements[element.placement];
          if (!silent && keys.indexOf(element.key) !== -1) {
            throw new TypeError("Duplicated element (" + element.key + ")");
          }
          keys.push(element.key);
        },
        decorateElement: function(element, placements) {
          var extras = [];
          var finishers = [];
          for (var decorators = element.decorators, i = decorators.length - 1; i >= 0; i--) {
            var keys = placements[element.placement];
            keys.splice(keys.indexOf(element.key), 1);
            var elementObject = this.fromElementDescriptor(element);
            var elementFinisherExtras = this.toElementFinisherExtras((0, decorators[i])(elementObject) || elementObject);
            element = elementFinisherExtras.element;
            this.addElementPlacement(element, placements);
            if (elementFinisherExtras.finisher) {
              finishers.push(elementFinisherExtras.finisher);
            }
            var newExtras = elementFinisherExtras.extras;
            if (newExtras) {
              for (var j = 0; j < newExtras.length; j++) {
                this.addElementPlacement(newExtras[j], placements);
              }
              extras.push.apply(extras, newExtras);
            }
          }
          return {
            element,
            finishers,
            extras
          };
        },
        decorateConstructor: function(elements, decorators) {
          var finishers = [];
          for (var i = decorators.length - 1; i >= 0; i--) {
            var obj = this.fromClassDescriptor(elements);
            var elementsAndFinisher = this.toClassDescriptor((0, decorators[i])(obj) || obj);
            if (elementsAndFinisher.finisher !== void 0) {
              finishers.push(elementsAndFinisher.finisher);
            }
            if (elementsAndFinisher.elements !== void 0) {
              elements = elementsAndFinisher.elements;
              for (var j = 0; j < elements.length - 1; j++) {
                for (var k = j + 1; k < elements.length; k++) {
                  if (elements[j].key === elements[k].key && elements[j].placement === elements[k].placement) {
                    throw new TypeError("Duplicated element (" + elements[j].key + ")");
                  }
                }
              }
            }
          }
          return {
            elements,
            finishers
          };
        },
        fromElementDescriptor: function(element) {
          var obj = {
            kind: element.kind,
            key: element.key,
            placement: element.placement,
            descriptor: element.descriptor
          };
          var desc = {
            value: "Descriptor",
            configurable: true
          };
          Object.defineProperty(obj, Symbol.toStringTag, desc);
          if (element.kind === "field")
            obj.initializer = element.initializer;
          return obj;
        },
        toElementDescriptors: function(elementObjects) {
          if (elementObjects === void 0)
            return;
          return _toArray(elementObjects).map(function(elementObject) {
            var element = this.toElementDescriptor(elementObject);
            this.disallowProperty(elementObject, "finisher", "An element descriptor");
            this.disallowProperty(elementObject, "extras", "An element descriptor");
            return element;
          }, this);
        },
        toElementDescriptor: function(elementObject) {
          var kind = String(elementObject.kind);
          if (kind !== "method" && kind !== "field") {
            throw new TypeError(`An element descriptor's .kind property must be either "method" or "field", but a decorator created an element descriptor with .kind "` + kind + '"');
          }
          var key = _toPropertyKey(elementObject.key);
          var placement = String(elementObject.placement);
          if (placement !== "static" && placement !== "prototype" && placement !== "own") {
            throw new TypeError(`An element descriptor's .placement property must be one of "static", "prototype" or "own", but a decorator created an element descriptor with .placement "` + placement + '"');
          }
          var descriptor = elementObject.descriptor;
          this.disallowProperty(elementObject, "elements", "An element descriptor");
          var element = {
            kind,
            key,
            placement,
            descriptor: Object.assign({}, descriptor)
          };
          if (kind !== "field") {
            this.disallowProperty(elementObject, "initializer", "A method descriptor");
          } else {
            this.disallowProperty(descriptor, "get", "The property descriptor of a field descriptor");
            this.disallowProperty(descriptor, "set", "The property descriptor of a field descriptor");
            this.disallowProperty(descriptor, "value", "The property descriptor of a field descriptor");
            element.initializer = elementObject.initializer;
          }
          return element;
        },
        toElementFinisherExtras: function(elementObject) {
          var element = this.toElementDescriptor(elementObject);
          var finisher = _optionalCallableProperty(elementObject, "finisher");
          var extras = this.toElementDescriptors(elementObject.extras);
          return {
            element,
            finisher,
            extras
          };
        },
        fromClassDescriptor: function(elements) {
          var obj = {
            kind: "class",
            elements: elements.map(this.fromElementDescriptor, this)
          };
          var desc = {
            value: "Descriptor",
            configurable: true
          };
          Object.defineProperty(obj, Symbol.toStringTag, desc);
          return obj;
        },
        toClassDescriptor: function(obj) {
          var kind = String(obj.kind);
          if (kind !== "class") {
            throw new TypeError(`A class descriptor's .kind property must be "class", but a decorator created a class descriptor with .kind "` + kind + '"');
          }
          this.disallowProperty(obj, "key", "A class descriptor");
          this.disallowProperty(obj, "placement", "A class descriptor");
          this.disallowProperty(obj, "descriptor", "A class descriptor");
          this.disallowProperty(obj, "initializer", "A class descriptor");
          this.disallowProperty(obj, "extras", "A class descriptor");
          var finisher = _optionalCallableProperty(obj, "finisher");
          var elements = this.toElementDescriptors(obj.elements);
          return {
            elements,
            finisher
          };
        },
        runClassFinishers: function(constructor, finishers) {
          for (var i = 0; i < finishers.length; i++) {
            var newConstructor = (0, finishers[i])(constructor);
            if (newConstructor !== void 0) {
              if (typeof newConstructor !== "function") {
                throw new TypeError("Finishers must return a constructor.");
              }
              constructor = newConstructor;
            }
          }
          return constructor;
        },
        disallowProperty: function(obj, name, objectType) {
          if (obj[name] !== void 0) {
            throw new TypeError(objectType + " can't have a ." + name + " property.");
          }
        }
      };
      return api;
    }
    function _createElementDescriptor(def) {
      var key = _toPropertyKey(def.key);
      var descriptor;
      if (def.kind === "method") {
        descriptor = {
          value: def.value,
          writable: true,
          configurable: true,
          enumerable: false
        };
      } else if (def.kind === "get") {
        descriptor = {
          get: def.value,
          configurable: true,
          enumerable: false
        };
      } else if (def.kind === "set") {
        descriptor = {
          set: def.value,
          configurable: true,
          enumerable: false
        };
      } else if (def.kind === "field") {
        descriptor = {
          configurable: true,
          writable: true,
          enumerable: true
        };
      }
      var element = {
        kind: def.kind === "field" ? "field" : "method",
        key,
        placement: def.static ? "static" : def.kind === "field" ? "own" : "prototype",
        descriptor
      };
      if (def.decorators)
        element.decorators = def.decorators;
      if (def.kind === "field")
        element.initializer = def.value;
      return element;
    }
    function _coalesceGetterSetter(element, other) {
      if (element.descriptor.get !== void 0) {
        other.descriptor.get = element.descriptor.get;
      } else {
        other.descriptor.set = element.descriptor.set;
      }
    }
    function _coalesceClassElements(elements) {
      var newElements = [];
      var isSameElement = function(other2) {
        return other2.kind === "method" && other2.key === element.key && other2.placement === element.placement;
      };
      for (var i = 0; i < elements.length; i++) {
        var element = elements[i];
        var other;
        if (element.kind === "method" && (other = newElements.find(isSameElement))) {
          if (_isDataDescriptor(element.descriptor) || _isDataDescriptor(other.descriptor)) {
            if (_hasDecorators(element) || _hasDecorators(other)) {
              throw new ReferenceError("Duplicated methods (" + element.key + ") can't be decorated.");
            }
            other.descriptor = element.descriptor;
          } else {
            if (_hasDecorators(element)) {
              if (_hasDecorators(other)) {
                throw new ReferenceError("Decorators can't be placed on different accessors with for the same property (" + element.key + ").");
              }
              other.decorators = element.decorators;
            }
            _coalesceGetterSetter(element, other);
          }
        } else {
          newElements.push(element);
        }
      }
      return newElements;
    }
    function _hasDecorators(element) {
      return element.decorators && element.decorators.length;
    }
    function _isDataDescriptor(desc) {
      return desc !== void 0 && !(desc.value === void 0 && desc.writable === void 0);
    }
    function _optionalCallableProperty(obj, name) {
      var value = obj[name];
      if (value !== void 0 && typeof value !== "function") {
        throw new TypeError("Expected '" + name + "' to be a function");
      }
      return value;
    }
    function _classPrivateMethodGet(receiver, privateSet, fn) {
      if (!privateSet.has(receiver)) {
        throw new TypeError("attempted to get private field on non-instance");
      }
      return fn;
    }
    function _classPrivateMethodSet() {
      throw new TypeError("attempted to reassign private method");
    }
    function _wrapRegExp(re, groups) {
      _wrapRegExp = function(re2, groups2) {
        return new BabelRegExp(re2, groups2);
      };
      var _RegExp = _wrapNativeSuper(RegExp);
      var _super = RegExp.prototype;
      var _groups = new WeakMap();
      function BabelRegExp(re2, groups2) {
        var _this = _RegExp.call(this, re2);
        _groups.set(_this, groups2);
        return _this;
      }
      _inherits(BabelRegExp, _RegExp);
      BabelRegExp.prototype.exec = function(str) {
        var result = _super.exec.call(this, str);
        if (result)
          result.groups = buildGroups(result, this);
        return result;
      };
      BabelRegExp.prototype[Symbol.replace] = function(str, substitution) {
        if (typeof substitution === "string") {
          var groups2 = _groups.get(this);
          return _super[Symbol.replace].call(this, str, substitution.replace(/\$<([^>]+)>/g, function(_, name) {
            return "$" + groups2[name];
          }));
        } else if (typeof substitution === "function") {
          var _this = this;
          return _super[Symbol.replace].call(this, str, function() {
            var args = [];
            args.push.apply(args, arguments);
            if (typeof args[args.length - 1] !== "object") {
              args.push(buildGroups(args, _this));
            }
            return substitution.apply(this, args);
          });
        } else {
          return _super[Symbol.replace].call(this, str, substitution);
        }
      };
      function buildGroups(result, re2) {
        var g = _groups.get(re2);
        return Object.keys(g).reduce(function(groups2, name) {
          groups2[name] = result[g[name]];
          return groups2;
        }, Object.create(null));
      }
      return _wrapRegExp.apply(this, arguments);
    }
    var vectorMultiply = function vectorMultiply2(v, amount) {
      return createVector(v.x * amount, v.y * amount);
    };
    var vectorAdd = function vectorAdd2(a, b) {
      return createVector(a.x + b.x, a.y + b.y);
    };
    var vectorNormalize = function vectorNormalize2(v) {
      var l = Math.sqrt(v.x * v.x + v.y * v.y);
      if (l === 0) {
        return {
          x: 0,
          y: 0
        };
      }
      return createVector(v.x / l, v.y / l);
    };
    var vectorRotate = function vectorRotate2(v, radians, origin) {
      var cos = Math.cos(radians);
      var sin = Math.sin(radians);
      var t = createVector(v.x - origin.x, v.y - origin.y);
      return createVector(origin.x + cos * t.x - sin * t.y, origin.y + sin * t.x + cos * t.y);
    };
    var createVector = function createVector2() {
      var x = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : 0;
      var y = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : 0;
      return {x, y};
    };
    var getMarkupValue = function getMarkupValue2(value, size) {
      var scalar = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : 1;
      var axis = arguments.length > 3 ? arguments[3] : void 0;
      if (typeof value === "string") {
        return parseFloat(value) * scalar;
      }
      if (typeof value === "number") {
        return value * (axis ? size[axis] : Math.min(size.width, size.height));
      }
      return;
    };
    var getMarkupStyles = function getMarkupStyles2(markup, size, scale) {
      var lineStyle = markup.borderStyle || markup.lineStyle || "solid";
      var fill = markup.backgroundColor || markup.fontColor || "transparent";
      var stroke = markup.borderColor || markup.lineColor || "transparent";
      var strokeWidth = getMarkupValue(markup.borderWidth || markup.lineWidth, size, scale);
      var lineCap = markup.lineCap || "round";
      var lineJoin = markup.lineJoin || "round";
      var dashes = typeof lineStyle === "string" ? "" : lineStyle.map(function(v) {
        return getMarkupValue(v, size, scale);
      }).join(",");
      var opacity = markup.opacity || 1;
      return {
        "stroke-linecap": lineCap,
        "stroke-linejoin": lineJoin,
        "stroke-width": strokeWidth || 0,
        "stroke-dasharray": dashes,
        stroke,
        fill,
        opacity
      };
    };
    var isDefined = function isDefined2(value) {
      return value != null;
    };
    var getMarkupRect = function getMarkupRect2(rect, size) {
      var scalar = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : 1;
      var left = getMarkupValue(rect.x, size, scalar, "width") || getMarkupValue(rect.left, size, scalar, "width");
      var top = getMarkupValue(rect.y, size, scalar, "height") || getMarkupValue(rect.top, size, scalar, "height");
      var width = getMarkupValue(rect.width, size, scalar, "width");
      var height = getMarkupValue(rect.height, size, scalar, "height");
      var right = getMarkupValue(rect.right, size, scalar, "width");
      var bottom = getMarkupValue(rect.bottom, size, scalar, "height");
      if (!isDefined(top)) {
        if (isDefined(height) && isDefined(bottom)) {
          top = size.height - height - bottom;
        } else {
          top = bottom;
        }
      }
      if (!isDefined(left)) {
        if (isDefined(width) && isDefined(right)) {
          left = size.width - width - right;
        } else {
          left = right;
        }
      }
      if (!isDefined(width)) {
        if (isDefined(left) && isDefined(right)) {
          width = size.width - left - right;
        } else {
          width = 0;
        }
      }
      if (!isDefined(height)) {
        if (isDefined(top) && isDefined(bottom)) {
          height = size.height - top - bottom;
        } else {
          height = 0;
        }
      }
      return {
        x: left || 0,
        y: top || 0,
        width: width || 0,
        height: height || 0
      };
    };
    var pointsToPathShape = function pointsToPathShape2(points) {
      return points.map(function(point, index) {
        return "".concat(index === 0 ? "M" : "L", " ").concat(point.x, " ").concat(point.y);
      }).join(" ");
    };
    var setAttributes = function setAttributes2(element, attr) {
      return Object.keys(attr).forEach(function(key) {
        return element.setAttribute(key, attr[key]);
      });
    };
    var ns = "http://www.w3.org/2000/svg";
    var svg = function svg2(tag, attr) {
      var element = document.createElementNS(ns, tag);
      if (attr) {
        setAttributes(element, attr);
      }
      return element;
    };
    var updateRect = function updateRect2(element) {
      return setAttributes(element, Object.assign({}, element.rect, element.styles));
    };
    var updateEllipse = function updateEllipse2(element) {
      var cx = element.rect.x + element.rect.width * 0.5;
      var cy = element.rect.y + element.rect.height * 0.5;
      var rx = element.rect.width * 0.5;
      var ry = element.rect.height * 0.5;
      return setAttributes(element, Object.assign({
        cx,
        cy,
        rx,
        ry
      }, element.styles));
    };
    var IMAGE_FIT_STYLE = {
      contain: "xMidYMid meet",
      cover: "xMidYMid slice"
    };
    var updateImage = function updateImage2(element, markup) {
      setAttributes(element, Object.assign({}, element.rect, element.styles, {
        preserveAspectRatio: IMAGE_FIT_STYLE[markup.fit] || "none"
      }));
    };
    var TEXT_ANCHOR = {
      left: "start",
      center: "middle",
      right: "end"
    };
    var updateText = function updateText2(element, markup, size, scale) {
      var fontSize = getMarkupValue(markup.fontSize, size, scale);
      var fontFamily = markup.fontFamily || "sans-serif";
      var fontWeight = markup.fontWeight || "normal";
      var textAlign = TEXT_ANCHOR[markup.textAlign] || "start";
      setAttributes(element, Object.assign({}, element.rect, element.styles, {
        "stroke-width": 0,
        "font-weight": fontWeight,
        "font-size": fontSize,
        "font-family": fontFamily,
        "text-anchor": textAlign
      }));
      if (element.text !== markup.text) {
        element.text = markup.text;
        element.textContent = markup.text.length ? markup.text : " ";
      }
    };
    var updateLine = function updateLine2(element, markup, size, scale) {
      setAttributes(element, Object.assign({}, element.rect, element.styles, {
        fill: "none"
      }));
      var line = element.childNodes[0];
      var begin = element.childNodes[1];
      var end = element.childNodes[2];
      var origin = element.rect;
      var target = {
        x: element.rect.x + element.rect.width,
        y: element.rect.y + element.rect.height
      };
      setAttributes(line, {
        x1: origin.x,
        y1: origin.y,
        x2: target.x,
        y2: target.y
      });
      if (!markup.lineDecoration)
        return;
      begin.style.display = "none";
      end.style.display = "none";
      var v = vectorNormalize({
        x: target.x - origin.x,
        y: target.y - origin.y
      });
      var l = getMarkupValue(0.05, size, scale);
      if (markup.lineDecoration.indexOf("arrow-begin") !== -1) {
        var arrowBeginRotationPoint = vectorMultiply(v, l);
        var arrowBeginCenter = vectorAdd(origin, arrowBeginRotationPoint);
        var arrowBeginA = vectorRotate(origin, 2, arrowBeginCenter);
        var arrowBeginB = vectorRotate(origin, -2, arrowBeginCenter);
        setAttributes(begin, {
          style: "display:block;",
          d: "M".concat(arrowBeginA.x, ",").concat(arrowBeginA.y, " L").concat(origin.x, ",").concat(origin.y, " L").concat(arrowBeginB.x, ",").concat(arrowBeginB.y)
        });
      }
      if (markup.lineDecoration.indexOf("arrow-end") !== -1) {
        var arrowEndRotationPoint = vectorMultiply(v, -l);
        var arrowEndCenter = vectorAdd(target, arrowEndRotationPoint);
        var arrowEndA = vectorRotate(target, 2, arrowEndCenter);
        var arrowEndB = vectorRotate(target, -2, arrowEndCenter);
        setAttributes(end, {
          style: "display:block;",
          d: "M".concat(arrowEndA.x, ",").concat(arrowEndA.y, " L").concat(target.x, ",").concat(target.y, " L").concat(arrowEndB.x, ",").concat(arrowEndB.y)
        });
      }
    };
    var updatePath = function updatePath2(element, markup, size, scale) {
      setAttributes(element, Object.assign({}, element.styles, {
        fill: "none",
        d: pointsToPathShape(markup.points.map(function(point) {
          return {
            x: getMarkupValue(point.x, size, scale, "width"),
            y: getMarkupValue(point.y, size, scale, "height")
          };
        }))
      }));
    };
    var createShape = function createShape2(node) {
      return function(markup) {
        return svg(node, {id: markup.id});
      };
    };
    var createImage = function createImage2(markup) {
      var shape = svg("image", {
        id: markup.id,
        "stroke-linecap": "round",
        "stroke-linejoin": "round",
        opacity: "0"
      });
      shape.onload = function() {
        shape.setAttribute("opacity", markup.opacity || 1);
      };
      shape.setAttributeNS("http://www.w3.org/1999/xlink", "xlink:href", markup.src);
      return shape;
    };
    var createLine = function createLine2(markup) {
      var shape = svg("g", {
        id: markup.id,
        "stroke-linecap": "round",
        "stroke-linejoin": "round"
      });
      var line = svg("line");
      shape.appendChild(line);
      var begin = svg("path");
      shape.appendChild(begin);
      var end = svg("path");
      shape.appendChild(end);
      return shape;
    };
    var CREATE_TYPE_ROUTES = {
      image: createImage,
      rect: createShape("rect"),
      ellipse: createShape("ellipse"),
      text: createShape("text"),
      path: createShape("path"),
      line: createLine
    };
    var UPDATE_TYPE_ROUTES = {
      rect: updateRect,
      ellipse: updateEllipse,
      image: updateImage,
      text: updateText,
      path: updatePath,
      line: updateLine
    };
    var createMarkupByType = function createMarkupByType2(type, markup) {
      return CREATE_TYPE_ROUTES[type](markup);
    };
    var updateMarkupByType = function updateMarkupByType2(element, type, markup, size, scale) {
      if (type !== "path") {
        element.rect = getMarkupRect(markup, size, scale);
      }
      element.styles = getMarkupStyles(markup, size, scale);
      UPDATE_TYPE_ROUTES[type](element, markup, size, scale);
    };
    var MARKUP_RECT = [
      "x",
      "y",
      "left",
      "top",
      "right",
      "bottom",
      "width",
      "height"
    ];
    var toOptionalFraction = function toOptionalFraction2(value) {
      return typeof value === "string" && /%/.test(value) ? parseFloat(value) / 100 : value;
    };
    var prepareMarkup = function prepareMarkup2(markup) {
      var _markup = _slicedToArray(markup, 2), type = _markup[0], props = _markup[1];
      var rect = props.points ? {} : MARKUP_RECT.reduce(function(prev, curr) {
        prev[curr] = toOptionalFraction(props[curr]);
        return prev;
      }, {});
      return [
        type,
        Object.assign({
          zIndex: 0
        }, props, rect)
      ];
    };
    var sortMarkupByZIndex = function sortMarkupByZIndex2(a, b) {
      if (a[1].zIndex > b[1].zIndex) {
        return 1;
      }
      if (a[1].zIndex < b[1].zIndex) {
        return -1;
      }
      return 0;
    };
    var createMarkupView = function createMarkupView2(_) {
      return _.utils.createView({
        name: "image-preview-markup",
        tag: "svg",
        ignoreRect: true,
        mixins: {
          apis: ["width", "height", "crop", "markup", "resize", "dirty"]
        },
        write: function write(_ref) {
          var root = _ref.root, props = _ref.props;
          if (!props.dirty)
            return;
          var crop = props.crop, resize = props.resize, markup = props.markup;
          var viewWidth = props.width;
          var viewHeight = props.height;
          var cropWidth = crop.width;
          var cropHeight = crop.height;
          if (resize) {
            var _size = resize.size;
            var outputWidth = _size && _size.width;
            var outputHeight = _size && _size.height;
            var outputFit = resize.mode;
            var outputUpscale = resize.upscale;
            if (outputWidth && !outputHeight)
              outputHeight = outputWidth;
            if (outputHeight && !outputWidth)
              outputWidth = outputHeight;
            var shouldUpscale = cropWidth < outputWidth && cropHeight < outputHeight;
            if (!shouldUpscale || shouldUpscale && outputUpscale) {
              var scalarWidth = outputWidth / cropWidth;
              var scalarHeight = outputHeight / cropHeight;
              if (outputFit === "force") {
                cropWidth = outputWidth;
                cropHeight = outputHeight;
              } else {
                var scalar;
                if (outputFit === "cover") {
                  scalar = Math.max(scalarWidth, scalarHeight);
                } else if (outputFit === "contain") {
                  scalar = Math.min(scalarWidth, scalarHeight);
                }
                cropWidth = cropWidth * scalar;
                cropHeight = cropHeight * scalar;
              }
            }
          }
          var size = {
            width: viewWidth,
            height: viewHeight
          };
          root.element.setAttribute("width", size.width);
          root.element.setAttribute("height", size.height);
          var scale = Math.min(viewWidth / cropWidth, viewHeight / cropHeight);
          root.element.innerHTML = "";
          var markupFilter = root.query("GET_IMAGE_PREVIEW_MARKUP_FILTER");
          markup.filter(markupFilter).map(prepareMarkup).sort(sortMarkupByZIndex).forEach(function(markup2) {
            var _markup = _slicedToArray(markup2, 2), type = _markup[0], settings = _markup[1];
            var element = createMarkupByType(type, settings);
            updateMarkupByType(element, type, settings, size, scale);
            root.element.appendChild(element);
          });
        }
      });
    };
    var createVector$1 = function createVector2(x, y) {
      return {x, y};
    };
    var vectorDot = function vectorDot2(a, b) {
      return a.x * b.x + a.y * b.y;
    };
    var vectorSubtract = function vectorSubtract2(a, b) {
      return createVector$1(a.x - b.x, a.y - b.y);
    };
    var vectorDistanceSquared = function vectorDistanceSquared2(a, b) {
      return vectorDot(vectorSubtract(a, b), vectorSubtract(a, b));
    };
    var vectorDistance = function vectorDistance2(a, b) {
      return Math.sqrt(vectorDistanceSquared(a, b));
    };
    var getOffsetPointOnEdge = function getOffsetPointOnEdge2(length, rotation) {
      var a = length;
      var A = 1.5707963267948966;
      var B = rotation;
      var C3 = 1.5707963267948966 - rotation;
      var sinA = Math.sin(A);
      var sinB = Math.sin(B);
      var sinC = Math.sin(C3);
      var cosC = Math.cos(C3);
      var ratio = a / sinA;
      var b = ratio * sinB;
      var c = ratio * sinC;
      return createVector$1(cosC * b, cosC * c);
    };
    var getRotatedRectSize = function getRotatedRectSize2(rect, rotation) {
      var w = rect.width;
      var h = rect.height;
      var hor = getOffsetPointOnEdge(w, rotation);
      var ver = getOffsetPointOnEdge(h, rotation);
      var tl = createVector$1(rect.x + Math.abs(hor.x), rect.y - Math.abs(hor.y));
      var tr = createVector$1(rect.x + rect.width + Math.abs(ver.y), rect.y + Math.abs(ver.x));
      var bl = createVector$1(rect.x - Math.abs(ver.y), rect.y + rect.height - Math.abs(ver.x));
      return {
        width: vectorDistance(tl, tr),
        height: vectorDistance(tl, bl)
      };
    };
    var calculateCanvasSize = function calculateCanvasSize2(image, canvasAspectRatio) {
      var zoom = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : 1;
      var imageAspectRatio = image.height / image.width;
      var canvasWidth = 1;
      var canvasHeight = canvasAspectRatio;
      var imgWidth = 1;
      var imgHeight = imageAspectRatio;
      if (imgHeight > canvasHeight) {
        imgHeight = canvasHeight;
        imgWidth = imgHeight / imageAspectRatio;
      }
      var scalar = Math.max(canvasWidth / imgWidth, canvasHeight / imgHeight);
      var width = image.width / (zoom * scalar * imgWidth);
      var height = width * canvasAspectRatio;
      return {
        width,
        height
      };
    };
    var getImageRectZoomFactor = function getImageRectZoomFactor2(imageRect, cropRect, rotation, center2) {
      var cx = center2.x > 0.5 ? 1 - center2.x : center2.x;
      var cy = center2.y > 0.5 ? 1 - center2.y : center2.y;
      var imageWidth = cx * 2 * imageRect.width;
      var imageHeight = cy * 2 * imageRect.height;
      var rotatedCropSize = getRotatedRectSize(cropRect, rotation);
      return Math.max(rotatedCropSize.width / imageWidth, rotatedCropSize.height / imageHeight);
    };
    var getCenteredCropRect = function getCenteredCropRect2(container, aspectRatio) {
      var width = container.width;
      var height = width * aspectRatio;
      if (height > container.height) {
        height = container.height;
        width = height / aspectRatio;
      }
      var x = (container.width - width) * 0.5;
      var y = (container.height - height) * 0.5;
      return {
        x,
        y,
        width,
        height
      };
    };
    var getCurrentCropSize = function getCurrentCropSize2(imageSize) {
      var crop = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : {};
      var zoom = crop.zoom, rotation = crop.rotation, center2 = crop.center, aspectRatio = crop.aspectRatio;
      if (!aspectRatio)
        aspectRatio = imageSize.height / imageSize.width;
      var canvasSize = calculateCanvasSize(imageSize, aspectRatio, zoom);
      var canvasCenter = {
        x: canvasSize.width * 0.5,
        y: canvasSize.height * 0.5
      };
      var stage = {
        x: 0,
        y: 0,
        width: canvasSize.width,
        height: canvasSize.height,
        center: canvasCenter
      };
      var shouldLimit = typeof crop.scaleToFit === "undefined" || crop.scaleToFit;
      var stageZoomFactor = getImageRectZoomFactor(imageSize, getCenteredCropRect(stage, aspectRatio), rotation, shouldLimit ? center2 : {x: 0.5, y: 0.5});
      var scale = zoom * stageZoomFactor;
      return {
        widthFloat: canvasSize.width / scale,
        heightFloat: canvasSize.height / scale,
        width: Math.round(canvasSize.width / scale),
        height: Math.round(canvasSize.height / scale)
      };
    };
    var IMAGE_SCALE_SPRING_PROPS = {
      type: "spring",
      stiffness: 0.5,
      damping: 0.45,
      mass: 10
    };
    var createBitmapView = function createBitmapView2(_) {
      return _.utils.createView({
        name: "image-bitmap",
        ignoreRect: true,
        mixins: {styles: ["scaleX", "scaleY"]},
        create: function create(_ref) {
          var root = _ref.root, props = _ref.props;
          root.appendChild(props.image);
        }
      });
    };
    var createImageCanvasWrapper = function createImageCanvasWrapper2(_) {
      return _.utils.createView({
        name: "image-canvas-wrapper",
        tag: "div",
        ignoreRect: true,
        mixins: {
          apis: ["crop", "width", "height"],
          styles: [
            "originX",
            "originY",
            "translateX",
            "translateY",
            "scaleX",
            "scaleY",
            "rotateZ"
          ],
          animations: {
            originX: IMAGE_SCALE_SPRING_PROPS,
            originY: IMAGE_SCALE_SPRING_PROPS,
            scaleX: IMAGE_SCALE_SPRING_PROPS,
            scaleY: IMAGE_SCALE_SPRING_PROPS,
            translateX: IMAGE_SCALE_SPRING_PROPS,
            translateY: IMAGE_SCALE_SPRING_PROPS,
            rotateZ: IMAGE_SCALE_SPRING_PROPS
          }
        },
        create: function create(_ref2) {
          var root = _ref2.root, props = _ref2.props;
          props.width = props.image.width;
          props.height = props.image.height;
          root.ref.bitmap = root.appendChildView(root.createChildView(createBitmapView(_), {image: props.image}));
        },
        write: function write(_ref3) {
          var root = _ref3.root, props = _ref3.props;
          var flip = props.crop.flip;
          var bitmap = root.ref.bitmap;
          bitmap.scaleX = flip.horizontal ? -1 : 1;
          bitmap.scaleY = flip.vertical ? -1 : 1;
        }
      });
    };
    var createClipView = function createClipView2(_) {
      return _.utils.createView({
        name: "image-clip",
        tag: "div",
        ignoreRect: true,
        mixins: {
          apis: [
            "crop",
            "markup",
            "resize",
            "width",
            "height",
            "dirty",
            "background"
          ],
          styles: ["width", "height", "opacity"],
          animations: {
            opacity: {type: "tween", duration: 250}
          }
        },
        didWriteView: function didWriteView(_ref4) {
          var root = _ref4.root, props = _ref4.props;
          if (!props.background)
            return;
          root.element.style.backgroundColor = props.background;
        },
        create: function create(_ref5) {
          var root = _ref5.root, props = _ref5.props;
          root.ref.image = root.appendChildView(root.createChildView(createImageCanvasWrapper(_), Object.assign({}, props)));
          root.ref.createMarkup = function() {
            if (root.ref.markup)
              return;
            root.ref.markup = root.appendChildView(root.createChildView(createMarkupView(_), Object.assign({}, props)));
          };
          root.ref.destroyMarkup = function() {
            if (!root.ref.markup)
              return;
            root.removeChildView(root.ref.markup);
            root.ref.markup = null;
          };
          var transparencyIndicator = root.query("GET_IMAGE_PREVIEW_TRANSPARENCY_INDICATOR");
          if (transparencyIndicator === null)
            return;
          if (transparencyIndicator === "grid") {
            root.element.dataset.transparencyIndicator = transparencyIndicator;
          } else {
            root.element.dataset.transparencyIndicator = "color";
          }
        },
        write: function write(_ref6) {
          var root = _ref6.root, props = _ref6.props, shouldOptimize = _ref6.shouldOptimize;
          var crop = props.crop, markup = props.markup, resize = props.resize, dirty = props.dirty, width = props.width, height = props.height;
          root.ref.image.crop = crop;
          var stage = {
            x: 0,
            y: 0,
            width,
            height,
            center: {
              x: width * 0.5,
              y: height * 0.5
            }
          };
          var image = {
            width: root.ref.image.width,
            height: root.ref.image.height
          };
          var origin = {
            x: crop.center.x * image.width,
            y: crop.center.y * image.height
          };
          var translation = {
            x: stage.center.x - image.width * crop.center.x,
            y: stage.center.y - image.height * crop.center.y
          };
          var rotation = Math.PI * 2 + crop.rotation % (Math.PI * 2);
          var cropAspectRatio = crop.aspectRatio || image.height / image.width;
          var shouldLimit = typeof crop.scaleToFit === "undefined" || crop.scaleToFit;
          var stageZoomFactor = getImageRectZoomFactor(image, getCenteredCropRect(stage, cropAspectRatio), rotation, shouldLimit ? crop.center : {x: 0.5, y: 0.5});
          var scale = crop.zoom * stageZoomFactor;
          if (markup && markup.length) {
            root.ref.createMarkup();
            root.ref.markup.width = width;
            root.ref.markup.height = height;
            root.ref.markup.resize = resize;
            root.ref.markup.dirty = dirty;
            root.ref.markup.markup = markup;
            root.ref.markup.crop = getCurrentCropSize(image, crop);
          } else if (root.ref.markup) {
            root.ref.destroyMarkup();
          }
          var imageView = root.ref.image;
          if (shouldOptimize) {
            imageView.originX = null;
            imageView.originY = null;
            imageView.translateX = null;
            imageView.translateY = null;
            imageView.rotateZ = null;
            imageView.scaleX = null;
            imageView.scaleY = null;
            return;
          }
          imageView.originX = origin.x;
          imageView.originY = origin.y;
          imageView.translateX = translation.x;
          imageView.translateY = translation.y;
          imageView.rotateZ = rotation;
          imageView.scaleX = scale;
          imageView.scaleY = scale;
        }
      });
    };
    var createImageView = function createImageView2(_) {
      return _.utils.createView({
        name: "image-preview",
        tag: "div",
        ignoreRect: true,
        mixins: {
          apis: ["image", "crop", "markup", "resize", "dirty", "background"],
          styles: ["translateY", "scaleX", "scaleY", "opacity"],
          animations: {
            scaleX: IMAGE_SCALE_SPRING_PROPS,
            scaleY: IMAGE_SCALE_SPRING_PROPS,
            translateY: IMAGE_SCALE_SPRING_PROPS,
            opacity: {type: "tween", duration: 400}
          }
        },
        create: function create(_ref7) {
          var root = _ref7.root, props = _ref7.props;
          root.ref.clip = root.appendChildView(root.createChildView(createClipView(_), {
            id: props.id,
            image: props.image,
            crop: props.crop,
            markup: props.markup,
            resize: props.resize,
            dirty: props.dirty,
            background: props.background
          }));
        },
        write: function write(_ref8) {
          var root = _ref8.root, props = _ref8.props, shouldOptimize = _ref8.shouldOptimize;
          var clip = root.ref.clip;
          var image = props.image, crop = props.crop, markup = props.markup, resize = props.resize, dirty = props.dirty;
          clip.crop = crop;
          clip.markup = markup;
          clip.resize = resize;
          clip.dirty = dirty;
          clip.opacity = shouldOptimize ? 0 : 1;
          if (shouldOptimize || root.rect.element.hidden)
            return;
          var imageAspectRatio = image.height / image.width;
          var aspectRatio = crop.aspectRatio || imageAspectRatio;
          var containerWidth = root.rect.inner.width;
          var containerHeight = root.rect.inner.height;
          var fixedPreviewHeight = root.query("GET_IMAGE_PREVIEW_HEIGHT");
          var minPreviewHeight = root.query("GET_IMAGE_PREVIEW_MIN_HEIGHT");
          var maxPreviewHeight = root.query("GET_IMAGE_PREVIEW_MAX_HEIGHT");
          var panelAspectRatio = root.query("GET_PANEL_ASPECT_RATIO");
          var allowMultiple = root.query("GET_ALLOW_MULTIPLE");
          if (panelAspectRatio && !allowMultiple) {
            fixedPreviewHeight = containerWidth * panelAspectRatio;
            aspectRatio = panelAspectRatio;
          }
          var clipHeight = fixedPreviewHeight !== null ? fixedPreviewHeight : Math.max(minPreviewHeight, Math.min(containerWidth * aspectRatio, maxPreviewHeight));
          var clipWidth = clipHeight / aspectRatio;
          if (clipWidth > containerWidth) {
            clipWidth = containerWidth;
            clipHeight = clipWidth * aspectRatio;
          }
          if (clipHeight > containerHeight) {
            clipHeight = containerHeight;
            clipWidth = containerHeight / aspectRatio;
          }
          clip.width = clipWidth;
          clip.height = clipHeight;
        }
      });
    };
    var SVG_MASK = `<svg width="500" height="200" viewBox="0 0 500 200" preserveAspectRatio="none">
    <defs>
        <radialGradient id="gradient-__UID__" cx=".5" cy="1.25" r="1.15">
            <stop offset='50%' stop-color='#000000'/>
            <stop offset='56%' stop-color='#0a0a0a'/>
            <stop offset='63%' stop-color='#262626'/>
            <stop offset='69%' stop-color='#4f4f4f'/>
            <stop offset='75%' stop-color='#808080'/>
            <stop offset='81%' stop-color='#b1b1b1'/>
            <stop offset='88%' stop-color='#dadada'/>
            <stop offset='94%' stop-color='#f6f6f6'/>
            <stop offset='100%' stop-color='#ffffff'/>
        </radialGradient>
        <mask id="mask-__UID__">
            <rect x="0" y="0" width="500" height="200" fill="url(#gradient-__UID__)"></rect>
        </mask>
    </defs>
    <rect x="0" width="500" height="200" fill="currentColor" mask="url(#mask-__UID__)"></rect>
</svg>`;
    var SVGMaskUniqueId = 0;
    var createImageOverlayView = function createImageOverlayView2(fpAPI) {
      return fpAPI.utils.createView({
        name: "image-preview-overlay",
        tag: "div",
        ignoreRect: true,
        create: function create(_ref) {
          var root = _ref.root, props = _ref.props;
          var mask = SVG_MASK;
          if (document.querySelector("base")) {
            var url = new URL(window.location.href.replace(window.location.hash, "")).href;
            mask = mask.replace(/url\(\#/g, "url(" + url + "#");
          }
          SVGMaskUniqueId++;
          root.element.classList.add("filepond--image-preview-overlay-".concat(props.status));
          root.element.innerHTML = mask.replace(/__UID__/g, SVGMaskUniqueId);
        },
        mixins: {
          styles: ["opacity"],
          animations: {
            opacity: {type: "spring", mass: 25}
          }
        }
      });
    };
    var BitmapWorker = function BitmapWorker2() {
      self.onmessage = function(e) {
        createImageBitmap(e.data.message.file).then(function(bitmap) {
          self.postMessage({id: e.data.id, message: bitmap}, [bitmap]);
        });
      };
    };
    var ColorMatrixWorker = function ColorMatrixWorker2() {
      self.onmessage = function(e) {
        var imageData = e.data.message.imageData;
        var matrix = e.data.message.colorMatrix;
        var data2 = imageData.data;
        var l = data2.length;
        var m11 = matrix[0];
        var m12 = matrix[1];
        var m13 = matrix[2];
        var m14 = matrix[3];
        var m15 = matrix[4];
        var m21 = matrix[5];
        var m22 = matrix[6];
        var m23 = matrix[7];
        var m24 = matrix[8];
        var m25 = matrix[9];
        var m31 = matrix[10];
        var m32 = matrix[11];
        var m33 = matrix[12];
        var m34 = matrix[13];
        var m35 = matrix[14];
        var m41 = matrix[15];
        var m42 = matrix[16];
        var m43 = matrix[17];
        var m44 = matrix[18];
        var m45 = matrix[19];
        var index = 0, r = 0, g = 0, b = 0, a = 0;
        for (; index < l; index += 4) {
          r = data2[index] / 255;
          g = data2[index + 1] / 255;
          b = data2[index + 2] / 255;
          a = data2[index + 3] / 255;
          data2[index] = Math.max(0, Math.min((r * m11 + g * m12 + b * m13 + a * m14 + m15) * 255, 255));
          data2[index + 1] = Math.max(0, Math.min((r * m21 + g * m22 + b * m23 + a * m24 + m25) * 255, 255));
          data2[index + 2] = Math.max(0, Math.min((r * m31 + g * m32 + b * m33 + a * m34 + m35) * 255, 255));
          data2[index + 3] = Math.max(0, Math.min((r * m41 + g * m42 + b * m43 + a * m44 + m45) * 255, 255));
        }
        self.postMessage({id: e.data.id, message: imageData}, [
          imageData.data.buffer
        ]);
      };
    };
    var getImageSize = function getImageSize2(url, cb) {
      var image = new Image();
      image.onload = function() {
        var width = image.naturalWidth;
        var height = image.naturalHeight;
        image = null;
        cb(width, height);
      };
      image.src = url;
    };
    var transforms = {
      1: function _() {
        return [1, 0, 0, 1, 0, 0];
      },
      2: function _(width) {
        return [-1, 0, 0, 1, width, 0];
      },
      3: function _(width, height) {
        return [-1, 0, 0, -1, width, height];
      },
      4: function _(width, height) {
        return [1, 0, 0, -1, 0, height];
      },
      5: function _() {
        return [0, 1, 1, 0, 0, 0];
      },
      6: function _(width, height) {
        return [0, 1, -1, 0, height, 0];
      },
      7: function _(width, height) {
        return [0, -1, -1, 0, height, width];
      },
      8: function _(width) {
        return [0, -1, 1, 0, 0, width];
      }
    };
    var fixImageOrientation = function fixImageOrientation2(ctx, width, height, orientation) {
      if (orientation === -1) {
        return;
      }
      ctx.transform.apply(ctx, transforms[orientation](width, height));
    };
    var createPreviewImage = function createPreviewImage2(data2, width, height, orientation) {
      width = Math.round(width);
      height = Math.round(height);
      var canvas = document.createElement("canvas");
      canvas.width = width;
      canvas.height = height;
      var ctx = canvas.getContext("2d");
      if (orientation >= 5 && orientation <= 8) {
        var _ref = [height, width];
        width = _ref[0];
        height = _ref[1];
      }
      fixImageOrientation(ctx, width, height, orientation);
      ctx.drawImage(data2, 0, 0, width, height);
      return canvas;
    };
    var isBitmap = function isBitmap2(file) {
      return /^image/.test(file.type) && !/svg/.test(file.type);
    };
    var MAX_WIDTH = 10;
    var MAX_HEIGHT = 10;
    var calculateAverageColor = function calculateAverageColor2(image) {
      var scalar = Math.min(MAX_WIDTH / image.width, MAX_HEIGHT / image.height);
      var canvas = document.createElement("canvas");
      var ctx = canvas.getContext("2d");
      var width = canvas.width = Math.ceil(image.width * scalar);
      var height = canvas.height = Math.ceil(image.height * scalar);
      ctx.drawImage(image, 0, 0, width, height);
      var data2 = null;
      try {
        data2 = ctx.getImageData(0, 0, width, height).data;
      } catch (e) {
        return null;
      }
      var l = data2.length;
      var r = 0;
      var g = 0;
      var b = 0;
      var i = 0;
      for (; i < l; i += 4) {
        r += data2[i] * data2[i];
        g += data2[i + 1] * data2[i + 1];
        b += data2[i + 2] * data2[i + 2];
      }
      r = averageColor(r, l);
      g = averageColor(g, l);
      b = averageColor(b, l);
      return {r, g, b};
    };
    var averageColor = function averageColor2(c, l) {
      return Math.floor(Math.sqrt(c / (l / 4)));
    };
    var cloneCanvas = function cloneCanvas2(origin, target) {
      target = target || document.createElement("canvas");
      target.width = origin.width;
      target.height = origin.height;
      var ctx = target.getContext("2d");
      ctx.drawImage(origin, 0, 0);
      return target;
    };
    var cloneImageData = function cloneImageData2(imageData) {
      var id2;
      try {
        id2 = new ImageData(imageData.width, imageData.height);
      } catch (e) {
        var canvas = document.createElement("canvas");
        var ctx = canvas.getContext("2d");
        id2 = ctx.createImageData(imageData.width, imageData.height);
      }
      id2.data.set(new Uint8ClampedArray(imageData.data));
      return id2;
    };
    var loadImage = function loadImage2(url) {
      return new Promise(function(resolve, reject) {
        var img = new Image();
        img.crossOrigin = "Anonymous";
        img.onload = function() {
          resolve(img);
        };
        img.onerror = function(e) {
          reject(e);
        };
        img.src = url;
      });
    };
    var createImageWrapperView = function createImageWrapperView2(_) {
      var OverlayView = createImageOverlayView(_);
      var ImageView = createImageView(_);
      var createWorker = _.utils.createWorker;
      var applyFilter = function applyFilter2(root, filter, target) {
        return new Promise(function(resolve) {
          if (!root.ref.imageData) {
            root.ref.imageData = target.getContext("2d").getImageData(0, 0, target.width, target.height);
          }
          var imageData = cloneImageData(root.ref.imageData);
          if (!filter || filter.length !== 20) {
            target.getContext("2d").putImageData(imageData, 0, 0);
            return resolve();
          }
          var worker = createWorker(ColorMatrixWorker);
          worker.post({
            imageData,
            colorMatrix: filter
          }, function(response) {
            target.getContext("2d").putImageData(response, 0, 0);
            worker.terminate();
            resolve();
          }, [imageData.data.buffer]);
        });
      };
      var removeImageView = function removeImageView2(root, imageView) {
        root.removeChildView(imageView);
        imageView.image.width = 1;
        imageView.image.height = 1;
        imageView._destroy();
      };
      var shiftImage = function shiftImage2(_ref) {
        var root = _ref.root;
        var imageView = root.ref.images.shift();
        imageView.opacity = 0;
        imageView.translateY = -15;
        root.ref.imageViewBin.push(imageView);
        return imageView;
      };
      var pushImage = function pushImage2(_ref2) {
        var root = _ref2.root, props = _ref2.props, image = _ref2.image;
        var id2 = props.id;
        var item = root.query("GET_ITEM", {id: id2});
        if (!item)
          return;
        var crop = item.getMetadata("crop") || {
          center: {
            x: 0.5,
            y: 0.5
          },
          flip: {
            horizontal: false,
            vertical: false
          },
          zoom: 1,
          rotation: 0,
          aspectRatio: null
        };
        var background = root.query("GET_IMAGE_TRANSFORM_CANVAS_BACKGROUND_COLOR");
        var markup;
        var resize;
        var dirty = false;
        if (root.query("GET_IMAGE_PREVIEW_MARKUP_SHOW")) {
          markup = item.getMetadata("markup") || [];
          resize = item.getMetadata("resize");
          dirty = true;
        }
        var imageView = root.appendChildView(root.createChildView(ImageView, {
          id: id2,
          image,
          crop,
          resize,
          markup,
          dirty,
          background,
          opacity: 0,
          scaleX: 1.15,
          scaleY: 1.15,
          translateY: 15
        }), root.childViews.length);
        root.ref.images.push(imageView);
        imageView.opacity = 1;
        imageView.scaleX = 1;
        imageView.scaleY = 1;
        imageView.translateY = 0;
        setTimeout(function() {
          root.dispatch("DID_IMAGE_PREVIEW_SHOW", {id: id2});
        }, 250);
      };
      var updateImage2 = function updateImage3(_ref3) {
        var root = _ref3.root, props = _ref3.props;
        var item = root.query("GET_ITEM", {id: props.id});
        if (!item)
          return;
        var imageView = root.ref.images[root.ref.images.length - 1];
        imageView.crop = item.getMetadata("crop");
        imageView.background = root.query("GET_IMAGE_TRANSFORM_CANVAS_BACKGROUND_COLOR");
        if (root.query("GET_IMAGE_PREVIEW_MARKUP_SHOW")) {
          imageView.dirty = true;
          imageView.resize = item.getMetadata("resize");
          imageView.markup = item.getMetadata("markup");
        }
      };
      var didUpdateItemMetadata = function didUpdateItemMetadata2(_ref4) {
        var root = _ref4.root, props = _ref4.props, action = _ref4.action;
        if (!/crop|filter|markup|resize/.test(action.change.key))
          return;
        if (!root.ref.images.length)
          return;
        var item = root.query("GET_ITEM", {id: props.id});
        if (!item)
          return;
        if (/filter/.test(action.change.key)) {
          var imageView = root.ref.images[root.ref.images.length - 1];
          applyFilter(root, action.change.value, imageView.image);
          return;
        }
        if (/crop|markup|resize/.test(action.change.key)) {
          var crop = item.getMetadata("crop");
          var image = root.ref.images[root.ref.images.length - 1];
          if (crop && crop.aspectRatio && image.crop && image.crop.aspectRatio && Math.abs(crop.aspectRatio - image.crop.aspectRatio) > 1e-5) {
            var _imageView = shiftImage({root});
            pushImage({
              root,
              props,
              image: cloneCanvas(_imageView.image)
            });
          } else {
            updateImage2({root, props});
          }
        }
      };
      var canCreateImageBitmap = function canCreateImageBitmap2(file) {
        var userAgent = window.navigator.userAgent;
        var isFirefox = userAgent.match(/Firefox\/([0-9]+)\./);
        var firefoxVersion = isFirefox ? parseInt(isFirefox[1]) : null;
        if (firefoxVersion <= 58)
          return false;
        return "createImageBitmap" in window && isBitmap(file);
      };
      var didCreatePreviewContainer = function didCreatePreviewContainer2(_ref5) {
        var root = _ref5.root, props = _ref5.props;
        var id2 = props.id;
        var item = root.query("GET_ITEM", id2);
        if (!item)
          return;
        var fileURL = URL.createObjectURL(item.file);
        getImageSize(fileURL, function(width, height) {
          root.dispatch("DID_IMAGE_PREVIEW_CALCULATE_SIZE", {
            id: id2,
            width,
            height
          });
        });
      };
      var drawPreview = function drawPreview2(_ref6) {
        var root = _ref6.root, props = _ref6.props;
        var id2 = props.id;
        var item = root.query("GET_ITEM", id2);
        if (!item)
          return;
        var fileURL = URL.createObjectURL(item.file);
        var loadPreviewFallback = function loadPreviewFallback2() {
          loadImage(fileURL).then(previewImageLoaded);
        };
        var previewImageLoaded = function previewImageLoaded2(imageData) {
          URL.revokeObjectURL(fileURL);
          var exif = item.getMetadata("exif") || {};
          var orientation = exif.orientation || -1;
          var width = imageData.width, height = imageData.height;
          if (!width || !height)
            return;
          if (orientation >= 5 && orientation <= 8) {
            var _ref7 = [height, width];
            width = _ref7[0];
            height = _ref7[1];
          }
          var pixelDensityFactor = Math.max(1, window.devicePixelRatio * 0.75);
          var zoomFactor = root.query("GET_IMAGE_PREVIEW_ZOOM_FACTOR");
          var scaleFactor = zoomFactor * pixelDensityFactor;
          var previewImageRatio = height / width;
          var previewContainerWidth = root.rect.element.width;
          var previewContainerHeight = root.rect.element.height;
          var imageWidth = previewContainerWidth;
          var imageHeight = imageWidth * previewImageRatio;
          if (previewImageRatio > 1) {
            imageWidth = Math.min(width, previewContainerWidth * scaleFactor);
            imageHeight = imageWidth * previewImageRatio;
          } else {
            imageHeight = Math.min(height, previewContainerHeight * scaleFactor);
            imageWidth = imageHeight / previewImageRatio;
          }
          var previewImage = createPreviewImage(imageData, imageWidth, imageHeight, orientation);
          var done = function done2() {
            var averageColor2 = root.query("GET_IMAGE_PREVIEW_CALCULATE_AVERAGE_IMAGE_COLOR") ? calculateAverageColor(data) : null;
            item.setMetadata("color", averageColor2, true);
            if ("close" in imageData) {
              imageData.close();
            }
            root.ref.overlayShadow.opacity = 1;
            pushImage({root, props, image: previewImage});
          };
          var filter = item.getMetadata("filter");
          if (filter) {
            applyFilter(root, filter, previewImage).then(done);
          } else {
            done();
          }
        };
        if (canCreateImageBitmap(item.file)) {
          var worker = createWorker(BitmapWorker);
          worker.post({
            file: item.file
          }, function(imageBitmap) {
            worker.terminate();
            if (!imageBitmap) {
              loadPreviewFallback();
              return;
            }
            previewImageLoaded(imageBitmap);
          });
        } else {
          loadPreviewFallback();
        }
      };
      var didDrawPreview = function didDrawPreview2(_ref8) {
        var root = _ref8.root;
        var image = root.ref.images[root.ref.images.length - 1];
        image.translateY = 0;
        image.scaleX = 1;
        image.scaleY = 1;
        image.opacity = 1;
      };
      var restoreOverlay = function restoreOverlay2(_ref9) {
        var root = _ref9.root;
        root.ref.overlayShadow.opacity = 1;
        root.ref.overlayError.opacity = 0;
        root.ref.overlaySuccess.opacity = 0;
      };
      var didThrowError = function didThrowError2(_ref10) {
        var root = _ref10.root;
        root.ref.overlayShadow.opacity = 0.25;
        root.ref.overlayError.opacity = 1;
      };
      var didCompleteProcessing = function didCompleteProcessing2(_ref11) {
        var root = _ref11.root;
        root.ref.overlayShadow.opacity = 0.25;
        root.ref.overlaySuccess.opacity = 1;
      };
      var create = function create2(_ref12) {
        var root = _ref12.root;
        root.ref.images = [];
        root.ref.imageData = null;
        root.ref.imageViewBin = [];
        root.ref.overlayShadow = root.appendChildView(root.createChildView(OverlayView, {
          opacity: 0,
          status: "idle"
        }));
        root.ref.overlaySuccess = root.appendChildView(root.createChildView(OverlayView, {
          opacity: 0,
          status: "success"
        }));
        root.ref.overlayError = root.appendChildView(root.createChildView(OverlayView, {
          opacity: 0,
          status: "failure"
        }));
      };
      return _.utils.createView({
        name: "image-preview-wrapper",
        create,
        styles: ["height"],
        apis: ["height"],
        destroy: function destroy(_ref13) {
          var root = _ref13.root;
          root.ref.images.forEach(function(imageView) {
            imageView.image.width = 1;
            imageView.image.height = 1;
          });
        },
        didWriteView: function didWriteView(_ref14) {
          var root = _ref14.root;
          root.ref.images.forEach(function(imageView) {
            imageView.dirty = false;
          });
        },
        write: _.utils.createRoute({
          DID_IMAGE_PREVIEW_DRAW: didDrawPreview,
          DID_IMAGE_PREVIEW_CONTAINER_CREATE: didCreatePreviewContainer,
          DID_FINISH_CALCULATE_PREVIEWSIZE: drawPreview,
          DID_UPDATE_ITEM_METADATA: didUpdateItemMetadata,
          DID_THROW_ITEM_LOAD_ERROR: didThrowError,
          DID_THROW_ITEM_PROCESSING_ERROR: didThrowError,
          DID_THROW_ITEM_INVALID: didThrowError,
          DID_COMPLETE_ITEM_PROCESSING: didCompleteProcessing,
          DID_START_ITEM_PROCESSING: restoreOverlay,
          DID_REVERT_ITEM_PROCESSING: restoreOverlay
        }, function(_ref15) {
          var root = _ref15.root;
          var viewsToRemove = root.ref.imageViewBin.filter(function(imageView) {
            return imageView.opacity === 0;
          });
          root.ref.imageViewBin = root.ref.imageViewBin.filter(function(imageView) {
            return imageView.opacity > 0;
          });
          viewsToRemove.forEach(function(imageView) {
            return removeImageView(root, imageView);
          });
          viewsToRemove.length = 0;
        })
      });
    };
    var plugin = function plugin2(fpAPI) {
      var addFilter = fpAPI.addFilter, utils = fpAPI.utils;
      var Type = utils.Type, createRoute = utils.createRoute, isFile = utils.isFile;
      var imagePreviewView = createImageWrapperView(fpAPI);
      addFilter("CREATE_VIEW", function(viewAPI) {
        var is = viewAPI.is, view = viewAPI.view, query = viewAPI.query;
        if (!is("file") || !query("GET_ALLOW_IMAGE_PREVIEW"))
          return;
        var didLoadItem = function didLoadItem2(_ref) {
          var root = _ref.root, props = _ref.props;
          var id2 = props.id;
          var item = query("GET_ITEM", id2);
          if (!item || !isFile(item.file) || item.archived)
            return;
          var file = item.file;
          if (!isPreviewableImage(file))
            return;
          if (!query("GET_IMAGE_PREVIEW_FILTER_ITEM")(item))
            return;
          var supportsCreateImageBitmap = "createImageBitmap" in (window || {});
          var maxPreviewFileSize = query("GET_IMAGE_PREVIEW_MAX_FILE_SIZE");
          if (!supportsCreateImageBitmap && maxPreviewFileSize && file.size > maxPreviewFileSize)
            return;
          root.ref.imagePreview = view.appendChildView(view.createChildView(imagePreviewView, {id: id2}));
          var fixedPreviewHeight = root.query("GET_IMAGE_PREVIEW_HEIGHT");
          if (fixedPreviewHeight) {
            root.dispatch("DID_UPDATE_PANEL_HEIGHT", {
              id: item.id,
              height: fixedPreviewHeight
            });
          }
          var queue = !supportsCreateImageBitmap && file.size > query("GET_IMAGE_PREVIEW_MAX_INSTANT_PREVIEW_FILE_SIZE");
          root.dispatch("DID_IMAGE_PREVIEW_CONTAINER_CREATE", {id: id2}, queue);
        };
        var rescaleItem = function rescaleItem2(root, props) {
          if (!root.ref.imagePreview)
            return;
          var id2 = props.id;
          var item = root.query("GET_ITEM", {id: id2});
          if (!item)
            return;
          var panelAspectRatio = root.query("GET_PANEL_ASPECT_RATIO");
          var itemPanelAspectRatio = root.query("GET_ITEM_PANEL_ASPECT_RATIO");
          var fixedHeight = root.query("GET_IMAGE_PREVIEW_HEIGHT");
          if (panelAspectRatio || itemPanelAspectRatio || fixedHeight)
            return;
          var _root$ref = root.ref, imageWidth = _root$ref.imageWidth, imageHeight = _root$ref.imageHeight;
          if (!imageWidth || !imageHeight)
            return;
          var minPreviewHeight = root.query("GET_IMAGE_PREVIEW_MIN_HEIGHT");
          var maxPreviewHeight = root.query("GET_IMAGE_PREVIEW_MAX_HEIGHT");
          var exif = item.getMetadata("exif") || {};
          var orientation = exif.orientation || -1;
          if (orientation >= 5 && orientation <= 8) {
            var _ref2 = [imageHeight, imageWidth];
            imageWidth = _ref2[0];
            imageHeight = _ref2[1];
          }
          if (!isBitmap(item.file) || root.query("GET_IMAGE_PREVIEW_UPSCALE")) {
            var scalar = 2048 / imageWidth;
            imageWidth *= scalar;
            imageHeight *= scalar;
          }
          var imageAspectRatio = imageHeight / imageWidth;
          var previewAspectRatio = (item.getMetadata("crop") || {}).aspectRatio || imageAspectRatio;
          var previewHeightMax = Math.max(minPreviewHeight, Math.min(imageHeight, maxPreviewHeight));
          var itemWidth = root.rect.element.width;
          var previewHeight = Math.min(itemWidth * previewAspectRatio, previewHeightMax);
          root.dispatch("DID_UPDATE_PANEL_HEIGHT", {
            id: item.id,
            height: previewHeight
          });
        };
        var didResizeView = function didResizeView2(_ref3) {
          var root = _ref3.root;
          root.ref.shouldRescale = true;
        };
        var didUpdateItemMetadata = function didUpdateItemMetadata2(_ref4) {
          var root = _ref4.root, action = _ref4.action;
          if (action.change.key !== "crop")
            return;
          root.ref.shouldRescale = true;
        };
        var didCalculatePreviewSize = function didCalculatePreviewSize2(_ref5) {
          var root = _ref5.root, action = _ref5.action;
          root.ref.imageWidth = action.width;
          root.ref.imageHeight = action.height;
          root.ref.shouldRescale = true;
          root.ref.shouldDrawPreview = true;
          root.dispatch("KICK");
        };
        view.registerWriter(createRoute({
          DID_RESIZE_ROOT: didResizeView,
          DID_STOP_RESIZE: didResizeView,
          DID_LOAD_ITEM: didLoadItem,
          DID_IMAGE_PREVIEW_CALCULATE_SIZE: didCalculatePreviewSize,
          DID_UPDATE_ITEM_METADATA: didUpdateItemMetadata
        }, function(_ref6) {
          var root = _ref6.root, props = _ref6.props;
          if (!root.ref.imagePreview)
            return;
          if (root.rect.element.hidden)
            return;
          if (root.ref.shouldRescale) {
            rescaleItem(root, props);
            root.ref.shouldRescale = false;
          }
          if (root.ref.shouldDrawPreview) {
            requestAnimationFrame(function() {
              requestAnimationFrame(function() {
                root.dispatch("DID_FINISH_CALCULATE_PREVIEWSIZE", {
                  id: props.id
                });
              });
            });
            root.ref.shouldDrawPreview = false;
          }
        }));
      });
      return {
        options: {
          allowImagePreview: [true, Type.BOOLEAN],
          imagePreviewFilterItem: [
            function() {
              return true;
            },
            Type.FUNCTION
          ],
          imagePreviewHeight: [null, Type.INT],
          imagePreviewMinHeight: [44, Type.INT],
          imagePreviewMaxHeight: [256, Type.INT],
          imagePreviewMaxFileSize: [null, Type.INT],
          imagePreviewZoomFactor: [2, Type.INT],
          imagePreviewUpscale: [false, Type.BOOLEAN],
          imagePreviewMaxInstantPreviewFileSize: [1e6, Type.INT],
          imagePreviewTransparencyIndicator: [null, Type.STRING],
          imagePreviewCalculateAverageImageColor: [false, Type.BOOLEAN],
          imagePreviewMarkupShow: [true, Type.BOOLEAN],
          imagePreviewMarkupFilter: [
            function() {
              return true;
            },
            Type.FUNCTION
          ]
        }
      };
    };
    var isBrowser = typeof window !== "undefined" && typeof window.document !== "undefined";
    if (isBrowser) {
      document.dispatchEvent(new CustomEvent("FilePond:pluginloaded", {detail: plugin}));
    }
    return plugin;
  });
});

// node_modules/filepond-plugin-image-resize/dist/filepond-plugin-image-resize.js
var require_filepond_plugin_image_resize = __commonJS((exports, module) => {
  /*!
   * FilePondPluginImageResize 2.0.10
   * Licensed under MIT, https://opensource.org/licenses/MIT/
   * Please visit https://pqina.nl/filepond/ for details.
   */
  (function(global2, factory) {
    typeof exports === "object" && typeof module !== "undefined" ? module.exports = factory() : typeof define === "function" && define.amd ? define(factory) : (global2 = global2 || self, global2.FilePondPluginImageResize = factory());
  })(exports, function() {
    "use strict";
    var isImage = function isImage2(file) {
      return /^image/.test(file.type);
    };
    var getImageSize = function getImageSize2(url, cb) {
      var image = new Image();
      image.onload = function() {
        var width = image.naturalWidth;
        var height = image.naturalHeight;
        image = null;
        cb({width, height});
      };
      image.onerror = function() {
        return cb(null);
      };
      image.src = url;
    };
    var plugin = function plugin2(_ref) {
      var addFilter = _ref.addFilter, utils = _ref.utils;
      var Type = utils.Type;
      addFilter("DID_LOAD_ITEM", function(item, _ref2) {
        var query = _ref2.query;
        return new Promise(function(resolve, reject) {
          var file = item.file;
          if (!isImage(file) || !query("GET_ALLOW_IMAGE_RESIZE")) {
            return resolve(item);
          }
          var mode = query("GET_IMAGE_RESIZE_MODE");
          var width = query("GET_IMAGE_RESIZE_TARGET_WIDTH");
          var height = query("GET_IMAGE_RESIZE_TARGET_HEIGHT");
          var upscale = query("GET_IMAGE_RESIZE_UPSCALE");
          if (width === null && height === null)
            return resolve(item);
          var targetWidth = width === null ? height : width;
          var targetHeight = height === null ? targetWidth : height;
          var fileURL = URL.createObjectURL(file);
          getImageSize(fileURL, function(size) {
            URL.revokeObjectURL(fileURL);
            if (!size)
              return resolve(item);
            var imageWidth = size.width, imageHeight = size.height;
            var orientation = (item.getMetadata("exif") || {}).orientation || -1;
            if (orientation >= 5 && orientation <= 8) {
              var _ref3 = [imageHeight, imageWidth];
              imageWidth = _ref3[0];
              imageHeight = _ref3[1];
            }
            if (imageWidth === targetWidth && imageHeight === targetHeight)
              return resolve(item);
            if (!upscale) {
              if (mode === "cover") {
                if (imageWidth <= targetWidth || imageHeight <= targetHeight)
                  return resolve(item);
              } else if (imageWidth <= targetWidth && imageHeight <= targetWidth) {
                return resolve(item);
              }
            }
            item.setMetadata("resize", {
              mode,
              upscale,
              size: {
                width: targetWidth,
                height: targetHeight
              }
            });
            resolve(item);
          });
        });
      });
      return {
        options: {
          allowImageResize: [true, Type.BOOLEAN],
          imageResizeMode: ["cover", Type.STRING],
          imageResizeUpscale: [true, Type.BOOLEAN],
          imageResizeTargetWidth: [null, Type.INT],
          imageResizeTargetHeight: [null, Type.INT]
        }
      };
    };
    var isBrowser = typeof window !== "undefined" && typeof window.document !== "undefined";
    if (isBrowser) {
      document.dispatchEvent(new CustomEvent("FilePond:pluginloaded", {detail: plugin}));
    }
    return plugin;
  });
});

// node_modules/filepond-plugin-image-transform/dist/filepond-plugin-image-transform.js
var require_filepond_plugin_image_transform = __commonJS((exports, module) => {
  /*!
   * FilePondPluginImageTransform 3.8.7
   * Licensed under MIT, https://opensource.org/licenses/MIT/
   * Please visit https://pqina.nl/filepond/ for details.
   */
  (function(global2, factory) {
    typeof exports === "object" && typeof module !== "undefined" ? module.exports = factory() : typeof define === "function" && define.amd ? define(factory) : (global2 = global2 || self, global2.FilePondPluginImageTransform = factory());
  })(exports, function() {
    "use strict";
    var isImage = function isImage2(file) {
      return /^image/.test(file.type);
    };
    var getFilenameWithoutExtension = function getFilenameWithoutExtension2(name) {
      return name.substr(0, name.lastIndexOf(".")) || name;
    };
    var ExtensionMap = {
      jpeg: "jpg",
      "svg+xml": "svg"
    };
    var renameFileToMatchMimeType = function renameFileToMatchMimeType2(filename, mimeType) {
      var name = getFilenameWithoutExtension(filename);
      var type = mimeType.split("/")[1];
      var extension = ExtensionMap[type] || type;
      return "".concat(name, ".").concat(extension);
    };
    var getValidOutputMimeType = function getValidOutputMimeType2(type) {
      return /jpeg|png|svg\+xml/.test(type) ? type : "image/jpeg";
    };
    var isImage$1 = function isImage2(file) {
      return /^image/.test(file.type);
    };
    var MATRICES = {
      1: function _() {
        return [1, 0, 0, 1, 0, 0];
      },
      2: function _(width) {
        return [-1, 0, 0, 1, width, 0];
      },
      3: function _(width, height) {
        return [-1, 0, 0, -1, width, height];
      },
      4: function _(width, height) {
        return [1, 0, 0, -1, 0, height];
      },
      5: function _() {
        return [0, 1, 1, 0, 0, 0];
      },
      6: function _(width, height) {
        return [0, 1, -1, 0, height, 0];
      },
      7: function _(width, height) {
        return [0, -1, -1, 0, height, width];
      },
      8: function _(width) {
        return [0, -1, 1, 0, 0, width];
      }
    };
    var getImageOrientationMatrix = function getImageOrientationMatrix2(width, height, orientation) {
      if (orientation === -1) {
        orientation = 1;
      }
      return MATRICES[orientation](width, height);
    };
    var createVector = function createVector2(x, y) {
      return {x, y};
    };
    var vectorDot = function vectorDot2(a, b) {
      return a.x * b.x + a.y * b.y;
    };
    var vectorSubtract = function vectorSubtract2(a, b) {
      return createVector(a.x - b.x, a.y - b.y);
    };
    var vectorDistanceSquared = function vectorDistanceSquared2(a, b) {
      return vectorDot(vectorSubtract(a, b), vectorSubtract(a, b));
    };
    var vectorDistance = function vectorDistance2(a, b) {
      return Math.sqrt(vectorDistanceSquared(a, b));
    };
    var getOffsetPointOnEdge = function getOffsetPointOnEdge2(length, rotation) {
      var a = length;
      var A = 1.5707963267948966;
      var B = rotation;
      var C3 = 1.5707963267948966 - rotation;
      var sinA = Math.sin(A);
      var sinB = Math.sin(B);
      var sinC = Math.sin(C3);
      var cosC = Math.cos(C3);
      var ratio = a / sinA;
      var b = ratio * sinB;
      var c = ratio * sinC;
      return createVector(cosC * b, cosC * c);
    };
    var getRotatedRectSize = function getRotatedRectSize2(rect, rotation) {
      var w = rect.width;
      var h = rect.height;
      var hor = getOffsetPointOnEdge(w, rotation);
      var ver = getOffsetPointOnEdge(h, rotation);
      var tl = createVector(rect.x + Math.abs(hor.x), rect.y - Math.abs(hor.y));
      var tr = createVector(rect.x + rect.width + Math.abs(ver.y), rect.y + Math.abs(ver.x));
      var bl = createVector(rect.x - Math.abs(ver.y), rect.y + rect.height - Math.abs(ver.x));
      return {
        width: vectorDistance(tl, tr),
        height: vectorDistance(tl, bl)
      };
    };
    var getImageRectZoomFactor = function getImageRectZoomFactor2(imageRect, cropRect) {
      var rotation = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : 0;
      var center2 = arguments.length > 3 && arguments[3] !== void 0 ? arguments[3] : {x: 0.5, y: 0.5};
      var cx = center2.x > 0.5 ? 1 - center2.x : center2.x;
      var cy = center2.y > 0.5 ? 1 - center2.y : center2.y;
      var imageWidth = cx * 2 * imageRect.width;
      var imageHeight = cy * 2 * imageRect.height;
      var rotatedCropSize = getRotatedRectSize(cropRect, rotation);
      return Math.max(rotatedCropSize.width / imageWidth, rotatedCropSize.height / imageHeight);
    };
    var getCenteredCropRect = function getCenteredCropRect2(container, aspectRatio) {
      var width = container.width;
      var height = width * aspectRatio;
      if (height > container.height) {
        height = container.height;
        width = height / aspectRatio;
      }
      var x = (container.width - width) * 0.5;
      var y = (container.height - height) * 0.5;
      return {
        x,
        y,
        width,
        height
      };
    };
    var calculateCanvasSize = function calculateCanvasSize2(image, canvasAspectRatio) {
      var zoom = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : 1;
      var imageAspectRatio = image.height / image.width;
      var canvasWidth = 1;
      var canvasHeight = canvasAspectRatio;
      var imgWidth = 1;
      var imgHeight = imageAspectRatio;
      if (imgHeight > canvasHeight) {
        imgHeight = canvasHeight;
        imgWidth = imgHeight / imageAspectRatio;
      }
      var scalar = Math.max(canvasWidth / imgWidth, canvasHeight / imgHeight);
      var width = image.width / (zoom * scalar * imgWidth);
      var height = width * canvasAspectRatio;
      return {
        width,
        height
      };
    };
    var canvasRelease = function canvasRelease2(canvas) {
      canvas.width = 1;
      canvas.height = 1;
      var ctx = canvas.getContext("2d");
      ctx.clearRect(0, 0, 1, 1);
    };
    var isFlipped = function isFlipped2(flip) {
      return flip && (flip.horizontal || flip.vertical);
    };
    var getBitmap = function getBitmap2(image, orientation, flip) {
      if (orientation <= 1 && !isFlipped(flip)) {
        image.width = image.naturalWidth;
        image.height = image.naturalHeight;
        return image;
      }
      var canvas = document.createElement("canvas");
      var width = image.naturalWidth;
      var height = image.naturalHeight;
      var swapped = orientation >= 5 && orientation <= 8;
      if (swapped) {
        canvas.width = height;
        canvas.height = width;
      } else {
        canvas.width = width;
        canvas.height = height;
      }
      var ctx = canvas.getContext("2d");
      if (orientation) {
        ctx.transform.apply(ctx, getImageOrientationMatrix(width, height, orientation));
      }
      if (isFlipped(flip)) {
        var matrix = [1, 0, 0, 1, 0, 0];
        if (!swapped && flip.horizontal || swapped & flip.vertical) {
          matrix[0] = -1;
          matrix[4] = width;
        }
        if (!swapped && flip.vertical || swapped && flip.horizontal) {
          matrix[3] = -1;
          matrix[5] = height;
        }
        ctx.transform.apply(ctx, matrix);
      }
      ctx.drawImage(image, 0, 0, width, height);
      return canvas;
    };
    var imageToImageData = function imageToImageData2(imageElement, orientation) {
      var crop = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : {};
      var options = arguments.length > 3 && arguments[3] !== void 0 ? arguments[3] : {};
      var canvasMemoryLimit = options.canvasMemoryLimit, _options$background = options.background, background = _options$background === void 0 ? null : _options$background;
      var zoom = crop.zoom || 1;
      var bitmap = getBitmap(imageElement, orientation, crop.flip);
      var imageSize = {
        width: bitmap.width,
        height: bitmap.height
      };
      var aspectRatio = crop.aspectRatio || imageSize.height / imageSize.width;
      var canvasSize = calculateCanvasSize(imageSize, aspectRatio, zoom);
      if (canvasMemoryLimit) {
        var requiredMemory = canvasSize.width * canvasSize.height;
        if (requiredMemory > canvasMemoryLimit) {
          var scalar = Math.sqrt(canvasMemoryLimit) / Math.sqrt(requiredMemory);
          imageSize.width = Math.floor(imageSize.width * scalar);
          imageSize.height = Math.floor(imageSize.height * scalar);
          canvasSize = calculateCanvasSize(imageSize, aspectRatio, zoom);
        }
      }
      var canvas = document.createElement("canvas");
      var canvasCenter = {
        x: canvasSize.width * 0.5,
        y: canvasSize.height * 0.5
      };
      var stage = {
        x: 0,
        y: 0,
        width: canvasSize.width,
        height: canvasSize.height,
        center: canvasCenter
      };
      var shouldLimit = typeof crop.scaleToFit === "undefined" || crop.scaleToFit;
      var scale = zoom * getImageRectZoomFactor(imageSize, getCenteredCropRect(stage, aspectRatio), crop.rotation, shouldLimit ? crop.center : {x: 0.5, y: 0.5});
      canvas.width = Math.round(canvasSize.width / scale);
      canvas.height = Math.round(canvasSize.height / scale);
      canvasCenter.x /= scale;
      canvasCenter.y /= scale;
      var imageOffset = {
        x: canvasCenter.x - imageSize.width * (crop.center ? crop.center.x : 0.5),
        y: canvasCenter.y - imageSize.height * (crop.center ? crop.center.y : 0.5)
      };
      var ctx = canvas.getContext("2d");
      if (background) {
        ctx.fillStyle = background;
        ctx.fillRect(0, 0, canvas.width, canvas.height);
      }
      ctx.translate(canvasCenter.x, canvasCenter.y);
      ctx.rotate(crop.rotation || 0);
      ctx.drawImage(bitmap, imageOffset.x - canvasCenter.x, imageOffset.y - canvasCenter.y, imageSize.width, imageSize.height);
      var imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
      canvasRelease(canvas);
      return imageData;
    };
    var IS_BROWSER = function() {
      return typeof window !== "undefined" && typeof window.document !== "undefined";
    }();
    if (IS_BROWSER) {
      if (!HTMLCanvasElement.prototype.toBlob) {
        Object.defineProperty(HTMLCanvasElement.prototype, "toBlob", {
          value: function value(callback, type, quality) {
            var dataURL = this.toDataURL(type, quality).split(",")[1];
            setTimeout(function() {
              var binStr = atob(dataURL);
              var len = binStr.length;
              var arr = new Uint8Array(len);
              for (var i = 0; i < len; i++) {
                arr[i] = binStr.charCodeAt(i);
              }
              callback(new Blob([arr], {type: type || "image/png"}));
            });
          }
        });
      }
    }
    var canvasToBlob = function canvasToBlob2(canvas, options) {
      var beforeCreateBlob = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : null;
      return new Promise(function(resolve) {
        var promisedImage = beforeCreateBlob ? beforeCreateBlob(canvas) : canvas;
        Promise.resolve(promisedImage).then(function(canvas2) {
          canvas2.toBlob(resolve, options.type, options.quality);
        });
      });
    };
    var vectorMultiply = function vectorMultiply2(v, amount) {
      return createVector$1(v.x * amount, v.y * amount);
    };
    var vectorAdd = function vectorAdd2(a, b) {
      return createVector$1(a.x + b.x, a.y + b.y);
    };
    var vectorNormalize = function vectorNormalize2(v) {
      var l = Math.sqrt(v.x * v.x + v.y * v.y);
      if (l === 0) {
        return {
          x: 0,
          y: 0
        };
      }
      return createVector$1(v.x / l, v.y / l);
    };
    var vectorRotate = function vectorRotate2(v, radians, origin) {
      var cos = Math.cos(radians);
      var sin = Math.sin(radians);
      var t = createVector$1(v.x - origin.x, v.y - origin.y);
      return createVector$1(origin.x + cos * t.x - sin * t.y, origin.y + sin * t.x + cos * t.y);
    };
    var createVector$1 = function createVector2() {
      var x = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : 0;
      var y = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : 0;
      return {x, y};
    };
    var getMarkupValue = function getMarkupValue2(value, size) {
      var scalar = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : 1;
      var axis = arguments.length > 3 ? arguments[3] : void 0;
      if (typeof value === "string") {
        return parseFloat(value) * scalar;
      }
      if (typeof value === "number") {
        return value * (axis ? size[axis] : Math.min(size.width, size.height));
      }
      return;
    };
    var getMarkupStyles = function getMarkupStyles2(markup, size, scale) {
      var lineStyle = markup.borderStyle || markup.lineStyle || "solid";
      var fill = markup.backgroundColor || markup.fontColor || "transparent";
      var stroke = markup.borderColor || markup.lineColor || "transparent";
      var strokeWidth = getMarkupValue(markup.borderWidth || markup.lineWidth, size, scale);
      var lineCap = markup.lineCap || "round";
      var lineJoin = markup.lineJoin || "round";
      var dashes = typeof lineStyle === "string" ? "" : lineStyle.map(function(v) {
        return getMarkupValue(v, size, scale);
      }).join(",");
      var opacity = markup.opacity || 1;
      return {
        "stroke-linecap": lineCap,
        "stroke-linejoin": lineJoin,
        "stroke-width": strokeWidth || 0,
        "stroke-dasharray": dashes,
        stroke,
        fill,
        opacity
      };
    };
    var isDefined = function isDefined2(value) {
      return value != null;
    };
    var getMarkupRect = function getMarkupRect2(rect, size) {
      var scalar = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : 1;
      var left = getMarkupValue(rect.x, size, scalar, "width") || getMarkupValue(rect.left, size, scalar, "width");
      var top = getMarkupValue(rect.y, size, scalar, "height") || getMarkupValue(rect.top, size, scalar, "height");
      var width = getMarkupValue(rect.width, size, scalar, "width");
      var height = getMarkupValue(rect.height, size, scalar, "height");
      var right = getMarkupValue(rect.right, size, scalar, "width");
      var bottom = getMarkupValue(rect.bottom, size, scalar, "height");
      if (!isDefined(top)) {
        if (isDefined(height) && isDefined(bottom)) {
          top = size.height - height - bottom;
        } else {
          top = bottom;
        }
      }
      if (!isDefined(left)) {
        if (isDefined(width) && isDefined(right)) {
          left = size.width - width - right;
        } else {
          left = right;
        }
      }
      if (!isDefined(width)) {
        if (isDefined(left) && isDefined(right)) {
          width = size.width - left - right;
        } else {
          width = 0;
        }
      }
      if (!isDefined(height)) {
        if (isDefined(top) && isDefined(bottom)) {
          height = size.height - top - bottom;
        } else {
          height = 0;
        }
      }
      return {
        x: left || 0,
        y: top || 0,
        width: width || 0,
        height: height || 0
      };
    };
    var pointsToPathShape = function pointsToPathShape2(points) {
      return points.map(function(point, index) {
        return "".concat(index === 0 ? "M" : "L", " ").concat(point.x, " ").concat(point.y);
      }).join(" ");
    };
    var setAttributes = function setAttributes2(element, attr) {
      return Object.keys(attr).forEach(function(key) {
        return element.setAttribute(key, attr[key]);
      });
    };
    var ns = "http://www.w3.org/2000/svg";
    var svg = function svg2(tag, attr) {
      var element = document.createElementNS(ns, tag);
      if (attr) {
        setAttributes(element, attr);
      }
      return element;
    };
    var updateRect = function updateRect2(element) {
      return setAttributes(element, Object.assign({}, element.rect, element.styles));
    };
    var updateEllipse = function updateEllipse2(element) {
      var cx = element.rect.x + element.rect.width * 0.5;
      var cy = element.rect.y + element.rect.height * 0.5;
      var rx = element.rect.width * 0.5;
      var ry = element.rect.height * 0.5;
      return setAttributes(element, Object.assign({
        cx,
        cy,
        rx,
        ry
      }, element.styles));
    };
    var IMAGE_FIT_STYLE = {
      contain: "xMidYMid meet",
      cover: "xMidYMid slice"
    };
    var updateImage = function updateImage2(element, markup) {
      setAttributes(element, Object.assign({}, element.rect, element.styles, {
        preserveAspectRatio: IMAGE_FIT_STYLE[markup.fit] || "none"
      }));
    };
    var TEXT_ANCHOR = {
      left: "start",
      center: "middle",
      right: "end"
    };
    var updateText = function updateText2(element, markup, size, scale) {
      var fontSize = getMarkupValue(markup.fontSize, size, scale);
      var fontFamily = markup.fontFamily || "sans-serif";
      var fontWeight = markup.fontWeight || "normal";
      var textAlign = TEXT_ANCHOR[markup.textAlign] || "start";
      setAttributes(element, Object.assign({}, element.rect, element.styles, {
        "stroke-width": 0,
        "font-weight": fontWeight,
        "font-size": fontSize,
        "font-family": fontFamily,
        "text-anchor": textAlign
      }));
      if (element.text !== markup.text) {
        element.text = markup.text;
        element.textContent = markup.text.length ? markup.text : " ";
      }
    };
    var updateLine = function updateLine2(element, markup, size, scale) {
      setAttributes(element, Object.assign({}, element.rect, element.styles, {
        fill: "none"
      }));
      var line = element.childNodes[0];
      var begin = element.childNodes[1];
      var end = element.childNodes[2];
      var origin = element.rect;
      var target = {
        x: element.rect.x + element.rect.width,
        y: element.rect.y + element.rect.height
      };
      setAttributes(line, {
        x1: origin.x,
        y1: origin.y,
        x2: target.x,
        y2: target.y
      });
      if (!markup.lineDecoration)
        return;
      begin.style.display = "none";
      end.style.display = "none";
      var v = vectorNormalize({
        x: target.x - origin.x,
        y: target.y - origin.y
      });
      var l = getMarkupValue(0.05, size, scale);
      if (markup.lineDecoration.indexOf("arrow-begin") !== -1) {
        var arrowBeginRotationPoint = vectorMultiply(v, l);
        var arrowBeginCenter = vectorAdd(origin, arrowBeginRotationPoint);
        var arrowBeginA = vectorRotate(origin, 2, arrowBeginCenter);
        var arrowBeginB = vectorRotate(origin, -2, arrowBeginCenter);
        setAttributes(begin, {
          style: "display:block;",
          d: "M".concat(arrowBeginA.x, ",").concat(arrowBeginA.y, " L").concat(origin.x, ",").concat(origin.y, " L").concat(arrowBeginB.x, ",").concat(arrowBeginB.y)
        });
      }
      if (markup.lineDecoration.indexOf("arrow-end") !== -1) {
        var arrowEndRotationPoint = vectorMultiply(v, -l);
        var arrowEndCenter = vectorAdd(target, arrowEndRotationPoint);
        var arrowEndA = vectorRotate(target, 2, arrowEndCenter);
        var arrowEndB = vectorRotate(target, -2, arrowEndCenter);
        setAttributes(end, {
          style: "display:block;",
          d: "M".concat(arrowEndA.x, ",").concat(arrowEndA.y, " L").concat(target.x, ",").concat(target.y, " L").concat(arrowEndB.x, ",").concat(arrowEndB.y)
        });
      }
    };
    var updatePath = function updatePath2(element, markup, size, scale) {
      setAttributes(element, Object.assign({}, element.styles, {
        fill: "none",
        d: pointsToPathShape(markup.points.map(function(point) {
          return {
            x: getMarkupValue(point.x, size, scale, "width"),
            y: getMarkupValue(point.y, size, scale, "height")
          };
        }))
      }));
    };
    var createShape = function createShape2(node) {
      return function(markup) {
        return svg(node, {id: markup.id});
      };
    };
    var createImage = function createImage2(markup) {
      var shape = svg("image", {
        id: markup.id,
        "stroke-linecap": "round",
        "stroke-linejoin": "round",
        opacity: "0"
      });
      shape.onload = function() {
        shape.setAttribute("opacity", markup.opacity || 1);
      };
      shape.setAttributeNS("http://www.w3.org/1999/xlink", "xlink:href", markup.src);
      return shape;
    };
    var createLine = function createLine2(markup) {
      var shape = svg("g", {
        id: markup.id,
        "stroke-linecap": "round",
        "stroke-linejoin": "round"
      });
      var line = svg("line");
      shape.appendChild(line);
      var begin = svg("path");
      shape.appendChild(begin);
      var end = svg("path");
      shape.appendChild(end);
      return shape;
    };
    var CREATE_TYPE_ROUTES = {
      image: createImage,
      rect: createShape("rect"),
      ellipse: createShape("ellipse"),
      text: createShape("text"),
      path: createShape("path"),
      line: createLine
    };
    var UPDATE_TYPE_ROUTES = {
      rect: updateRect,
      ellipse: updateEllipse,
      image: updateImage,
      text: updateText,
      path: updatePath,
      line: updateLine
    };
    var createMarkupByType = function createMarkupByType2(type, markup) {
      return CREATE_TYPE_ROUTES[type](markup);
    };
    var updateMarkupByType = function updateMarkupByType2(element, type, markup, size, scale) {
      if (type !== "path") {
        element.rect = getMarkupRect(markup, size, scale);
      }
      element.styles = getMarkupStyles(markup, size, scale);
      UPDATE_TYPE_ROUTES[type](element, markup, size, scale);
    };
    var sortMarkupByZIndex = function sortMarkupByZIndex2(a, b) {
      if (a[1].zIndex > b[1].zIndex) {
        return 1;
      }
      if (a[1].zIndex < b[1].zIndex) {
        return -1;
      }
      return 0;
    };
    var cropSVG = function cropSVG2(blob) {
      var crop = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : {};
      var markup = arguments.length > 2 ? arguments[2] : void 0;
      var options = arguments.length > 3 ? arguments[3] : void 0;
      return new Promise(function(resolve) {
        var _options$background = options.background, background = _options$background === void 0 ? null : _options$background;
        var fr = new FileReader();
        fr.onloadend = function() {
          var text = fr.result;
          var original = document.createElement("div");
          original.style.cssText = "position:absolute;pointer-events:none;width:0;height:0;visibility:hidden;";
          original.innerHTML = text;
          var originalNode = original.querySelector("svg");
          document.body.appendChild(original);
          var bBox = originalNode.getBBox();
          original.parentNode.removeChild(original);
          var titleNode = original.querySelector("title");
          var viewBoxAttribute = originalNode.getAttribute("viewBox") || "";
          var widthAttribute = originalNode.getAttribute("width") || "";
          var heightAttribute = originalNode.getAttribute("height") || "";
          var width = parseFloat(widthAttribute) || null;
          var height = parseFloat(heightAttribute) || null;
          var widthUnits = (widthAttribute.match(/[a-z]+/) || [])[0] || "";
          var heightUnits = (heightAttribute.match(/[a-z]+/) || [])[0] || "";
          var viewBoxList = viewBoxAttribute.split(" ").map(parseFloat);
          var viewBox = viewBoxList.length ? {
            x: viewBoxList[0],
            y: viewBoxList[1],
            width: viewBoxList[2],
            height: viewBoxList[3]
          } : bBox;
          var imageWidth = width != null ? width : viewBox.width;
          var imageHeight = height != null ? height : viewBox.height;
          originalNode.style.overflow = "visible";
          originalNode.setAttribute("width", imageWidth);
          originalNode.setAttribute("height", imageHeight);
          var markupSVG = "";
          if (markup && markup.length) {
            var size = {
              width: imageWidth,
              height: imageHeight
            };
            markupSVG = markup.sort(sortMarkupByZIndex).reduce(function(prev, shape) {
              var el = createMarkupByType(shape[0], shape[1]);
              updateMarkupByType(el, shape[0], shape[1], size);
              el.removeAttribute("id");
              if (el.getAttribute("opacity") === 1) {
                el.removeAttribute("opacity");
              }
              return prev + "\n" + el.outerHTML + "\n";
            }, "");
            markupSVG = "\n\n<g>".concat(markupSVG.replace(/&nbsp;/g, " "), "</g>\n\n");
          }
          var aspectRatio = crop.aspectRatio || imageHeight / imageWidth;
          var canvasWidth = imageWidth;
          var canvasHeight = canvasWidth * aspectRatio;
          var shouldLimit = typeof crop.scaleToFit === "undefined" || crop.scaleToFit;
          var cropCenterX = crop.center ? crop.center.x : 0.5;
          var cropCenterY = crop.center ? crop.center.y : 0.5;
          var canvasZoomFactor = getImageRectZoomFactor({
            width: imageWidth,
            height: imageHeight
          }, getCenteredCropRect({
            width: canvasWidth,
            height: canvasHeight
          }, aspectRatio), crop.rotation, shouldLimit ? {x: cropCenterX, y: cropCenterY} : {
            x: 0.5,
            y: 0.5
          });
          var scale = crop.zoom * canvasZoomFactor;
          var rotation = crop.rotation * (180 / Math.PI);
          var canvasCenter = {
            x: canvasWidth * 0.5,
            y: canvasHeight * 0.5
          };
          var imageOffset = {
            x: canvasCenter.x - imageWidth * cropCenterX,
            y: canvasCenter.y - imageHeight * cropCenterY
          };
          var cropTransforms = [
            "rotate(".concat(rotation, " ").concat(canvasCenter.x, " ").concat(canvasCenter.y, ")"),
            "translate(".concat(canvasCenter.x, " ").concat(canvasCenter.y, ")"),
            "scale(".concat(scale, ")"),
            "translate(".concat(-canvasCenter.x, " ").concat(-canvasCenter.y, ")"),
            "translate(".concat(imageOffset.x, " ").concat(imageOffset.y, ")")
          ];
          var cropFlipHorizontal = crop.flip && crop.flip.horizontal;
          var cropFlipVertical = crop.flip && crop.flip.vertical;
          var flipTransforms = [
            "scale(".concat(cropFlipHorizontal ? -1 : 1, " ").concat(cropFlipVertical ? -1 : 1, ")"),
            "translate(".concat(cropFlipHorizontal ? -imageWidth : 0, " ").concat(cropFlipVertical ? -imageHeight : 0, ")")
          ];
          var transformed = '<?xml version="1.0" encoding="UTF-8"?>\n<svg width="'.concat(canvasWidth).concat(widthUnits, '" height="').concat(canvasHeight).concat(heightUnits, '" \nviewBox="0 0 ').concat(canvasWidth, " ").concat(canvasHeight, '" ').concat(background ? 'style="background:' + background + '" ' : "", '\npreserveAspectRatio="xMinYMin"\nxmlns:xlink="http://www.w3.org/1999/xlink"\nxmlns="http://www.w3.org/2000/svg">\n<!-- Generated by PQINA - https://pqina.nl/ -->\n<title>').concat(titleNode ? titleNode.textContent : "", '</title>\n<g transform="').concat(cropTransforms.join(" "), '">\n<g transform="').concat(flipTransforms.join(" "), '">\n').concat(originalNode.outerHTML).concat(markupSVG, "\n</g>\n</g>\n</svg>");
          resolve(transformed);
        };
        fr.readAsText(blob);
      });
    };
    var objectToImageData = function objectToImageData2(obj) {
      var imageData;
      try {
        imageData = new ImageData(obj.width, obj.height);
      } catch (e) {
        var canvas = document.createElement("canvas");
        imageData = canvas.getContext("2d").createImageData(obj.width, obj.height);
      }
      imageData.data.set(obj.data);
      return imageData;
    };
    var TransformWorker = function TransformWorker2() {
      var TRANSFORMS = {resize, filter};
      var applyTransforms = function applyTransforms2(transforms, imageData) {
        transforms.forEach(function(transform2) {
          imageData = TRANSFORMS[transform2.type](imageData, transform2.data);
        });
        return imageData;
      };
      var transform = function transform2(data2, cb) {
        var transforms = data2.transforms;
        var filterTransform = null;
        transforms.forEach(function(transform3) {
          if (transform3.type === "filter") {
            filterTransform = transform3;
          }
        });
        if (filterTransform) {
          var resizeTransform = null;
          transforms.forEach(function(transform3) {
            if (transform3.type === "resize") {
              resizeTransform = transform3;
            }
          });
          if (resizeTransform) {
            resizeTransform.data.matrix = filterTransform.data;
            transforms = transforms.filter(function(transform3) {
              return transform3.type !== "filter";
            });
          }
        }
        cb(applyTransforms(transforms, data2.imageData));
      };
      self.onmessage = function(e) {
        transform(e.data.message, function(response) {
          self.postMessage({id: e.data.id, message: response}, [response.data.buffer]);
        });
      };
      var br = 1;
      var bg = 1;
      var bb = 1;
      function applyFilterMatrix(index, data2, m) {
        var ir = data2[index] / 255;
        var ig = data2[index + 1] / 255;
        var ib = data2[index + 2] / 255;
        var ia = data2[index + 3] / 255;
        var mr = ir * m[0] + ig * m[1] + ib * m[2] + ia * m[3] + m[4];
        var mg = ir * m[5] + ig * m[6] + ib * m[7] + ia * m[8] + m[9];
        var mb = ir * m[10] + ig * m[11] + ib * m[12] + ia * m[13] + m[14];
        var ma = ir * m[15] + ig * m[16] + ib * m[17] + ia * m[18] + m[19];
        var or = Math.max(0, mr * ma) + br * (1 - ma);
        var og = Math.max(0, mg * ma) + bg * (1 - ma);
        var ob = Math.max(0, mb * ma) + bb * (1 - ma);
        data2[index] = Math.max(0, Math.min(1, or)) * 255;
        data2[index + 1] = Math.max(0, Math.min(1, og)) * 255;
        data2[index + 2] = Math.max(0, Math.min(1, ob)) * 255;
      }
      var identityMatrix = self.JSON.stringify([
        1,
        0,
        0,
        0,
        0,
        0,
        1,
        0,
        0,
        0,
        0,
        0,
        1,
        0,
        0,
        0,
        0,
        0,
        1,
        0
      ]);
      function isIdentityMatrix(filter2) {
        return self.JSON.stringify(filter2 || []) === identityMatrix;
      }
      function filter(imageData, matrix) {
        if (!matrix || isIdentityMatrix(matrix))
          return imageData;
        var data2 = imageData.data;
        var l = data2.length;
        var m11 = matrix[0];
        var m12 = matrix[1];
        var m13 = matrix[2];
        var m14 = matrix[3];
        var m15 = matrix[4];
        var m21 = matrix[5];
        var m22 = matrix[6];
        var m23 = matrix[7];
        var m24 = matrix[8];
        var m25 = matrix[9];
        var m31 = matrix[10];
        var m32 = matrix[11];
        var m33 = matrix[12];
        var m34 = matrix[13];
        var m35 = matrix[14];
        var m41 = matrix[15];
        var m42 = matrix[16];
        var m43 = matrix[17];
        var m44 = matrix[18];
        var m45 = matrix[19];
        var index = 0, r = 0, g = 0, b = 0, a = 0, mr = 0, mg = 0, mb = 0, ma = 0, or = 0, og = 0, ob = 0;
        for (; index < l; index += 4) {
          r = data2[index] / 255;
          g = data2[index + 1] / 255;
          b = data2[index + 2] / 255;
          a = data2[index + 3] / 255;
          mr = r * m11 + g * m12 + b * m13 + a * m14 + m15;
          mg = r * m21 + g * m22 + b * m23 + a * m24 + m25;
          mb = r * m31 + g * m32 + b * m33 + a * m34 + m35;
          ma = r * m41 + g * m42 + b * m43 + a * m44 + m45;
          or = Math.max(0, mr * ma) + br * (1 - ma);
          og = Math.max(0, mg * ma) + bg * (1 - ma);
          ob = Math.max(0, mb * ma) + bb * (1 - ma);
          data2[index] = Math.max(0, Math.min(1, or)) * 255;
          data2[index + 1] = Math.max(0, Math.min(1, og)) * 255;
          data2[index + 2] = Math.max(0, Math.min(1, ob)) * 255;
        }
        return imageData;
      }
      function resize(imageData, data2) {
        var _data$mode = data2.mode, mode = _data$mode === void 0 ? "contain" : _data$mode, _data$upscale = data2.upscale, upscale = _data$upscale === void 0 ? false : _data$upscale, width = data2.width, height = data2.height, matrix = data2.matrix;
        matrix = !matrix || isIdentityMatrix(matrix) ? null : matrix;
        if (!width && !height) {
          return filter(imageData, matrix);
        }
        if (width === null) {
          width = height;
        } else if (height === null) {
          height = width;
        }
        if (mode !== "force") {
          var scalarWidth = width / imageData.width;
          var scalarHeight = height / imageData.height;
          var scalar = 1;
          if (mode === "cover") {
            scalar = Math.max(scalarWidth, scalarHeight);
          } else if (mode === "contain") {
            scalar = Math.min(scalarWidth, scalarHeight);
          }
          if (scalar > 1 && upscale === false) {
            return filter(imageData, matrix);
          }
          width = imageData.width * scalar;
          height = imageData.height * scalar;
        }
        var originWidth = imageData.width;
        var originHeight = imageData.height;
        var targetWidth = Math.round(width);
        var targetHeight = Math.round(height);
        var inputData = imageData.data;
        var outputData = new Uint8ClampedArray(targetWidth * targetHeight * 4);
        var ratioWidth = originWidth / targetWidth;
        var ratioHeight = originHeight / targetHeight;
        var ratioWidthHalf = Math.ceil(ratioWidth * 0.5);
        var ratioHeightHalf = Math.ceil(ratioHeight * 0.5);
        for (var j = 0; j < targetHeight; j++) {
          for (var i = 0; i < targetWidth; i++) {
            var x2 = (i + j * targetWidth) * 4;
            var weight = 0;
            var weights = 0;
            var weightsAlpha = 0;
            var r = 0;
            var g = 0;
            var b = 0;
            var a = 0;
            var centerY = (j + 0.5) * ratioHeight;
            for (var yy = Math.floor(j * ratioHeight); yy < (j + 1) * ratioHeight; yy++) {
              var dy = Math.abs(centerY - (yy + 0.5)) / ratioHeightHalf;
              var centerX = (i + 0.5) * ratioWidth;
              var w0 = dy * dy;
              for (var xx = Math.floor(i * ratioWidth); xx < (i + 1) * ratioWidth; xx++) {
                var dx = Math.abs(centerX - (xx + 0.5)) / ratioWidthHalf;
                var w = Math.sqrt(w0 + dx * dx);
                if (w >= -1 && w <= 1) {
                  weight = 2 * w * w * w - 3 * w * w + 1;
                  if (weight > 0) {
                    dx = 4 * (xx + yy * originWidth);
                    var ref = inputData[dx + 3];
                    a += weight * ref;
                    weightsAlpha += weight;
                    if (ref < 255) {
                      weight = weight * ref / 250;
                    }
                    r += weight * inputData[dx];
                    g += weight * inputData[dx + 1];
                    b += weight * inputData[dx + 2];
                    weights += weight;
                  }
                }
              }
            }
            outputData[x2] = r / weights;
            outputData[x2 + 1] = g / weights;
            outputData[x2 + 2] = b / weights;
            outputData[x2 + 3] = a / weightsAlpha;
            matrix && applyFilterMatrix(x2, outputData, matrix);
          }
        }
        return {
          data: outputData,
          width: targetWidth,
          height: targetHeight
        };
      }
    };
    var correctOrientation = function correctOrientation2(view, offset) {
      if (view.getUint32(offset + 4, false) !== 1165519206)
        return;
      offset += 4;
      var intelByteAligned = view.getUint16(offset += 6, false) === 18761;
      offset += view.getUint32(offset + 4, intelByteAligned);
      var tags = view.getUint16(offset, intelByteAligned);
      offset += 2;
      for (var i = 0; i < tags; i++) {
        if (view.getUint16(offset + i * 12, intelByteAligned) === 274) {
          view.setUint16(offset + i * 12 + 8, 1, intelByteAligned);
          return true;
        }
      }
      return false;
    };
    var readData = function readData2(data2) {
      var view = new DataView(data2);
      if (view.getUint16(0) !== 65496)
        return null;
      var offset = 2;
      var marker;
      var markerLength;
      var orientationCorrected = false;
      while (offset < view.byteLength) {
        marker = view.getUint16(offset, false);
        markerLength = view.getUint16(offset + 2, false) + 2;
        var isData = marker >= 65504 && marker <= 65519 || marker === 65534;
        if (!isData) {
          break;
        }
        if (!orientationCorrected) {
          orientationCorrected = correctOrientation(view, offset, markerLength);
        }
        if (offset + markerLength > view.byteLength) {
          break;
        }
        offset += markerLength;
      }
      return data2.slice(0, offset);
    };
    var getImageHead = function getImageHead2(file) {
      return new Promise(function(resolve) {
        var reader = new FileReader();
        reader.onload = function() {
          return resolve(readData(reader.result) || null);
        };
        reader.readAsArrayBuffer(file.slice(0, 256 * 1024));
      });
    };
    var getBlobBuilder = function getBlobBuilder2() {
      return window.BlobBuilder = window.BlobBuilder || window.WebKitBlobBuilder || window.MozBlobBuilder || window.MSBlobBuilder;
    };
    var createBlob = function createBlob2(arrayBuffer, mimeType) {
      var BB = getBlobBuilder();
      if (BB) {
        var bb = new BB();
        bb.append(arrayBuffer);
        return bb.getBlob(mimeType);
      }
      return new Blob([arrayBuffer], {
        type: mimeType
      });
    };
    var getUniqueId = function getUniqueId2() {
      return Math.random().toString(36).substr(2, 9);
    };
    var createWorker = function createWorker2(fn) {
      var workerBlob = new Blob(["(", fn.toString(), ")()"], {type: "application/javascript"});
      var workerURL = URL.createObjectURL(workerBlob);
      var worker = new Worker(workerURL);
      var trips = [];
      return {
        transfer: function transfer() {
        },
        post: function post(message, cb, transferList) {
          var id2 = getUniqueId();
          trips[id2] = cb;
          worker.onmessage = function(e) {
            var cb2 = trips[e.data.id];
            if (!cb2)
              return;
            cb2(e.data.message);
            delete trips[e.data.id];
          };
          worker.postMessage({
            id: id2,
            message
          }, transferList);
        },
        terminate: function terminate() {
          worker.terminate();
          URL.revokeObjectURL(workerURL);
        }
      };
    };
    var loadImage = function loadImage2(url) {
      return new Promise(function(resolve, reject) {
        var img = new Image();
        img.onload = function() {
          resolve(img);
        };
        img.onerror = function(e) {
          reject(e);
        };
        img.src = url;
      });
    };
    var chain = function chain2(funcs) {
      return funcs.reduce(function(promise, func) {
        return promise.then(function(result) {
          return func().then(Array.prototype.concat.bind(result));
        });
      }, Promise.resolve([]));
    };
    var canvasApplyMarkup = function canvasApplyMarkup2(canvas, markup) {
      return new Promise(function(resolve) {
        var size = {
          width: canvas.width,
          height: canvas.height
        };
        var ctx = canvas.getContext("2d");
        var drawers = markup.sort(sortMarkupByZIndex).map(function(item) {
          return function() {
            return new Promise(function(resolve2) {
              var result = TYPE_DRAW_ROUTES[item[0]](ctx, size, item[1], resolve2);
              if (result)
                resolve2();
            });
          };
        });
        chain(drawers).then(function() {
          return resolve(canvas);
        });
      });
    };
    var applyMarkupStyles = function applyMarkupStyles2(ctx, styles2) {
      ctx.beginPath();
      ctx.lineCap = styles2["stroke-linecap"];
      ctx.lineJoin = styles2["stroke-linejoin"];
      ctx.lineWidth = styles2["stroke-width"];
      if (styles2["stroke-dasharray"].length) {
        ctx.setLineDash(styles2["stroke-dasharray"].split(","));
      }
      ctx.fillStyle = styles2["fill"];
      ctx.strokeStyle = styles2["stroke"];
      ctx.globalAlpha = styles2.opacity || 1;
    };
    var drawMarkupStyles = function drawMarkupStyles2(ctx) {
      ctx.fill();
      ctx.stroke();
      ctx.globalAlpha = 1;
    };
    var drawRect = function drawRect2(ctx, size, markup) {
      var rect = getMarkupRect(markup, size);
      var styles2 = getMarkupStyles(markup, size);
      applyMarkupStyles(ctx, styles2);
      ctx.rect(rect.x, rect.y, rect.width, rect.height);
      drawMarkupStyles(ctx, styles2);
      return true;
    };
    var drawEllipse = function drawEllipse2(ctx, size, markup) {
      var rect = getMarkupRect(markup, size);
      var styles2 = getMarkupStyles(markup, size);
      applyMarkupStyles(ctx, styles2);
      var x = rect.x, y = rect.y, w = rect.width, h = rect.height, kappa = 0.5522848, ox = w / 2 * kappa, oy = h / 2 * kappa, xe = x + w, ye = y + h, xm = x + w / 2, ym = y + h / 2;
      ctx.moveTo(x, ym);
      ctx.bezierCurveTo(x, ym - oy, xm - ox, y, xm, y);
      ctx.bezierCurveTo(xm + ox, y, xe, ym - oy, xe, ym);
      ctx.bezierCurveTo(xe, ym + oy, xm + ox, ye, xm, ye);
      ctx.bezierCurveTo(xm - ox, ye, x, ym + oy, x, ym);
      drawMarkupStyles(ctx, styles2);
      return true;
    };
    var drawImage = function drawImage2(ctx, size, markup, done) {
      var rect = getMarkupRect(markup, size);
      var styles2 = getMarkupStyles(markup, size);
      applyMarkupStyles(ctx, styles2);
      var image = new Image();
      var isCrossOriginImage = new URL(markup.src, window.location.href).origin !== window.location.origin;
      if (isCrossOriginImage)
        image.crossOrigin = "";
      image.onload = function() {
        if (markup.fit === "cover") {
          var ar = rect.width / rect.height;
          var width = ar > 1 ? image.width : image.height * ar;
          var height = ar > 1 ? image.width / ar : image.height;
          var x = image.width * 0.5 - width * 0.5;
          var y = image.height * 0.5 - height * 0.5;
          ctx.drawImage(image, x, y, width, height, rect.x, rect.y, rect.width, rect.height);
        } else if (markup.fit === "contain") {
          var scalar = Math.min(rect.width / image.width, rect.height / image.height);
          var _width = scalar * image.width;
          var _height = scalar * image.height;
          var _x = rect.x + rect.width * 0.5 - _width * 0.5;
          var _y = rect.y + rect.height * 0.5 - _height * 0.5;
          ctx.drawImage(image, 0, 0, image.width, image.height, _x, _y, _width, _height);
        } else {
          ctx.drawImage(image, 0, 0, image.width, image.height, rect.x, rect.y, rect.width, rect.height);
        }
        drawMarkupStyles(ctx, styles2);
        done();
      };
      image.src = markup.src;
    };
    var drawText = function drawText2(ctx, size, markup) {
      var rect = getMarkupRect(markup, size);
      var styles2 = getMarkupStyles(markup, size);
      applyMarkupStyles(ctx, styles2);
      var fontSize = getMarkupValue(markup.fontSize, size);
      var fontFamily = markup.fontFamily || "sans-serif";
      var fontWeight = markup.fontWeight || "normal";
      var textAlign = markup.textAlign || "left";
      ctx.font = "".concat(fontWeight, " ").concat(fontSize, "px ").concat(fontFamily);
      ctx.textAlign = textAlign;
      ctx.fillText(markup.text, rect.x, rect.y);
      drawMarkupStyles(ctx, styles2);
      return true;
    };
    var drawPath = function drawPath2(ctx, size, markup) {
      var styles2 = getMarkupStyles(markup, size);
      applyMarkupStyles(ctx, styles2);
      ctx.beginPath();
      var points = markup.points.map(function(point) {
        return {
          x: getMarkupValue(point.x, size, 1, "width"),
          y: getMarkupValue(point.y, size, 1, "height")
        };
      });
      ctx.moveTo(points[0].x, points[0].y);
      var l = points.length;
      for (var i = 1; i < l; i++) {
        ctx.lineTo(points[i].x, points[i].y);
      }
      drawMarkupStyles(ctx, styles2);
      return true;
    };
    var drawLine = function drawLine2(ctx, size, markup) {
      var rect = getMarkupRect(markup, size);
      var styles2 = getMarkupStyles(markup, size);
      applyMarkupStyles(ctx, styles2);
      ctx.beginPath();
      var origin = {
        x: rect.x,
        y: rect.y
      };
      var target = {
        x: rect.x + rect.width,
        y: rect.y + rect.height
      };
      ctx.moveTo(origin.x, origin.y);
      ctx.lineTo(target.x, target.y);
      var v = vectorNormalize({
        x: target.x - origin.x,
        y: target.y - origin.y
      });
      var l = 0.04 * Math.min(size.width, size.height);
      if (markup.lineDecoration.indexOf("arrow-begin") !== -1) {
        var arrowBeginRotationPoint = vectorMultiply(v, l);
        var arrowBeginCenter = vectorAdd(origin, arrowBeginRotationPoint);
        var arrowBeginA = vectorRotate(origin, 2, arrowBeginCenter);
        var arrowBeginB = vectorRotate(origin, -2, arrowBeginCenter);
        ctx.moveTo(arrowBeginA.x, arrowBeginA.y);
        ctx.lineTo(origin.x, origin.y);
        ctx.lineTo(arrowBeginB.x, arrowBeginB.y);
      }
      if (markup.lineDecoration.indexOf("arrow-end") !== -1) {
        var arrowEndRotationPoint = vectorMultiply(v, -l);
        var arrowEndCenter = vectorAdd(target, arrowEndRotationPoint);
        var arrowEndA = vectorRotate(target, 2, arrowEndCenter);
        var arrowEndB = vectorRotate(target, -2, arrowEndCenter);
        ctx.moveTo(arrowEndA.x, arrowEndA.y);
        ctx.lineTo(target.x, target.y);
        ctx.lineTo(arrowEndB.x, arrowEndB.y);
      }
      drawMarkupStyles(ctx, styles2);
      return true;
    };
    var TYPE_DRAW_ROUTES = {
      rect: drawRect,
      ellipse: drawEllipse,
      image: drawImage,
      text: drawText,
      line: drawLine,
      path: drawPath
    };
    var imageDataToCanvas = function imageDataToCanvas2(imageData) {
      var image = document.createElement("canvas");
      image.width = imageData.width;
      image.height = imageData.height;
      var ctx = image.getContext("2d");
      ctx.putImageData(imageData, 0, 0);
      return image;
    };
    var transformImage = function transformImage2(file, instructions) {
      var options = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : {};
      return new Promise(function(resolve, reject) {
        if (!file || !isImage$1(file))
          return reject({status: "not an image file", file});
        var stripImageHead = options.stripImageHead, beforeCreateBlob = options.beforeCreateBlob, afterCreateBlob = options.afterCreateBlob, canvasMemoryLimit = options.canvasMemoryLimit;
        var crop = instructions.crop, size = instructions.size, filter = instructions.filter, markup = instructions.markup, output = instructions.output;
        var orientation = instructions.image && instructions.image.orientation ? Math.max(1, Math.min(8, instructions.image.orientation)) : null;
        var qualityAsPercentage = output && output.quality;
        var quality = qualityAsPercentage === null ? null : qualityAsPercentage / 100;
        var type = output && output.type || null;
        var background = output && output.background || null;
        var transforms = [];
        if (size && (typeof size.width === "number" || typeof size.height === "number")) {
          transforms.push({type: "resize", data: size});
        }
        if (filter && filter.length === 20) {
          transforms.push({type: "filter", data: filter});
        }
        var resolveWithBlob = function resolveWithBlob2(blob) {
          var promisedBlob = afterCreateBlob ? afterCreateBlob(blob) : blob;
          Promise.resolve(promisedBlob).then(resolve);
        };
        var toBlob = function toBlob2(imageData, options2) {
          var canvas = imageDataToCanvas(imageData);
          var promisedCanvas = markup.length ? canvasApplyMarkup(canvas, markup) : canvas;
          Promise.resolve(promisedCanvas).then(function(canvas2) {
            canvasToBlob(canvas2, options2, beforeCreateBlob).then(function(blob) {
              canvasRelease(canvas2);
              if (stripImageHead)
                return resolveWithBlob(blob);
              getImageHead(file).then(function(imageHead) {
                if (imageHead !== null) {
                  blob = new Blob([imageHead, blob.slice(20)], {
                    type: blob.type
                  });
                }
                resolveWithBlob(blob);
              });
            }).catch(reject);
          });
        };
        if (/svg/.test(file.type) && type === null) {
          return cropSVG(file, crop, markup, {background}).then(function(text) {
            resolve(createBlob(text, "image/svg+xml"));
          });
        }
        var url = URL.createObjectURL(file);
        loadImage(url).then(function(image) {
          URL.revokeObjectURL(url);
          var imageData = imageToImageData(image, orientation, crop, {
            canvasMemoryLimit,
            background
          });
          var outputFormat = {
            quality,
            type: type || file.type
          };
          if (!transforms.length) {
            return toBlob(imageData, outputFormat);
          }
          var worker = createWorker(TransformWorker);
          worker.post({
            transforms,
            imageData
          }, function(response) {
            toBlob(objectToImageData(response), outputFormat);
            worker.terminate();
          }, [imageData.data.buffer]);
        }).catch(reject);
      });
    };
    function _typeof(obj) {
      if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") {
        _typeof = function(obj2) {
          return typeof obj2;
        };
      } else {
        _typeof = function(obj2) {
          return obj2 && typeof Symbol === "function" && obj2.constructor === Symbol && obj2 !== Symbol.prototype ? "symbol" : typeof obj2;
        };
      }
      return _typeof(obj);
    }
    var REACT_ELEMENT_TYPE;
    function _jsx(type, props, key, children) {
      if (!REACT_ELEMENT_TYPE) {
        REACT_ELEMENT_TYPE = typeof Symbol === "function" && Symbol.for && Symbol.for("react.element") || 60103;
      }
      var defaultProps = type && type.defaultProps;
      var childrenLength = arguments.length - 3;
      if (!props && childrenLength !== 0) {
        props = {
          children: void 0
        };
      }
      if (props && defaultProps) {
        for (var propName in defaultProps) {
          if (props[propName] === void 0) {
            props[propName] = defaultProps[propName];
          }
        }
      } else if (!props) {
        props = defaultProps || {};
      }
      if (childrenLength === 1) {
        props.children = children;
      } else if (childrenLength > 1) {
        var childArray = new Array(childrenLength);
        for (var i = 0; i < childrenLength; i++) {
          childArray[i] = arguments[i + 3];
        }
        props.children = childArray;
      }
      return {
        $$typeof: REACT_ELEMENT_TYPE,
        type,
        key: key === void 0 ? null : "" + key,
        ref: null,
        props,
        _owner: null
      };
    }
    function _asyncIterator(iterable) {
      var method;
      if (typeof Symbol === "function") {
        if (Symbol.asyncIterator) {
          method = iterable[Symbol.asyncIterator];
          if (method != null)
            return method.call(iterable);
        }
        if (Symbol.iterator) {
          method = iterable[Symbol.iterator];
          if (method != null)
            return method.call(iterable);
        }
      }
      throw new TypeError("Object is not async iterable");
    }
    function _AwaitValue(value) {
      this.wrapped = value;
    }
    function _AsyncGenerator(gen) {
      var front, back;
      function send(key, arg) {
        return new Promise(function(resolve, reject) {
          var request = {
            key,
            arg,
            resolve,
            reject,
            next: null
          };
          if (back) {
            back = back.next = request;
          } else {
            front = back = request;
            resume(key, arg);
          }
        });
      }
      function resume(key, arg) {
        try {
          var result = gen[key](arg);
          var value = result.value;
          var wrappedAwait = value instanceof _AwaitValue;
          Promise.resolve(wrappedAwait ? value.wrapped : value).then(function(arg2) {
            if (wrappedAwait) {
              resume("next", arg2);
              return;
            }
            settle(result.done ? "return" : "normal", arg2);
          }, function(err) {
            resume("throw", err);
          });
        } catch (err) {
          settle("throw", err);
        }
      }
      function settle(type, value) {
        switch (type) {
          case "return":
            front.resolve({
              value,
              done: true
            });
            break;
          case "throw":
            front.reject(value);
            break;
          default:
            front.resolve({
              value,
              done: false
            });
            break;
        }
        front = front.next;
        if (front) {
          resume(front.key, front.arg);
        } else {
          back = null;
        }
      }
      this._invoke = send;
      if (typeof gen.return !== "function") {
        this.return = void 0;
      }
    }
    if (typeof Symbol === "function" && Symbol.asyncIterator) {
      _AsyncGenerator.prototype[Symbol.asyncIterator] = function() {
        return this;
      };
    }
    _AsyncGenerator.prototype.next = function(arg) {
      return this._invoke("next", arg);
    };
    _AsyncGenerator.prototype.throw = function(arg) {
      return this._invoke("throw", arg);
    };
    _AsyncGenerator.prototype.return = function(arg) {
      return this._invoke("return", arg);
    };
    function _wrapAsyncGenerator(fn) {
      return function() {
        return new _AsyncGenerator(fn.apply(this, arguments));
      };
    }
    function _awaitAsyncGenerator(value) {
      return new _AwaitValue(value);
    }
    function _asyncGeneratorDelegate(inner, awaitWrap) {
      var iter = {}, waiting = false;
      function pump(key, value) {
        waiting = true;
        value = new Promise(function(resolve) {
          resolve(inner[key](value));
        });
        return {
          done: false,
          value: awaitWrap(value)
        };
      }
      if (typeof Symbol === "function" && Symbol.iterator) {
        iter[Symbol.iterator] = function() {
          return this;
        };
      }
      iter.next = function(value) {
        if (waiting) {
          waiting = false;
          return value;
        }
        return pump("next", value);
      };
      if (typeof inner.throw === "function") {
        iter.throw = function(value) {
          if (waiting) {
            waiting = false;
            throw value;
          }
          return pump("throw", value);
        };
      }
      if (typeof inner.return === "function") {
        iter.return = function(value) {
          return pump("return", value);
        };
      }
      return iter;
    }
    function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {
      try {
        var info = gen[key](arg);
        var value = info.value;
      } catch (error) {
        reject(error);
        return;
      }
      if (info.done) {
        resolve(value);
      } else {
        Promise.resolve(value).then(_next, _throw);
      }
    }
    function _asyncToGenerator(fn) {
      return function() {
        var self2 = this, args = arguments;
        return new Promise(function(resolve, reject) {
          var gen = fn.apply(self2, args);
          function _next(value) {
            asyncGeneratorStep(gen, resolve, reject, _next, _throw, "next", value);
          }
          function _throw(err) {
            asyncGeneratorStep(gen, resolve, reject, _next, _throw, "throw", err);
          }
          _next(void 0);
        });
      };
    }
    function _classCallCheck(instance, Constructor) {
      if (!(instance instanceof Constructor)) {
        throw new TypeError("Cannot call a class as a function");
      }
    }
    function _defineProperties(target, props) {
      for (var i = 0; i < props.length; i++) {
        var descriptor = props[i];
        descriptor.enumerable = descriptor.enumerable || false;
        descriptor.configurable = true;
        if ("value" in descriptor)
          descriptor.writable = true;
        Object.defineProperty(target, descriptor.key, descriptor);
      }
    }
    function _createClass(Constructor, protoProps, staticProps) {
      if (protoProps)
        _defineProperties(Constructor.prototype, protoProps);
      if (staticProps)
        _defineProperties(Constructor, staticProps);
      return Constructor;
    }
    function _defineEnumerableProperties(obj, descs) {
      for (var key in descs) {
        var desc = descs[key];
        desc.configurable = desc.enumerable = true;
        if ("value" in desc)
          desc.writable = true;
        Object.defineProperty(obj, key, desc);
      }
      if (Object.getOwnPropertySymbols) {
        var objectSymbols = Object.getOwnPropertySymbols(descs);
        for (var i = 0; i < objectSymbols.length; i++) {
          var sym = objectSymbols[i];
          var desc = descs[sym];
          desc.configurable = desc.enumerable = true;
          if ("value" in desc)
            desc.writable = true;
          Object.defineProperty(obj, sym, desc);
        }
      }
      return obj;
    }
    function _defaults(obj, defaults) {
      var keys = Object.getOwnPropertyNames(defaults);
      for (var i = 0; i < keys.length; i++) {
        var key = keys[i];
        var value = Object.getOwnPropertyDescriptor(defaults, key);
        if (value && value.configurable && obj[key] === void 0) {
          Object.defineProperty(obj, key, value);
        }
      }
      return obj;
    }
    function _defineProperty(obj, key, value) {
      if (key in obj) {
        Object.defineProperty(obj, key, {
          value,
          enumerable: true,
          configurable: true,
          writable: true
        });
      } else {
        obj[key] = value;
      }
      return obj;
    }
    function _extends() {
      _extends = Object.assign || function(target) {
        for (var i = 1; i < arguments.length; i++) {
          var source = arguments[i];
          for (var key in source) {
            if (Object.prototype.hasOwnProperty.call(source, key)) {
              target[key] = source[key];
            }
          }
        }
        return target;
      };
      return _extends.apply(this, arguments);
    }
    function _objectSpread(target) {
      for (var i = 1; i < arguments.length; i++) {
        var source = arguments[i] != null ? arguments[i] : {};
        var ownKeys = Object.keys(source);
        if (typeof Object.getOwnPropertySymbols === "function") {
          ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function(sym) {
            return Object.getOwnPropertyDescriptor(source, sym).enumerable;
          }));
        }
        ownKeys.forEach(function(key) {
          _defineProperty(target, key, source[key]);
        });
      }
      return target;
    }
    function _inherits(subClass, superClass) {
      if (typeof superClass !== "function" && superClass !== null) {
        throw new TypeError("Super expression must either be null or a function");
      }
      subClass.prototype = Object.create(superClass && superClass.prototype, {
        constructor: {
          value: subClass,
          writable: true,
          configurable: true
        }
      });
      if (superClass)
        _setPrototypeOf(subClass, superClass);
    }
    function _inheritsLoose(subClass, superClass) {
      subClass.prototype = Object.create(superClass.prototype);
      subClass.prototype.constructor = subClass;
      subClass.__proto__ = superClass;
    }
    function _getPrototypeOf(o) {
      _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf2(o2) {
        return o2.__proto__ || Object.getPrototypeOf(o2);
      };
      return _getPrototypeOf(o);
    }
    function _setPrototypeOf(o, p) {
      _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf2(o2, p2) {
        o2.__proto__ = p2;
        return o2;
      };
      return _setPrototypeOf(o, p);
    }
    function isNativeReflectConstruct() {
      if (typeof Reflect === "undefined" || !Reflect.construct)
        return false;
      if (Reflect.construct.sham)
        return false;
      if (typeof Proxy === "function")
        return true;
      try {
        Date.prototype.toString.call(Reflect.construct(Date, [], function() {
        }));
        return true;
      } catch (e) {
        return false;
      }
    }
    function _construct(Parent, args, Class) {
      if (isNativeReflectConstruct()) {
        _construct = Reflect.construct;
      } else {
        _construct = function _construct2(Parent2, args2, Class2) {
          var a = [null];
          a.push.apply(a, args2);
          var Constructor = Function.bind.apply(Parent2, a);
          var instance = new Constructor();
          if (Class2)
            _setPrototypeOf(instance, Class2.prototype);
          return instance;
        };
      }
      return _construct.apply(null, arguments);
    }
    function _isNativeFunction(fn) {
      return Function.toString.call(fn).indexOf("[native code]") !== -1;
    }
    function _wrapNativeSuper(Class) {
      var _cache = typeof Map === "function" ? new Map() : void 0;
      _wrapNativeSuper = function _wrapNativeSuper2(Class2) {
        if (Class2 === null || !_isNativeFunction(Class2))
          return Class2;
        if (typeof Class2 !== "function") {
          throw new TypeError("Super expression must either be null or a function");
        }
        if (typeof _cache !== "undefined") {
          if (_cache.has(Class2))
            return _cache.get(Class2);
          _cache.set(Class2, Wrapper);
        }
        function Wrapper() {
          return _construct(Class2, arguments, _getPrototypeOf(this).constructor);
        }
        Wrapper.prototype = Object.create(Class2.prototype, {
          constructor: {
            value: Wrapper,
            enumerable: false,
            writable: true,
            configurable: true
          }
        });
        return _setPrototypeOf(Wrapper, Class2);
      };
      return _wrapNativeSuper(Class);
    }
    function _instanceof(left, right) {
      if (right != null && typeof Symbol !== "undefined" && right[Symbol.hasInstance]) {
        return right[Symbol.hasInstance](left);
      } else {
        return left instanceof right;
      }
    }
    function _interopRequireDefault(obj) {
      return obj && obj.__esModule ? obj : {
        default: obj
      };
    }
    function _interopRequireWildcard(obj) {
      if (obj && obj.__esModule) {
        return obj;
      } else {
        var newObj = {};
        if (obj != null) {
          for (var key in obj) {
            if (Object.prototype.hasOwnProperty.call(obj, key)) {
              var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {};
              if (desc.get || desc.set) {
                Object.defineProperty(newObj, key, desc);
              } else {
                newObj[key] = obj[key];
              }
            }
          }
        }
        newObj.default = obj;
        return newObj;
      }
    }
    function _newArrowCheck(innerThis, boundThis) {
      if (innerThis !== boundThis) {
        throw new TypeError("Cannot instantiate an arrow function");
      }
    }
    function _objectDestructuringEmpty(obj) {
      if (obj == null)
        throw new TypeError("Cannot destructure undefined");
    }
    function _objectWithoutPropertiesLoose(source, excluded) {
      if (source == null)
        return {};
      var target = {};
      var sourceKeys = Object.keys(source);
      var key, i;
      for (i = 0; i < sourceKeys.length; i++) {
        key = sourceKeys[i];
        if (excluded.indexOf(key) >= 0)
          continue;
        target[key] = source[key];
      }
      return target;
    }
    function _objectWithoutProperties(source, excluded) {
      if (source == null)
        return {};
      var target = _objectWithoutPropertiesLoose(source, excluded);
      var key, i;
      if (Object.getOwnPropertySymbols) {
        var sourceSymbolKeys = Object.getOwnPropertySymbols(source);
        for (i = 0; i < sourceSymbolKeys.length; i++) {
          key = sourceSymbolKeys[i];
          if (excluded.indexOf(key) >= 0)
            continue;
          if (!Object.prototype.propertyIsEnumerable.call(source, key))
            continue;
          target[key] = source[key];
        }
      }
      return target;
    }
    function _assertThisInitialized(self2) {
      if (self2 === void 0) {
        throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
      }
      return self2;
    }
    function _possibleConstructorReturn(self2, call) {
      if (call && (typeof call === "object" || typeof call === "function")) {
        return call;
      }
      return _assertThisInitialized(self2);
    }
    function _superPropBase(object, property) {
      while (!Object.prototype.hasOwnProperty.call(object, property)) {
        object = _getPrototypeOf(object);
        if (object === null)
          break;
      }
      return object;
    }
    function _get(target, property, receiver) {
      if (typeof Reflect !== "undefined" && Reflect.get) {
        _get = Reflect.get;
      } else {
        _get = function _get2(target2, property2, receiver2) {
          var base = _superPropBase(target2, property2);
          if (!base)
            return;
          var desc = Object.getOwnPropertyDescriptor(base, property2);
          if (desc.get) {
            return desc.get.call(receiver2);
          }
          return desc.value;
        };
      }
      return _get(target, property, receiver || target);
    }
    function set(target, property, value, receiver) {
      if (typeof Reflect !== "undefined" && Reflect.set) {
        set = Reflect.set;
      } else {
        set = function set2(target2, property2, value2, receiver2) {
          var base = _superPropBase(target2, property2);
          var desc;
          if (base) {
            desc = Object.getOwnPropertyDescriptor(base, property2);
            if (desc.set) {
              desc.set.call(receiver2, value2);
              return true;
            } else if (!desc.writable) {
              return false;
            }
          }
          desc = Object.getOwnPropertyDescriptor(receiver2, property2);
          if (desc) {
            if (!desc.writable) {
              return false;
            }
            desc.value = value2;
            Object.defineProperty(receiver2, property2, desc);
          } else {
            _defineProperty(receiver2, property2, value2);
          }
          return true;
        };
      }
      return set(target, property, value, receiver);
    }
    function _set(target, property, value, receiver, isStrict) {
      var s = set(target, property, value, receiver || target);
      if (!s && isStrict) {
        throw new Error("failed to set property");
      }
      return value;
    }
    function _taggedTemplateLiteral(strings, raw) {
      if (!raw) {
        raw = strings.slice(0);
      }
      return Object.freeze(Object.defineProperties(strings, {
        raw: {
          value: Object.freeze(raw)
        }
      }));
    }
    function _taggedTemplateLiteralLoose(strings, raw) {
      if (!raw) {
        raw = strings.slice(0);
      }
      strings.raw = raw;
      return strings;
    }
    function _temporalRef(val, name) {
      if (val === _temporalUndefined) {
        throw new ReferenceError(name + " is not defined - temporal dead zone");
      } else {
        return val;
      }
    }
    function _readOnlyError(name) {
      throw new Error('"' + name + '" is read-only');
    }
    function _classNameTDZError(name) {
      throw new Error('Class "' + name + '" cannot be referenced in computed property keys.');
    }
    var _temporalUndefined = {};
    function _slicedToArray(arr, i) {
      return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest();
    }
    function _slicedToArrayLoose(arr, i) {
      return _arrayWithHoles(arr) || _iterableToArrayLimitLoose(arr, i) || _nonIterableRest();
    }
    function _toArray(arr) {
      return _arrayWithHoles(arr) || _iterableToArray(arr) || _nonIterableRest();
    }
    function _toConsumableArray(arr) {
      return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread();
    }
    function _arrayWithoutHoles(arr) {
      if (Array.isArray(arr)) {
        for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++)
          arr2[i] = arr[i];
        return arr2;
      }
    }
    function _arrayWithHoles(arr) {
      if (Array.isArray(arr))
        return arr;
    }
    function _iterableToArray(iter) {
      if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === "[object Arguments]")
        return Array.from(iter);
    }
    function _iterableToArrayLimit(arr, i) {
      var _arr = [];
      var _n = true;
      var _d = false;
      var _e = void 0;
      try {
        for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {
          _arr.push(_s.value);
          if (i && _arr.length === i)
            break;
        }
      } catch (err) {
        _d = true;
        _e = err;
      } finally {
        try {
          if (!_n && _i["return"] != null)
            _i["return"]();
        } finally {
          if (_d)
            throw _e;
        }
      }
      return _arr;
    }
    function _iterableToArrayLimitLoose(arr, i) {
      var _arr = [];
      for (var _iterator = arr[Symbol.iterator](), _step; !(_step = _iterator.next()).done; ) {
        _arr.push(_step.value);
        if (i && _arr.length === i)
          break;
      }
      return _arr;
    }
    function _nonIterableSpread() {
      throw new TypeError("Invalid attempt to spread non-iterable instance");
    }
    function _nonIterableRest() {
      throw new TypeError("Invalid attempt to destructure non-iterable instance");
    }
    function _skipFirstGeneratorNext(fn) {
      return function() {
        var it = fn.apply(this, arguments);
        it.next();
        return it;
      };
    }
    function _toPrimitive(input, hint) {
      if (typeof input !== "object" || input === null)
        return input;
      var prim = input[Symbol.toPrimitive];
      if (prim !== void 0) {
        var res = prim.call(input, hint || "default");
        if (typeof res !== "object")
          return res;
        throw new TypeError("@@toPrimitive must return a primitive value.");
      }
      return (hint === "string" ? String : Number)(input);
    }
    function _toPropertyKey(arg) {
      var key = _toPrimitive(arg, "string");
      return typeof key === "symbol" ? key : String(key);
    }
    function _initializerWarningHelper(descriptor, context) {
      throw new Error("Decorating class property failed. Please ensure that proposal-class-properties is enabled and set to use loose mode. To use proposal-class-properties in spec mode with decorators, wait for the next major version of decorators in stage 2.");
    }
    function _initializerDefineProperty(target, property, descriptor, context) {
      if (!descriptor)
        return;
      Object.defineProperty(target, property, {
        enumerable: descriptor.enumerable,
        configurable: descriptor.configurable,
        writable: descriptor.writable,
        value: descriptor.initializer ? descriptor.initializer.call(context) : void 0
      });
    }
    function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) {
      var desc = {};
      Object.keys(descriptor).forEach(function(key) {
        desc[key] = descriptor[key];
      });
      desc.enumerable = !!desc.enumerable;
      desc.configurable = !!desc.configurable;
      if ("value" in desc || desc.initializer) {
        desc.writable = true;
      }
      desc = decorators.slice().reverse().reduce(function(desc2, decorator) {
        return decorator(target, property, desc2) || desc2;
      }, desc);
      if (context && desc.initializer !== void 0) {
        desc.value = desc.initializer ? desc.initializer.call(context) : void 0;
        desc.initializer = void 0;
      }
      if (desc.initializer === void 0) {
        Object.defineProperty(target, property, desc);
        desc = null;
      }
      return desc;
    }
    var id = 0;
    function _classPrivateFieldLooseKey(name) {
      return "__private_" + id++ + "_" + name;
    }
    function _classPrivateFieldLooseBase(receiver, privateKey) {
      if (!Object.prototype.hasOwnProperty.call(receiver, privateKey)) {
        throw new TypeError("attempted to use private field on non-instance");
      }
      return receiver;
    }
    function _classPrivateFieldGet(receiver, privateMap) {
      if (!privateMap.has(receiver)) {
        throw new TypeError("attempted to get private field on non-instance");
      }
      var descriptor = privateMap.get(receiver);
      if (descriptor.get) {
        return descriptor.get.call(receiver);
      }
      return descriptor.value;
    }
    function _classPrivateFieldSet(receiver, privateMap, value) {
      if (!privateMap.has(receiver)) {
        throw new TypeError("attempted to set private field on non-instance");
      }
      var descriptor = privateMap.get(receiver);
      if (descriptor.set) {
        descriptor.set.call(receiver, value);
      } else {
        if (!descriptor.writable) {
          throw new TypeError("attempted to set read only private field");
        }
        descriptor.value = value;
      }
      return value;
    }
    function _classStaticPrivateFieldSpecGet(receiver, classConstructor, descriptor) {
      if (receiver !== classConstructor) {
        throw new TypeError("Private static access of wrong provenance");
      }
      return descriptor.value;
    }
    function _classStaticPrivateFieldSpecSet(receiver, classConstructor, descriptor, value) {
      if (receiver !== classConstructor) {
        throw new TypeError("Private static access of wrong provenance");
      }
      if (!descriptor.writable) {
        throw new TypeError("attempted to set read only private field");
      }
      descriptor.value = value;
      return value;
    }
    function _classStaticPrivateMethodGet(receiver, classConstructor, method) {
      if (receiver !== classConstructor) {
        throw new TypeError("Private static access of wrong provenance");
      }
      return method;
    }
    function _classStaticPrivateMethodSet() {
      throw new TypeError("attempted to set read only static private field");
    }
    function _decorate(decorators, factory, superClass, mixins) {
      var api = _getDecoratorsApi();
      if (mixins) {
        for (var i = 0; i < mixins.length; i++) {
          api = mixins[i](api);
        }
      }
      var r = factory(function initialize(O) {
        api.initializeInstanceElements(O, decorated.elements);
      }, superClass);
      var decorated = api.decorateClass(_coalesceClassElements(r.d.map(_createElementDescriptor)), decorators);
      api.initializeClassElements(r.F, decorated.elements);
      return api.runClassFinishers(r.F, decorated.finishers);
    }
    function _getDecoratorsApi() {
      _getDecoratorsApi = function() {
        return api;
      };
      var api = {
        elementsDefinitionOrder: [["method"], ["field"]],
        initializeInstanceElements: function(O, elements) {
          ["method", "field"].forEach(function(kind) {
            elements.forEach(function(element) {
              if (element.kind === kind && element.placement === "own") {
                this.defineClassElement(O, element);
              }
            }, this);
          }, this);
        },
        initializeClassElements: function(F, elements) {
          var proto2 = F.prototype;
          ["method", "field"].forEach(function(kind) {
            elements.forEach(function(element) {
              var placement = element.placement;
              if (element.kind === kind && (placement === "static" || placement === "prototype")) {
                var receiver = placement === "static" ? F : proto2;
                this.defineClassElement(receiver, element);
              }
            }, this);
          }, this);
        },
        defineClassElement: function(receiver, element) {
          var descriptor = element.descriptor;
          if (element.kind === "field") {
            var initializer = element.initializer;
            descriptor = {
              enumerable: descriptor.enumerable,
              writable: descriptor.writable,
              configurable: descriptor.configurable,
              value: initializer === void 0 ? void 0 : initializer.call(receiver)
            };
          }
          Object.defineProperty(receiver, element.key, descriptor);
        },
        decorateClass: function(elements, decorators) {
          var newElements = [];
          var finishers = [];
          var placements = {
            static: [],
            prototype: [],
            own: []
          };
          elements.forEach(function(element) {
            this.addElementPlacement(element, placements);
          }, this);
          elements.forEach(function(element) {
            if (!_hasDecorators(element))
              return newElements.push(element);
            var elementFinishersExtras = this.decorateElement(element, placements);
            newElements.push(elementFinishersExtras.element);
            newElements.push.apply(newElements, elementFinishersExtras.extras);
            finishers.push.apply(finishers, elementFinishersExtras.finishers);
          }, this);
          if (!decorators) {
            return {
              elements: newElements,
              finishers
            };
          }
          var result = this.decorateConstructor(newElements, decorators);
          finishers.push.apply(finishers, result.finishers);
          result.finishers = finishers;
          return result;
        },
        addElementPlacement: function(element, placements, silent) {
          var keys = placements[element.placement];
          if (!silent && keys.indexOf(element.key) !== -1) {
            throw new TypeError("Duplicated element (" + element.key + ")");
          }
          keys.push(element.key);
        },
        decorateElement: function(element, placements) {
          var extras = [];
          var finishers = [];
          for (var decorators = element.decorators, i = decorators.length - 1; i >= 0; i--) {
            var keys = placements[element.placement];
            keys.splice(keys.indexOf(element.key), 1);
            var elementObject = this.fromElementDescriptor(element);
            var elementFinisherExtras = this.toElementFinisherExtras((0, decorators[i])(elementObject) || elementObject);
            element = elementFinisherExtras.element;
            this.addElementPlacement(element, placements);
            if (elementFinisherExtras.finisher) {
              finishers.push(elementFinisherExtras.finisher);
            }
            var newExtras = elementFinisherExtras.extras;
            if (newExtras) {
              for (var j = 0; j < newExtras.length; j++) {
                this.addElementPlacement(newExtras[j], placements);
              }
              extras.push.apply(extras, newExtras);
            }
          }
          return {
            element,
            finishers,
            extras
          };
        },
        decorateConstructor: function(elements, decorators) {
          var finishers = [];
          for (var i = decorators.length - 1; i >= 0; i--) {
            var obj = this.fromClassDescriptor(elements);
            var elementsAndFinisher = this.toClassDescriptor((0, decorators[i])(obj) || obj);
            if (elementsAndFinisher.finisher !== void 0) {
              finishers.push(elementsAndFinisher.finisher);
            }
            if (elementsAndFinisher.elements !== void 0) {
              elements = elementsAndFinisher.elements;
              for (var j = 0; j < elements.length - 1; j++) {
                for (var k = j + 1; k < elements.length; k++) {
                  if (elements[j].key === elements[k].key && elements[j].placement === elements[k].placement) {
                    throw new TypeError("Duplicated element (" + elements[j].key + ")");
                  }
                }
              }
            }
          }
          return {
            elements,
            finishers
          };
        },
        fromElementDescriptor: function(element) {
          var obj = {
            kind: element.kind,
            key: element.key,
            placement: element.placement,
            descriptor: element.descriptor
          };
          var desc = {
            value: "Descriptor",
            configurable: true
          };
          Object.defineProperty(obj, Symbol.toStringTag, desc);
          if (element.kind === "field")
            obj.initializer = element.initializer;
          return obj;
        },
        toElementDescriptors: function(elementObjects) {
          if (elementObjects === void 0)
            return;
          return _toArray(elementObjects).map(function(elementObject) {
            var element = this.toElementDescriptor(elementObject);
            this.disallowProperty(elementObject, "finisher", "An element descriptor");
            this.disallowProperty(elementObject, "extras", "An element descriptor");
            return element;
          }, this);
        },
        toElementDescriptor: function(elementObject) {
          var kind = String(elementObject.kind);
          if (kind !== "method" && kind !== "field") {
            throw new TypeError(`An element descriptor's .kind property must be either "method" or "field", but a decorator created an element descriptor with .kind "` + kind + '"');
          }
          var key = _toPropertyKey(elementObject.key);
          var placement = String(elementObject.placement);
          if (placement !== "static" && placement !== "prototype" && placement !== "own") {
            throw new TypeError(`An element descriptor's .placement property must be one of "static", "prototype" or "own", but a decorator created an element descriptor with .placement "` + placement + '"');
          }
          var descriptor = elementObject.descriptor;
          this.disallowProperty(elementObject, "elements", "An element descriptor");
          var element = {
            kind,
            key,
            placement,
            descriptor: Object.assign({}, descriptor)
          };
          if (kind !== "field") {
            this.disallowProperty(elementObject, "initializer", "A method descriptor");
          } else {
            this.disallowProperty(descriptor, "get", "The property descriptor of a field descriptor");
            this.disallowProperty(descriptor, "set", "The property descriptor of a field descriptor");
            this.disallowProperty(descriptor, "value", "The property descriptor of a field descriptor");
            element.initializer = elementObject.initializer;
          }
          return element;
        },
        toElementFinisherExtras: function(elementObject) {
          var element = this.toElementDescriptor(elementObject);
          var finisher = _optionalCallableProperty(elementObject, "finisher");
          var extras = this.toElementDescriptors(elementObject.extras);
          return {
            element,
            finisher,
            extras
          };
        },
        fromClassDescriptor: function(elements) {
          var obj = {
            kind: "class",
            elements: elements.map(this.fromElementDescriptor, this)
          };
          var desc = {
            value: "Descriptor",
            configurable: true
          };
          Object.defineProperty(obj, Symbol.toStringTag, desc);
          return obj;
        },
        toClassDescriptor: function(obj) {
          var kind = String(obj.kind);
          if (kind !== "class") {
            throw new TypeError(`A class descriptor's .kind property must be "class", but a decorator created a class descriptor with .kind "` + kind + '"');
          }
          this.disallowProperty(obj, "key", "A class descriptor");
          this.disallowProperty(obj, "placement", "A class descriptor");
          this.disallowProperty(obj, "descriptor", "A class descriptor");
          this.disallowProperty(obj, "initializer", "A class descriptor");
          this.disallowProperty(obj, "extras", "A class descriptor");
          var finisher = _optionalCallableProperty(obj, "finisher");
          var elements = this.toElementDescriptors(obj.elements);
          return {
            elements,
            finisher
          };
        },
        runClassFinishers: function(constructor, finishers) {
          for (var i = 0; i < finishers.length; i++) {
            var newConstructor = (0, finishers[i])(constructor);
            if (newConstructor !== void 0) {
              if (typeof newConstructor !== "function") {
                throw new TypeError("Finishers must return a constructor.");
              }
              constructor = newConstructor;
            }
          }
          return constructor;
        },
        disallowProperty: function(obj, name, objectType) {
          if (obj[name] !== void 0) {
            throw new TypeError(objectType + " can't have a ." + name + " property.");
          }
        }
      };
      return api;
    }
    function _createElementDescriptor(def) {
      var key = _toPropertyKey(def.key);
      var descriptor;
      if (def.kind === "method") {
        descriptor = {
          value: def.value,
          writable: true,
          configurable: true,
          enumerable: false
        };
      } else if (def.kind === "get") {
        descriptor = {
          get: def.value,
          configurable: true,
          enumerable: false
        };
      } else if (def.kind === "set") {
        descriptor = {
          set: def.value,
          configurable: true,
          enumerable: false
        };
      } else if (def.kind === "field") {
        descriptor = {
          configurable: true,
          writable: true,
          enumerable: true
        };
      }
      var element = {
        kind: def.kind === "field" ? "field" : "method",
        key,
        placement: def.static ? "static" : def.kind === "field" ? "own" : "prototype",
        descriptor
      };
      if (def.decorators)
        element.decorators = def.decorators;
      if (def.kind === "field")
        element.initializer = def.value;
      return element;
    }
    function _coalesceGetterSetter(element, other) {
      if (element.descriptor.get !== void 0) {
        other.descriptor.get = element.descriptor.get;
      } else {
        other.descriptor.set = element.descriptor.set;
      }
    }
    function _coalesceClassElements(elements) {
      var newElements = [];
      var isSameElement = function(other2) {
        return other2.kind === "method" && other2.key === element.key && other2.placement === element.placement;
      };
      for (var i = 0; i < elements.length; i++) {
        var element = elements[i];
        var other;
        if (element.kind === "method" && (other = newElements.find(isSameElement))) {
          if (_isDataDescriptor(element.descriptor) || _isDataDescriptor(other.descriptor)) {
            if (_hasDecorators(element) || _hasDecorators(other)) {
              throw new ReferenceError("Duplicated methods (" + element.key + ") can't be decorated.");
            }
            other.descriptor = element.descriptor;
          } else {
            if (_hasDecorators(element)) {
              if (_hasDecorators(other)) {
                throw new ReferenceError("Decorators can't be placed on different accessors with for the same property (" + element.key + ").");
              }
              other.decorators = element.decorators;
            }
            _coalesceGetterSetter(element, other);
          }
        } else {
          newElements.push(element);
        }
      }
      return newElements;
    }
    function _hasDecorators(element) {
      return element.decorators && element.decorators.length;
    }
    function _isDataDescriptor(desc) {
      return desc !== void 0 && !(desc.value === void 0 && desc.writable === void 0);
    }
    function _optionalCallableProperty(obj, name) {
      var value = obj[name];
      if (value !== void 0 && typeof value !== "function") {
        throw new TypeError("Expected '" + name + "' to be a function");
      }
      return value;
    }
    function _classPrivateMethodGet(receiver, privateSet, fn) {
      if (!privateSet.has(receiver)) {
        throw new TypeError("attempted to get private field on non-instance");
      }
      return fn;
    }
    function _classPrivateMethodSet() {
      throw new TypeError("attempted to reassign private method");
    }
    function _wrapRegExp(re, groups) {
      _wrapRegExp = function(re2, groups2) {
        return new BabelRegExp(re2, groups2);
      };
      var _RegExp = _wrapNativeSuper(RegExp);
      var _super = RegExp.prototype;
      var _groups = new WeakMap();
      function BabelRegExp(re2, groups2) {
        var _this = _RegExp.call(this, re2);
        _groups.set(_this, groups2);
        return _this;
      }
      _inherits(BabelRegExp, _RegExp);
      BabelRegExp.prototype.exec = function(str) {
        var result = _super.exec.call(this, str);
        if (result)
          result.groups = buildGroups(result, this);
        return result;
      };
      BabelRegExp.prototype[Symbol.replace] = function(str, substitution) {
        if (typeof substitution === "string") {
          var groups2 = _groups.get(this);
          return _super[Symbol.replace].call(this, str, substitution.replace(/\$<([^>]+)>/g, function(_, name) {
            return "$" + groups2[name];
          }));
        } else if (typeof substitution === "function") {
          var _this = this;
          return _super[Symbol.replace].call(this, str, function() {
            var args = [];
            args.push.apply(args, arguments);
            if (typeof args[args.length - 1] !== "object") {
              args.push(buildGroups(args, _this));
            }
            return substitution.apply(this, args);
          });
        } else {
          return _super[Symbol.replace].call(this, str, substitution);
        }
      };
      function buildGroups(result, re2) {
        var g = _groups.get(re2);
        return Object.keys(g).reduce(function(groups2, name) {
          groups2[name] = result[g[name]];
          return groups2;
        }, Object.create(null));
      }
      return _wrapRegExp.apply(this, arguments);
    }
    var MARKUP_RECT = ["x", "y", "left", "top", "right", "bottom", "width", "height"];
    var toOptionalFraction = function toOptionalFraction2(value) {
      return typeof value === "string" && /%/.test(value) ? parseFloat(value) / 100 : value;
    };
    var prepareMarkup = function prepareMarkup2(markup) {
      var _markup = _slicedToArray(markup, 2), type = _markup[0], props = _markup[1];
      var rect = props.points ? {} : MARKUP_RECT.reduce(function(prev, curr) {
        prev[curr] = toOptionalFraction(props[curr]);
        return prev;
      }, {});
      return [
        type,
        Object.assign({
          zIndex: 0
        }, props, rect)
      ];
    };
    var getImageSize = function getImageSize2(file) {
      return new Promise(function(resolve, reject) {
        var imageElement = new Image();
        imageElement.src = URL.createObjectURL(file);
        var measure = function measure2() {
          var width = imageElement.naturalWidth;
          var height = imageElement.naturalHeight;
          var hasSize = width && height;
          if (!hasSize)
            return;
          URL.revokeObjectURL(imageElement.src);
          clearInterval(intervalId);
          resolve({width, height});
        };
        imageElement.onerror = function(err) {
          URL.revokeObjectURL(imageElement.src);
          clearInterval(intervalId);
          reject(err);
        };
        var intervalId = setInterval(measure, 1);
        measure();
      });
    };
    if (typeof window !== "undefined" && typeof window.document !== "undefined") {
      if (!HTMLCanvasElement.prototype.toBlob) {
        Object.defineProperty(HTMLCanvasElement.prototype, "toBlob", {
          value: function value(cb, type, quality) {
            var canvas = this;
            setTimeout(function() {
              var dataURL = canvas.toDataURL(type, quality).split(",")[1];
              var binStr = atob(dataURL);
              var index = binStr.length;
              var data2 = new Uint8Array(index);
              while (index--) {
                data2[index] = binStr.charCodeAt(index);
              }
              cb(new Blob([data2], {type: type || "image/png"}));
            });
          }
        });
      }
    }
    var isBrowser = typeof window !== "undefined" && typeof window.document !== "undefined";
    var isIOS = isBrowser && /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;
    var plugin = function plugin2(_ref) {
      var addFilter = _ref.addFilter, utils = _ref.utils;
      var Type = utils.Type, forin = utils.forin, getFileFromBlob = utils.getFileFromBlob, isFile = utils.isFile;
      var TRANSFORM_LIST = ["crop", "resize", "filter", "markup", "output"];
      var createVariantCreator = function createVariantCreator2(updateMetadata) {
        return function(transform, file, metadata) {
          return transform(file, updateMetadata ? updateMetadata(metadata) : metadata);
        };
      };
      var isDefaultCrop = function isDefaultCrop2(crop) {
        return crop.aspectRatio === null && crop.rotation === 0 && crop.zoom === 1 && crop.center && crop.center.x === 0.5 && crop.center.y === 0.5 && crop.flip && crop.flip.horizontal === false && crop.flip.vertical === false;
      };
      addFilter("SHOULD_PREPARE_OUTPUT", function(shouldPrepareOutput, _ref2) {
        var query = _ref2.query;
        return new Promise(function(resolve) {
          resolve(!query("IS_ASYNC"));
        });
      });
      var shouldTransformFile = function shouldTransformFile2(query, file, item) {
        return new Promise(function(resolve) {
          if (!query("GET_ALLOW_IMAGE_TRANSFORM") || item.archived || !isFile(file) || !isImage(file)) {
            return resolve(false);
          }
          getImageSize(file).then(function() {
            var fn = query("GET_IMAGE_TRANSFORM_IMAGE_FILTER");
            if (fn) {
              var filterResult = fn(file);
              if (filterResult == null) {
                return handleRevert(true);
              }
              if (typeof filterResult === "boolean") {
                return resolve(filterResult);
              }
              if (typeof filterResult.then === "function") {
                return filterResult.then(resolve);
              }
            }
            resolve(true);
          }).catch(function(err) {
            resolve(false);
          });
        });
      };
      addFilter("DID_CREATE_ITEM", function(item, _ref3) {
        var query = _ref3.query, dispatch = _ref3.dispatch;
        if (!query("GET_ALLOW_IMAGE_TRANSFORM"))
          return;
        item.extend("requestPrepare", function() {
          return new Promise(function(resolve, reject) {
            dispatch("REQUEST_PREPARE_OUTPUT", {
              query: item.id,
              item,
              success: resolve,
              failure: reject
            }, true);
          });
        });
      });
      addFilter("PREPARE_OUTPUT", function(file, _ref4) {
        var query = _ref4.query, item = _ref4.item;
        return new Promise(function(resolve) {
          shouldTransformFile(query, file, item).then(function(shouldTransform) {
            if (!shouldTransform)
              return resolve(file);
            var variants = [];
            if (query("GET_IMAGE_TRANSFORM_VARIANTS_INCLUDE_ORIGINAL")) {
              variants.push(function() {
                return new Promise(function(resolve2) {
                  resolve2({
                    name: query("GET_IMAGE_TRANSFORM_VARIANTS_ORIGINAL_NAME"),
                    file
                  });
                });
              });
            }
            if (query("GET_IMAGE_TRANSFORM_VARIANTS_INCLUDE_DEFAULT")) {
              variants.push(function(transform2, file2, metadata) {
                return new Promise(function(resolve2) {
                  transform2(file2, metadata).then(function(file3) {
                    return resolve2({
                      name: query("GET_IMAGE_TRANSFORM_VARIANTS_DEFAULT_NAME"),
                      file: file3
                    });
                  });
                });
              });
            }
            var variantsDefinition = query("GET_IMAGE_TRANSFORM_VARIANTS") || {};
            forin(variantsDefinition, function(key, fn) {
              var createVariant = createVariantCreator(fn);
              variants.push(function(transform2, file2, metadata) {
                return new Promise(function(resolve2) {
                  createVariant(transform2, file2, metadata).then(function(file3) {
                    return resolve2({name: key, file: file3});
                  });
                });
              });
            });
            var qualityAsPercentage = query("GET_IMAGE_TRANSFORM_OUTPUT_QUALITY");
            var qualityMode = query("GET_IMAGE_TRANSFORM_OUTPUT_QUALITY_MODE");
            var quality = qualityAsPercentage === null ? null : qualityAsPercentage / 100;
            var type = query("GET_IMAGE_TRANSFORM_OUTPUT_MIME_TYPE");
            var clientTransforms = query("GET_IMAGE_TRANSFORM_CLIENT_TRANSFORMS") || TRANSFORM_LIST;
            item.setMetadata("output", {
              type,
              quality,
              client: clientTransforms
            }, true);
            var transform = function transform2(file2, metadata) {
              return new Promise(function(resolve2, reject) {
                var filteredMetadata = Object.assign({}, metadata);
                Object.keys(filteredMetadata).filter(function(instruction) {
                  return instruction !== "exif";
                }).forEach(function(instruction) {
                  if (clientTransforms.indexOf(instruction) === -1) {
                    delete filteredMetadata[instruction];
                  }
                });
                var resize = filteredMetadata.resize, exif = filteredMetadata.exif, output = filteredMetadata.output, crop = filteredMetadata.crop, filter = filteredMetadata.filter, markup = filteredMetadata.markup;
                var instructions = {
                  image: {
                    orientation: exif ? exif.orientation : null
                  },
                  output: output && (output.type || typeof output.quality === "number" || output.background) ? {
                    type: output.type,
                    quality: typeof output.quality === "number" ? output.quality * 100 : null,
                    background: output.background || query("GET_IMAGE_TRANSFORM_CANVAS_BACKGROUND_COLOR") || null
                  } : void 0,
                  size: resize && (resize.size.width || resize.size.height) ? Object.assign({
                    mode: resize.mode,
                    upscale: resize.upscale
                  }, resize.size) : void 0,
                  crop: crop && !isDefaultCrop(crop) ? Object.assign({}, crop) : void 0,
                  markup: markup && markup.length ? markup.map(prepareMarkup) : [],
                  filter
                };
                if (instructions.output) {
                  var willChangeType = output.type ? output.type !== file2.type : false;
                  var canChangeQuality = /\/jpe?g$/.test(file2.type);
                  var willChangeQuality = output.quality !== null ? canChangeQuality && qualityMode === "always" : false;
                  var willModifyImageData = !!(instructions.size || instructions.crop || instructions.filter || willChangeType || willChangeQuality);
                  if (!willModifyImageData)
                    return resolve2(file2);
                }
                var options = {
                  beforeCreateBlob: query("GET_IMAGE_TRANSFORM_BEFORE_CREATE_BLOB"),
                  afterCreateBlob: query("GET_IMAGE_TRANSFORM_AFTER_CREATE_BLOB"),
                  canvasMemoryLimit: query("GET_IMAGE_TRANSFORM_CANVAS_MEMORY_LIMIT"),
                  stripImageHead: query("GET_IMAGE_TRANSFORM_OUTPUT_STRIP_IMAGE_HEAD")
                };
                transformImage(file2, instructions, options).then(function(blob) {
                  var out = getFileFromBlob(blob, renameFileToMatchMimeType(file2.name, getValidOutputMimeType(blob.type)));
                  resolve2(out);
                }).catch(reject);
              });
            };
            var variantPromises = variants.map(function(create) {
              return create(transform, file, item.getMetadata());
            });
            Promise.all(variantPromises).then(function(files) {
              resolve(files.length === 1 && files[0].name === null ? files[0].file : files);
            });
          });
        });
      });
      return {
        options: {
          allowImageTransform: [true, Type.BOOLEAN],
          imageTransformImageFilter: [null, Type.FUNCTION],
          imageTransformOutputMimeType: [null, Type.STRING],
          imageTransformOutputQuality: [null, Type.INT],
          imageTransformOutputStripImageHead: [true, Type.BOOLEAN],
          imageTransformClientTransforms: [null, Type.ARRAY],
          imageTransformOutputQualityMode: ["always", Type.STRING],
          imageTransformVariants: [null, Type.OBJECT],
          imageTransformVariantsIncludeDefault: [true, Type.BOOLEAN],
          imageTransformVariantsDefaultName: [null, Type.STRING],
          imageTransformVariantsIncludeOriginal: [false, Type.BOOLEAN],
          imageTransformVariantsOriginalName: ["original_", Type.STRING],
          imageTransformBeforeCreateBlob: [null, Type.FUNCTION],
          imageTransformAfterCreateBlob: [null, Type.FUNCTION],
          imageTransformCanvasMemoryLimit: [
            isBrowser && isIOS ? 4096 * 4096 : null,
            Type.INT
          ],
          imageTransformCanvasBackgroundColor: [null, Type.STRING]
        }
      };
    };
    if (isBrowser) {
      document.dispatchEvent(new CustomEvent("FilePond:pluginloaded", {detail: plugin}));
    }
    return plugin;
  });
});

// node_modules/filepond-plugin-media-preview/dist/filepond-plugin-media-preview.js
var require_filepond_plugin_media_preview = __commonJS((exports, module) => {
  /*!
   * FilePondPluginMediaPreview 1.0.11
   * Licensed under MIT, https://opensource.org/licenses/MIT/
   * Please visit undefined for details.
   */
  (function(global2, factory) {
    typeof exports === "object" && typeof module !== "undefined" ? module.exports = factory() : typeof define === "function" && define.amd ? define(factory) : (global2 = typeof globalThis !== "undefined" ? globalThis : global2 || self, global2.FilePondPluginMediaPreview = factory());
  })(exports, function() {
    "use strict";
    const isPreviewableVideo = (file) => /^video/.test(file.type);
    const isPreviewableAudio = (file) => /^audio/.test(file.type);
    "use strict";
    class AudioPlayer {
      constructor(mediaEl, audioElems) {
        this.mediaEl = mediaEl;
        this.audioElems = audioElems;
        this.onplayhead = false;
        this.duration = 0;
        this.timelineWidth = this.audioElems.timeline.offsetWidth - this.audioElems.playhead.offsetWidth;
        this.moveplayheadFn = this.moveplayhead.bind(this);
        this.registerListeners();
      }
      registerListeners() {
        this.mediaEl.addEventListener("timeupdate", this.timeUpdate.bind(this), false);
        this.mediaEl.addEventListener("canplaythrough", () => this.duration = this.mediaEl.duration, false);
        this.audioElems.timeline.addEventListener("click", this.timelineClicked.bind(this), false);
        this.audioElems.button.addEventListener("click", this.play.bind(this));
        this.audioElems.playhead.addEventListener("mousedown", this.mouseDown.bind(this), false);
        window.addEventListener("mouseup", this.mouseUp.bind(this), false);
      }
      play() {
        if (this.mediaEl.paused) {
          this.mediaEl.play();
        } else {
          this.mediaEl.pause();
        }
        this.audioElems.button.classList.toggle("play");
        this.audioElems.button.classList.toggle("pause");
      }
      timeUpdate() {
        let playPercent = this.mediaEl.currentTime / this.duration * 100;
        this.audioElems.playhead.style.marginLeft = playPercent + "%";
        if (this.mediaEl.currentTime === this.duration) {
          this.audioElems.button.classList.toggle("play");
          this.audioElems.button.classList.toggle("pause");
        }
      }
      moveplayhead(event) {
        let newMargLeft = event.clientX - this.getPosition(this.audioElems.timeline);
        if (newMargLeft >= 0 && newMargLeft <= this.timelineWidth) {
          this.audioElems.playhead.style.marginLeft = newMargLeft + "px";
        }
        if (newMargLeft < 0) {
          this.audioElems.playhead.style.marginLeft = "0px";
        }
        if (newMargLeft > this.timelineWidth) {
          this.audioElems.playhead.style.marginLeft = this.timelineWidth - 4 + "px";
        }
      }
      timelineClicked(event) {
        this.moveplayhead(event);
        this.mediaEl.currentTime = this.duration * this.clickPercent(event);
      }
      mouseDown() {
        this.onplayhead = true;
        window.addEventListener("mousemove", this.moveplayheadFn, true);
        this.mediaEl.removeEventListener("timeupdate", this.timeUpdate.bind(this), false);
      }
      mouseUp(event) {
        window.removeEventListener("mousemove", this.moveplayheadFn, true);
        if (this.onplayhead == true) {
          this.moveplayhead(event);
          this.mediaEl.currentTime = this.duration * this.clickPercent(event);
          this.mediaEl.addEventListener("timeupdate", this.timeUpdate.bind(this), false);
        }
        this.onplayhead = false;
      }
      clickPercent(event) {
        return (event.clientX - this.getPosition(this.audioElems.timeline)) / this.timelineWidth;
      }
      getPosition(el) {
        return el.getBoundingClientRect().left;
      }
    }
    const createMediaView = (_) => _.utils.createView({
      name: "media-preview",
      tag: "div",
      ignoreRect: true,
      create: ({root, props}) => {
        const {id} = props;
        const item = root.query("GET_ITEM", {
          id: props.id
        });
        let tagName = isPreviewableAudio(item.file) ? "audio" : "video";
        root.ref.media = document.createElement(tagName);
        root.ref.media.setAttribute("controls", true);
        root.element.appendChild(root.ref.media);
        if (isPreviewableAudio(item.file)) {
          let docfrag = document.createDocumentFragment();
          root.ref.audio = [];
          root.ref.audio.container = document.createElement("div"), root.ref.audio.button = document.createElement("span"), root.ref.audio.timeline = document.createElement("div"), root.ref.audio.playhead = document.createElement("div");
          root.ref.audio.container.className = "audioplayer";
          root.ref.audio.button.className = "playpausebtn play";
          root.ref.audio.timeline.className = "timeline";
          root.ref.audio.playhead.className = "playhead";
          root.ref.audio.timeline.appendChild(root.ref.audio.playhead);
          root.ref.audio.container.appendChild(root.ref.audio.button);
          root.ref.audio.container.appendChild(root.ref.audio.timeline);
          docfrag.appendChild(root.ref.audio.container);
          root.element.appendChild(docfrag);
        }
      },
      write: _.utils.createRoute({
        DID_MEDIA_PREVIEW_LOAD: ({root, props}) => {
          const {id} = props;
          const item = root.query("GET_ITEM", {
            id: props.id
          });
          if (!item)
            return;
          let URL2 = window.URL || window.webkitURL;
          let blob = new Blob([item.file], {
            type: item.file.type
          });
          root.ref.media.type = item.file.type;
          root.ref.media.src = item.file.mock && item.file.url || URL2.createObjectURL(blob);
          if (isPreviewableAudio(item.file)) {
            new AudioPlayer(root.ref.media, root.ref.audio);
          }
          root.ref.media.addEventListener("loadeddata", () => {
            let height = 75;
            if (isPreviewableVideo(item.file)) {
              let containerWidth = root.ref.media.offsetWidth;
              let factor = root.ref.media.videoWidth / containerWidth;
              height = root.ref.media.videoHeight / factor;
            }
            root.dispatch("DID_UPDATE_PANEL_HEIGHT", {
              id: props.id,
              height
            });
          }, false);
        }
      })
    });
    const createMediaWrapperView = (_) => {
      const didCreatePreviewContainer = ({root, props}) => {
        const {id} = props;
        const item = root.query("GET_ITEM", id);
        if (!item)
          return;
        root.dispatch("DID_MEDIA_PREVIEW_LOAD", {
          id
        });
      };
      const create = ({root, props}) => {
        const media = createMediaView(_);
        root.ref.media = root.appendChildView(root.createChildView(media, {
          id: props.id
        }));
      };
      return _.utils.createView({
        name: "media-preview-wrapper",
        create,
        write: _.utils.createRoute({
          DID_MEDIA_PREVIEW_CONTAINER_CREATE: didCreatePreviewContainer
        })
      });
    };
    const plugin = (fpAPI) => {
      const {addFilter, utils} = fpAPI;
      const {Type, createRoute} = utils;
      const mediaWrapperView = createMediaWrapperView(fpAPI);
      addFilter("CREATE_VIEW", (viewAPI) => {
        const {is, view, query} = viewAPI;
        if (!is("file")) {
          return;
        }
        const didLoadItem = ({root, props}) => {
          const {id} = props;
          const item = query("GET_ITEM", id);
          const allowVideoPreview = query("GET_ALLOW_VIDEO_PREVIEW");
          const allowAudioPreview = query("GET_ALLOW_AUDIO_PREVIEW");
          if (!item || item.archived || (!isPreviewableVideo(item.file) || !allowVideoPreview) && (!isPreviewableAudio(item.file) || !allowAudioPreview)) {
            return;
          }
          root.ref.mediaPreview = view.appendChildView(view.createChildView(mediaWrapperView, {
            id
          }));
          root.dispatch("DID_MEDIA_PREVIEW_CONTAINER_CREATE", {
            id
          });
        };
        view.registerWriter(createRoute({
          DID_LOAD_ITEM: didLoadItem
        }, ({root, props}) => {
          const {id} = props;
          const item = query("GET_ITEM", id);
          const allowVideoPreview = root.query("GET_ALLOW_VIDEO_PREVIEW");
          const allowAudioPreview = root.query("GET_ALLOW_AUDIO_PREVIEW");
          if (!item || (!isPreviewableVideo(item.file) || !allowVideoPreview) && (!isPreviewableAudio(item.file) || !allowAudioPreview) || root.rect.element.hidden)
            return;
        }));
      });
      return {
        options: {
          allowVideoPreview: [true, Type.BOOLEAN],
          allowAudioPreview: [true, Type.BOOLEAN]
        }
      };
    };
    const isBrowser = typeof window !== "undefined" && typeof window.document !== "undefined";
    if (isBrowser) {
      document.dispatchEvent(new CustomEvent("FilePond:pluginloaded", {
        detail: plugin
      }));
    }
    return plugin;
  });
});

// node_modules/@github/file-attachment-element/dist/index.umd.js
var require_index_umd = __commonJS((exports, module) => {
  (function(global2, factory) {
    typeof exports === "object" && typeof module !== "undefined" ? factory(exports) : typeof define === "function" && define.amd ? define(["exports"], factory) : (global2 = typeof globalThis !== "undefined" ? globalThis : global2 || self, factory(global2.FileAttachmentElement = {}));
  })(exports, function(exports2) {
    "use strict";
    class Attachment {
      constructor(file, directory) {
        this.file = file;
        this.directory = directory;
        this.state = "pending";
        this.id = null;
        this.href = null;
        this.name = null;
        this.percent = 0;
      }
      static traverse(transfer, directory) {
        return transferredFiles(transfer, directory);
      }
      static from(files) {
        const result = [];
        for (const file of files) {
          if (file instanceof File) {
            result.push(new Attachment(file));
          } else if (file instanceof Attachment) {
            result.push(file);
          } else {
            throw new Error("Unexpected type");
          }
        }
        return result;
      }
      get fullPath() {
        return this.directory ? `${this.directory}/${this.file.name}` : this.file.name;
      }
      isImage() {
        return ["image/gif", "image/png", "image/jpg", "image/jpeg"].indexOf(this.file.type) > -1;
      }
      saving(percent) {
        if (this.state !== "pending" && this.state !== "saving") {
          throw new Error(`Unexpected transition from ${this.state} to saving`);
        }
        this.state = "saving";
        this.percent = percent;
      }
      saved(attributes) {
        var _a, _b, _c;
        if (this.state !== "pending" && this.state !== "saving") {
          throw new Error(`Unexpected transition from ${this.state} to saved`);
        }
        this.state = "saved";
        this.id = (_a = attributes === null || attributes === void 0 ? void 0 : attributes.id) !== null && _a !== void 0 ? _a : null;
        this.href = (_b = attributes === null || attributes === void 0 ? void 0 : attributes.href) !== null && _b !== void 0 ? _b : null;
        this.name = (_c = attributes === null || attributes === void 0 ? void 0 : attributes.name) !== null && _c !== void 0 ? _c : null;
      }
      isPending() {
        return this.state === "pending";
      }
      isSaving() {
        return this.state === "saving";
      }
      isSaved() {
        return this.state === "saved";
      }
    }
    function transferredFiles(transfer, directory) {
      if (directory && isDirectory(transfer)) {
        return traverse("", roots(transfer));
      }
      return Promise.resolve(visible(Array.from(transfer.files || [])).map((f) => new Attachment(f)));
    }
    function hidden(file) {
      return file.name.startsWith(".");
    }
    function visible(files) {
      return Array.from(files).filter((file) => !hidden(file));
    }
    function getFile(entry) {
      return new Promise(function(resolve, reject) {
        entry.file(resolve, reject);
      });
    }
    function getEntries(entry) {
      return new Promise(function(resolve, reject) {
        const result = [];
        const reader = entry.createReader();
        const read = () => {
          reader.readEntries((entries) => {
            if (entries.length > 0) {
              result.push(...entries);
              read();
            } else {
              resolve(result);
            }
          }, reject);
        };
        read();
      });
    }
    async function traverse(path, entries) {
      const results = [];
      for (const entry of visible(entries)) {
        if (entry.isDirectory) {
          results.push(...await traverse(entry.fullPath, await getEntries(entry)));
        } else {
          const file = await getFile(entry);
          results.push(new Attachment(file, path));
        }
      }
      return results;
    }
    function isDirectory(transfer) {
      return transfer.items && Array.from(transfer.items).some((item) => {
        const entry = item.webkitGetAsEntry && item.webkitGetAsEntry();
        return entry && entry.isDirectory;
      });
    }
    function roots(transfer) {
      return Array.from(transfer.items).map((item) => item.webkitGetAsEntry()).filter((entry) => entry != null);
    }
    class FileAttachmentElement extends HTMLElement {
      connectedCallback() {
        this.addEventListener("dragenter", onDragenter);
        this.addEventListener("dragover", onDragenter);
        this.addEventListener("dragleave", onDragleave);
        this.addEventListener("drop", onDrop);
        this.addEventListener("paste", onPaste);
        this.addEventListener("change", onChange);
      }
      disconnectedCallback() {
        this.removeEventListener("dragenter", onDragenter);
        this.removeEventListener("dragover", onDragenter);
        this.removeEventListener("dragleave", onDragleave);
        this.removeEventListener("drop", onDrop);
        this.removeEventListener("paste", onPaste);
        this.removeEventListener("change", onChange);
      }
      get directory() {
        return this.hasAttribute("directory");
      }
      set directory(value) {
        if (value) {
          this.setAttribute("directory", "");
        } else {
          this.removeAttribute("directory");
        }
      }
      async attach(transferred) {
        const attachments = transferred instanceof DataTransfer ? await Attachment.traverse(transferred, this.directory) : Attachment.from(transferred);
        const accepted = this.dispatchEvent(new CustomEvent("file-attachment-accept", {
          bubbles: true,
          cancelable: true,
          detail: {attachments}
        }));
        if (accepted && attachments.length) {
          this.dispatchEvent(new CustomEvent("file-attachment-accepted", {
            bubbles: true,
            detail: {attachments}
          }));
        }
      }
    }
    function hasFile(transfer) {
      return Array.from(transfer.types).indexOf("Files") >= 0;
    }
    let dragging = null;
    function onDragenter(event) {
      const target = event.currentTarget;
      if (dragging) {
        clearTimeout(dragging);
      }
      dragging = window.setTimeout(() => target.removeAttribute("hover"), 200);
      const transfer = event.dataTransfer;
      if (!transfer || !hasFile(transfer))
        return;
      transfer.dropEffect = "copy";
      target.setAttribute("hover", "");
      event.stopPropagation();
      event.preventDefault();
    }
    function onDragleave(event) {
      if (event.dataTransfer) {
        event.dataTransfer.dropEffect = "none";
      }
      const target = event.currentTarget;
      target.removeAttribute("hover");
      event.stopPropagation();
      event.preventDefault();
    }
    function onDrop(event) {
      const container = event.currentTarget;
      if (!(container instanceof FileAttachmentElement))
        return;
      container.removeAttribute("hover");
      const transfer = event.dataTransfer;
      if (!transfer || !hasFile(transfer))
        return;
      container.attach(transfer);
      event.stopPropagation();
      event.preventDefault();
    }
    const images = /^image\/(gif|png|jpeg)$/;
    function pastedFile(items) {
      for (const item of items) {
        if (images.test(item.type)) {
          return item.getAsFile();
        }
      }
      return null;
    }
    function onPaste(event) {
      if (!event.clipboardData)
        return;
      if (!event.clipboardData.items)
        return;
      const container = event.currentTarget;
      if (!(container instanceof FileAttachmentElement))
        return;
      const file = pastedFile(event.clipboardData.items);
      if (!file)
        return;
      const files = [file];
      container.attach(files);
      event.preventDefault();
    }
    function onChange(event) {
      const container = event.currentTarget;
      if (!(container instanceof FileAttachmentElement))
        return;
      const input = event.target;
      if (!(input instanceof HTMLInputElement))
        return;
      const id = container.getAttribute("input");
      if (id && input.id !== id)
        return;
      const files = input.files;
      if (!files || files.length === 0)
        return;
      container.attach(files);
      input.value = "";
    }
    if (!window.customElements.get("file-attachment")) {
      window.FileAttachmentElement = FileAttachmentElement;
      window.customElements.define("file-attachment", FileAttachmentElement);
    }
    exports2.Attachment = Attachment;
    exports2.default = FileAttachmentElement;
    Object.defineProperty(exports2, "__esModule", {value: true});
  });
});

// node_modules/marked/lib/marked.cjs
var require_marked = __commonJS((exports) => {
  "use strict";
  Object.defineProperty(exports, "__esModule", {value: true});
  function _defineProperties(target, props) {
    for (var i = 0; i < props.length; i++) {
      var descriptor = props[i];
      descriptor.enumerable = descriptor.enumerable || false;
      descriptor.configurable = true;
      if ("value" in descriptor)
        descriptor.writable = true;
      Object.defineProperty(target, descriptor.key, descriptor);
    }
  }
  function _createClass(Constructor, protoProps, staticProps) {
    if (protoProps)
      _defineProperties(Constructor.prototype, protoProps);
    if (staticProps)
      _defineProperties(Constructor, staticProps);
    Object.defineProperty(Constructor, "prototype", {
      writable: false
    });
    return Constructor;
  }
  function _unsupportedIterableToArray(o, minLen) {
    if (!o)
      return;
    if (typeof o === "string")
      return _arrayLikeToArray(o, minLen);
    var n = Object.prototype.toString.call(o).slice(8, -1);
    if (n === "Object" && o.constructor)
      n = o.constructor.name;
    if (n === "Map" || n === "Set")
      return Array.from(o);
    if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))
      return _arrayLikeToArray(o, minLen);
  }
  function _arrayLikeToArray(arr, len) {
    if (len == null || len > arr.length)
      len = arr.length;
    for (var i = 0, arr2 = new Array(len); i < len; i++)
      arr2[i] = arr[i];
    return arr2;
  }
  function _createForOfIteratorHelperLoose(o, allowArrayLike) {
    var it = typeof Symbol !== "undefined" && o[Symbol.iterator] || o["@@iterator"];
    if (it)
      return (it = it.call(o)).next.bind(it);
    if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === "number") {
      if (it)
        o = it;
      var i = 0;
      return function() {
        if (i >= o.length)
          return {
            done: true
          };
        return {
          done: false,
          value: o[i++]
        };
      };
    }
    throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");
  }
  function getDefaults() {
    return {
      baseUrl: null,
      breaks: false,
      extensions: null,
      gfm: true,
      headerIds: true,
      headerPrefix: "",
      highlight: null,
      langPrefix: "language-",
      mangle: true,
      pedantic: false,
      renderer: null,
      sanitize: false,
      sanitizer: null,
      silent: false,
      smartLists: false,
      smartypants: false,
      tokenizer: null,
      walkTokens: null,
      xhtml: false
    };
  }
  exports.defaults = getDefaults();
  function changeDefaults(newDefaults) {
    exports.defaults = newDefaults;
  }
  var escapeTest = /[&<>"']/;
  var escapeReplace = /[&<>"']/g;
  var escapeTestNoEncode = /[<>"']|&(?!#?\w+;)/;
  var escapeReplaceNoEncode = /[<>"']|&(?!#?\w+;)/g;
  var escapeReplacements = {
    "&": "&amp;",
    "<": "&lt;",
    ">": "&gt;",
    '"': "&quot;",
    "'": "&#39;"
  };
  var getEscapeReplacement = function getEscapeReplacement2(ch) {
    return escapeReplacements[ch];
  };
  function escape(html, encode) {
    if (encode) {
      if (escapeTest.test(html)) {
        return html.replace(escapeReplace, getEscapeReplacement);
      }
    } else {
      if (escapeTestNoEncode.test(html)) {
        return html.replace(escapeReplaceNoEncode, getEscapeReplacement);
      }
    }
    return html;
  }
  var unescapeTest = /&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig;
  function unescape2(html) {
    return html.replace(unescapeTest, function(_, n) {
      n = n.toLowerCase();
      if (n === "colon")
        return ":";
      if (n.charAt(0) === "#") {
        return n.charAt(1) === "x" ? String.fromCharCode(parseInt(n.substring(2), 16)) : String.fromCharCode(+n.substring(1));
      }
      return "";
    });
  }
  var caret = /(^|[^\[])\^/g;
  function edit(regex, opt) {
    regex = typeof regex === "string" ? regex : regex.source;
    opt = opt || "";
    var obj = {
      replace: function replace(name, val) {
        val = val.source || val;
        val = val.replace(caret, "$1");
        regex = regex.replace(name, val);
        return obj;
      },
      getRegex: function getRegex() {
        return new RegExp(regex, opt);
      }
    };
    return obj;
  }
  var nonWordAndColonTest = /[^\w:]/g;
  var originIndependentUrl = /^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;
  function cleanUrl(sanitize, base, href) {
    if (sanitize) {
      var prot;
      try {
        prot = decodeURIComponent(unescape2(href)).replace(nonWordAndColonTest, "").toLowerCase();
      } catch (e) {
        return null;
      }
      if (prot.indexOf("javascript:") === 0 || prot.indexOf("vbscript:") === 0 || prot.indexOf("data:") === 0) {
        return null;
      }
    }
    if (base && !originIndependentUrl.test(href)) {
      href = resolveUrl(base, href);
    }
    try {
      href = encodeURI(href).replace(/%25/g, "%");
    } catch (e) {
      return null;
    }
    return href;
  }
  var baseUrls = {};
  var justDomain = /^[^:]+:\/*[^/]*$/;
  var protocol = /^([^:]+:)[\s\S]*$/;
  var domain = /^([^:]+:\/*[^/]*)[\s\S]*$/;
  function resolveUrl(base, href) {
    if (!baseUrls[" " + base]) {
      if (justDomain.test(base)) {
        baseUrls[" " + base] = base + "/";
      } else {
        baseUrls[" " + base] = rtrim(base, "/", true);
      }
    }
    base = baseUrls[" " + base];
    var relativeBase = base.indexOf(":") === -1;
    if (href.substring(0, 2) === "//") {
      if (relativeBase) {
        return href;
      }
      return base.replace(protocol, "$1") + href;
    } else if (href.charAt(0) === "/") {
      if (relativeBase) {
        return href;
      }
      return base.replace(domain, "$1") + href;
    } else {
      return base + href;
    }
  }
  var noopTest = {
    exec: function noopTest2() {
    }
  };
  function merge(obj) {
    var i = 1, target, key;
    for (; i < arguments.length; i++) {
      target = arguments[i];
      for (key in target) {
        if (Object.prototype.hasOwnProperty.call(target, key)) {
          obj[key] = target[key];
        }
      }
    }
    return obj;
  }
  function splitCells(tableRow, count) {
    var row = tableRow.replace(/\|/g, function(match, offset, str) {
      var escaped = false, curr = offset;
      while (--curr >= 0 && str[curr] === "\\") {
        escaped = !escaped;
      }
      if (escaped) {
        return "|";
      } else {
        return " |";
      }
    }), cells = row.split(/ \|/);
    var i = 0;
    if (!cells[0].trim()) {
      cells.shift();
    }
    if (cells.length > 0 && !cells[cells.length - 1].trim()) {
      cells.pop();
    }
    if (cells.length > count) {
      cells.splice(count);
    } else {
      while (cells.length < count) {
        cells.push("");
      }
    }
    for (; i < cells.length; i++) {
      cells[i] = cells[i].trim().replace(/\\\|/g, "|");
    }
    return cells;
  }
  function rtrim(str, c, invert) {
    var l = str.length;
    if (l === 0) {
      return "";
    }
    var suffLen = 0;
    while (suffLen < l) {
      var currChar = str.charAt(l - suffLen - 1);
      if (currChar === c && !invert) {
        suffLen++;
      } else if (currChar !== c && invert) {
        suffLen++;
      } else {
        break;
      }
    }
    return str.slice(0, l - suffLen);
  }
  function findClosingBracket(str, b) {
    if (str.indexOf(b[1]) === -1) {
      return -1;
    }
    var l = str.length;
    var level = 0, i = 0;
    for (; i < l; i++) {
      if (str[i] === "\\") {
        i++;
      } else if (str[i] === b[0]) {
        level++;
      } else if (str[i] === b[1]) {
        level--;
        if (level < 0) {
          return i;
        }
      }
    }
    return -1;
  }
  function checkSanitizeDeprecation(opt) {
    if (opt && opt.sanitize && !opt.silent) {
      console.warn("marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options");
    }
  }
  function repeatString(pattern, count) {
    if (count < 1) {
      return "";
    }
    var result = "";
    while (count > 1) {
      if (count & 1) {
        result += pattern;
      }
      count >>= 1;
      pattern += pattern;
    }
    return result + pattern;
  }
  function outputLink(cap, link, raw, lexer2) {
    var href = link.href;
    var title = link.title ? escape(link.title) : null;
    var text = cap[1].replace(/\\([\[\]])/g, "$1");
    if (cap[0].charAt(0) !== "!") {
      lexer2.state.inLink = true;
      var token = {
        type: "link",
        raw,
        href,
        title,
        text,
        tokens: lexer2.inlineTokens(text, [])
      };
      lexer2.state.inLink = false;
      return token;
    }
    return {
      type: "image",
      raw,
      href,
      title,
      text: escape(text)
    };
  }
  function indentCodeCompensation(raw, text) {
    var matchIndentToCode = raw.match(/^(\s+)(?:```)/);
    if (matchIndentToCode === null) {
      return text;
    }
    var indentToCode = matchIndentToCode[1];
    return text.split("\n").map(function(node) {
      var matchIndentInNode = node.match(/^\s+/);
      if (matchIndentInNode === null) {
        return node;
      }
      var indentInNode = matchIndentInNode[0];
      if (indentInNode.length >= indentToCode.length) {
        return node.slice(indentToCode.length);
      }
      return node;
    }).join("\n");
  }
  var Tokenizer = /* @__PURE__ */ function() {
    function Tokenizer2(options2) {
      this.options = options2 || exports.defaults;
    }
    var _proto = Tokenizer2.prototype;
    _proto.space = function space(src) {
      var cap = this.rules.block.newline.exec(src);
      if (cap && cap[0].length > 0) {
        return {
          type: "space",
          raw: cap[0]
        };
      }
    };
    _proto.code = function code(src) {
      var cap = this.rules.block.code.exec(src);
      if (cap) {
        var text = cap[0].replace(/^ {1,4}/gm, "");
        return {
          type: "code",
          raw: cap[0],
          codeBlockStyle: "indented",
          text: !this.options.pedantic ? rtrim(text, "\n") : text
        };
      }
    };
    _proto.fences = function fences(src) {
      var cap = this.rules.block.fences.exec(src);
      if (cap) {
        var raw = cap[0];
        var text = indentCodeCompensation(raw, cap[3] || "");
        return {
          type: "code",
          raw,
          lang: cap[2] ? cap[2].trim() : cap[2],
          text
        };
      }
    };
    _proto.heading = function heading(src) {
      var cap = this.rules.block.heading.exec(src);
      if (cap) {
        var text = cap[2].trim();
        if (/#$/.test(text)) {
          var trimmed = rtrim(text, "#");
          if (this.options.pedantic) {
            text = trimmed.trim();
          } else if (!trimmed || / $/.test(trimmed)) {
            text = trimmed.trim();
          }
        }
        var token = {
          type: "heading",
          raw: cap[0],
          depth: cap[1].length,
          text,
          tokens: []
        };
        this.lexer.inline(token.text, token.tokens);
        return token;
      }
    };
    _proto.hr = function hr(src) {
      var cap = this.rules.block.hr.exec(src);
      if (cap) {
        return {
          type: "hr",
          raw: cap[0]
        };
      }
    };
    _proto.blockquote = function blockquote(src) {
      var cap = this.rules.block.blockquote.exec(src);
      if (cap) {
        var text = cap[0].replace(/^ *>[ \t]?/gm, "");
        return {
          type: "blockquote",
          raw: cap[0],
          tokens: this.lexer.blockTokens(text, []),
          text
        };
      }
    };
    _proto.list = function list(src) {
      var cap = this.rules.block.list.exec(src);
      if (cap) {
        var raw, istask, ischecked, indent, i, blankLine, endsWithBlankLine, line, nextLine, rawLine, itemContents, endEarly;
        var bull = cap[1].trim();
        var isordered = bull.length > 1;
        var list2 = {
          type: "list",
          raw: "",
          ordered: isordered,
          start: isordered ? +bull.slice(0, -1) : "",
          loose: false,
          items: []
        };
        bull = isordered ? "\\d{1,9}\\" + bull.slice(-1) : "\\" + bull;
        if (this.options.pedantic) {
          bull = isordered ? bull : "[*+-]";
        }
        var itemRegex = new RegExp("^( {0,3}" + bull + ")((?:[	 ][^\\n]*)?(?:\\n|$))");
        while (src) {
          endEarly = false;
          if (!(cap = itemRegex.exec(src))) {
            break;
          }
          if (this.rules.block.hr.test(src)) {
            break;
          }
          raw = cap[0];
          src = src.substring(raw.length);
          line = cap[2].split("\n", 1)[0];
          nextLine = src.split("\n", 1)[0];
          if (this.options.pedantic) {
            indent = 2;
            itemContents = line.trimLeft();
          } else {
            indent = cap[2].search(/[^ ]/);
            indent = indent > 4 ? 1 : indent;
            itemContents = line.slice(indent);
            indent += cap[1].length;
          }
          blankLine = false;
          if (!line && /^ *$/.test(nextLine)) {
            raw += nextLine + "\n";
            src = src.substring(nextLine.length + 1);
            endEarly = true;
          }
          if (!endEarly) {
            var nextBulletRegex = new RegExp("^ {0," + Math.min(3, indent - 1) + "}(?:[*+-]|\\d{1,9}[.)])((?: [^\\n]*)?(?:\\n|$))");
            var hrRegex = new RegExp("^ {0," + Math.min(3, indent - 1) + "}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)");
            while (src) {
              rawLine = src.split("\n", 1)[0];
              line = rawLine;
              if (this.options.pedantic) {
                line = line.replace(/^ {1,4}(?=( {4})*[^ ])/g, "  ");
              }
              if (nextBulletRegex.test(line)) {
                break;
              }
              if (hrRegex.test(src)) {
                break;
              }
              if (line.search(/[^ ]/) >= indent || !line.trim()) {
                itemContents += "\n" + line.slice(indent);
              } else if (!blankLine) {
                itemContents += "\n" + line;
              } else {
                break;
              }
              if (!blankLine && !line.trim()) {
                blankLine = true;
              }
              raw += rawLine + "\n";
              src = src.substring(rawLine.length + 1);
            }
          }
          if (!list2.loose) {
            if (endsWithBlankLine) {
              list2.loose = true;
            } else if (/\n *\n *$/.test(raw)) {
              endsWithBlankLine = true;
            }
          }
          if (this.options.gfm) {
            istask = /^\[[ xX]\] /.exec(itemContents);
            if (istask) {
              ischecked = istask[0] !== "[ ] ";
              itemContents = itemContents.replace(/^\[[ xX]\] +/, "");
            }
          }
          list2.items.push({
            type: "list_item",
            raw,
            task: !!istask,
            checked: ischecked,
            loose: false,
            text: itemContents
          });
          list2.raw += raw;
        }
        list2.items[list2.items.length - 1].raw = raw.trimRight();
        list2.items[list2.items.length - 1].text = itemContents.trimRight();
        list2.raw = list2.raw.trimRight();
        var l = list2.items.length;
        for (i = 0; i < l; i++) {
          this.lexer.state.top = false;
          list2.items[i].tokens = this.lexer.blockTokens(list2.items[i].text, []);
          var spacers = list2.items[i].tokens.filter(function(t) {
            return t.type === "space";
          });
          var hasMultipleLineBreaks = spacers.every(function(t) {
            var chars = t.raw.split("");
            var lineBreaks = 0;
            for (var _iterator = _createForOfIteratorHelperLoose(chars), _step; !(_step = _iterator()).done; ) {
              var _char = _step.value;
              if (_char === "\n") {
                lineBreaks += 1;
              }
              if (lineBreaks > 1) {
                return true;
              }
            }
            return false;
          });
          if (!list2.loose && spacers.length && hasMultipleLineBreaks) {
            list2.loose = true;
            list2.items[i].loose = true;
          }
        }
        return list2;
      }
    };
    _proto.html = function html(src) {
      var cap = this.rules.block.html.exec(src);
      if (cap) {
        var token = {
          type: "html",
          raw: cap[0],
          pre: !this.options.sanitizer && (cap[1] === "pre" || cap[1] === "script" || cap[1] === "style"),
          text: cap[0]
        };
        if (this.options.sanitize) {
          token.type = "paragraph";
          token.text = this.options.sanitizer ? this.options.sanitizer(cap[0]) : escape(cap[0]);
          token.tokens = [];
          this.lexer.inline(token.text, token.tokens);
        }
        return token;
      }
    };
    _proto.def = function def(src) {
      var cap = this.rules.block.def.exec(src);
      if (cap) {
        if (cap[3])
          cap[3] = cap[3].substring(1, cap[3].length - 1);
        var tag = cap[1].toLowerCase().replace(/\s+/g, " ");
        return {
          type: "def",
          tag,
          raw: cap[0],
          href: cap[2],
          title: cap[3]
        };
      }
    };
    _proto.table = function table(src) {
      var cap = this.rules.block.table.exec(src);
      if (cap) {
        var item = {
          type: "table",
          header: splitCells(cap[1]).map(function(c) {
            return {
              text: c
            };
          }),
          align: cap[2].replace(/^ *|\| *$/g, "").split(/ *\| */),
          rows: cap[3] && cap[3].trim() ? cap[3].replace(/\n[ \t]*$/, "").split("\n") : []
        };
        if (item.header.length === item.align.length) {
          item.raw = cap[0];
          var l = item.align.length;
          var i, j, k, row;
          for (i = 0; i < l; i++) {
            if (/^ *-+: *$/.test(item.align[i])) {
              item.align[i] = "right";
            } else if (/^ *:-+: *$/.test(item.align[i])) {
              item.align[i] = "center";
            } else if (/^ *:-+ *$/.test(item.align[i])) {
              item.align[i] = "left";
            } else {
              item.align[i] = null;
            }
          }
          l = item.rows.length;
          for (i = 0; i < l; i++) {
            item.rows[i] = splitCells(item.rows[i], item.header.length).map(function(c) {
              return {
                text: c
              };
            });
          }
          l = item.header.length;
          for (j = 0; j < l; j++) {
            item.header[j].tokens = [];
            this.lexer.inlineTokens(item.header[j].text, item.header[j].tokens);
          }
          l = item.rows.length;
          for (j = 0; j < l; j++) {
            row = item.rows[j];
            for (k = 0; k < row.length; k++) {
              row[k].tokens = [];
              this.lexer.inlineTokens(row[k].text, row[k].tokens);
            }
          }
          return item;
        }
      }
    };
    _proto.lheading = function lheading(src) {
      var cap = this.rules.block.lheading.exec(src);
      if (cap) {
        var token = {
          type: "heading",
          raw: cap[0],
          depth: cap[2].charAt(0) === "=" ? 1 : 2,
          text: cap[1],
          tokens: []
        };
        this.lexer.inline(token.text, token.tokens);
        return token;
      }
    };
    _proto.paragraph = function paragraph(src) {
      var cap = this.rules.block.paragraph.exec(src);
      if (cap) {
        var token = {
          type: "paragraph",
          raw: cap[0],
          text: cap[1].charAt(cap[1].length - 1) === "\n" ? cap[1].slice(0, -1) : cap[1],
          tokens: []
        };
        this.lexer.inline(token.text, token.tokens);
        return token;
      }
    };
    _proto.text = function text(src) {
      var cap = this.rules.block.text.exec(src);
      if (cap) {
        var token = {
          type: "text",
          raw: cap[0],
          text: cap[0],
          tokens: []
        };
        this.lexer.inline(token.text, token.tokens);
        return token;
      }
    };
    _proto.escape = function escape$1(src) {
      var cap = this.rules.inline.escape.exec(src);
      if (cap) {
        return {
          type: "escape",
          raw: cap[0],
          text: escape(cap[1])
        };
      }
    };
    _proto.tag = function tag(src) {
      var cap = this.rules.inline.tag.exec(src);
      if (cap) {
        if (!this.lexer.state.inLink && /^<a /i.test(cap[0])) {
          this.lexer.state.inLink = true;
        } else if (this.lexer.state.inLink && /^<\/a>/i.test(cap[0])) {
          this.lexer.state.inLink = false;
        }
        if (!this.lexer.state.inRawBlock && /^<(pre|code|kbd|script)(\s|>)/i.test(cap[0])) {
          this.lexer.state.inRawBlock = true;
        } else if (this.lexer.state.inRawBlock && /^<\/(pre|code|kbd|script)(\s|>)/i.test(cap[0])) {
          this.lexer.state.inRawBlock = false;
        }
        return {
          type: this.options.sanitize ? "text" : "html",
          raw: cap[0],
          inLink: this.lexer.state.inLink,
          inRawBlock: this.lexer.state.inRawBlock,
          text: this.options.sanitize ? this.options.sanitizer ? this.options.sanitizer(cap[0]) : escape(cap[0]) : cap[0]
        };
      }
    };
    _proto.link = function link(src) {
      var cap = this.rules.inline.link.exec(src);
      if (cap) {
        var trimmedUrl = cap[2].trim();
        if (!this.options.pedantic && /^</.test(trimmedUrl)) {
          if (!/>$/.test(trimmedUrl)) {
            return;
          }
          var rtrimSlash = rtrim(trimmedUrl.slice(0, -1), "\\");
          if ((trimmedUrl.length - rtrimSlash.length) % 2 === 0) {
            return;
          }
        } else {
          var lastParenIndex = findClosingBracket(cap[2], "()");
          if (lastParenIndex > -1) {
            var start = cap[0].indexOf("!") === 0 ? 5 : 4;
            var linkLen = start + cap[1].length + lastParenIndex;
            cap[2] = cap[2].substring(0, lastParenIndex);
            cap[0] = cap[0].substring(0, linkLen).trim();
            cap[3] = "";
          }
        }
        var href = cap[2];
        var title = "";
        if (this.options.pedantic) {
          var link2 = /^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(href);
          if (link2) {
            href = link2[1];
            title = link2[3];
          }
        } else {
          title = cap[3] ? cap[3].slice(1, -1) : "";
        }
        href = href.trim();
        if (/^</.test(href)) {
          if (this.options.pedantic && !/>$/.test(trimmedUrl)) {
            href = href.slice(1);
          } else {
            href = href.slice(1, -1);
          }
        }
        return outputLink(cap, {
          href: href ? href.replace(this.rules.inline._escapes, "$1") : href,
          title: title ? title.replace(this.rules.inline._escapes, "$1") : title
        }, cap[0], this.lexer);
      }
    };
    _proto.reflink = function reflink(src, links) {
      var cap;
      if ((cap = this.rules.inline.reflink.exec(src)) || (cap = this.rules.inline.nolink.exec(src))) {
        var link = (cap[2] || cap[1]).replace(/\s+/g, " ");
        link = links[link.toLowerCase()];
        if (!link || !link.href) {
          var text = cap[0].charAt(0);
          return {
            type: "text",
            raw: text,
            text
          };
        }
        return outputLink(cap, link, cap[0], this.lexer);
      }
    };
    _proto.emStrong = function emStrong(src, maskedSrc, prevChar) {
      if (prevChar === void 0) {
        prevChar = "";
      }
      var match = this.rules.inline.emStrong.lDelim.exec(src);
      if (!match)
        return;
      if (match[3] && prevChar.match(/(?:[0-9A-Za-z\xAA\xB2\xB3\xB5\xB9\xBA\xBC-\xBE\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u0660-\u0669\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07C0-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0966-\u096F\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09E6-\u09F1\u09F4-\u09F9\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A66-\u0A6F\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AE6-\u0AEF\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B66-\u0B6F\u0B71-\u0B77\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0BE6-\u0BF2\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C66-\u0C6F\u0C78-\u0C7E\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CE6-\u0CEF\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D58-\u0D61\u0D66-\u0D78\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DE6-\u0DEF\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F20-\u0F33\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F-\u1049\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u1090-\u1099\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1369-\u137C\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u17E0-\u17E9\u17F0-\u17F9\u1810-\u1819\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u1A00-\u1A16\u1A20-\u1A54\u1A80-\u1A89\u1A90-\u1A99\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B50-\u1B59\u1B83-\u1BA0\u1BAE-\u1BE5\u1C00-\u1C23\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2070\u2071\u2074-\u2079\u207F-\u2089\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2150-\u2189\u2460-\u249B\u24EA-\u24FF\u2776-\u2793\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2CFD\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u3192-\u3195\u31A0-\u31BF\u31F0-\u31FF\u3220-\u3229\u3248-\u324F\u3251-\u325F\u3280-\u3289\u32B1-\u32BF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CA\uA7D0\uA7D1\uA7D3\uA7D5-\uA7D9\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA830-\uA835\uA840-\uA873\uA882-\uA8B3\uA8D0-\uA8D9\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA900-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF-\uA9D9\uA9E0-\uA9E4\uA9E6-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA50-\uAA59\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD07-\uDD33\uDD40-\uDD78\uDD8A\uDD8B\uDE80-\uDE9C\uDEA0-\uDED0\uDEE1-\uDEFB\uDF00-\uDF23\uDF2D-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC58-\uDC76\uDC79-\uDC9E\uDCA7-\uDCAF\uDCE0-\uDCF2\uDCF4\uDCF5\uDCFB-\uDD1B\uDD20-\uDD39\uDD80-\uDDB7\uDDBC-\uDDCF\uDDD2-\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE40-\uDE48\uDE60-\uDE7E\uDE80-\uDE9F\uDEC0-\uDEC7\uDEC9-\uDEE4\uDEEB-\uDEEF\uDF00-\uDF35\uDF40-\uDF55\uDF58-\uDF72\uDF78-\uDF91\uDFA9-\uDFAF]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDCFA-\uDD23\uDD30-\uDD39\uDE60-\uDE7E\uDE80-\uDEA9\uDEB0\uDEB1\uDF00-\uDF27\uDF30-\uDF45\uDF51-\uDF54\uDF70-\uDF81\uDFB0-\uDFCB\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC52-\uDC6F\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD03-\uDD26\uDD36-\uDD3F\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDD0-\uDDDA\uDDDC\uDDE1-\uDDF4\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDEF0-\uDEF9\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC50-\uDC59\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE50-\uDE59\uDE80-\uDEAA\uDEB8\uDEC0-\uDEC9\uDF00-\uDF1A\uDF30-\uDF3B\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCF2\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDD50-\uDD59\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC50-\uDC6C\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD50-\uDD59\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDDA0-\uDDA9\uDEE0-\uDEF2\uDFB0\uDFC0-\uDFD4]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDE70-\uDEBE\uDEC0-\uDEC9\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF50-\uDF59\uDF5B-\uDF61\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE96\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD50-\uDD52\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD834[\uDEE0-\uDEF3\uDF60-\uDF78]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD837[\uDF00-\uDF1E]|\uD838[\uDD00-\uDD2C\uDD37-\uDD3D\uDD40-\uDD49\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB\uDEF0-\uDEF9]|\uD839[\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDCC7-\uDCCF\uDD00-\uDD43\uDD4B\uDD50-\uDD59]|\uD83B[\uDC71-\uDCAB\uDCAD-\uDCAF\uDCB1-\uDCB4\uDD01-\uDD2D\uDD2F-\uDD3D\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD83C[\uDD00-\uDD0C]|\uD83E[\uDFF0-\uDFF9]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF38\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A])/))
        return;
      var nextChar = match[1] || match[2] || "";
      if (!nextChar || nextChar && (prevChar === "" || this.rules.inline.punctuation.exec(prevChar))) {
        var lLength = match[0].length - 1;
        var rDelim, rLength, delimTotal = lLength, midDelimTotal = 0;
        var endReg = match[0][0] === "*" ? this.rules.inline.emStrong.rDelimAst : this.rules.inline.emStrong.rDelimUnd;
        endReg.lastIndex = 0;
        maskedSrc = maskedSrc.slice(-1 * src.length + lLength);
        while ((match = endReg.exec(maskedSrc)) != null) {
          rDelim = match[1] || match[2] || match[3] || match[4] || match[5] || match[6];
          if (!rDelim)
            continue;
          rLength = rDelim.length;
          if (match[3] || match[4]) {
            delimTotal += rLength;
            continue;
          } else if (match[5] || match[6]) {
            if (lLength % 3 && !((lLength + rLength) % 3)) {
              midDelimTotal += rLength;
              continue;
            }
          }
          delimTotal -= rLength;
          if (delimTotal > 0)
            continue;
          rLength = Math.min(rLength, rLength + delimTotal + midDelimTotal);
          if (Math.min(lLength, rLength) % 2) {
            var _text = src.slice(1, lLength + match.index + rLength);
            return {
              type: "em",
              raw: src.slice(0, lLength + match.index + rLength + 1),
              text: _text,
              tokens: this.lexer.inlineTokens(_text, [])
            };
          }
          var text = src.slice(2, lLength + match.index + rLength - 1);
          return {
            type: "strong",
            raw: src.slice(0, lLength + match.index + rLength + 1),
            text,
            tokens: this.lexer.inlineTokens(text, [])
          };
        }
      }
    };
    _proto.codespan = function codespan(src) {
      var cap = this.rules.inline.code.exec(src);
      if (cap) {
        var text = cap[2].replace(/\n/g, " ");
        var hasNonSpaceChars = /[^ ]/.test(text);
        var hasSpaceCharsOnBothEnds = /^ /.test(text) && / $/.test(text);
        if (hasNonSpaceChars && hasSpaceCharsOnBothEnds) {
          text = text.substring(1, text.length - 1);
        }
        text = escape(text, true);
        return {
          type: "codespan",
          raw: cap[0],
          text
        };
      }
    };
    _proto.br = function br(src) {
      var cap = this.rules.inline.br.exec(src);
      if (cap) {
        return {
          type: "br",
          raw: cap[0]
        };
      }
    };
    _proto.del = function del(src) {
      var cap = this.rules.inline.del.exec(src);
      if (cap) {
        return {
          type: "del",
          raw: cap[0],
          text: cap[2],
          tokens: this.lexer.inlineTokens(cap[2], [])
        };
      }
    };
    _proto.autolink = function autolink(src, mangle2) {
      var cap = this.rules.inline.autolink.exec(src);
      if (cap) {
        var text, href;
        if (cap[2] === "@") {
          text = escape(this.options.mangle ? mangle2(cap[1]) : cap[1]);
          href = "mailto:" + text;
        } else {
          text = escape(cap[1]);
          href = text;
        }
        return {
          type: "link",
          raw: cap[0],
          text,
          href,
          tokens: [{
            type: "text",
            raw: text,
            text
          }]
        };
      }
    };
    _proto.url = function url(src, mangle2) {
      var cap;
      if (cap = this.rules.inline.url.exec(src)) {
        var text, href;
        if (cap[2] === "@") {
          text = escape(this.options.mangle ? mangle2(cap[0]) : cap[0]);
          href = "mailto:" + text;
        } else {
          var prevCapZero;
          do {
            prevCapZero = cap[0];
            cap[0] = this.rules.inline._backpedal.exec(cap[0])[0];
          } while (prevCapZero !== cap[0]);
          text = escape(cap[0]);
          if (cap[1] === "www.") {
            href = "http://" + text;
          } else {
            href = text;
          }
        }
        return {
          type: "link",
          raw: cap[0],
          text,
          href,
          tokens: [{
            type: "text",
            raw: text,
            text
          }]
        };
      }
    };
    _proto.inlineText = function inlineText(src, smartypants2) {
      var cap = this.rules.inline.text.exec(src);
      if (cap) {
        var text;
        if (this.lexer.state.inRawBlock) {
          text = this.options.sanitize ? this.options.sanitizer ? this.options.sanitizer(cap[0]) : escape(cap[0]) : cap[0];
        } else {
          text = escape(this.options.smartypants ? smartypants2(cap[0]) : cap[0]);
        }
        return {
          type: "text",
          raw: cap[0],
          text
        };
      }
    };
    return Tokenizer2;
  }();
  var block = {
    newline: /^(?: *(?:\n|$))+/,
    code: /^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,
    fences: /^ {0,3}(`{3,}(?=[^`\n]*\n)|~{3,})([^\n]*)\n(?:|([\s\S]*?)\n)(?: {0,3}\1[~`]* *(?=\n|$)|$)/,
    hr: /^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,
    heading: /^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,
    blockquote: /^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,
    list: /^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/,
    html: "^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))",
    def: /^ {0,3}\[(label)\]: *(?:\n *)?<?([^\s>]+)>?(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/,
    table: noopTest,
    lheading: /^([^\n]+)\n {0,3}(=+|-+) *(?:\n+|$)/,
    _paragraph: /^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,
    text: /^[^\n]+/
  };
  block._label = /(?!\s*\])(?:\\.|[^\[\]\\])+/;
  block._title = /(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/;
  block.def = edit(block.def).replace("label", block._label).replace("title", block._title).getRegex();
  block.bullet = /(?:[*+-]|\d{1,9}[.)])/;
  block.listItemStart = edit(/^( *)(bull) */).replace("bull", block.bullet).getRegex();
  block.list = edit(block.list).replace(/bull/g, block.bullet).replace("hr", "\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def", "\\n+(?=" + block.def.source + ")").getRegex();
  block._tag = "address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul";
  block._comment = /<!--(?!-?>)[\s\S]*?(?:-->|$)/;
  block.html = edit(block.html, "i").replace("comment", block._comment).replace("tag", block._tag).replace("attribute", / +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex();
  block.paragraph = edit(block._paragraph).replace("hr", block.hr).replace("heading", " {0,3}#{1,6} ").replace("|lheading", "").replace("|table", "").replace("blockquote", " {0,3}>").replace("fences", " {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list", " {0,3}(?:[*+-]|1[.)]) ").replace("html", "</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag", block._tag).getRegex();
  block.blockquote = edit(block.blockquote).replace("paragraph", block.paragraph).getRegex();
  block.normal = merge({}, block);
  block.gfm = merge({}, block.normal, {
    table: "^ *([^\\n ].*\\|.*)\\n {0,3}(?:\\| *)?(:?-+:? *(?:\\| *:?-+:? *)*)(?:\\| *)?(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)"
  });
  block.gfm.table = edit(block.gfm.table).replace("hr", block.hr).replace("heading", " {0,3}#{1,6} ").replace("blockquote", " {0,3}>").replace("code", " {4}[^\\n]").replace("fences", " {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list", " {0,3}(?:[*+-]|1[.)]) ").replace("html", "</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag", block._tag).getRegex();
  block.gfm.paragraph = edit(block._paragraph).replace("hr", block.hr).replace("heading", " {0,3}#{1,6} ").replace("|lheading", "").replace("table", block.gfm.table).replace("blockquote", " {0,3}>").replace("fences", " {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list", " {0,3}(?:[*+-]|1[.)]) ").replace("html", "</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag", block._tag).getRegex();
  block.pedantic = merge({}, block.normal, {
    html: edit(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment", block._comment).replace(/tag/g, "(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),
    def: /^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,
    heading: /^(#{1,6})(.*)(?:\n+|$)/,
    fences: noopTest,
    paragraph: edit(block.normal._paragraph).replace("hr", block.hr).replace("heading", " *#{1,6} *[^\n]").replace("lheading", block.lheading).replace("blockquote", " {0,3}>").replace("|fences", "").replace("|list", "").replace("|html", "").getRegex()
  });
  var inline = {
    escape: /^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,
    autolink: /^<(scheme:[^\s\x00-\x1f<>]*|email)>/,
    url: noopTest,
    tag: "^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",
    link: /^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,
    reflink: /^!?\[(label)\]\[(ref)\]/,
    nolink: /^!?\[(ref)\](?:\[\])?/,
    reflinkSearch: "reflink|nolink(?!\\()",
    emStrong: {
      lDelim: /^(?:\*+(?:([punct_])|[^\s*]))|^_+(?:([punct*])|([^\s_]))/,
      rDelimAst: /^[^_*]*?\_\_[^_*]*?\*[^_*]*?(?=\_\_)|[^*]+(?=[^*])|[punct_](\*+)(?=[\s]|$)|[^punct*_\s](\*+)(?=[punct_\s]|$)|[punct_\s](\*+)(?=[^punct*_\s])|[\s](\*+)(?=[punct_])|[punct_](\*+)(?=[punct_])|[^punct*_\s](\*+)(?=[^punct*_\s])/,
      rDelimUnd: /^[^_*]*?\*\*[^_*]*?\_[^_*]*?(?=\*\*)|[^_]+(?=[^_])|[punct*](\_+)(?=[\s]|$)|[^punct*_\s](\_+)(?=[punct*\s]|$)|[punct*\s](\_+)(?=[^punct*_\s])|[\s](\_+)(?=[punct*])|[punct*](\_+)(?=[punct*])/
    },
    code: /^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,
    br: /^( {2,}|\\)\n(?!\s*$)/,
    del: noopTest,
    text: /^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,
    punctuation: /^([\spunctuation])/
  };
  inline._punctuation = "!\"#$%&'()+\\-.,/:;<=>?@\\[\\]`^{|}~";
  inline.punctuation = edit(inline.punctuation).replace(/punctuation/g, inline._punctuation).getRegex();
  inline.blockSkip = /\[[^\]]*?\]\([^\)]*?\)|`[^`]*?`|<[^>]*?>/g;
  inline.escapedEmSt = /\\\*|\\_/g;
  inline._comment = edit(block._comment).replace("(?:-->|$)", "-->").getRegex();
  inline.emStrong.lDelim = edit(inline.emStrong.lDelim).replace(/punct/g, inline._punctuation).getRegex();
  inline.emStrong.rDelimAst = edit(inline.emStrong.rDelimAst, "g").replace(/punct/g, inline._punctuation).getRegex();
  inline.emStrong.rDelimUnd = edit(inline.emStrong.rDelimUnd, "g").replace(/punct/g, inline._punctuation).getRegex();
  inline._escapes = /\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/g;
  inline._scheme = /[a-zA-Z][a-zA-Z0-9+.-]{1,31}/;
  inline._email = /[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/;
  inline.autolink = edit(inline.autolink).replace("scheme", inline._scheme).replace("email", inline._email).getRegex();
  inline._attribute = /\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/;
  inline.tag = edit(inline.tag).replace("comment", inline._comment).replace("attribute", inline._attribute).getRegex();
  inline._label = /(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/;
  inline._href = /<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/;
  inline._title = /"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/;
  inline.link = edit(inline.link).replace("label", inline._label).replace("href", inline._href).replace("title", inline._title).getRegex();
  inline.reflink = edit(inline.reflink).replace("label", inline._label).replace("ref", block._label).getRegex();
  inline.nolink = edit(inline.nolink).replace("ref", block._label).getRegex();
  inline.reflinkSearch = edit(inline.reflinkSearch, "g").replace("reflink", inline.reflink).replace("nolink", inline.nolink).getRegex();
  inline.normal = merge({}, inline);
  inline.pedantic = merge({}, inline.normal, {
    strong: {
      start: /^__|\*\*/,
      middle: /^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,
      endAst: /\*\*(?!\*)/g,
      endUnd: /__(?!_)/g
    },
    em: {
      start: /^_|\*/,
      middle: /^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,
      endAst: /\*(?!\*)/g,
      endUnd: /_(?!_)/g
    },
    link: edit(/^!?\[(label)\]\((.*?)\)/).replace("label", inline._label).getRegex(),
    reflink: edit(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label", inline._label).getRegex()
  });
  inline.gfm = merge({}, inline.normal, {
    escape: edit(inline.escape).replace("])", "~|])").getRegex(),
    _extended_email: /[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,
    url: /^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,
    _backpedal: /(?:[^?!.,:;*_~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_~)]+(?!$))+/,
    del: /^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,
    text: /^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/
  });
  inline.gfm.url = edit(inline.gfm.url, "i").replace("email", inline.gfm._extended_email).getRegex();
  inline.breaks = merge({}, inline.gfm, {
    br: edit(inline.br).replace("{2,}", "*").getRegex(),
    text: edit(inline.gfm.text).replace("\\b_", "\\b_| {2,}\\n").replace(/\{2,\}/g, "*").getRegex()
  });
  function smartypants(text) {
    return text.replace(/---/g, "\u2014").replace(/--/g, "\u2013").replace(/(^|[-\u2014/(\[{"\s])'/g, "$1\u2018").replace(/'/g, "\u2019").replace(/(^|[-\u2014/(\[{\u2018\s])"/g, "$1\u201C").replace(/"/g, "\u201D").replace(/\.{3}/g, "\u2026");
  }
  function mangle(text) {
    var out = "", i, ch;
    var l = text.length;
    for (i = 0; i < l; i++) {
      ch = text.charCodeAt(i);
      if (Math.random() > 0.5) {
        ch = "x" + ch.toString(16);
      }
      out += "&#" + ch + ";";
    }
    return out;
  }
  var Lexer = /* @__PURE__ */ function() {
    function Lexer2(options2) {
      this.tokens = [];
      this.tokens.links = Object.create(null);
      this.options = options2 || exports.defaults;
      this.options.tokenizer = this.options.tokenizer || new Tokenizer();
      this.tokenizer = this.options.tokenizer;
      this.tokenizer.options = this.options;
      this.tokenizer.lexer = this;
      this.inlineQueue = [];
      this.state = {
        inLink: false,
        inRawBlock: false,
        top: true
      };
      var rules = {
        block: block.normal,
        inline: inline.normal
      };
      if (this.options.pedantic) {
        rules.block = block.pedantic;
        rules.inline = inline.pedantic;
      } else if (this.options.gfm) {
        rules.block = block.gfm;
        if (this.options.breaks) {
          rules.inline = inline.breaks;
        } else {
          rules.inline = inline.gfm;
        }
      }
      this.tokenizer.rules = rules;
    }
    Lexer2.lex = function lex(src, options2) {
      var lexer2 = new Lexer2(options2);
      return lexer2.lex(src);
    };
    Lexer2.lexInline = function lexInline(src, options2) {
      var lexer2 = new Lexer2(options2);
      return lexer2.inlineTokens(src);
    };
    var _proto = Lexer2.prototype;
    _proto.lex = function lex(src) {
      src = src.replace(/\r\n|\r/g, "\n");
      this.blockTokens(src, this.tokens);
      var next;
      while (next = this.inlineQueue.shift()) {
        this.inlineTokens(next.src, next.tokens);
      }
      return this.tokens;
    };
    _proto.blockTokens = function blockTokens(src, tokens) {
      var _this = this;
      if (tokens === void 0) {
        tokens = [];
      }
      if (this.options.pedantic) {
        src = src.replace(/\t/g, "    ").replace(/^ +$/gm, "");
      } else {
        src = src.replace(/^( *)(\t+)/gm, function(_, leading, tabs) {
          return leading + "    ".repeat(tabs.length);
        });
      }
      var token, lastToken, cutSrc, lastParagraphClipped;
      while (src) {
        if (this.options.extensions && this.options.extensions.block && this.options.extensions.block.some(function(extTokenizer) {
          if (token = extTokenizer.call({
            lexer: _this
          }, src, tokens)) {
            src = src.substring(token.raw.length);
            tokens.push(token);
            return true;
          }
          return false;
        })) {
          continue;
        }
        if (token = this.tokenizer.space(src)) {
          src = src.substring(token.raw.length);
          if (token.raw.length === 1 && tokens.length > 0) {
            tokens[tokens.length - 1].raw += "\n";
          } else {
            tokens.push(token);
          }
          continue;
        }
        if (token = this.tokenizer.code(src)) {
          src = src.substring(token.raw.length);
          lastToken = tokens[tokens.length - 1];
          if (lastToken && (lastToken.type === "paragraph" || lastToken.type === "text")) {
            lastToken.raw += "\n" + token.raw;
            lastToken.text += "\n" + token.text;
            this.inlineQueue[this.inlineQueue.length - 1].src = lastToken.text;
          } else {
            tokens.push(token);
          }
          continue;
        }
        if (token = this.tokenizer.fences(src)) {
          src = src.substring(token.raw.length);
          tokens.push(token);
          continue;
        }
        if (token = this.tokenizer.heading(src)) {
          src = src.substring(token.raw.length);
          tokens.push(token);
          continue;
        }
        if (token = this.tokenizer.hr(src)) {
          src = src.substring(token.raw.length);
          tokens.push(token);
          continue;
        }
        if (token = this.tokenizer.blockquote(src)) {
          src = src.substring(token.raw.length);
          tokens.push(token);
          continue;
        }
        if (token = this.tokenizer.list(src)) {
          src = src.substring(token.raw.length);
          tokens.push(token);
          continue;
        }
        if (token = this.tokenizer.html(src)) {
          src = src.substring(token.raw.length);
          tokens.push(token);
          continue;
        }
        if (token = this.tokenizer.def(src)) {
          src = src.substring(token.raw.length);
          lastToken = tokens[tokens.length - 1];
          if (lastToken && (lastToken.type === "paragraph" || lastToken.type === "text")) {
            lastToken.raw += "\n" + token.raw;
            lastToken.text += "\n" + token.raw;
            this.inlineQueue[this.inlineQueue.length - 1].src = lastToken.text;
          } else if (!this.tokens.links[token.tag]) {
            this.tokens.links[token.tag] = {
              href: token.href,
              title: token.title
            };
          }
          continue;
        }
        if (token = this.tokenizer.table(src)) {
          src = src.substring(token.raw.length);
          tokens.push(token);
          continue;
        }
        if (token = this.tokenizer.lheading(src)) {
          src = src.substring(token.raw.length);
          tokens.push(token);
          continue;
        }
        cutSrc = src;
        if (this.options.extensions && this.options.extensions.startBlock) {
          (function() {
            var startIndex = Infinity;
            var tempSrc = src.slice(1);
            var tempStart = void 0;
            _this.options.extensions.startBlock.forEach(function(getStartIndex) {
              tempStart = getStartIndex.call({
                lexer: this
              }, tempSrc);
              if (typeof tempStart === "number" && tempStart >= 0) {
                startIndex = Math.min(startIndex, tempStart);
              }
            });
            if (startIndex < Infinity && startIndex >= 0) {
              cutSrc = src.substring(0, startIndex + 1);
            }
          })();
        }
        if (this.state.top && (token = this.tokenizer.paragraph(cutSrc))) {
          lastToken = tokens[tokens.length - 1];
          if (lastParagraphClipped && lastToken.type === "paragraph") {
            lastToken.raw += "\n" + token.raw;
            lastToken.text += "\n" + token.text;
            this.inlineQueue.pop();
            this.inlineQueue[this.inlineQueue.length - 1].src = lastToken.text;
          } else {
            tokens.push(token);
          }
          lastParagraphClipped = cutSrc.length !== src.length;
          src = src.substring(token.raw.length);
          continue;
        }
        if (token = this.tokenizer.text(src)) {
          src = src.substring(token.raw.length);
          lastToken = tokens[tokens.length - 1];
          if (lastToken && lastToken.type === "text") {
            lastToken.raw += "\n" + token.raw;
            lastToken.text += "\n" + token.text;
            this.inlineQueue.pop();
            this.inlineQueue[this.inlineQueue.length - 1].src = lastToken.text;
          } else {
            tokens.push(token);
          }
          continue;
        }
        if (src) {
          var errMsg = "Infinite loop on byte: " + src.charCodeAt(0);
          if (this.options.silent) {
            console.error(errMsg);
            break;
          } else {
            throw new Error(errMsg);
          }
        }
      }
      this.state.top = true;
      return tokens;
    };
    _proto.inline = function inline2(src, tokens) {
      this.inlineQueue.push({
        src,
        tokens
      });
    };
    _proto.inlineTokens = function inlineTokens(src, tokens) {
      var _this2 = this;
      if (tokens === void 0) {
        tokens = [];
      }
      var token, lastToken, cutSrc;
      var maskedSrc = src;
      var match;
      var keepPrevChar, prevChar;
      if (this.tokens.links) {
        var links = Object.keys(this.tokens.links);
        if (links.length > 0) {
          while ((match = this.tokenizer.rules.inline.reflinkSearch.exec(maskedSrc)) != null) {
            if (links.includes(match[0].slice(match[0].lastIndexOf("[") + 1, -1))) {
              maskedSrc = maskedSrc.slice(0, match.index) + "[" + repeatString("a", match[0].length - 2) + "]" + maskedSrc.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex);
            }
          }
        }
      }
      while ((match = this.tokenizer.rules.inline.blockSkip.exec(maskedSrc)) != null) {
        maskedSrc = maskedSrc.slice(0, match.index) + "[" + repeatString("a", match[0].length - 2) + "]" + maskedSrc.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);
      }
      while ((match = this.tokenizer.rules.inline.escapedEmSt.exec(maskedSrc)) != null) {
        maskedSrc = maskedSrc.slice(0, match.index) + "++" + maskedSrc.slice(this.tokenizer.rules.inline.escapedEmSt.lastIndex);
      }
      while (src) {
        if (!keepPrevChar) {
          prevChar = "";
        }
        keepPrevChar = false;
        if (this.options.extensions && this.options.extensions.inline && this.options.extensions.inline.some(function(extTokenizer) {
          if (token = extTokenizer.call({
            lexer: _this2
          }, src, tokens)) {
            src = src.substring(token.raw.length);
            tokens.push(token);
            return true;
          }
          return false;
        })) {
          continue;
        }
        if (token = this.tokenizer.escape(src)) {
          src = src.substring(token.raw.length);
          tokens.push(token);
          continue;
        }
        if (token = this.tokenizer.tag(src)) {
          src = src.substring(token.raw.length);
          lastToken = tokens[tokens.length - 1];
          if (lastToken && token.type === "text" && lastToken.type === "text") {
            lastToken.raw += token.raw;
            lastToken.text += token.text;
          } else {
            tokens.push(token);
          }
          continue;
        }
        if (token = this.tokenizer.link(src)) {
          src = src.substring(token.raw.length);
          tokens.push(token);
          continue;
        }
        if (token = this.tokenizer.reflink(src, this.tokens.links)) {
          src = src.substring(token.raw.length);
          lastToken = tokens[tokens.length - 1];
          if (lastToken && token.type === "text" && lastToken.type === "text") {
            lastToken.raw += token.raw;
            lastToken.text += token.text;
          } else {
            tokens.push(token);
          }
          continue;
        }
        if (token = this.tokenizer.emStrong(src, maskedSrc, prevChar)) {
          src = src.substring(token.raw.length);
          tokens.push(token);
          continue;
        }
        if (token = this.tokenizer.codespan(src)) {
          src = src.substring(token.raw.length);
          tokens.push(token);
          continue;
        }
        if (token = this.tokenizer.br(src)) {
          src = src.substring(token.raw.length);
          tokens.push(token);
          continue;
        }
        if (token = this.tokenizer.del(src)) {
          src = src.substring(token.raw.length);
          tokens.push(token);
          continue;
        }
        if (token = this.tokenizer.autolink(src, mangle)) {
          src = src.substring(token.raw.length);
          tokens.push(token);
          continue;
        }
        if (!this.state.inLink && (token = this.tokenizer.url(src, mangle))) {
          src = src.substring(token.raw.length);
          tokens.push(token);
          continue;
        }
        cutSrc = src;
        if (this.options.extensions && this.options.extensions.startInline) {
          (function() {
            var startIndex = Infinity;
            var tempSrc = src.slice(1);
            var tempStart = void 0;
            _this2.options.extensions.startInline.forEach(function(getStartIndex) {
              tempStart = getStartIndex.call({
                lexer: this
              }, tempSrc);
              if (typeof tempStart === "number" && tempStart >= 0) {
                startIndex = Math.min(startIndex, tempStart);
              }
            });
            if (startIndex < Infinity && startIndex >= 0) {
              cutSrc = src.substring(0, startIndex + 1);
            }
          })();
        }
        if (token = this.tokenizer.inlineText(cutSrc, smartypants)) {
          src = src.substring(token.raw.length);
          if (token.raw.slice(-1) !== "_") {
            prevChar = token.raw.slice(-1);
          }
          keepPrevChar = true;
          lastToken = tokens[tokens.length - 1];
          if (lastToken && lastToken.type === "text") {
            lastToken.raw += token.raw;
            lastToken.text += token.text;
          } else {
            tokens.push(token);
          }
          continue;
        }
        if (src) {
          var errMsg = "Infinite loop on byte: " + src.charCodeAt(0);
          if (this.options.silent) {
            console.error(errMsg);
            break;
          } else {
            throw new Error(errMsg);
          }
        }
      }
      return tokens;
    };
    _createClass(Lexer2, null, [{
      key: "rules",
      get: function get() {
        return {
          block,
          inline
        };
      }
    }]);
    return Lexer2;
  }();
  var Renderer = /* @__PURE__ */ function() {
    function Renderer2(options2) {
      this.options = options2 || exports.defaults;
    }
    var _proto = Renderer2.prototype;
    _proto.code = function code(_code, infostring, escaped) {
      var lang = (infostring || "").match(/\S*/)[0];
      if (this.options.highlight) {
        var out = this.options.highlight(_code, lang);
        if (out != null && out !== _code) {
          escaped = true;
          _code = out;
        }
      }
      _code = _code.replace(/\n$/, "") + "\n";
      if (!lang) {
        return "<pre><code>" + (escaped ? _code : escape(_code, true)) + "</code></pre>\n";
      }
      return '<pre><code class="' + this.options.langPrefix + escape(lang, true) + '">' + (escaped ? _code : escape(_code, true)) + "</code></pre>\n";
    };
    _proto.blockquote = function blockquote(quote) {
      return "<blockquote>\n" + quote + "</blockquote>\n";
    };
    _proto.html = function html(_html) {
      return _html;
    };
    _proto.heading = function heading(text, level, raw, slugger) {
      if (this.options.headerIds) {
        var id = this.options.headerPrefix + slugger.slug(raw);
        return "<h" + level + ' id="' + id + '">' + text + "</h" + level + ">\n";
      }
      return "<h" + level + ">" + text + "</h" + level + ">\n";
    };
    _proto.hr = function hr() {
      return this.options.xhtml ? "<hr/>\n" : "<hr>\n";
    };
    _proto.list = function list(body, ordered, start) {
      var type = ordered ? "ol" : "ul", startatt = ordered && start !== 1 ? ' start="' + start + '"' : "";
      return "<" + type + startatt + ">\n" + body + "</" + type + ">\n";
    };
    _proto.listitem = function listitem(text) {
      return "<li>" + text + "</li>\n";
    };
    _proto.checkbox = function checkbox(checked) {
      return "<input " + (checked ? 'checked="" ' : "") + 'disabled="" type="checkbox"' + (this.options.xhtml ? " /" : "") + "> ";
    };
    _proto.paragraph = function paragraph(text) {
      return "<p>" + text + "</p>\n";
    };
    _proto.table = function table(header, body) {
      if (body)
        body = "<tbody>" + body + "</tbody>";
      return "<table>\n<thead>\n" + header + "</thead>\n" + body + "</table>\n";
    };
    _proto.tablerow = function tablerow(content) {
      return "<tr>\n" + content + "</tr>\n";
    };
    _proto.tablecell = function tablecell(content, flags) {
      var type = flags.header ? "th" : "td";
      var tag = flags.align ? "<" + type + ' align="' + flags.align + '">' : "<" + type + ">";
      return tag + content + ("</" + type + ">\n");
    };
    _proto.strong = function strong(text) {
      return "<strong>" + text + "</strong>";
    };
    _proto.em = function em(text) {
      return "<em>" + text + "</em>";
    };
    _proto.codespan = function codespan(text) {
      return "<code>" + text + "</code>";
    };
    _proto.br = function br() {
      return this.options.xhtml ? "<br/>" : "<br>";
    };
    _proto.del = function del(text) {
      return "<del>" + text + "</del>";
    };
    _proto.link = function link(href, title, text) {
      href = cleanUrl(this.options.sanitize, this.options.baseUrl, href);
      if (href === null) {
        return text;
      }
      var out = '<a href="' + escape(href) + '"';
      if (title) {
        out += ' title="' + title + '"';
      }
      out += ">" + text + "</a>";
      return out;
    };
    _proto.image = function image(href, title, text) {
      href = cleanUrl(this.options.sanitize, this.options.baseUrl, href);
      if (href === null) {
        return text;
      }
      var out = '<img src="' + href + '" alt="' + text + '"';
      if (title) {
        out += ' title="' + title + '"';
      }
      out += this.options.xhtml ? "/>" : ">";
      return out;
    };
    _proto.text = function text(_text) {
      return _text;
    };
    return Renderer2;
  }();
  var TextRenderer = /* @__PURE__ */ function() {
    function TextRenderer2() {
    }
    var _proto = TextRenderer2.prototype;
    _proto.strong = function strong(text) {
      return text;
    };
    _proto.em = function em(text) {
      return text;
    };
    _proto.codespan = function codespan(text) {
      return text;
    };
    _proto.del = function del(text) {
      return text;
    };
    _proto.html = function html(text) {
      return text;
    };
    _proto.text = function text(_text) {
      return _text;
    };
    _proto.link = function link(href, title, text) {
      return "" + text;
    };
    _proto.image = function image(href, title, text) {
      return "" + text;
    };
    _proto.br = function br() {
      return "";
    };
    return TextRenderer2;
  }();
  var Slugger = /* @__PURE__ */ function() {
    function Slugger2() {
      this.seen = {};
    }
    var _proto = Slugger2.prototype;
    _proto.serialize = function serialize(value) {
      return value.toLowerCase().trim().replace(/<[!\/a-z].*?>/ig, "").replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g, "").replace(/\s/g, "-");
    };
    _proto.getNextSafeSlug = function getNextSafeSlug(originalSlug, isDryRun) {
      var slug = originalSlug;
      var occurenceAccumulator = 0;
      if (this.seen.hasOwnProperty(slug)) {
        occurenceAccumulator = this.seen[originalSlug];
        do {
          occurenceAccumulator++;
          slug = originalSlug + "-" + occurenceAccumulator;
        } while (this.seen.hasOwnProperty(slug));
      }
      if (!isDryRun) {
        this.seen[originalSlug] = occurenceAccumulator;
        this.seen[slug] = 0;
      }
      return slug;
    };
    _proto.slug = function slug(value, options2) {
      if (options2 === void 0) {
        options2 = {};
      }
      var slug2 = this.serialize(value);
      return this.getNextSafeSlug(slug2, options2.dryrun);
    };
    return Slugger2;
  }();
  var Parser = /* @__PURE__ */ function() {
    function Parser2(options2) {
      this.options = options2 || exports.defaults;
      this.options.renderer = this.options.renderer || new Renderer();
      this.renderer = this.options.renderer;
      this.renderer.options = this.options;
      this.textRenderer = new TextRenderer();
      this.slugger = new Slugger();
    }
    Parser2.parse = function parse2(tokens, options2) {
      var parser2 = new Parser2(options2);
      return parser2.parse(tokens);
    };
    Parser2.parseInline = function parseInline2(tokens, options2) {
      var parser2 = new Parser2(options2);
      return parser2.parseInline(tokens);
    };
    var _proto = Parser2.prototype;
    _proto.parse = function parse2(tokens, top) {
      if (top === void 0) {
        top = true;
      }
      var out = "", i, j, k, l2, l3, row, cell, header, body, token, ordered, start, loose, itemBody, item, checked, task, checkbox, ret;
      var l = tokens.length;
      for (i = 0; i < l; i++) {
        token = tokens[i];
        if (this.options.extensions && this.options.extensions.renderers && this.options.extensions.renderers[token.type]) {
          ret = this.options.extensions.renderers[token.type].call({
            parser: this
          }, token);
          if (ret !== false || !["space", "hr", "heading", "code", "table", "blockquote", "list", "html", "paragraph", "text"].includes(token.type)) {
            out += ret || "";
            continue;
          }
        }
        switch (token.type) {
          case "space": {
            continue;
          }
          case "hr": {
            out += this.renderer.hr();
            continue;
          }
          case "heading": {
            out += this.renderer.heading(this.parseInline(token.tokens), token.depth, unescape2(this.parseInline(token.tokens, this.textRenderer)), this.slugger);
            continue;
          }
          case "code": {
            out += this.renderer.code(token.text, token.lang, token.escaped);
            continue;
          }
          case "table": {
            header = "";
            cell = "";
            l2 = token.header.length;
            for (j = 0; j < l2; j++) {
              cell += this.renderer.tablecell(this.parseInline(token.header[j].tokens), {
                header: true,
                align: token.align[j]
              });
            }
            header += this.renderer.tablerow(cell);
            body = "";
            l2 = token.rows.length;
            for (j = 0; j < l2; j++) {
              row = token.rows[j];
              cell = "";
              l3 = row.length;
              for (k = 0; k < l3; k++) {
                cell += this.renderer.tablecell(this.parseInline(row[k].tokens), {
                  header: false,
                  align: token.align[k]
                });
              }
              body += this.renderer.tablerow(cell);
            }
            out += this.renderer.table(header, body);
            continue;
          }
          case "blockquote": {
            body = this.parse(token.tokens);
            out += this.renderer.blockquote(body);
            continue;
          }
          case "list": {
            ordered = token.ordered;
            start = token.start;
            loose = token.loose;
            l2 = token.items.length;
            body = "";
            for (j = 0; j < l2; j++) {
              item = token.items[j];
              checked = item.checked;
              task = item.task;
              itemBody = "";
              if (item.task) {
                checkbox = this.renderer.checkbox(checked);
                if (loose) {
                  if (item.tokens.length > 0 && item.tokens[0].type === "paragraph") {
                    item.tokens[0].text = checkbox + " " + item.tokens[0].text;
                    if (item.tokens[0].tokens && item.tokens[0].tokens.length > 0 && item.tokens[0].tokens[0].type === "text") {
                      item.tokens[0].tokens[0].text = checkbox + " " + item.tokens[0].tokens[0].text;
                    }
                  } else {
                    item.tokens.unshift({
                      type: "text",
                      text: checkbox
                    });
                  }
                } else {
                  itemBody += checkbox;
                }
              }
              itemBody += this.parse(item.tokens, loose);
              body += this.renderer.listitem(itemBody, task, checked);
            }
            out += this.renderer.list(body, ordered, start);
            continue;
          }
          case "html": {
            out += this.renderer.html(token.text);
            continue;
          }
          case "paragraph": {
            out += this.renderer.paragraph(this.parseInline(token.tokens));
            continue;
          }
          case "text": {
            body = token.tokens ? this.parseInline(token.tokens) : token.text;
            while (i + 1 < l && tokens[i + 1].type === "text") {
              token = tokens[++i];
              body += "\n" + (token.tokens ? this.parseInline(token.tokens) : token.text);
            }
            out += top ? this.renderer.paragraph(body) : body;
            continue;
          }
          default: {
            var errMsg = 'Token with "' + token.type + '" type was not found.';
            if (this.options.silent) {
              console.error(errMsg);
              return;
            } else {
              throw new Error(errMsg);
            }
          }
        }
      }
      return out;
    };
    _proto.parseInline = function parseInline2(tokens, renderer) {
      renderer = renderer || this.renderer;
      var out = "", i, token, ret;
      var l = tokens.length;
      for (i = 0; i < l; i++) {
        token = tokens[i];
        if (this.options.extensions && this.options.extensions.renderers && this.options.extensions.renderers[token.type]) {
          ret = this.options.extensions.renderers[token.type].call({
            parser: this
          }, token);
          if (ret !== false || !["escape", "html", "link", "image", "strong", "em", "codespan", "br", "del", "text"].includes(token.type)) {
            out += ret || "";
            continue;
          }
        }
        switch (token.type) {
          case "escape": {
            out += renderer.text(token.text);
            break;
          }
          case "html": {
            out += renderer.html(token.text);
            break;
          }
          case "link": {
            out += renderer.link(token.href, token.title, this.parseInline(token.tokens, renderer));
            break;
          }
          case "image": {
            out += renderer.image(token.href, token.title, token.text);
            break;
          }
          case "strong": {
            out += renderer.strong(this.parseInline(token.tokens, renderer));
            break;
          }
          case "em": {
            out += renderer.em(this.parseInline(token.tokens, renderer));
            break;
          }
          case "codespan": {
            out += renderer.codespan(token.text);
            break;
          }
          case "br": {
            out += renderer.br();
            break;
          }
          case "del": {
            out += renderer.del(this.parseInline(token.tokens, renderer));
            break;
          }
          case "text": {
            out += renderer.text(token.text);
            break;
          }
          default: {
            var errMsg = 'Token with "' + token.type + '" type was not found.';
            if (this.options.silent) {
              console.error(errMsg);
              return;
            } else {
              throw new Error(errMsg);
            }
          }
        }
      }
      return out;
    };
    return Parser2;
  }();
  function marked2(src, opt, callback) {
    if (typeof src === "undefined" || src === null) {
      throw new Error("marked(): input parameter is undefined or null");
    }
    if (typeof src !== "string") {
      throw new Error("marked(): input parameter is of type " + Object.prototype.toString.call(src) + ", string expected");
    }
    if (typeof opt === "function") {
      callback = opt;
      opt = null;
    }
    opt = merge({}, marked2.defaults, opt || {});
    checkSanitizeDeprecation(opt);
    if (callback) {
      var highlight2 = opt.highlight;
      var tokens;
      try {
        tokens = Lexer.lex(src, opt);
      } catch (e) {
        return callback(e);
      }
      var done = function done2(err) {
        var out;
        if (!err) {
          try {
            if (opt.walkTokens) {
              marked2.walkTokens(tokens, opt.walkTokens);
            }
            out = Parser.parse(tokens, opt);
          } catch (e) {
            err = e;
          }
        }
        opt.highlight = highlight2;
        return err ? callback(err) : callback(null, out);
      };
      if (!highlight2 || highlight2.length < 3) {
        return done();
      }
      delete opt.highlight;
      if (!tokens.length)
        return done();
      var pending = 0;
      marked2.walkTokens(tokens, function(token) {
        if (token.type === "code") {
          pending++;
          setTimeout(function() {
            highlight2(token.text, token.lang, function(err, code) {
              if (err) {
                return done(err);
              }
              if (code != null && code !== token.text) {
                token.text = code;
                token.escaped = true;
              }
              pending--;
              if (pending === 0) {
                done();
              }
            });
          }, 0);
        }
      });
      if (pending === 0) {
        done();
      }
      return;
    }
    try {
      var _tokens = Lexer.lex(src, opt);
      if (opt.walkTokens) {
        marked2.walkTokens(_tokens, opt.walkTokens);
      }
      return Parser.parse(_tokens, opt);
    } catch (e) {
      e.message += "\nPlease report this to https://github.com/markedjs/marked.";
      if (opt.silent) {
        return "<p>An error occurred:</p><pre>" + escape(e.message + "", true) + "</pre>";
      }
      throw e;
    }
  }
  marked2.options = marked2.setOptions = function(opt) {
    merge(marked2.defaults, opt);
    changeDefaults(marked2.defaults);
    return marked2;
  };
  marked2.getDefaults = getDefaults;
  marked2.defaults = exports.defaults;
  marked2.use = function() {
    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }
    var opts = merge.apply(void 0, [{}].concat(args));
    var extensions = marked2.defaults.extensions || {
      renderers: {},
      childTokens: {}
    };
    var hasExtensions;
    args.forEach(function(pack) {
      if (pack.extensions) {
        hasExtensions = true;
        pack.extensions.forEach(function(ext) {
          if (!ext.name) {
            throw new Error("extension name required");
          }
          if (ext.renderer) {
            var prevRenderer = extensions.renderers ? extensions.renderers[ext.name] : null;
            if (prevRenderer) {
              extensions.renderers[ext.name] = function() {
                for (var _len2 = arguments.length, args2 = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
                  args2[_key2] = arguments[_key2];
                }
                var ret = ext.renderer.apply(this, args2);
                if (ret === false) {
                  ret = prevRenderer.apply(this, args2);
                }
                return ret;
              };
            } else {
              extensions.renderers[ext.name] = ext.renderer;
            }
          }
          if (ext.tokenizer) {
            if (!ext.level || ext.level !== "block" && ext.level !== "inline") {
              throw new Error("extension level must be 'block' or 'inline'");
            }
            if (extensions[ext.level]) {
              extensions[ext.level].unshift(ext.tokenizer);
            } else {
              extensions[ext.level] = [ext.tokenizer];
            }
            if (ext.start) {
              if (ext.level === "block") {
                if (extensions.startBlock) {
                  extensions.startBlock.push(ext.start);
                } else {
                  extensions.startBlock = [ext.start];
                }
              } else if (ext.level === "inline") {
                if (extensions.startInline) {
                  extensions.startInline.push(ext.start);
                } else {
                  extensions.startInline = [ext.start];
                }
              }
            }
          }
          if (ext.childTokens) {
            extensions.childTokens[ext.name] = ext.childTokens;
          }
        });
      }
      if (pack.renderer) {
        (function() {
          var renderer = marked2.defaults.renderer || new Renderer();
          var _loop = function _loop2(prop2) {
            var prevRenderer = renderer[prop2];
            renderer[prop2] = function() {
              for (var _len3 = arguments.length, args2 = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {
                args2[_key3] = arguments[_key3];
              }
              var ret = pack.renderer[prop2].apply(renderer, args2);
              if (ret === false) {
                ret = prevRenderer.apply(renderer, args2);
              }
              return ret;
            };
          };
          for (var prop in pack.renderer) {
            _loop(prop);
          }
          opts.renderer = renderer;
        })();
      }
      if (pack.tokenizer) {
        (function() {
          var tokenizer = marked2.defaults.tokenizer || new Tokenizer();
          var _loop2 = function _loop22(prop2) {
            var prevTokenizer = tokenizer[prop2];
            tokenizer[prop2] = function() {
              for (var _len4 = arguments.length, args2 = new Array(_len4), _key4 = 0; _key4 < _len4; _key4++) {
                args2[_key4] = arguments[_key4];
              }
              var ret = pack.tokenizer[prop2].apply(tokenizer, args2);
              if (ret === false) {
                ret = prevTokenizer.apply(tokenizer, args2);
              }
              return ret;
            };
          };
          for (var prop in pack.tokenizer) {
            _loop2(prop);
          }
          opts.tokenizer = tokenizer;
        })();
      }
      if (pack.walkTokens) {
        var _walkTokens = marked2.defaults.walkTokens;
        opts.walkTokens = function(token) {
          pack.walkTokens.call(this, token);
          if (_walkTokens) {
            _walkTokens.call(this, token);
          }
        };
      }
      if (hasExtensions) {
        opts.extensions = extensions;
      }
      marked2.setOptions(opts);
    });
  };
  marked2.walkTokens = function(tokens, callback) {
    var _loop3 = function _loop32() {
      var token = _step.value;
      callback.call(marked2, token);
      switch (token.type) {
        case "table": {
          for (var _iterator2 = _createForOfIteratorHelperLoose(token.header), _step2; !(_step2 = _iterator2()).done; ) {
            var cell = _step2.value;
            marked2.walkTokens(cell.tokens, callback);
          }
          for (var _iterator3 = _createForOfIteratorHelperLoose(token.rows), _step3; !(_step3 = _iterator3()).done; ) {
            var row = _step3.value;
            for (var _iterator4 = _createForOfIteratorHelperLoose(row), _step4; !(_step4 = _iterator4()).done; ) {
              var _cell = _step4.value;
              marked2.walkTokens(_cell.tokens, callback);
            }
          }
          break;
        }
        case "list": {
          marked2.walkTokens(token.items, callback);
          break;
        }
        default: {
          if (marked2.defaults.extensions && marked2.defaults.extensions.childTokens && marked2.defaults.extensions.childTokens[token.type]) {
            marked2.defaults.extensions.childTokens[token.type].forEach(function(childTokens) {
              marked2.walkTokens(token[childTokens], callback);
            });
          } else if (token.tokens) {
            marked2.walkTokens(token.tokens, callback);
          }
        }
      }
    };
    for (var _iterator = _createForOfIteratorHelperLoose(tokens), _step; !(_step = _iterator()).done; ) {
      _loop3();
    }
  };
  marked2.parseInline = function(src, opt) {
    if (typeof src === "undefined" || src === null) {
      throw new Error("marked.parseInline(): input parameter is undefined or null");
    }
    if (typeof src !== "string") {
      throw new Error("marked.parseInline(): input parameter is of type " + Object.prototype.toString.call(src) + ", string expected");
    }
    opt = merge({}, marked2.defaults, opt || {});
    checkSanitizeDeprecation(opt);
    try {
      var tokens = Lexer.lexInline(src, opt);
      if (opt.walkTokens) {
        marked2.walkTokens(tokens, opt.walkTokens);
      }
      return Parser.parseInline(tokens, opt);
    } catch (e) {
      e.message += "\nPlease report this to https://github.com/markedjs/marked.";
      if (opt.silent) {
        return "<p>An error occurred:</p><pre>" + escape(e.message + "", true) + "</pre>";
      }
      throw e;
    }
  };
  marked2.Parser = Parser;
  marked2.parser = Parser.parse;
  marked2.Renderer = Renderer;
  marked2.TextRenderer = TextRenderer;
  marked2.Lexer = Lexer;
  marked2.lexer = Lexer.lex;
  marked2.Tokenizer = Tokenizer;
  marked2.Slugger = Slugger;
  marked2.parse = marked2;
  var options = marked2.options;
  var setOptions = marked2.setOptions;
  var use = marked2.use;
  var walkTokens = marked2.walkTokens;
  var parseInline = marked2.parseInline;
  var parse = marked2;
  var parser = Parser.parse;
  var lexer = Lexer.lex;
  exports.Lexer = Lexer;
  exports.Parser = Parser;
  exports.Renderer = Renderer;
  exports.Slugger = Slugger;
  exports.TextRenderer = TextRenderer;
  exports.Tokenizer = Tokenizer;
  exports.getDefaults = getDefaults;
  exports.lexer = lexer;
  exports.marked = marked2;
  exports.options = options;
  exports.parse = parse;
  exports.parseInline = parseInline;
  exports.parser = parser;
  exports.setOptions = setOptions;
  exports.use = use;
  exports.walkTokens = walkTokens;
});

// node_modules/mdhl/dist/mdhl.js
var require_mdhl = __commonJS((exports) => {
  function e(e2) {
    return e2.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#039;");
  }
  var n = {space: /^\n+/, blockCode: /^( {4}[^\n]+\n*)+/, fences: /^ {0,3}(`{3,}(?=[^`\n]*\n)|~{3,})([^\n]*)(\n)(|[\s\S]*?\n)( {0,3}\1[~`]* *(?:\n+|$)|$)/, heading: /^#{1,6} [^\n]+(\n|$)/, lheading: /^[^\n]+\n {0,3}(=+|-+) *(\n+|$)/, hr: /^(([-_*]) *){3,}(\n+|$)/, list: /^( {0})((?:[*+-]|\d{1,9}\.)) [\s\S]+?(?:\n+(?! )(?!\1(?:[*+-]|\d{1,9}\.) )\n*|\s*$)/, blockquote: /^( {0,3}> ?([^\n]*)(?:\n|$))+/, html: /^ {0,3}(?:<(script|pre|style)[\s>][\s\S]*?(?:<\/\1>[^\n]*\n+|$)|<!--(?!-?>)[\s\S]*?-->[^\n]*(\n+|$)|<\/?(\w+)(?: +|\n|\/?>)[\s\S]*?(?:\n{2,}|$))/, paragraph: /^[^\n]+/};
  var t = {strong: /^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/, em: /^_(?=\S)([\s\S]*?\S)_(?!_)|^\*(?=\S)([\s\S]*?\S)\*(?!\*)/, inlineCode: /^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/, link: /^!?\[([\s\S]+)\]\(\s*([\s\S]+)(?:\s+([\s\S]+))?\s*\)/, text: /^(`+|[^`])(?:[\s\S]*?(?:(?=[\\<!\[`*]|\b_|$)|[^ ](?= {2,}\n))|(?= {2,}\n))/};
  var r = (e2, n2, t2) => `<${e2} class="mdhl-${t2}">${n2}</${e2}>`;
  var s = {codeInFences: (n2, t2) => r("span", e(n2), "codeInFences"), heading: (e2, n2, t2) => r("b", t2(e2.text, n2), e2.type), lheading: (e2, n2, t2) => r("b", t2(e2.text, n2), "heading"), paragraph: (e2, n2, t2) => r("span", t2(e2.text, n2), e2.type), list: (e2, n2, t2) => {
    const s2 = e2.text.split("\n").map((e3) => {
      const s3 = e3.substr(0, 1), o2 = e3.substr(1), c2 = t2(o2, n2);
      return `${r("span", s3, "bullet")}${c2}`;
    }).join("\n");
    return r("span", s2, "list");
  }, fences: (n2, t2) => {
    const [, r2, s2, o2, c2, p2] = n2.cap, a = t2.codeInFences(c2, s2);
    return `${r2}${e(s2)}${o2}${a}${p2}`;
  }, space: (e2) => e2.text, text: (e2) => e2.text, em: (e2) => r("i", e2.text, e2.type), strong: (e2) => r("b", e2.text, e2.type), defaultInlineRenderer: (e2) => r("span", e2.text, e2.type), defaultBlockRenderer: (n2) => r("span", e(n2.text), n2.type)};
  function o(n2, r2) {
    let s2 = "";
    for (; n2; )
      if (!Object.keys(t).some((c2) => {
        const p2 = t[c2].exec(n2);
        if (p2) {
          const t2 = p2[0];
          n2 = n2.substring(t2.length);
          const a = e(t2);
          return s2 += (r2[c2] || r2.defaultInlineRenderer)({type: c2, text: a, cap: p2}, r2, o), true;
        }
        return false;
      }))
        throw new Error("Infinite loop on byte: " + n2.charCodeAt(0));
    return s2;
  }
  function c(e2) {
    const t2 = [];
    for (e2 = e2.replace(/^ +$/gm, ""); e2; )
      if (!Object.keys(n).some((r2) => {
        const s2 = n[r2].exec(e2);
        if (s2) {
          const n2 = s2[0];
          return e2 = e2.substring(n2.length), t2.push({text: n2, type: r2, cap: s2}), true;
        }
        return false;
      }))
        throw new Error("Infinite loop on byte: " + e2.charCodeAt(0));
    return t2;
  }
  function p(e2, n2) {
    return e2.map((e3) => (n2[e3.type] || n2.defaultBlockRenderer)(e3, n2, o)).join("").replace(/\n/g, "<br/>");
  }
  exports.blockLexer = c, exports.createElement = r, exports.defaultRenderers = s, exports.escape = e, exports.highlight = function(e2, n2 = s) {
    return p(c(e2), n2);
  }, exports.render = p, exports.renderLine = o;
});

// node_modules/trix/dist/trix.js
var require_trix = __commonJS((exports, module) => {
  (function() {
  }).call(exports), function() {
    var t;
    window.Set == null && (window.Set = t = function() {
      function t2() {
        this.clear();
      }
      return t2.prototype.clear = function() {
        return this.values = [];
      }, t2.prototype.has = function(t3) {
        return this.values.indexOf(t3) !== -1;
      }, t2.prototype.add = function(t3) {
        return this.has(t3) || this.values.push(t3), this;
      }, t2.prototype["delete"] = function(t3) {
        var e;
        return (e = this.values.indexOf(t3)) === -1 ? false : (this.values.splice(e, 1), true);
      }, t2.prototype.forEach = function() {
        var t3;
        return (t3 = this.values).forEach.apply(t3, arguments);
      }, t2;
    }());
  }.call(exports), function(t) {
    function e() {
    }
    function n(t2, e2) {
      return function() {
        t2.apply(e2, arguments);
      };
    }
    function i(t2) {
      if (typeof this != "object")
        throw new TypeError("Promises must be constructed via new");
      if (typeof t2 != "function")
        throw new TypeError("not a function");
      this._state = 0, this._handled = false, this._value = void 0, this._deferreds = [], c(t2, this);
    }
    function o(t2, e2) {
      for (; t2._state === 3; )
        t2 = t2._value;
      return t2._state === 0 ? void t2._deferreds.push(e2) : (t2._handled = true, void h(function() {
        var n2 = t2._state === 1 ? e2.onFulfilled : e2.onRejected;
        if (n2 === null)
          return void (t2._state === 1 ? r : s)(e2.promise, t2._value);
        var i2;
        try {
          i2 = n2(t2._value);
        } catch (o2) {
          return void s(e2.promise, o2);
        }
        r(e2.promise, i2);
      }));
    }
    function r(t2, e2) {
      try {
        if (e2 === t2)
          throw new TypeError("A promise cannot be resolved with itself.");
        if (e2 && (typeof e2 == "object" || typeof e2 == "function")) {
          var o2 = e2.then;
          if (e2 instanceof i)
            return t2._state = 3, t2._value = e2, void a(t2);
          if (typeof o2 == "function")
            return void c(n(o2, e2), t2);
        }
        t2._state = 1, t2._value = e2, a(t2);
      } catch (r2) {
        s(t2, r2);
      }
    }
    function s(t2, e2) {
      t2._state = 2, t2._value = e2, a(t2);
    }
    function a(t2) {
      t2._state === 2 && t2._deferreds.length === 0 && setTimeout(function() {
        t2._handled || p(t2._value);
      }, 1);
      for (var e2 = 0, n2 = t2._deferreds.length; n2 > e2; e2++)
        o(t2, t2._deferreds[e2]);
      t2._deferreds = null;
    }
    function u(t2, e2, n2) {
      this.onFulfilled = typeof t2 == "function" ? t2 : null, this.onRejected = typeof e2 == "function" ? e2 : null, this.promise = n2;
    }
    function c(t2, e2) {
      var n2 = false;
      try {
        t2(function(t3) {
          n2 || (n2 = true, r(e2, t3));
        }, function(t3) {
          n2 || (n2 = true, s(e2, t3));
        });
      } catch (i2) {
        if (n2)
          return;
        n2 = true, s(e2, i2);
      }
    }
    var l = setTimeout, h = typeof setImmediate == "function" && setImmediate || function(t2) {
      l(t2, 1);
    }, p = function(t2) {
      typeof console != "undefined" && console && console.warn("Possible Unhandled Promise Rejection:", t2);
    };
    i.prototype["catch"] = function(t2) {
      return this.then(null, t2);
    }, i.prototype.then = function(t2, n2) {
      var r2 = new i(e);
      return o(this, new u(t2, n2, r2)), r2;
    }, i.all = function(t2) {
      var e2 = Array.prototype.slice.call(t2);
      return new i(function(t3, n2) {
        function i2(r3, s2) {
          try {
            if (s2 && (typeof s2 == "object" || typeof s2 == "function")) {
              var a2 = s2.then;
              if (typeof a2 == "function")
                return void a2.call(s2, function(t4) {
                  i2(r3, t4);
                }, n2);
            }
            e2[r3] = s2, --o2 === 0 && t3(e2);
          } catch (u2) {
            n2(u2);
          }
        }
        if (e2.length === 0)
          return t3([]);
        for (var o2 = e2.length, r2 = 0; r2 < e2.length; r2++)
          i2(r2, e2[r2]);
      });
    }, i.resolve = function(t2) {
      return t2 && typeof t2 == "object" && t2.constructor === i ? t2 : new i(function(e2) {
        e2(t2);
      });
    }, i.reject = function(t2) {
      return new i(function(e2, n2) {
        n2(t2);
      });
    }, i.race = function(t2) {
      return new i(function(e2, n2) {
        for (var i2 = 0, o2 = t2.length; o2 > i2; i2++)
          t2[i2].then(e2, n2);
      });
    }, i._setImmediateFn = function(t2) {
      h = t2;
    }, i._setUnhandledRejectionFn = function(t2) {
      p = t2;
    }, typeof module != "undefined" && module.exports ? module.exports = i : t.Promise || (t.Promise = i);
  }(exports), function() {
    var t = typeof window.customElements == "object", e = typeof document.registerElement == "function", n = t || e;
    n || (typeof WeakMap == "undefined" && !function() {
      var t2 = Object.defineProperty, e2 = Date.now() % 1e9, n2 = function() {
        this.name = "__st" + (1e9 * Math.random() >>> 0) + (e2++ + "__");
      };
      n2.prototype = {set: function(e3, n3) {
        var i = e3[this.name];
        return i && i[0] === e3 ? i[1] = n3 : t2(e3, this.name, {value: [e3, n3], writable: true}), this;
      }, get: function(t3) {
        var e3;
        return (e3 = t3[this.name]) && e3[0] === t3 ? e3[1] : void 0;
      }, delete: function(t3) {
        var e3 = t3[this.name];
        return e3 && e3[0] === t3 ? (e3[0] = e3[1] = void 0, true) : false;
      }, has: function(t3) {
        var e3 = t3[this.name];
        return e3 ? e3[0] === t3 : false;
      }}, window.WeakMap = n2;
    }(), function(t2) {
      function e2(t3) {
        A.push(t3), b || (b = true, g(i));
      }
      function n2(t3) {
        return window.ShadowDOMPolyfill && window.ShadowDOMPolyfill.wrapIfNeeded(t3) || t3;
      }
      function i() {
        b = false;
        var t3 = A;
        A = [], t3.sort(function(t4, e4) {
          return t4.uid_ - e4.uid_;
        });
        var e3 = false;
        t3.forEach(function(t4) {
          var n3 = t4.takeRecords();
          o(t4), n3.length && (t4.callback_(n3, t4), e3 = true);
        }), e3 && i();
      }
      function o(t3) {
        t3.nodes_.forEach(function(e3) {
          var n3 = m.get(e3);
          n3 && n3.forEach(function(e4) {
            e4.observer === t3 && e4.removeTransientObservers();
          });
        });
      }
      function r(t3, e3) {
        for (var n3 = t3; n3; n3 = n3.parentNode) {
          var i2 = m.get(n3);
          if (i2)
            for (var o2 = 0; o2 < i2.length; o2++) {
              var r2 = i2[o2], s2 = r2.options;
              if (n3 === t3 || s2.subtree) {
                var a2 = e3(s2);
                a2 && r2.enqueue(a2);
              }
            }
        }
      }
      function s(t3) {
        this.callback_ = t3, this.nodes_ = [], this.records_ = [], this.uid_ = ++C3;
      }
      function a(t3, e3) {
        this.type = t3, this.target = e3, this.addedNodes = [], this.removedNodes = [], this.previousSibling = null, this.nextSibling = null, this.attributeName = null, this.attributeNamespace = null, this.oldValue = null;
      }
      function u(t3) {
        var e3 = new a(t3.type, t3.target);
        return e3.addedNodes = t3.addedNodes.slice(), e3.removedNodes = t3.removedNodes.slice(), e3.previousSibling = t3.previousSibling, e3.nextSibling = t3.nextSibling, e3.attributeName = t3.attributeName, e3.attributeNamespace = t3.attributeNamespace, e3.oldValue = t3.oldValue, e3;
      }
      function c(t3, e3) {
        return x = new a(t3, e3);
      }
      function l(t3) {
        return w ? w : (w = u(x), w.oldValue = t3, w);
      }
      function h() {
        x = w = void 0;
      }
      function p(t3) {
        return t3 === w || t3 === x;
      }
      function d(t3, e3) {
        return t3 === e3 ? t3 : w && p(t3) ? w : null;
      }
      function f(t3, e3, n3) {
        this.observer = t3, this.target = e3, this.options = n3, this.transientObservedNodes = [];
      }
      if (!t2.JsMutationObserver) {
        var g, m = new WeakMap();
        if (/Trident|Edge/.test(navigator.userAgent))
          g = setTimeout;
        else if (window.setImmediate)
          g = window.setImmediate;
        else {
          var v = [], y = String(Math.random());
          window.addEventListener("message", function(t3) {
            if (t3.data === y) {
              var e3 = v;
              v = [], e3.forEach(function(t4) {
                t4();
              });
            }
          }), g = function(t3) {
            v.push(t3), window.postMessage(y, "*");
          };
        }
        var b = false, A = [], C3 = 0;
        s.prototype = {observe: function(t3, e3) {
          if (t3 = n2(t3), !e3.childList && !e3.attributes && !e3.characterData || e3.attributeOldValue && !e3.attributes || e3.attributeFilter && e3.attributeFilter.length && !e3.attributes || e3.characterDataOldValue && !e3.characterData)
            throw new SyntaxError();
          var i2 = m.get(t3);
          i2 || m.set(t3, i2 = []);
          for (var o2, r2 = 0; r2 < i2.length; r2++)
            if (i2[r2].observer === this) {
              o2 = i2[r2], o2.removeListeners(), o2.options = e3;
              break;
            }
          o2 || (o2 = new f(this, t3, e3), i2.push(o2), this.nodes_.push(t3)), o2.addListeners();
        }, disconnect: function() {
          this.nodes_.forEach(function(t3) {
            for (var e3 = m.get(t3), n3 = 0; n3 < e3.length; n3++) {
              var i2 = e3[n3];
              if (i2.observer === this) {
                i2.removeListeners(), e3.splice(n3, 1);
                break;
              }
            }
          }, this), this.records_ = [];
        }, takeRecords: function() {
          var t3 = this.records_;
          return this.records_ = [], t3;
        }};
        var x, w;
        f.prototype = {enqueue: function(t3) {
          var n3 = this.observer.records_, i2 = n3.length;
          if (n3.length > 0) {
            var o2 = n3[i2 - 1], r2 = d(o2, t3);
            if (r2)
              return void (n3[i2 - 1] = r2);
          } else
            e2(this.observer);
          n3[i2] = t3;
        }, addListeners: function() {
          this.addListeners_(this.target);
        }, addListeners_: function(t3) {
          var e3 = this.options;
          e3.attributes && t3.addEventListener("DOMAttrModified", this, true), e3.characterData && t3.addEventListener("DOMCharacterDataModified", this, true), e3.childList && t3.addEventListener("DOMNodeInserted", this, true), (e3.childList || e3.subtree) && t3.addEventListener("DOMNodeRemoved", this, true);
        }, removeListeners: function() {
          this.removeListeners_(this.target);
        }, removeListeners_: function(t3) {
          var e3 = this.options;
          e3.attributes && t3.removeEventListener("DOMAttrModified", this, true), e3.characterData && t3.removeEventListener("DOMCharacterDataModified", this, true), e3.childList && t3.removeEventListener("DOMNodeInserted", this, true), (e3.childList || e3.subtree) && t3.removeEventListener("DOMNodeRemoved", this, true);
        }, addTransientObserver: function(t3) {
          if (t3 !== this.target) {
            this.addListeners_(t3), this.transientObservedNodes.push(t3);
            var e3 = m.get(t3);
            e3 || m.set(t3, e3 = []), e3.push(this);
          }
        }, removeTransientObservers: function() {
          var t3 = this.transientObservedNodes;
          this.transientObservedNodes = [], t3.forEach(function(t4) {
            this.removeListeners_(t4);
            for (var e3 = m.get(t4), n3 = 0; n3 < e3.length; n3++)
              if (e3[n3] === this) {
                e3.splice(n3, 1);
                break;
              }
          }, this);
        }, handleEvent: function(t3) {
          switch (t3.stopImmediatePropagation(), t3.type) {
            case "DOMAttrModified":
              var e3 = t3.attrName, n3 = t3.relatedNode.namespaceURI, i2 = t3.target, o2 = new c("attributes", i2);
              o2.attributeName = e3, o2.attributeNamespace = n3;
              var s2 = t3.attrChange === MutationEvent.ADDITION ? null : t3.prevValue;
              r(i2, function(t4) {
                return !t4.attributes || t4.attributeFilter && t4.attributeFilter.length && t4.attributeFilter.indexOf(e3) === -1 && t4.attributeFilter.indexOf(n3) === -1 ? void 0 : t4.attributeOldValue ? l(s2) : o2;
              });
              break;
            case "DOMCharacterDataModified":
              var i2 = t3.target, o2 = c("characterData", i2), s2 = t3.prevValue;
              r(i2, function(t4) {
                return t4.characterData ? t4.characterDataOldValue ? l(s2) : o2 : void 0;
              });
              break;
            case "DOMNodeRemoved":
              this.addTransientObserver(t3.target);
            case "DOMNodeInserted":
              var a2, u2, p2 = t3.target;
              t3.type === "DOMNodeInserted" ? (a2 = [p2], u2 = []) : (a2 = [], u2 = [p2]);
              var d2 = p2.previousSibling, f2 = p2.nextSibling, o2 = c("childList", t3.target.parentNode);
              o2.addedNodes = a2, o2.removedNodes = u2, o2.previousSibling = d2, o2.nextSibling = f2, r(t3.relatedNode, function(t4) {
                return t4.childList ? o2 : void 0;
              });
          }
          h();
        }}, t2.JsMutationObserver = s, t2.MutationObserver || (t2.MutationObserver = s, s._isPolyfilled = true);
      }
    }(self), function() {
      "use strict";
      if (!window.performance || !window.performance.now) {
        var t2 = Date.now();
        window.performance = {now: function() {
          return Date.now() - t2;
        }};
      }
      window.requestAnimationFrame || (window.requestAnimationFrame = function() {
        var t3 = window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame;
        return t3 ? function(e3) {
          return t3(function() {
            e3(performance.now());
          });
        } : function(t4) {
          return window.setTimeout(t4, 1e3 / 60);
        };
      }()), window.cancelAnimationFrame || (window.cancelAnimationFrame = function() {
        return window.webkitCancelAnimationFrame || window.mozCancelAnimationFrame || function(t3) {
          clearTimeout(t3);
        };
      }());
      var e2 = function() {
        var t3 = document.createEvent("Event");
        return t3.initEvent("foo", true, true), t3.preventDefault(), t3.defaultPrevented;
      }();
      if (!e2) {
        var n2 = Event.prototype.preventDefault;
        Event.prototype.preventDefault = function() {
          this.cancelable && (n2.call(this), Object.defineProperty(this, "defaultPrevented", {get: function() {
            return true;
          }, configurable: true}));
        };
      }
      var i = /Trident/.test(navigator.userAgent);
      if ((!window.CustomEvent || i && typeof window.CustomEvent != "function") && (window.CustomEvent = function(t3, e3) {
        e3 = e3 || {};
        var n3 = document.createEvent("CustomEvent");
        return n3.initCustomEvent(t3, Boolean(e3.bubbles), Boolean(e3.cancelable), e3.detail), n3;
      }, window.CustomEvent.prototype = window.Event.prototype), !window.Event || i && typeof window.Event != "function") {
        var o = window.Event;
        window.Event = function(t3, e3) {
          e3 = e3 || {};
          var n3 = document.createEvent("Event");
          return n3.initEvent(t3, Boolean(e3.bubbles), Boolean(e3.cancelable)), n3;
        }, window.Event.prototype = o.prototype;
      }
    }(window.WebComponents), window.CustomElements = window.CustomElements || {flags: {}}, function(t2) {
      var e2 = t2.flags, n2 = [], i = function(t3) {
        n2.push(t3);
      }, o = function() {
        n2.forEach(function(e3) {
          e3(t2);
        });
      };
      t2.addModule = i, t2.initializeModules = o, t2.hasNative = Boolean(document.registerElement), t2.isIE = /Trident/.test(navigator.userAgent), t2.useNative = !e2.register && t2.hasNative && !window.ShadowDOMPolyfill && (!window.HTMLImports || window.HTMLImports.useNative);
    }(window.CustomElements), window.CustomElements.addModule(function(t2) {
      function e2(t3, e3) {
        n2(t3, function(t4) {
          return e3(t4) ? true : void i(t4, e3);
        }), i(t3, e3);
      }
      function n2(t3, e3, i2) {
        var o2 = t3.firstElementChild;
        if (!o2)
          for (o2 = t3.firstChild; o2 && o2.nodeType !== Node.ELEMENT_NODE; )
            o2 = o2.nextSibling;
        for (; o2; )
          e3(o2, i2) !== true && n2(o2, e3, i2), o2 = o2.nextElementSibling;
        return null;
      }
      function i(t3, n3) {
        for (var i2 = t3.shadowRoot; i2; )
          e2(i2, n3), i2 = i2.olderShadowRoot;
      }
      function o(t3, e3) {
        r(t3, e3, []);
      }
      function r(t3, e3, n3) {
        if (t3 = window.wrap(t3), !(n3.indexOf(t3) >= 0)) {
          n3.push(t3);
          for (var i2, o2 = t3.querySelectorAll("link[rel=" + s + "]"), a = 0, u = o2.length; u > a && (i2 = o2[a]); a++)
            i2.import && r(i2.import, e3, n3);
          e3(t3);
        }
      }
      var s = window.HTMLImports ? window.HTMLImports.IMPORT_LINK_TYPE : "none";
      t2.forDocumentTree = o, t2.forSubtree = e2;
    }), window.CustomElements.addModule(function(t2) {
      function e2(t3, e3) {
        return n2(t3, e3) || i(t3, e3);
      }
      function n2(e3, n3) {
        return t2.upgrade(e3, n3) ? true : void (n3 && s(e3));
      }
      function i(t3, e3) {
        b(t3, function(t4) {
          return n2(t4, e3) ? true : void 0;
        });
      }
      function o(t3) {
        w.push(t3), x || (x = true, setTimeout(r));
      }
      function r() {
        x = false;
        for (var t3, e3 = w, n3 = 0, i2 = e3.length; i2 > n3 && (t3 = e3[n3]); n3++)
          t3();
        w = [];
      }
      function s(t3) {
        C3 ? o(function() {
          a(t3);
        }) : a(t3);
      }
      function a(t3) {
        t3.__upgraded__ && !t3.__attached && (t3.__attached = true, t3.attachedCallback && t3.attachedCallback());
      }
      function u(t3) {
        c(t3), b(t3, function(t4) {
          c(t4);
        });
      }
      function c(t3) {
        C3 ? o(function() {
          l(t3);
        }) : l(t3);
      }
      function l(t3) {
        t3.__upgraded__ && t3.__attached && (t3.__attached = false, t3.detachedCallback && t3.detachedCallback());
      }
      function h(t3) {
        for (var e3 = t3, n3 = window.wrap(document); e3; ) {
          if (e3 == n3)
            return true;
          e3 = e3.parentNode || e3.nodeType === Node.DOCUMENT_FRAGMENT_NODE && e3.host;
        }
      }
      function p(t3) {
        if (t3.shadowRoot && !t3.shadowRoot.__watched) {
          y.dom && console.log("watching shadow-root for: ", t3.localName);
          for (var e3 = t3.shadowRoot; e3; )
            g(e3), e3 = e3.olderShadowRoot;
        }
      }
      function d(t3, n3) {
        if (y.dom) {
          var i2 = n3[0];
          if (i2 && i2.type === "childList" && i2.addedNodes && i2.addedNodes) {
            for (var o2 = i2.addedNodes[0]; o2 && o2 !== document && !o2.host; )
              o2 = o2.parentNode;
            var r2 = o2 && (o2.URL || o2._URL || o2.host && o2.host.localName) || "";
            r2 = r2.split("/?").shift().split("/").pop();
          }
          console.group("mutations (%d) [%s]", n3.length, r2 || "");
        }
        var s2 = h(t3);
        n3.forEach(function(t4) {
          t4.type === "childList" && (E(t4.addedNodes, function(t5) {
            t5.localName && e2(t5, s2);
          }), E(t4.removedNodes, function(t5) {
            t5.localName && u(t5);
          }));
        }), y.dom && console.groupEnd();
      }
      function f(t3) {
        for (t3 = window.wrap(t3), t3 || (t3 = window.wrap(document)); t3.parentNode; )
          t3 = t3.parentNode;
        var e3 = t3.__observer;
        e3 && (d(t3, e3.takeRecords()), r());
      }
      function g(t3) {
        if (!t3.__observer) {
          var e3 = new MutationObserver(d.bind(this, t3));
          e3.observe(t3, {childList: true, subtree: true}), t3.__observer = e3;
        }
      }
      function m(t3) {
        t3 = window.wrap(t3), y.dom && console.group("upgradeDocument: ", t3.baseURI.split("/").pop());
        var n3 = t3 === window.wrap(document);
        e2(t3, n3), g(t3), y.dom && console.groupEnd();
      }
      function v(t3) {
        A(t3, m);
      }
      var y = t2.flags, b = t2.forSubtree, A = t2.forDocumentTree, C3 = window.MutationObserver._isPolyfilled && y["throttle-attached"];
      t2.hasPolyfillMutations = C3, t2.hasThrottledAttached = C3;
      var x = false, w = [], E = Array.prototype.forEach.call.bind(Array.prototype.forEach), S2 = Element.prototype.createShadowRoot;
      S2 && (Element.prototype.createShadowRoot = function() {
        var t3 = S2.call(this);
        return window.CustomElements.watchShadow(this), t3;
      }), t2.watchShadow = p, t2.upgradeDocumentTree = v, t2.upgradeDocument = m, t2.upgradeSubtree = i, t2.upgradeAll = e2, t2.attached = s, t2.takeRecords = f;
    }), window.CustomElements.addModule(function(t2) {
      function e2(e3, i2) {
        if (e3.localName === "template" && window.HTMLTemplateElement && HTMLTemplateElement.decorate && HTMLTemplateElement.decorate(e3), !e3.__upgraded__ && e3.nodeType === Node.ELEMENT_NODE) {
          var o2 = e3.getAttribute("is"), r2 = t2.getRegisteredDefinition(e3.localName) || t2.getRegisteredDefinition(o2);
          if (r2 && (o2 && r2.tag == e3.localName || !o2 && !r2.extends))
            return n2(e3, r2, i2);
        }
      }
      function n2(e3, n3, o2) {
        return s.upgrade && console.group("upgrade:", e3.localName), n3.is && e3.setAttribute("is", n3.is), i(e3, n3), e3.__upgraded__ = true, r(e3), o2 && t2.attached(e3), t2.upgradeSubtree(e3, o2), s.upgrade && console.groupEnd(), e3;
      }
      function i(t3, e3) {
        Object.__proto__ ? t3.__proto__ = e3.prototype : (o(t3, e3.prototype, e3.native), t3.__proto__ = e3.prototype);
      }
      function o(t3, e3, n3) {
        for (var i2 = {}, o2 = e3; o2 !== n3 && o2 !== HTMLElement.prototype; ) {
          for (var r2, s2 = Object.getOwnPropertyNames(o2), a = 0; r2 = s2[a]; a++)
            i2[r2] || (Object.defineProperty(t3, r2, Object.getOwnPropertyDescriptor(o2, r2)), i2[r2] = 1);
          o2 = Object.getPrototypeOf(o2);
        }
      }
      function r(t3) {
        t3.createdCallback && t3.createdCallback();
      }
      var s = t2.flags;
      t2.upgrade = e2, t2.upgradeWithDefinition = n2, t2.implementPrototype = i;
    }), window.CustomElements.addModule(function(t2) {
      function e2(e3, i2) {
        var u2 = i2 || {};
        if (!e3)
          throw new Error("document.registerElement: first argument `name` must not be empty");
        if (e3.indexOf("-") < 0)
          throw new Error("document.registerElement: first argument ('name') must contain a dash ('-'). Argument provided was '" + String(e3) + "'.");
        if (o(e3))
          throw new Error("Failed to execute 'registerElement' on 'Document': Registration failed for type '" + String(e3) + "'. The type name is invalid.");
        if (c(e3))
          throw new Error("DuplicateDefinitionError: a type with name '" + String(e3) + "' is already registered");
        return u2.prototype || (u2.prototype = Object.create(HTMLElement.prototype)), u2.__name = e3.toLowerCase(), u2.extends && (u2.extends = u2.extends.toLowerCase()), u2.lifecycle = u2.lifecycle || {}, u2.ancestry = r(u2.extends), s(u2), a(u2), n2(u2.prototype), l(u2.__name, u2), u2.ctor = h(u2), u2.ctor.prototype = u2.prototype, u2.prototype.constructor = u2.ctor, t2.ready && m(document), u2.ctor;
      }
      function n2(t3) {
        if (!t3.setAttribute._polyfilled) {
          var e3 = t3.setAttribute;
          t3.setAttribute = function(t4, n4) {
            i.call(this, t4, n4, e3);
          };
          var n3 = t3.removeAttribute;
          t3.removeAttribute = function(t4) {
            i.call(this, t4, null, n3);
          }, t3.setAttribute._polyfilled = true;
        }
      }
      function i(t3, e3, n3) {
        t3 = t3.toLowerCase();
        var i2 = this.getAttribute(t3);
        n3.apply(this, arguments);
        var o2 = this.getAttribute(t3);
        this.attributeChangedCallback && o2 !== i2 && this.attributeChangedCallback(t3, i2, o2);
      }
      function o(t3) {
        for (var e3 = 0; e3 < C3.length; e3++)
          if (t3 === C3[e3])
            return true;
      }
      function r(t3) {
        var e3 = c(t3);
        return e3 ? r(e3.extends).concat([e3]) : [];
      }
      function s(t3) {
        for (var e3, n3 = t3.extends, i2 = 0; e3 = t3.ancestry[i2]; i2++)
          n3 = e3.is && e3.tag;
        t3.tag = n3 || t3.__name, n3 && (t3.is = t3.__name);
      }
      function a(t3) {
        if (!Object.__proto__) {
          var e3 = HTMLElement.prototype;
          if (t3.is) {
            var n3 = document.createElement(t3.tag);
            e3 = Object.getPrototypeOf(n3);
          }
          for (var i2, o2 = t3.prototype, r2 = false; o2; )
            o2 == e3 && (r2 = true), i2 = Object.getPrototypeOf(o2), i2 && (o2.__proto__ = i2), o2 = i2;
          r2 || console.warn(t3.tag + " prototype not found in prototype chain for " + t3.is), t3.native = e3;
        }
      }
      function u(t3) {
        return y(E(t3.tag), t3);
      }
      function c(t3) {
        return t3 ? x[t3.toLowerCase()] : void 0;
      }
      function l(t3, e3) {
        x[t3] = e3;
      }
      function h(t3) {
        return function() {
          return u(t3);
        };
      }
      function p(t3, e3, n3) {
        return t3 === w ? d(e3, n3) : S2(t3, e3);
      }
      function d(t3, e3) {
        t3 && (t3 = t3.toLowerCase()), e3 && (e3 = e3.toLowerCase());
        var n3 = c(e3 || t3);
        if (n3) {
          if (t3 == n3.tag && e3 == n3.is)
            return new n3.ctor();
          if (!e3 && !n3.is)
            return new n3.ctor();
        }
        var i2;
        return e3 ? (i2 = d(t3), i2.setAttribute("is", e3), i2) : (i2 = E(t3), t3.indexOf("-") >= 0 && b(i2, HTMLElement), i2);
      }
      function f(t3, e3) {
        var n3 = t3[e3];
        t3[e3] = function() {
          var t4 = n3.apply(this, arguments);
          return v(t4), t4;
        };
      }
      var g, m = (t2.isIE, t2.upgradeDocumentTree), v = t2.upgradeAll, y = t2.upgradeWithDefinition, b = t2.implementPrototype, A = t2.useNative, C3 = ["annotation-xml", "color-profile", "font-face", "font-face-src", "font-face-uri", "font-face-format", "font-face-name", "missing-glyph"], x = {}, w = "http://www.w3.org/1999/xhtml", E = document.createElement.bind(document), S2 = document.createElementNS.bind(document);
      g = Object.__proto__ || A ? function(t3, e3) {
        return t3 instanceof e3;
      } : function(t3, e3) {
        if (t3 instanceof e3)
          return true;
        for (var n3 = t3; n3; ) {
          if (n3 === e3.prototype)
            return true;
          n3 = n3.__proto__;
        }
        return false;
      }, f(Node.prototype, "cloneNode"), f(document, "importNode"), document.registerElement = e2, document.createElement = d, document.createElementNS = p, t2.registry = x, t2.instanceof = g, t2.reservedTagList = C3, t2.getRegisteredDefinition = c, document.register = document.registerElement;
    }), function(t2) {
      function e2() {
        r(window.wrap(document)), window.CustomElements.ready = true;
        var t3 = window.requestAnimationFrame || function(t4) {
          setTimeout(t4, 16);
        };
        t3(function() {
          setTimeout(function() {
            window.CustomElements.readyTime = Date.now(), window.HTMLImports && (window.CustomElements.elapsed = window.CustomElements.readyTime - window.HTMLImports.readyTime), document.dispatchEvent(new CustomEvent("WebComponentsReady", {bubbles: true}));
          });
        });
      }
      var n2 = t2.useNative, i = t2.initializeModules;
      if (t2.isIE, n2) {
        var o = function() {
        };
        t2.watchShadow = o, t2.upgrade = o, t2.upgradeAll = o, t2.upgradeDocumentTree = o, t2.upgradeSubtree = o, t2.takeRecords = o, t2.instanceof = function(t3, e3) {
          return t3 instanceof e3;
        };
      } else
        i();
      var r = t2.upgradeDocumentTree, s = t2.upgradeDocument;
      if (window.wrap || (window.ShadowDOMPolyfill ? (window.wrap = window.ShadowDOMPolyfill.wrapIfNeeded, window.unwrap = window.ShadowDOMPolyfill.unwrapIfNeeded) : window.wrap = window.unwrap = function(t3) {
        return t3;
      }), window.HTMLImports && (window.HTMLImports.__importsParsingHook = function(t3) {
        t3.import && s(wrap(t3.import));
      }), document.readyState === "complete" || t2.flags.eager)
        e2();
      else if (document.readyState !== "interactive" || window.attachEvent || window.HTMLImports && !window.HTMLImports.ready) {
        var a = window.HTMLImports && !window.HTMLImports.ready ? "HTMLImportsLoaded" : "DOMContentLoaded";
        window.addEventListener(a, e2);
      } else
        e2();
    }(window.CustomElements));
  }.call(exports), function() {
  }.call(exports), function() {
    var t = this;
    (function() {
      (function() {
        this.Trix = {VERSION: "1.3.1", ZERO_WIDTH_SPACE: "\uFEFF", NON_BREAKING_SPACE: "\xA0", OBJECT_REPLACEMENT_CHARACTER: "\uFFFC", browser: {composesExistingText: /Android.*Chrome/.test(navigator.userAgent), forcesObjectResizing: /Trident.*rv:11/.test(navigator.userAgent), supportsInputEvents: function() {
          var t2, e2, n, i;
          if (typeof InputEvent == "undefined")
            return false;
          for (i = ["data", "getTargetRanges", "inputType"], t2 = 0, e2 = i.length; e2 > t2; t2++)
            if (n = i[t2], !(n in InputEvent.prototype))
              return false;
          return true;
        }()}, config: {}};
      }).call(this);
    }).call(t);
    var e = t.Trix;
    (function() {
      (function() {
        e.BasicObject = function() {
          function t2() {
          }
          var e2, n, i;
          return t2.proxyMethod = function(t3) {
            var i2, o, r, s, a;
            return r = n(t3), i2 = r.name, s = r.toMethod, a = r.toProperty, o = r.optional, this.prototype[i2] = function() {
              var t4, n2;
              return t4 = s != null ? o ? typeof this[s] == "function" ? this[s]() : void 0 : this[s]() : a != null ? this[a] : void 0, o ? (n2 = t4 != null ? t4[i2] : void 0, n2 != null ? e2.call(n2, t4, arguments) : void 0) : (n2 = t4[i2], e2.call(n2, t4, arguments));
            };
          }, n = function(t3) {
            var e3, n2;
            if (!(n2 = t3.match(i)))
              throw new Error("can't parse @proxyMethod expression: " + t3);
            return e3 = {name: n2[4]}, n2[2] != null ? e3.toMethod = n2[1] : e3.toProperty = n2[1], n2[3] != null && (e3.optional = true), e3;
          }, e2 = Function.prototype.apply, i = /^(.+?)(\(\))?(\?)?\.(.+?)$/, t2;
        }();
      }).call(this), function() {
        var t2 = function(t3, e2) {
          function i() {
            this.constructor = t3;
          }
          for (var o in e2)
            n.call(e2, o) && (t3[o] = e2[o]);
          return i.prototype = e2.prototype, t3.prototype = new i(), t3.__super__ = e2.prototype, t3;
        }, n = {}.hasOwnProperty;
        e.Object = function(n2) {
          function i() {
            this.id = ++o;
          }
          var o;
          return t2(i, n2), o = 0, i.fromJSONString = function(t3) {
            return this.fromJSON(JSON.parse(t3));
          }, i.prototype.hasSameConstructorAs = function(t3) {
            return this.constructor === (t3 != null ? t3.constructor : void 0);
          }, i.prototype.isEqualTo = function(t3) {
            return this === t3;
          }, i.prototype.inspect = function() {
            var t3, e2, n3;
            return t3 = function() {
              var t4, i2, o2;
              i2 = (t4 = this.contentsForInspection()) != null ? t4 : {}, o2 = [];
              for (e2 in i2)
                n3 = i2[e2], o2.push(e2 + "=" + n3);
              return o2;
            }.call(this), "#<" + this.constructor.name + ":" + this.id + (t3.length ? " " + t3.join(", ") : "") + ">";
          }, i.prototype.contentsForInspection = function() {
          }, i.prototype.toJSONString = function() {
            return JSON.stringify(this);
          }, i.prototype.toUTF16String = function() {
            return e.UTF16String.box(this);
          }, i.prototype.getCacheKey = function() {
            return this.id.toString();
          }, i;
        }(e.BasicObject);
      }.call(this), function() {
        e.extend = function(t2) {
          var e2, n;
          for (e2 in t2)
            n = t2[e2], this[e2] = n;
          return this;
        };
      }.call(this), function() {
        e.extend({defer: function(t2) {
          return setTimeout(t2, 1);
        }});
      }.call(this), function() {
        var t2, n;
        e.extend({normalizeSpaces: function(t3) {
          return t3.replace(RegExp("" + e.ZERO_WIDTH_SPACE, "g"), "").replace(RegExp("" + e.NON_BREAKING_SPACE, "g"), " ");
        }, normalizeNewlines: function(t3) {
          return t3.replace(/\r\n/g, "\n");
        }, breakableWhitespacePattern: RegExp("[^\\S" + e.NON_BREAKING_SPACE + "]"), squishBreakableWhitespace: function(t3) {
          return t3.replace(RegExp("" + e.breakableWhitespacePattern.source, "g"), " ").replace(/\ {2,}/g, " ");
        }, summarizeStringChange: function(t3, i) {
          var o, r, s, a;
          return t3 = e.UTF16String.box(t3), i = e.UTF16String.box(i), i.length < t3.length ? (r = n(t3, i), a = r[0], o = r[1]) : (s = n(i, t3), o = s[0], a = s[1]), {added: o, removed: a};
        }}), n = function(n2, i) {
          var o, r, s, a, u;
          return n2.isEqualTo(i) ? ["", ""] : (r = t2(n2, i), a = r.utf16String.length, s = a ? (u = r.offset, r, o = n2.codepoints.slice(0, u).concat(n2.codepoints.slice(u + a)), t2(i, e.UTF16String.fromCodepoints(o))) : t2(i, n2), [r.utf16String.toString(), s.utf16String.toString()]);
        }, t2 = function(t3, e2) {
          var n2, i, o;
          for (n2 = 0, i = t3.length, o = e2.length; i > n2 && t3.charAt(n2).isEqualTo(e2.charAt(n2)); )
            n2++;
          for (; i > n2 + 1 && t3.charAt(i - 1).isEqualTo(e2.charAt(o - 1)); )
            i--, o--;
          return {utf16String: t3.slice(n2, i), offset: n2};
        };
      }.call(this), function() {
        e.extend({copyObject: function(t2) {
          var e2, n, i;
          t2 == null && (t2 = {}), n = {};
          for (e2 in t2)
            i = t2[e2], n[e2] = i;
          return n;
        }, objectsAreEqual: function(t2, e2) {
          var n, i;
          if (t2 == null && (t2 = {}), e2 == null && (e2 = {}), Object.keys(t2).length !== Object.keys(e2).length)
            return false;
          for (n in t2)
            if (i = t2[n], i !== e2[n])
              return false;
          return true;
        }});
      }.call(this), function() {
        var t2 = [].slice;
        e.extend({arraysAreEqual: function(t3, e2) {
          var n, i, o, r;
          if (t3 == null && (t3 = []), e2 == null && (e2 = []), t3.length !== e2.length)
            return false;
          for (i = n = 0, o = t3.length; o > n; i = ++n)
            if (r = t3[i], r !== e2[i])
              return false;
          return true;
        }, arrayStartsWith: function(t3, n) {
          return t3 == null && (t3 = []), n == null && (n = []), e.arraysAreEqual(t3.slice(0, n.length), n);
        }, spliceArray: function() {
          var e2, n, i;
          return n = arguments[0], e2 = 2 <= arguments.length ? t2.call(arguments, 1) : [], i = n.slice(0), i.splice.apply(i, e2), i;
        }, summarizeArrayChange: function(t3, e2) {
          var n, i, o, r, s, a, u, c, l, h, p;
          for (t3 == null && (t3 = []), e2 == null && (e2 = []), n = [], h = [], o = new Set(), r = 0, u = t3.length; u > r; r++)
            p = t3[r], o.add(p);
          for (i = new Set(), s = 0, c = e2.length; c > s; s++)
            p = e2[s], i.add(p), o.has(p) || n.push(p);
          for (a = 0, l = t3.length; l > a; a++)
            p = t3[a], i.has(p) || h.push(p);
          return {added: n, removed: h};
        }});
      }.call(this), function() {
        var t2, n, i, o;
        t2 = null, n = null, o = null, i = null, e.extend({getAllAttributeNames: function() {
          return t2 != null ? t2 : t2 = e.getTextAttributeNames().concat(e.getBlockAttributeNames());
        }, getBlockConfig: function(t3) {
          return e.config.blockAttributes[t3];
        }, getBlockAttributeNames: function() {
          return n != null ? n : n = Object.keys(e.config.blockAttributes);
        }, getTextConfig: function(t3) {
          return e.config.textAttributes[t3];
        }, getTextAttributeNames: function() {
          return o != null ? o : o = Object.keys(e.config.textAttributes);
        }, getListAttributeNames: function() {
          var t3, n2;
          return i != null ? i : i = function() {
            var i2, o2;
            i2 = e.config.blockAttributes, o2 = [];
            for (t3 in i2)
              n2 = i2[t3].listAttribute, n2 != null && o2.push(n2);
            return o2;
          }();
        }});
      }.call(this), function() {
        var t2, n, i, o, r, s = [].indexOf || function(t3) {
          for (var e2 = 0, n2 = this.length; n2 > e2; e2++)
            if (e2 in this && this[e2] === t3)
              return e2;
          return -1;
        };
        t2 = document.documentElement, n = (i = (o = (r = t2.matchesSelector) != null ? r : t2.webkitMatchesSelector) != null ? o : t2.msMatchesSelector) != null ? i : t2.mozMatchesSelector, e.extend({handleEvent: function(n2, i2) {
          var o2, r2, s2, a, u, c, l, h, p, d, f, g;
          return h = i2 != null ? i2 : {}, c = h.onElement, u = h.matchingSelector, g = h.withCallback, a = h.inPhase, l = h.preventDefault, d = h.times, r2 = c != null ? c : t2, p = u, o2 = g, f = a === "capturing", s2 = function(t3) {
            var n3;
            return d != null && --d === 0 && s2.destroy(), n3 = e.findClosestElementFromNode(t3.target, {matchingSelector: p}), n3 != null && (g != null && g.call(n3, t3, n3), l) ? t3.preventDefault() : void 0;
          }, s2.destroy = function() {
            return r2.removeEventListener(n2, s2, f);
          }, r2.addEventListener(n2, s2, f), s2;
        }, handleEventOnce: function(t3, n2) {
          return n2 == null && (n2 = {}), n2.times = 1, e.handleEvent(t3, n2);
        }, triggerEvent: function(n2, i2) {
          var o2, r2, s2, a, u, c, l;
          return l = i2 != null ? i2 : {}, c = l.onElement, r2 = l.bubbles, s2 = l.cancelable, o2 = l.attributes, a = c != null ? c : t2, r2 = r2 !== false, s2 = s2 !== false, u = document.createEvent("Events"), u.initEvent(n2, r2, s2), o2 != null && e.extend.call(u, o2), a.dispatchEvent(u);
        }, elementMatchesSelector: function(t3, e2) {
          return (t3 != null ? t3.nodeType : void 0) === 1 ? n.call(t3, e2) : void 0;
        }, findClosestElementFromNode: function(t3, n2) {
          var i2, o2, r2;
          for (o2 = n2 != null ? n2 : {}, i2 = o2.matchingSelector, r2 = o2.untilNode; t3 != null && t3.nodeType !== Node.ELEMENT_NODE; )
            t3 = t3.parentNode;
          if (t3 != null) {
            if (i2 == null)
              return t3;
            if (t3.closest && r2 == null)
              return t3.closest(i2);
            for (; t3 && t3 !== r2; ) {
              if (e.elementMatchesSelector(t3, i2))
                return t3;
              t3 = t3.parentNode;
            }
          }
        }, findInnerElement: function(t3) {
          for (; t3 != null ? t3.firstElementChild : void 0; )
            t3 = t3.firstElementChild;
          return t3;
        }, innerElementIsActive: function(t3) {
          return document.activeElement !== t3 && e.elementContainsNode(t3, document.activeElement);
        }, elementContainsNode: function(t3, e2) {
          if (t3 && e2)
            for (; e2; ) {
              if (e2 === t3)
                return true;
              e2 = e2.parentNode;
            }
        }, findNodeFromContainerAndOffset: function(t3, e2) {
          var n2;
          if (t3)
            return t3.nodeType === Node.TEXT_NODE ? t3 : e2 === 0 ? (n2 = t3.firstChild) != null ? n2 : t3 : t3.childNodes.item(e2 - 1);
        }, findElementFromContainerAndOffset: function(t3, n2) {
          var i2;
          return i2 = e.findNodeFromContainerAndOffset(t3, n2), e.findClosestElementFromNode(i2);
        }, findChildIndexOfNode: function(t3) {
          var e2;
          if (t3 != null ? t3.parentNode : void 0) {
            for (e2 = 0; t3 = t3.previousSibling; )
              e2++;
            return e2;
          }
        }, removeNode: function(t3) {
          var e2;
          return t3 != null && (e2 = t3.parentNode) != null ? e2.removeChild(t3) : void 0;
        }, walkTree: function(t3, e2) {
          var n2, i2, o2, r2, s2;
          return o2 = e2 != null ? e2 : {}, i2 = o2.onlyNodesOfType, r2 = o2.usingFilter, n2 = o2.expandEntityReferences, s2 = function() {
            switch (i2) {
              case "element":
                return NodeFilter.SHOW_ELEMENT;
              case "text":
                return NodeFilter.SHOW_TEXT;
              case "comment":
                return NodeFilter.SHOW_COMMENT;
              default:
                return NodeFilter.SHOW_ALL;
            }
          }(), document.createTreeWalker(t3, s2, r2 != null ? r2 : null, n2 === true);
        }, tagName: function(t3) {
          var e2;
          return t3 != null && (e2 = t3.tagName) != null ? e2.toLowerCase() : void 0;
        }, makeElement: function(t3, e2) {
          var n2, i2, o2, r2, s2, a, u, c, l, h, p, d, f, g;
          if (e2 == null && (e2 = {}), typeof t3 == "object" ? (e2 = t3, t3 = e2.tagName) : e2 = {attributes: e2}, o2 = document.createElement(t3), e2.editable != null && (e2.attributes == null && (e2.attributes = {}), e2.attributes.contenteditable = e2.editable), e2.attributes) {
            l = e2.attributes;
            for (a in l)
              g = l[a], o2.setAttribute(a, g);
          }
          if (e2.style) {
            h = e2.style;
            for (a in h)
              g = h[a], o2.style[a] = g;
          }
          if (e2.data) {
            p = e2.data;
            for (a in p)
              g = p[a], o2.dataset[a] = g;
          }
          if (e2.className)
            for (d = e2.className.split(" "), r2 = 0, u = d.length; u > r2; r2++)
              i2 = d[r2], o2.classList.add(i2);
          if (e2.textContent && (o2.textContent = e2.textContent), e2.childNodes)
            for (f = [].concat(e2.childNodes), s2 = 0, c = f.length; c > s2; s2++)
              n2 = f[s2], o2.appendChild(n2);
          return o2;
        }, getBlockTagNames: function() {
          var t3, n2;
          return e.blockTagNames != null ? e.blockTagNames : e.blockTagNames = function() {
            var i2, o2;
            i2 = e.config.blockAttributes, o2 = [];
            for (t3 in i2)
              n2 = i2[t3].tagName, n2 && o2.push(n2);
            return o2;
          }();
        }, nodeIsBlockContainer: function(t3) {
          return e.nodeIsBlockStartComment(t3 != null ? t3.firstChild : void 0);
        }, nodeProbablyIsBlockContainer: function(t3) {
          var n2, i2;
          return n2 = e.tagName(t3), s.call(e.getBlockTagNames(), n2) >= 0 && (i2 = e.tagName(t3.firstChild), s.call(e.getBlockTagNames(), i2) < 0);
        }, nodeIsBlockStart: function(t3, n2) {
          var i2;
          return i2 = (n2 != null ? n2 : {strict: true}).strict, i2 ? e.nodeIsBlockStartComment(t3) : e.nodeIsBlockStartComment(t3) || !e.nodeIsBlockStartComment(t3.firstChild) && e.nodeProbablyIsBlockContainer(t3);
        }, nodeIsBlockStartComment: function(t3) {
          return e.nodeIsCommentNode(t3) && (t3 != null ? t3.data : void 0) === "block";
        }, nodeIsCommentNode: function(t3) {
          return (t3 != null ? t3.nodeType : void 0) === Node.COMMENT_NODE;
        }, nodeIsCursorTarget: function(t3, n2) {
          var i2;
          return i2 = (n2 != null ? n2 : {}).name, t3 ? e.nodeIsTextNode(t3) ? t3.data === e.ZERO_WIDTH_SPACE ? i2 ? t3.parentNode.dataset.trixCursorTarget === i2 : true : void 0 : e.nodeIsCursorTarget(t3.firstChild) : void 0;
        }, nodeIsAttachmentElement: function(t3) {
          return e.elementMatchesSelector(t3, e.AttachmentView.attachmentSelector);
        }, nodeIsEmptyTextNode: function(t3) {
          return e.nodeIsTextNode(t3) && (t3 != null ? t3.data : void 0) === "";
        }, nodeIsTextNode: function(t3) {
          return (t3 != null ? t3.nodeType : void 0) === Node.TEXT_NODE;
        }});
      }.call(this), function() {
        var t2, n, i, o, r;
        t2 = e.copyObject, o = e.objectsAreEqual, e.extend({normalizeRange: i = function(t3) {
          var e2;
          if (t3 != null)
            return Array.isArray(t3) || (t3 = [t3, t3]), [n(t3[0]), n((e2 = t3[1]) != null ? e2 : t3[0])];
        }, rangeIsCollapsed: function(t3) {
          var e2, n2, o2;
          if (t3 != null)
            return n2 = i(t3), o2 = n2[0], e2 = n2[1], r(o2, e2);
        }, rangesAreEqual: function(t3, e2) {
          var n2, o2, s, a, u, c;
          if (t3 != null && e2 != null)
            return s = i(t3), o2 = s[0], n2 = s[1], a = i(e2), c = a[0], u = a[1], r(o2, c) && r(n2, u);
        }}), n = function(e2) {
          return typeof e2 == "number" ? e2 : t2(e2);
        }, r = function(t3, e2) {
          return typeof t3 == "number" ? t3 === e2 : o(t3, e2);
        };
      }.call(this), function() {
        var t2, n, i, o, r, s, a;
        e.registerElement = function(t3, e2) {
          var n2, i2;
          return e2 == null && (e2 = {}), t3 = t3.toLowerCase(), e2 = a(e2), i2 = s(e2), (n2 = i2.defaultCSS) && (delete i2.defaultCSS, o(n2, t3)), r(t3, i2);
        }, o = function(t3, e2) {
          var n2;
          return n2 = i(e2), n2.textContent = t3.replace(/%t/g, e2);
        }, i = function(e2) {
          var n2, i2;
          return n2 = document.createElement("style"), n2.setAttribute("type", "text/css"), n2.setAttribute("data-tag-name", e2.toLowerCase()), (i2 = t2()) && n2.setAttribute("nonce", i2), document.head.insertBefore(n2, document.head.firstChild), n2;
        }, t2 = function() {
          var t3;
          return (t3 = n("trix-csp-nonce") || n("csp-nonce")) ? t3.getAttribute("content") : void 0;
        }, n = function(t3) {
          return document.head.querySelector("meta[name=" + t3 + "]");
        }, s = function(t3) {
          var e2, n2, i2;
          n2 = {};
          for (e2 in t3)
            i2 = t3[e2], n2[e2] = typeof i2 == "function" ? {value: i2} : i2;
          return n2;
        }, a = function() {
          var t3;
          return t3 = function(t4) {
            var e2, n2, i2, o2, r2;
            for (e2 = {}, r2 = ["initialize", "connect", "disconnect"], n2 = 0, o2 = r2.length; o2 > n2; n2++)
              i2 = r2[n2], e2[i2] = t4[i2], delete t4[i2];
            return e2;
          }, window.customElements ? function(e2) {
            var n2, i2, o2, r2, s2;
            return s2 = t3(e2), o2 = s2.initialize, n2 = s2.connect, i2 = s2.disconnect, o2 && (r2 = n2, n2 = function() {
              return this.initialized || (this.initialized = true, o2.call(this)), r2 != null ? r2.call(this) : void 0;
            }), n2 && (e2.connectedCallback = n2), i2 && (e2.disconnectedCallback = i2), e2;
          } : function(e2) {
            var n2, i2, o2, r2;
            return r2 = t3(e2), o2 = r2.initialize, n2 = r2.connect, i2 = r2.disconnect, o2 && (e2.createdCallback = o2), n2 && (e2.attachedCallback = n2), i2 && (e2.detachedCallback = i2), e2;
          };
        }(), r = function() {
          return window.customElements ? function(t3, e2) {
            var n2;
            return n2 = function() {
              return typeof Reflect == "object" ? Reflect.construct(HTMLElement, [], n2) : HTMLElement.apply(this);
            }, Object.setPrototypeOf(n2.prototype, HTMLElement.prototype), Object.setPrototypeOf(n2, HTMLElement), Object.defineProperties(n2.prototype, e2), window.customElements.define(t3, n2), n2;
          } : function(t3, e2) {
            var n2, i2;
            return i2 = Object.create(HTMLElement.prototype, e2), n2 = document.registerElement(t3, {prototype: i2}), Object.defineProperty(i2, "constructor", {value: n2}), n2;
          };
        }();
      }.call(this), function() {
        var t2, n;
        e.extend({getDOMSelection: function() {
          var t3;
          return t3 = window.getSelection(), t3.rangeCount > 0 ? t3 : void 0;
        }, getDOMRange: function() {
          var n2, i;
          return (n2 = (i = e.getDOMSelection()) != null ? i.getRangeAt(0) : void 0) && !t2(n2) ? n2 : void 0;
        }, setDOMRange: function(t3) {
          var n2;
          return n2 = window.getSelection(), n2.removeAllRanges(), n2.addRange(t3), e.selectionChangeObserver.update();
        }}), t2 = function(t3) {
          return n(t3.startContainer) || n(t3.endContainer);
        }, n = function(t3) {
          return !Object.getPrototypeOf(t3);
        };
      }.call(this), function() {
        var t2;
        t2 = {"application/x-trix-feature-detection": "test"}, e.extend({dataTransferIsPlainText: function(t3) {
          var e2, n, i;
          return i = t3.getData("text/plain"), n = t3.getData("text/html"), i && n ? (e2 = new DOMParser().parseFromString(n, "text/html").body, e2.textContent === i ? !e2.querySelector("*") : void 0) : i != null ? i.length : void 0;
        }, dataTransferIsWritable: function(e2) {
          var n, i;
          if ((e2 != null ? e2.setData : void 0) != null) {
            for (n in t2)
              if (i = t2[n], !function() {
                try {
                  return e2.setData(n, i), e2.getData(n) === i;
                } catch (t3) {
                }
              }())
                return;
            return true;
          }
        }, keyEventIsKeyboardCommand: function() {
          return /Mac|^iP/.test(navigator.platform) ? function(t3) {
            return t3.metaKey;
          } : function(t3) {
            return t3.ctrlKey;
          };
        }()});
      }.call(this), function() {
        e.extend({RTL_PATTERN: /[\u05BE\u05C0\u05C3\u05D0-\u05EA\u05F0-\u05F4\u061B\u061F\u0621-\u063A\u0640-\u064A\u066D\u0671-\u06B7\u06BA-\u06BE\u06C0-\u06CE\u06D0-\u06D5\u06E5\u06E6\u200F\u202B\u202E\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE72\uFE74\uFE76-\uFEFC]/, getDirection: function() {
          var t2, n, i, o;
          return n = e.makeElement("input", {dir: "auto", name: "x", dirName: "x.dir"}), t2 = e.makeElement("form"), t2.appendChild(n), i = function() {
            try {
              return new FormData(t2).has(n.dirName);
            } catch (e2) {
            }
          }(), o = function() {
            try {
              return n.matches(":dir(ltr),:dir(rtl)");
            } catch (t3) {
            }
          }(), i ? function(e2) {
            return n.value = e2, new FormData(t2).get(n.dirName);
          } : o ? function(t3) {
            return n.value = t3, n.matches(":dir(rtl)") ? "rtl" : "ltr";
          } : function(t3) {
            var n2;
            return n2 = t3.trim().charAt(0), e.RTL_PATTERN.test(n2) ? "rtl" : "ltr";
          };
        }()});
      }.call(this), function() {
      }.call(this), function() {
        var t2, n = function(t3, e2) {
          function n2() {
            this.constructor = t3;
          }
          for (var o in e2)
            i.call(e2, o) && (t3[o] = e2[o]);
          return n2.prototype = e2.prototype, t3.prototype = new n2(), t3.__super__ = e2.prototype, t3;
        }, i = {}.hasOwnProperty;
        t2 = e.arraysAreEqual, e.Hash = function(i2) {
          function o(t3) {
            t3 == null && (t3 = {}), this.values = s(t3), o.__super__.constructor.apply(this, arguments);
          }
          var r, s, a, u, c;
          return n(o, i2), o.fromCommonAttributesOfObjects = function(t3) {
            var e2, n2, i3, o2, s2, a2;
            if (t3 == null && (t3 = []), !t3.length)
              return new this();
            for (e2 = r(t3[0]), i3 = e2.getKeys(), a2 = t3.slice(1), n2 = 0, o2 = a2.length; o2 > n2; n2++)
              s2 = a2[n2], i3 = e2.getKeysCommonToHash(r(s2)), e2 = e2.slice(i3);
            return e2;
          }, o.box = function(t3) {
            return r(t3);
          }, o.prototype.add = function(t3, e2) {
            return this.merge(u(t3, e2));
          }, o.prototype.remove = function(t3) {
            return new e.Hash(s(this.values, t3));
          }, o.prototype.get = function(t3) {
            return this.values[t3];
          }, o.prototype.has = function(t3) {
            return t3 in this.values;
          }, o.prototype.merge = function(t3) {
            return new e.Hash(a(this.values, c(t3)));
          }, o.prototype.slice = function(t3) {
            var n2, i3, o2, r2;
            for (r2 = {}, n2 = 0, o2 = t3.length; o2 > n2; n2++)
              i3 = t3[n2], this.has(i3) && (r2[i3] = this.values[i3]);
            return new e.Hash(r2);
          }, o.prototype.getKeys = function() {
            return Object.keys(this.values);
          }, o.prototype.getKeysCommonToHash = function(t3) {
            var e2, n2, i3, o2, s2;
            for (t3 = r(t3), o2 = this.getKeys(), s2 = [], e2 = 0, i3 = o2.length; i3 > e2; e2++)
              n2 = o2[e2], this.values[n2] === t3.values[n2] && s2.push(n2);
            return s2;
          }, o.prototype.isEqualTo = function(e2) {
            return t2(this.toArray(), r(e2).toArray());
          }, o.prototype.isEmpty = function() {
            return this.getKeys().length === 0;
          }, o.prototype.toArray = function() {
            var t3, e2, n2;
            return (this.array != null ? this.array : this.array = function() {
              var i3;
              e2 = [], i3 = this.values;
              for (t3 in i3)
                n2 = i3[t3], e2.push(t3, n2);
              return e2;
            }.call(this)).slice(0);
          }, o.prototype.toObject = function() {
            return s(this.values);
          }, o.prototype.toJSON = function() {
            return this.toObject();
          }, o.prototype.contentsForInspection = function() {
            return {values: JSON.stringify(this.values)};
          }, u = function(t3, e2) {
            var n2;
            return n2 = {}, n2[t3] = e2, n2;
          }, a = function(t3, e2) {
            var n2, i3, o2;
            i3 = s(t3);
            for (n2 in e2)
              o2 = e2[n2], i3[n2] = o2;
            return i3;
          }, s = function(t3, e2) {
            var n2, i3, o2, r2, s2;
            for (r2 = {}, s2 = Object.keys(t3).sort(), n2 = 0, o2 = s2.length; o2 > n2; n2++)
              i3 = s2[n2], i3 !== e2 && (r2[i3] = t3[i3]);
            return r2;
          }, r = function(t3) {
            return t3 instanceof e.Hash ? t3 : new e.Hash(t3);
          }, c = function(t3) {
            return t3 instanceof e.Hash ? t3.values : t3;
          }, o;
        }(e.Object);
      }.call(this), function() {
        e.ObjectGroup = function() {
          function t2(t3, e2) {
            var n, i;
            this.objects = t3 != null ? t3 : [], i = e2.depth, n = e2.asTree, n && (this.depth = i, this.objects = this.constructor.groupObjects(this.objects, {asTree: n, depth: this.depth + 1}));
          }
          return t2.groupObjects = function(t3, e2) {
            var n, i, o, r, s, a, u, c, l;
            for (t3 == null && (t3 = []), l = e2 != null ? e2 : {}, o = l.depth, n = l.asTree, n && o == null && (o = 0), c = [], s = 0, a = t3.length; a > s; s++) {
              if (u = t3[s], r) {
                if ((typeof u.canBeGrouped == "function" ? u.canBeGrouped(o) : void 0) && (typeof (i = r[r.length - 1]).canBeGroupedWith == "function" ? i.canBeGroupedWith(u, o) : void 0)) {
                  r.push(u);
                  continue;
                }
                c.push(new this(r, {depth: o, asTree: n})), r = null;
              }
              (typeof u.canBeGrouped == "function" ? u.canBeGrouped(o) : void 0) ? r = [u] : c.push(u);
            }
            return r && c.push(new this(r, {depth: o, asTree: n})), c;
          }, t2.prototype.getObjects = function() {
            return this.objects;
          }, t2.prototype.getDepth = function() {
            return this.depth;
          }, t2.prototype.getCacheKey = function() {
            var t3, e2, n, i, o;
            for (e2 = ["objectGroup"], o = this.getObjects(), t3 = 0, n = o.length; n > t3; t3++)
              i = o[t3], e2.push(i.getCacheKey());
            return e2.join("/");
          }, t2;
        }();
      }.call(this), function() {
        var t2 = function(t3, e2) {
          function i() {
            this.constructor = t3;
          }
          for (var o in e2)
            n.call(e2, o) && (t3[o] = e2[o]);
          return i.prototype = e2.prototype, t3.prototype = new i(), t3.__super__ = e2.prototype, t3;
        }, n = {}.hasOwnProperty;
        e.ObjectMap = function(e2) {
          function n2(t3) {
            var e3, n3, i, o, r;
            for (t3 == null && (t3 = []), this.objects = {}, i = 0, o = t3.length; o > i; i++)
              r = t3[i], n3 = JSON.stringify(r), (e3 = this.objects)[n3] == null && (e3[n3] = r);
          }
          return t2(n2, e2), n2.prototype.find = function(t3) {
            var e3;
            return e3 = JSON.stringify(t3), this.objects[e3];
          }, n2;
        }(e.BasicObject);
      }.call(this), function() {
        e.ElementStore = function() {
          function t2(t3) {
            this.reset(t3);
          }
          var e2;
          return t2.prototype.add = function(t3) {
            var n;
            return n = e2(t3), this.elements[n] = t3;
          }, t2.prototype.remove = function(t3) {
            var n, i;
            return n = e2(t3), (i = this.elements[n]) ? (delete this.elements[n], i) : void 0;
          }, t2.prototype.reset = function(t3) {
            var e3, n, i;
            for (t3 == null && (t3 = []), this.elements = {}, n = 0, i = t3.length; i > n; n++)
              e3 = t3[n], this.add(e3);
            return t3;
          }, e2 = function(t3) {
            return t3.dataset.trixStoreKey;
          }, t2;
        }();
      }.call(this), function() {
      }.call(this), function() {
        var t2 = function(t3, e2) {
          function i() {
            this.constructor = t3;
          }
          for (var o in e2)
            n.call(e2, o) && (t3[o] = e2[o]);
          return i.prototype = e2.prototype, t3.prototype = new i(), t3.__super__ = e2.prototype, t3;
        }, n = {}.hasOwnProperty;
        e.Operation = function(e2) {
          function n2() {
            return n2.__super__.constructor.apply(this, arguments);
          }
          return t2(n2, e2), n2.prototype.isPerforming = function() {
            return this.performing === true;
          }, n2.prototype.hasPerformed = function() {
            return this.performed === true;
          }, n2.prototype.hasSucceeded = function() {
            return this.performed && this.succeeded;
          }, n2.prototype.hasFailed = function() {
            return this.performed && !this.succeeded;
          }, n2.prototype.getPromise = function() {
            return this.promise != null ? this.promise : this.promise = new Promise(function(t3) {
              return function(e3, n3) {
                return t3.performing = true, t3.perform(function(i, o) {
                  return t3.succeeded = i, t3.performing = false, t3.performed = true, t3.succeeded ? e3(o) : n3(o);
                });
              };
            }(this));
          }, n2.prototype.perform = function(t3) {
            return t3(false);
          }, n2.prototype.release = function() {
            var t3;
            return (t3 = this.promise) != null && typeof t3.cancel == "function" && t3.cancel(), this.promise = null, this.performing = null, this.performed = null, this.succeeded = null;
          }, n2.proxyMethod("getPromise().then"), n2.proxyMethod("getPromise().catch"), n2;
        }(e.BasicObject);
      }.call(this), function() {
        var t2, n, i, o, r, s = function(t3, e2) {
          function n2() {
            this.constructor = t3;
          }
          for (var i2 in e2)
            a.call(e2, i2) && (t3[i2] = e2[i2]);
          return n2.prototype = e2.prototype, t3.prototype = new n2(), t3.__super__ = e2.prototype, t3;
        }, a = {}.hasOwnProperty;
        e.UTF16String = function(t3) {
          function e2(t4, e3) {
            this.ucs2String = t4, this.codepoints = e3, this.length = this.codepoints.length, this.ucs2Length = this.ucs2String.length;
          }
          return s(e2, t3), e2.box = function(t4) {
            return t4 == null && (t4 = ""), t4 instanceof this ? t4 : this.fromUCS2String(t4 != null ? t4.toString() : void 0);
          }, e2.fromUCS2String = function(t4) {
            return new this(t4, o(t4));
          }, e2.fromCodepoints = function(t4) {
            return new this(r(t4), t4);
          }, e2.prototype.offsetToUCS2Offset = function(t4) {
            return r(this.codepoints.slice(0, Math.max(0, t4))).length;
          }, e2.prototype.offsetFromUCS2Offset = function(t4) {
            return o(this.ucs2String.slice(0, Math.max(0, t4))).length;
          }, e2.prototype.slice = function() {
            var t4;
            return this.constructor.fromCodepoints((t4 = this.codepoints).slice.apply(t4, arguments));
          }, e2.prototype.charAt = function(t4) {
            return this.slice(t4, t4 + 1);
          }, e2.prototype.isEqualTo = function(t4) {
            return this.constructor.box(t4).ucs2String === this.ucs2String;
          }, e2.prototype.toJSON = function() {
            return this.ucs2String;
          }, e2.prototype.getCacheKey = function() {
            return this.ucs2String;
          }, e2.prototype.toString = function() {
            return this.ucs2String;
          }, e2;
        }(e.BasicObject), t2 = (typeof Array.from == "function" ? Array.from("\u{1F47C}").length : void 0) === 1, n = (typeof " ".codePointAt == "function" ? " ".codePointAt(0) : void 0) != null, i = (typeof String.fromCodePoint == "function" ? String.fromCodePoint(32, 128124) : void 0) === " \u{1F47C}", o = t2 && n ? function(t3) {
          return Array.from(t3).map(function(t4) {
            return t4.codePointAt(0);
          });
        } : function(t3) {
          var e2, n2, i2, o2, r2;
          for (o2 = [], e2 = 0, i2 = t3.length; i2 > e2; )
            r2 = t3.charCodeAt(e2++), r2 >= 55296 && 56319 >= r2 && i2 > e2 && (n2 = t3.charCodeAt(e2++), (64512 & n2) === 56320 ? r2 = ((1023 & r2) << 10) + (1023 & n2) + 65536 : e2--), o2.push(r2);
          return o2;
        }, r = i ? function(t3) {
          return String.fromCodePoint.apply(String, t3);
        } : function(t3) {
          var e2, n2, i2;
          return e2 = function() {
            var e3, o2, r2;
            for (r2 = [], e3 = 0, o2 = t3.length; o2 > e3; e3++)
              i2 = t3[e3], n2 = "", i2 > 65535 && (i2 -= 65536, n2 += String.fromCharCode(i2 >>> 10 & 1023 | 55296), i2 = 56320 | 1023 & i2), r2.push(n2 + String.fromCharCode(i2));
            return r2;
          }(), e2.join("");
        };
      }.call(this), function() {
      }.call(this), function() {
      }.call(this), function() {
        e.config.lang = {attachFiles: "Attach Files", bold: "Bold", bullets: "Bullets", byte: "Byte", bytes: "Bytes", captionPlaceholder: "Add a caption\u2026", code: "Code", heading1: "Heading", indent: "Increase Level", italic: "Italic", link: "Link", numbers: "Numbers", outdent: "Decrease Level", quote: "Quote", redo: "Redo", remove: "Remove", strike: "Strikethrough", undo: "Undo", unlink: "Unlink", url: "URL", urlPlaceholder: "Enter a URL\u2026", GB: "GB", KB: "KB", MB: "MB", PB: "PB", TB: "TB"};
      }.call(this), function() {
        e.config.css = {attachment: "attachment", attachmentCaption: "attachment__caption", attachmentCaptionEditor: "attachment__caption-editor", attachmentMetadata: "attachment__metadata", attachmentMetadataContainer: "attachment__metadata-container", attachmentName: "attachment__name", attachmentProgress: "attachment__progress", attachmentSize: "attachment__size", attachmentToolbar: "attachment__toolbar", attachmentGallery: "attachment-gallery"};
      }.call(this), function() {
        var t2;
        e.config.blockAttributes = t2 = {default: {tagName: "div", parse: false}, quote: {tagName: "blockquote", nestable: true}, heading1: {tagName: "h1", terminal: true, breakOnReturn: true, group: false}, code: {tagName: "pre", terminal: true, text: {plaintext: true}}, bulletList: {tagName: "ul", parse: false}, bullet: {tagName: "li", listAttribute: "bulletList", group: false, nestable: true, test: function(n) {
          return e.tagName(n.parentNode) === t2[this.listAttribute].tagName;
        }}, numberList: {tagName: "ol", parse: false}, number: {tagName: "li", listAttribute: "numberList", group: false, nestable: true, test: function(n) {
          return e.tagName(n.parentNode) === t2[this.listAttribute].tagName;
        }}, attachmentGallery: {tagName: "div", exclusive: true, terminal: true, parse: false, group: false}};
      }.call(this), function() {
        var t2, n;
        t2 = e.config.lang, n = [t2.bytes, t2.KB, t2.MB, t2.GB, t2.TB, t2.PB], e.config.fileSize = {prefix: "IEC", precision: 2, formatter: function(e2) {
          var i, o, r, s, a;
          switch (e2) {
            case 0:
              return "0 " + t2.bytes;
            case 1:
              return "1 " + t2.byte;
            default:
              return i = function() {
                switch (this.prefix) {
                  case "SI":
                    return 1e3;
                  case "IEC":
                    return 1024;
                }
              }.call(this), o = Math.floor(Math.log(e2) / Math.log(i)), r = e2 / Math.pow(i, o), s = r.toFixed(this.precision), a = s.replace(/0*$/, "").replace(/\.$/, ""), a + " " + n[o];
          }
        }};
      }.call(this), function() {
        e.config.textAttributes = {bold: {tagName: "strong", inheritable: true, parser: function(t2) {
          var e2;
          return e2 = window.getComputedStyle(t2), e2.fontWeight === "bold" || e2.fontWeight >= 600;
        }}, italic: {tagName: "em", inheritable: true, parser: function(t2) {
          var e2;
          return e2 = window.getComputedStyle(t2), e2.fontStyle === "italic";
        }}, href: {groupTagName: "a", parser: function(t2) {
          var n, i, o;
          return n = e.AttachmentView.attachmentSelector, o = "a:not(" + n + ")", (i = e.findClosestElementFromNode(t2, {matchingSelector: o})) ? i.getAttribute("href") : void 0;
        }}, strike: {tagName: "del", inheritable: true}, frozen: {style: {backgroundColor: "highlight"}}};
      }.call(this), function() {
        var t2, n, i, o, r;
        r = "[data-trix-serialize=false]", o = ["contenteditable", "data-trix-id", "data-trix-store-key", "data-trix-mutable", "data-trix-placeholder", "tabindex"], n = "data-trix-serialized-attributes", i = "[" + n + "]", t2 = new RegExp("<!--block-->", "g"), e.extend({serializers: {"application/json": function(t3) {
          var n2;
          if (t3 instanceof e.Document)
            n2 = t3;
          else {
            if (!(t3 instanceof HTMLElement))
              throw new Error("unserializable object");
            n2 = e.Document.fromHTML(t3.innerHTML);
          }
          return n2.toSerializableDocument().toJSONString();
        }, "text/html": function(s) {
          var a, u, c, l, h, p, d, f, g, m, v, y, b, A, C3, x, w;
          if (s instanceof e.Document)
            l = e.DocumentView.render(s);
          else {
            if (!(s instanceof HTMLElement))
              throw new Error("unserializable object");
            l = s.cloneNode(true);
          }
          for (A = l.querySelectorAll(r), h = 0, g = A.length; g > h; h++)
            c = A[h], e.removeNode(c);
          for (p = 0, m = o.length; m > p; p++)
            for (a = o[p], C3 = l.querySelectorAll("[" + a + "]"), d = 0, v = C3.length; v > d; d++)
              c = C3[d], c.removeAttribute(a);
          for (x = l.querySelectorAll(i), f = 0, y = x.length; y > f; f++) {
            c = x[f];
            try {
              u = JSON.parse(c.getAttribute(n)), c.removeAttribute(n);
              for (b in u)
                w = u[b], c.setAttribute(b, w);
            } catch (E) {
            }
          }
          return l.innerHTML.replace(t2, "");
        }}, deserializers: {"application/json": function(t3) {
          return e.Document.fromJSONString(t3);
        }, "text/html": function(t3) {
          return e.Document.fromHTML(t3);
        }}, serializeToContentType: function(t3, n2) {
          var i2;
          if (i2 = e.serializers[n2])
            return i2(t3);
          throw new Error("unknown content type: " + n2);
        }, deserializeFromContentType: function(t3, n2) {
          var i2;
          if (i2 = e.deserializers[n2])
            return i2(t3);
          throw new Error("unknown content type: " + n2);
        }});
      }.call(this), function() {
        var t2;
        t2 = e.config.lang, e.config.toolbar = {getDefaultHTML: function() {
          return '<div class="trix-button-row">\n  <span class="trix-button-group trix-button-group--text-tools" data-trix-button-group="text-tools">\n    <button type="button" class="trix-button trix-button--icon trix-button--icon-bold" data-trix-attribute="bold" data-trix-key="b" title="' + t2.bold + '" tabindex="-1">' + t2.bold + '</button>\n    <button type="button" class="trix-button trix-button--icon trix-button--icon-italic" data-trix-attribute="italic" data-trix-key="i" title="' + t2.italic + '" tabindex="-1">' + t2.italic + '</button>\n    <button type="button" class="trix-button trix-button--icon trix-button--icon-strike" data-trix-attribute="strike" title="' + t2.strike + '" tabindex="-1">' + t2.strike + '</button>\n    <button type="button" class="trix-button trix-button--icon trix-button--icon-link" data-trix-attribute="href" data-trix-action="link" data-trix-key="k" title="' + t2.link + '" tabindex="-1">' + t2.link + '</button>\n  </span>\n\n  <span class="trix-button-group trix-button-group--block-tools" data-trix-button-group="block-tools">\n    <button type="button" class="trix-button trix-button--icon trix-button--icon-heading-1" data-trix-attribute="heading1" title="' + t2.heading1 + '" tabindex="-1">' + t2.heading1 + '</button>\n    <button type="button" class="trix-button trix-button--icon trix-button--icon-quote" data-trix-attribute="quote" title="' + t2.quote + '" tabindex="-1">' + t2.quote + '</button>\n    <button type="button" class="trix-button trix-button--icon trix-button--icon-code" data-trix-attribute="code" title="' + t2.code + '" tabindex="-1">' + t2.code + '</button>\n    <button type="button" class="trix-button trix-button--icon trix-button--icon-bullet-list" data-trix-attribute="bullet" title="' + t2.bullets + '" tabindex="-1">' + t2.bullets + '</button>\n    <button type="button" class="trix-button trix-button--icon trix-button--icon-number-list" data-trix-attribute="number" title="' + t2.numbers + '" tabindex="-1">' + t2.numbers + '</button>\n    <button type="button" class="trix-button trix-button--icon trix-button--icon-decrease-nesting-level" data-trix-action="decreaseNestingLevel" title="' + t2.outdent + '" tabindex="-1">' + t2.outdent + '</button>\n    <button type="button" class="trix-button trix-button--icon trix-button--icon-increase-nesting-level" data-trix-action="increaseNestingLevel" title="' + t2.indent + '" tabindex="-1">' + t2.indent + '</button>\n  </span>\n\n  <span class="trix-button-group trix-button-group--file-tools" data-trix-button-group="file-tools">\n    <button type="button" class="trix-button trix-button--icon trix-button--icon-attach" data-trix-action="attachFiles" title="' + t2.attachFiles + '" tabindex="-1">' + t2.attachFiles + '</button>\n  </span>\n\n  <span class="trix-button-group-spacer"></span>\n\n  <span class="trix-button-group trix-button-group--history-tools" data-trix-button-group="history-tools">\n    <button type="button" class="trix-button trix-button--icon trix-button--icon-undo" data-trix-action="undo" data-trix-key="z" title="' + t2.undo + '" tabindex="-1">' + t2.undo + '</button>\n    <button type="button" class="trix-button trix-button--icon trix-button--icon-redo" data-trix-action="redo" data-trix-key="shift+z" title="' + t2.redo + '" tabindex="-1">' + t2.redo + '</button>\n  </span>\n</div>\n\n<div class="trix-dialogs" data-trix-dialogs>\n  <div class="trix-dialog trix-dialog--link" data-trix-dialog="href" data-trix-dialog-attribute="href">\n    <div class="trix-dialog__link-fields">\n      <input type="url" name="href" class="trix-input trix-input--dialog" placeholder="' + t2.urlPlaceholder + '" aria-label="' + t2.url + '" required data-trix-input>\n      <div class="trix-button-group">\n        <input type="button" class="trix-button trix-button--dialog" value="' + t2.link + '" data-trix-method="setAttribute">\n        <input type="button" class="trix-button trix-button--dialog" value="' + t2.unlink + '" data-trix-method="removeAttribute">\n      </div>\n    </div>\n  </div>\n</div>';
        }};
      }.call(this), function() {
        e.config.undoInterval = 5e3;
      }.call(this), function() {
        e.config.attachments = {preview: {presentation: "gallery", caption: {name: true, size: true}}, file: {caption: {size: true}}};
      }.call(this), function() {
        e.config.keyNames = {8: "backspace", 9: "tab", 13: "return", 27: "escape", 37: "left", 39: "right", 46: "delete", 68: "d", 72: "h", 79: "o"};
      }.call(this), function() {
        e.config.input = {level2Enabled: true, getLevel: function() {
          return this.level2Enabled && e.browser.supportsInputEvents ? 2 : 0;
        }, pickFiles: function(t2) {
          var n;
          return n = e.makeElement("input", {type: "file", multiple: true, hidden: true, id: this.fileInputId}), n.addEventListener("change", function() {
            return t2(n.files), e.removeNode(n);
          }), e.removeNode(document.getElementById(this.fileInputId)), document.body.appendChild(n), n.click();
        }, fileInputId: "trix-file-input-" + Date.now().toString(16)};
      }.call(this), function() {
      }.call(this), function() {
        e.registerElement("trix-toolbar", {defaultCSS: "%t {\n  display: block;\n}\n\n%t {\n  white-space: nowrap;\n}\n\n%t [data-trix-dialog] {\n  display: none;\n}\n\n%t [data-trix-dialog][data-trix-active] {\n  display: block;\n}\n\n%t [data-trix-dialog] [data-trix-validate]:invalid {\n  background-color: #ffdddd;\n}", initialize: function() {
          return this.innerHTML === "" ? this.innerHTML = e.config.toolbar.getDefaultHTML() : void 0;
        }});
      }.call(this), function() {
        var t2 = function(t3, e2) {
          function i2() {
            this.constructor = t3;
          }
          for (var o in e2)
            n.call(e2, o) && (t3[o] = e2[o]);
          return i2.prototype = e2.prototype, t3.prototype = new i2(), t3.__super__ = e2.prototype, t3;
        }, n = {}.hasOwnProperty, i = [].indexOf || function(t3) {
          for (var e2 = 0, n2 = this.length; n2 > e2; e2++)
            if (e2 in this && this[e2] === t3)
              return e2;
          return -1;
        };
        e.ObjectView = function(n2) {
          function o(t3, e2) {
            this.object = t3, this.options = e2 != null ? e2 : {}, this.childViews = [], this.rootView = this;
          }
          return t2(o, n2), o.prototype.getNodes = function() {
            var t3, e2, n3, i2, o2;
            for (this.nodes == null && (this.nodes = this.createNodes()), i2 = this.nodes, o2 = [], t3 = 0, e2 = i2.length; e2 > t3; t3++)
              n3 = i2[t3], o2.push(n3.cloneNode(true));
            return o2;
          }, o.prototype.invalidate = function() {
            var t3;
            return this.nodes = null, this.childViews = [], (t3 = this.parentView) != null ? t3.invalidate() : void 0;
          }, o.prototype.invalidateViewForObject = function(t3) {
            var e2;
            return (e2 = this.findViewForObject(t3)) != null ? e2.invalidate() : void 0;
          }, o.prototype.findOrCreateCachedChildView = function(t3, e2) {
            var n3;
            return (n3 = this.getCachedViewForObject(e2)) ? this.recordChildView(n3) : (n3 = this.createChildView.apply(this, arguments), this.cacheViewForObject(n3, e2)), n3;
          }, o.prototype.createChildView = function(t3, n3, i2) {
            var o2;
            return i2 == null && (i2 = {}), n3 instanceof e.ObjectGroup && (i2.viewClass = t3, t3 = e.ObjectGroupView), o2 = new t3(n3, i2), this.recordChildView(o2);
          }, o.prototype.recordChildView = function(t3) {
            return t3.parentView = this, t3.rootView = this.rootView, this.childViews.push(t3), t3;
          }, o.prototype.getAllChildViews = function() {
            var t3, e2, n3, i2, o2;
            for (o2 = [], i2 = this.childViews, e2 = 0, n3 = i2.length; n3 > e2; e2++)
              t3 = i2[e2], o2.push(t3), o2 = o2.concat(t3.getAllChildViews());
            return o2;
          }, o.prototype.findElement = function() {
            return this.findElementForObject(this.object);
          }, o.prototype.findElementForObject = function(t3) {
            var e2;
            return (e2 = t3 != null ? t3.id : void 0) ? this.rootView.element.querySelector("[data-trix-id='" + e2 + "']") : void 0;
          }, o.prototype.findViewForObject = function(t3) {
            var e2, n3, i2, o2;
            for (i2 = this.getAllChildViews(), e2 = 0, n3 = i2.length; n3 > e2; e2++)
              if (o2 = i2[e2], o2.object === t3)
                return o2;
          }, o.prototype.getViewCache = function() {
            return this.rootView !== this ? this.rootView.getViewCache() : this.isViewCachingEnabled() ? this.viewCache != null ? this.viewCache : this.viewCache = {} : void 0;
          }, o.prototype.isViewCachingEnabled = function() {
            return this.shouldCacheViews !== false;
          }, o.prototype.enableViewCaching = function() {
            return this.shouldCacheViews = true;
          }, o.prototype.disableViewCaching = function() {
            return this.shouldCacheViews = false;
          }, o.prototype.getCachedViewForObject = function(t3) {
            var e2;
            return (e2 = this.getViewCache()) != null ? e2[t3.getCacheKey()] : void 0;
          }, o.prototype.cacheViewForObject = function(t3, e2) {
            var n3;
            return (n3 = this.getViewCache()) != null ? n3[e2.getCacheKey()] = t3 : void 0;
          }, o.prototype.garbageCollectCachedViews = function() {
            var t3, e2, n3, o2, r, s;
            if (t3 = this.getViewCache()) {
              s = this.getAllChildViews().concat(this), n3 = function() {
                var t4, e3, n4;
                for (n4 = [], t4 = 0, e3 = s.length; e3 > t4; t4++)
                  r = s[t4], n4.push(r.object.getCacheKey());
                return n4;
              }(), o2 = [];
              for (e2 in t3)
                i.call(n3, e2) < 0 && o2.push(delete t3[e2]);
              return o2;
            }
          }, o;
        }(e.BasicObject);
      }.call(this), function() {
        var t2 = function(t3, e2) {
          function i() {
            this.constructor = t3;
          }
          for (var o in e2)
            n.call(e2, o) && (t3[o] = e2[o]);
          return i.prototype = e2.prototype, t3.prototype = new i(), t3.__super__ = e2.prototype, t3;
        }, n = {}.hasOwnProperty;
        e.ObjectGroupView = function(e2) {
          function n2() {
            n2.__super__.constructor.apply(this, arguments), this.objectGroup = this.object, this.viewClass = this.options.viewClass, delete this.options.viewClass;
          }
          return t2(n2, e2), n2.prototype.getChildViews = function() {
            var t3, e3, n3, i;
            if (!this.childViews.length)
              for (i = this.objectGroup.getObjects(), t3 = 0, e3 = i.length; e3 > t3; t3++)
                n3 = i[t3], this.findOrCreateCachedChildView(this.viewClass, n3, this.options);
            return this.childViews;
          }, n2.prototype.createNodes = function() {
            var t3, e3, n3, i, o, r, s, a, u;
            for (t3 = this.createContainerElement(), s = this.getChildViews(), e3 = 0, i = s.length; i > e3; e3++)
              for (u = s[e3], a = u.getNodes(), n3 = 0, o = a.length; o > n3; n3++)
                r = a[n3], t3.appendChild(r);
            return [t3];
          }, n2.prototype.createContainerElement = function(t3) {
            return t3 == null && (t3 = this.objectGroup.getDepth()), this.getChildViews()[0].createContainerElement(t3);
          }, n2;
        }(e.ObjectView);
      }.call(this), function() {
        var t2 = function(t3, e2) {
          function i() {
            this.constructor = t3;
          }
          for (var o in e2)
            n.call(e2, o) && (t3[o] = e2[o]);
          return i.prototype = e2.prototype, t3.prototype = new i(), t3.__super__ = e2.prototype, t3;
        }, n = {}.hasOwnProperty;
        e.Controller = function(e2) {
          function n2() {
            return n2.__super__.constructor.apply(this, arguments);
          }
          return t2(n2, e2), n2;
        }(e.BasicObject);
      }.call(this), function() {
        var t2, n, i, o, r, s, a = function(t3, e2) {
          return function() {
            return t3.apply(e2, arguments);
          };
        }, u = function(t3, e2) {
          function n2() {
            this.constructor = t3;
          }
          for (var i2 in e2)
            c.call(e2, i2) && (t3[i2] = e2[i2]);
          return n2.prototype = e2.prototype, t3.prototype = new n2(), t3.__super__ = e2.prototype, t3;
        }, c = {}.hasOwnProperty, l = [].indexOf || function(t3) {
          for (var e2 = 0, n2 = this.length; n2 > e2; e2++)
            if (e2 in this && this[e2] === t3)
              return e2;
          return -1;
        };
        t2 = e.findClosestElementFromNode, i = e.nodeIsEmptyTextNode, n = e.nodeIsBlockStartComment, o = e.normalizeSpaces, r = e.summarizeStringChange, s = e.tagName, e.MutationObserver = function(e2) {
          function c2(t3) {
            this.element = t3, this.didMutate = a(this.didMutate, this), this.observer = new window.MutationObserver(this.didMutate), this.start();
          }
          var h, p, d, f;
          return u(c2, e2), p = "data-trix-mutable", d = "[" + p + "]", f = {attributes: true, childList: true, characterData: true, characterDataOldValue: true, subtree: true}, c2.prototype.start = function() {
            return this.reset(), this.observer.observe(this.element, f);
          }, c2.prototype.stop = function() {
            return this.observer.disconnect();
          }, c2.prototype.didMutate = function(t3) {
            var e3, n2;
            return (e3 = this.mutations).push.apply(e3, this.findSignificantMutations(t3)), this.mutations.length ? ((n2 = this.delegate) != null && typeof n2.elementDidMutate == "function" && n2.elementDidMutate(this.getMutationSummary()), this.reset()) : void 0;
          }, c2.prototype.reset = function() {
            return this.mutations = [];
          }, c2.prototype.findSignificantMutations = function(t3) {
            var e3, n2, i2, o2;
            for (o2 = [], e3 = 0, n2 = t3.length; n2 > e3; e3++)
              i2 = t3[e3], this.mutationIsSignificant(i2) && o2.push(i2);
            return o2;
          }, c2.prototype.mutationIsSignificant = function(t3) {
            var e3, n2, i2, o2;
            if (this.nodeIsMutable(t3.target))
              return false;
            for (o2 = this.nodesModifiedByMutation(t3), e3 = 0, n2 = o2.length; n2 > e3; e3++)
              if (i2 = o2[e3], this.nodeIsSignificant(i2))
                return true;
            return false;
          }, c2.prototype.nodeIsSignificant = function(t3) {
            return t3 !== this.element && !this.nodeIsMutable(t3) && !i(t3);
          }, c2.prototype.nodeIsMutable = function(e3) {
            return t2(e3, {matchingSelector: d});
          }, c2.prototype.nodesModifiedByMutation = function(t3) {
            var e3;
            switch (e3 = [], t3.type) {
              case "attributes":
                t3.attributeName !== p && e3.push(t3.target);
                break;
              case "characterData":
                e3.push(t3.target.parentNode), e3.push(t3.target);
                break;
              case "childList":
                e3.push.apply(e3, t3.addedNodes), e3.push.apply(e3, t3.removedNodes);
            }
            return e3;
          }, c2.prototype.getMutationSummary = function() {
            return this.getTextMutationSummary();
          }, c2.prototype.getTextMutationSummary = function() {
            var t3, e3, n2, i2, o2, r2, s2, a2, u2, c3, h2;
            for (a2 = this.getTextChangesFromCharacterData(), n2 = a2.additions, o2 = a2.deletions, h2 = this.getTextChangesFromChildList(), u2 = h2.additions, r2 = 0, s2 = u2.length; s2 > r2; r2++)
              e3 = u2[r2], l.call(n2, e3) < 0 && n2.push(e3);
            return o2.push.apply(o2, h2.deletions), c3 = {}, (t3 = n2.join("")) && (c3.textAdded = t3), (i2 = o2.join("")) && (c3.textDeleted = i2), c3;
          }, c2.prototype.getMutationsByType = function(t3) {
            var e3, n2, i2, o2, r2;
            for (o2 = this.mutations, r2 = [], e3 = 0, n2 = o2.length; n2 > e3; e3++)
              i2 = o2[e3], i2.type === t3 && r2.push(i2);
            return r2;
          }, c2.prototype.getTextChangesFromChildList = function() {
            var t3, e3, i2, r2, s2, a2, u2, c3, l2, p2, d2;
            for (t3 = [], u2 = [], a2 = this.getMutationsByType("childList"), e3 = 0, r2 = a2.length; r2 > e3; e3++)
              s2 = a2[e3], t3.push.apply(t3, s2.addedNodes), u2.push.apply(u2, s2.removedNodes);
            return c3 = t3.length === 0 && u2.length === 1 && n(u2[0]), c3 ? (p2 = [], d2 = ["\n"]) : (p2 = h(t3), d2 = h(u2)), {additions: function() {
              var t4, e4, n2;
              for (n2 = [], i2 = t4 = 0, e4 = p2.length; e4 > t4; i2 = ++t4)
                l2 = p2[i2], l2 !== d2[i2] && n2.push(o(l2));
              return n2;
            }(), deletions: function() {
              var t4, e4, n2;
              for (n2 = [], i2 = t4 = 0, e4 = d2.length; e4 > t4; i2 = ++t4)
                l2 = d2[i2], l2 !== p2[i2] && n2.push(o(l2));
              return n2;
            }()};
          }, c2.prototype.getTextChangesFromCharacterData = function() {
            var t3, e3, n2, i2, s2, a2, u2, c3;
            return e3 = this.getMutationsByType("characterData"), e3.length && (c3 = e3[0], n2 = e3[e3.length - 1], s2 = o(c3.oldValue), i2 = o(n2.target.data), a2 = r(s2, i2), t3 = a2.added, u2 = a2.removed), {additions: t3 ? [t3] : [], deletions: u2 ? [u2] : []};
          }, h = function(t3) {
            var e3, n2, i2, o2;
            for (t3 == null && (t3 = []), o2 = [], e3 = 0, n2 = t3.length; n2 > e3; e3++)
              switch (i2 = t3[e3], i2.nodeType) {
                case Node.TEXT_NODE:
                  o2.push(i2.data);
                  break;
                case Node.ELEMENT_NODE:
                  s(i2) === "br" ? o2.push("\n") : o2.push.apply(o2, h(i2.childNodes));
              }
            return o2;
          }, c2;
        }(e.BasicObject);
      }.call(this), function() {
        var t2 = function(t3, e2) {
          function i() {
            this.constructor = t3;
          }
          for (var o in e2)
            n.call(e2, o) && (t3[o] = e2[o]);
          return i.prototype = e2.prototype, t3.prototype = new i(), t3.__super__ = e2.prototype, t3;
        }, n = {}.hasOwnProperty;
        e.FileVerificationOperation = function(e2) {
          function n2(t3) {
            this.file = t3;
          }
          return t2(n2, e2), n2.prototype.perform = function(t3) {
            var e3;
            return e3 = new FileReader(), e3.onerror = function() {
              return t3(false);
            }, e3.onload = function(n3) {
              return function() {
                e3.onerror = null;
                try {
                  e3.abort();
                } catch (i) {
                }
                return t3(true, n3.file);
              };
            }(this), e3.readAsArrayBuffer(this.file);
          }, n2;
        }(e.Operation);
      }.call(this), function() {
        var t2, n, i = function(t3, e2) {
          function n2() {
            this.constructor = t3;
          }
          for (var i2 in e2)
            o.call(e2, i2) && (t3[i2] = e2[i2]);
          return n2.prototype = e2.prototype, t3.prototype = new n2(), t3.__super__ = e2.prototype, t3;
        }, o = {}.hasOwnProperty;
        t2 = e.handleEvent, n = e.innerElementIsActive, e.InputController = function(o2) {
          function r(n2) {
            var i2;
            this.element = n2, this.mutationObserver = new e.MutationObserver(this.element), this.mutationObserver.delegate = this;
            for (i2 in this.events)
              t2(i2, {onElement: this.element, withCallback: this.handlerFor(i2)});
          }
          return i(r, o2), r.prototype.events = {}, r.prototype.elementDidMutate = function() {
          }, r.prototype.editorWillSyncDocumentView = function() {
            return this.mutationObserver.stop();
          }, r.prototype.editorDidSyncDocumentView = function() {
            return this.mutationObserver.start();
          }, r.prototype.requestRender = function() {
            var t3;
            return (t3 = this.delegate) != null && typeof t3.inputControllerDidRequestRender == "function" ? t3.inputControllerDidRequestRender() : void 0;
          }, r.prototype.requestReparse = function() {
            var t3;
            return (t3 = this.delegate) != null && typeof t3.inputControllerDidRequestReparse == "function" && t3.inputControllerDidRequestReparse(), this.requestRender();
          }, r.prototype.attachFiles = function(t3) {
            var n2, i2;
            return i2 = function() {
              var i3, o3, r2;
              for (r2 = [], i3 = 0, o3 = t3.length; o3 > i3; i3++)
                n2 = t3[i3], r2.push(new e.FileVerificationOperation(n2));
              return r2;
            }(), Promise.all(i2).then(function(t4) {
              return function(e2) {
                return t4.handleInput(function() {
                  var t5, n3;
                  return (t5 = this.delegate) != null && t5.inputControllerWillAttachFiles(), (n3 = this.responder) != null && n3.insertFiles(e2), this.requestRender();
                });
              };
            }(this));
          }, r.prototype.handlerFor = function(t3) {
            return function(e2) {
              return function(i2) {
                return i2.defaultPrevented ? void 0 : e2.handleInput(function() {
                  return n(this.element) ? void 0 : (this.eventName = t3, this.events[t3].call(this, i2));
                });
              };
            }(this);
          }, r.prototype.handleInput = function(t3) {
            var e2, n2;
            try {
              return (e2 = this.delegate) != null && e2.inputControllerWillHandleInput(), t3.call(this);
            } finally {
              (n2 = this.delegate) != null && n2.inputControllerDidHandleInput();
            }
          }, r.prototype.createLinkHTML = function(t3, e2) {
            var n2;
            return n2 = document.createElement("a"), n2.href = t3, n2.textContent = e2 != null ? e2 : t3, n2.outerHTML;
          }, r;
        }(e.BasicObject);
      }.call(this), function() {
        var t2, n, i, o, r, s, a, u, c, l, h, p, d, f = function(t3, e2) {
          function n2() {
            this.constructor = t3;
          }
          for (var i2 in e2)
            g.call(e2, i2) && (t3[i2] = e2[i2]);
          return n2.prototype = e2.prototype, t3.prototype = new n2(), t3.__super__ = e2.prototype, t3;
        }, g = {}.hasOwnProperty, m = [].indexOf || function(t3) {
          for (var e2 = 0, n2 = this.length; n2 > e2; e2++)
            if (e2 in this && this[e2] === t3)
              return e2;
          return -1;
        };
        c = e.makeElement, l = e.objectsAreEqual, d = e.tagName, n = e.browser, a = e.keyEventIsKeyboardCommand, o = e.dataTransferIsWritable, i = e.dataTransferIsPlainText, u = e.config.keyNames, e.Level0InputController = function(n2) {
          function s2() {
            s2.__super__.constructor.apply(this, arguments), this.resetInputSummary();
          }
          var d2;
          return f(s2, n2), d2 = 0, s2.prototype.setInputSummary = function(t3) {
            var e2, n3;
            t3 == null && (t3 = {}), this.inputSummary.eventName = this.eventName;
            for (e2 in t3)
              n3 = t3[e2], this.inputSummary[e2] = n3;
            return this.inputSummary;
          }, s2.prototype.resetInputSummary = function() {
            return this.inputSummary = {};
          }, s2.prototype.reset = function() {
            return this.resetInputSummary(), e.selectionChangeObserver.reset();
          }, s2.prototype.elementDidMutate = function(t3) {
            var e2;
            return this.isComposing() ? (e2 = this.delegate) != null && typeof e2.inputControllerDidAllowUnhandledInput == "function" ? e2.inputControllerDidAllowUnhandledInput() : void 0 : this.handleInput(function() {
              return this.mutationIsSignificant(t3) && (this.mutationIsExpected(t3) ? this.requestRender() : this.requestReparse()), this.reset();
            });
          }, s2.prototype.mutationIsExpected = function(t3) {
            var e2, n3, i2, o2, r2, s3, a2, u2, c2, l2;
            return a2 = t3.textAdded, u2 = t3.textDeleted, this.inputSummary.preferDocument ? true : (e2 = a2 != null ? a2 === this.inputSummary.textAdded : !this.inputSummary.textAdded, n3 = u2 != null ? this.inputSummary.didDelete : !this.inputSummary.didDelete, c2 = (a2 === "\n" || a2 === " \n") && !e2, l2 = u2 === "\n" && !n3, s3 = c2 && !l2 || l2 && !c2, s3 && (o2 = this.getSelectedRange()) && (i2 = c2 ? a2.replace(/\n$/, "").length || -1 : (a2 != null ? a2.length : void 0) || 1, (r2 = this.responder) != null ? r2.positionIsBlockBreak(o2[1] + i2) : void 0) ? true : e2 && n3);
          }, s2.prototype.mutationIsSignificant = function(t3) {
            var e2, n3, i2;
            return i2 = Object.keys(t3).length > 0, e2 = ((n3 = this.compositionInput) != null ? n3.getEndData() : void 0) === "", i2 || !e2;
          }, s2.prototype.events = {keydown: function(t3) {
            var n3, i2, o2, r2, s3, c2, l2, h2, p2;
            if (this.isComposing() || this.resetInputSummary(), this.inputSummary.didInput = true, r2 = u[t3.keyCode]) {
              for (i2 = this.keys, h2 = ["ctrl", "alt", "shift", "meta"], o2 = 0, c2 = h2.length; c2 > o2; o2++)
                l2 = h2[o2], t3[l2 + "Key"] && (l2 === "ctrl" && (l2 = "control"), i2 = i2 != null ? i2[l2] : void 0);
              (i2 != null ? i2[r2] : void 0) != null && (this.setInputSummary({keyName: r2}), e.selectionChangeObserver.reset(), i2[r2].call(this, t3));
            }
            return a(t3) && (n3 = String.fromCharCode(t3.keyCode).toLowerCase()) && (s3 = function() {
              var e2, n4, i3, o3;
              for (i3 = ["alt", "shift"], o3 = [], e2 = 0, n4 = i3.length; n4 > e2; e2++)
                l2 = i3[e2], t3[l2 + "Key"] && o3.push(l2);
              return o3;
            }(), s3.push(n3), (p2 = this.delegate) != null ? p2.inputControllerDidReceiveKeyboardCommand(s3) : void 0) ? t3.preventDefault() : void 0;
          }, keypress: function(t3) {
            var e2, n3, i2;
            if (this.inputSummary.eventName == null && !t3.metaKey && (!t3.ctrlKey || t3.altKey))
              return (i2 = p(t3)) ? ((e2 = this.delegate) != null && e2.inputControllerWillPerformTyping(), (n3 = this.responder) != null && n3.insertString(i2), this.setInputSummary({textAdded: i2, didDelete: this.selectionIsExpanded()})) : void 0;
          }, textInput: function(t3) {
            var e2, n3, i2, o2;
            return e2 = t3.data, o2 = this.inputSummary.textAdded, o2 && o2 !== e2 && o2.toUpperCase() === e2 ? (n3 = this.getSelectedRange(), this.setSelectedRange([n3[0], n3[1] + o2.length]), (i2 = this.responder) != null && i2.insertString(e2), this.setInputSummary({textAdded: e2}), this.setSelectedRange(n3)) : void 0;
          }, dragenter: function(t3) {
            return t3.preventDefault();
          }, dragstart: function(t3) {
            var e2, n3;
            return n3 = t3.target, this.serializeSelectionToDataTransfer(t3.dataTransfer), this.draggedRange = this.getSelectedRange(), (e2 = this.delegate) != null && typeof e2.inputControllerDidStartDrag == "function" ? e2.inputControllerDidStartDrag() : void 0;
          }, dragover: function(t3) {
            var e2, n3;
            return !this.draggedRange && !this.canAcceptDataTransfer(t3.dataTransfer) || (t3.preventDefault(), e2 = {x: t3.clientX, y: t3.clientY}, l(e2, this.draggingPoint)) ? void 0 : (this.draggingPoint = e2, (n3 = this.delegate) != null && typeof n3.inputControllerDidReceiveDragOverPoint == "function" ? n3.inputControllerDidReceiveDragOverPoint(this.draggingPoint) : void 0);
          }, dragend: function() {
            var t3;
            return (t3 = this.delegate) != null && typeof t3.inputControllerDidCancelDrag == "function" && t3.inputControllerDidCancelDrag(), this.draggedRange = null, this.draggingPoint = null;
          }, drop: function(t3) {
            var n3, i2, o2, r2, s3, a2, u2, c2, l2;
            return t3.preventDefault(), o2 = (s3 = t3.dataTransfer) != null ? s3.files : void 0, r2 = {x: t3.clientX, y: t3.clientY}, (a2 = this.responder) != null && a2.setLocationRangeFromPointRange(r2), (o2 != null ? o2.length : void 0) ? this.attachFiles(o2) : this.draggedRange ? ((u2 = this.delegate) != null && u2.inputControllerWillMoveText(), (c2 = this.responder) != null && c2.moveTextFromRange(this.draggedRange), this.draggedRange = null, this.requestRender()) : (i2 = t3.dataTransfer.getData("application/x-trix-document")) && (n3 = e.Document.fromJSONString(i2), (l2 = this.responder) != null && l2.insertDocument(n3), this.requestRender()), this.draggedRange = null, this.draggingPoint = null;
          }, cut: function(t3) {
            var e2, n3;
            return ((e2 = this.responder) != null ? e2.selectionIsExpanded() : void 0) && (this.serializeSelectionToDataTransfer(t3.clipboardData) && t3.preventDefault(), (n3 = this.delegate) != null && n3.inputControllerWillCutText(), this.deleteInDirection("backward"), t3.defaultPrevented) ? this.requestRender() : void 0;
          }, copy: function(t3) {
            var e2;
            return ((e2 = this.responder) != null ? e2.selectionIsExpanded() : void 0) && this.serializeSelectionToDataTransfer(t3.clipboardData) ? t3.preventDefault() : void 0;
          }, paste: function(t3) {
            var n3, o2, s3, a2, u2, c2, l2, p2, f2, g2, v, y, b, A, C3, x, w, E, S2, R, k, D2, L2;
            return n3 = (p2 = t3.clipboardData) != null ? p2 : t3.testClipboardData, l2 = {clipboard: n3}, n3 == null || h(t3) ? void this.getPastedHTMLUsingHiddenElement(function(t4) {
              return function(e2) {
                var n4, i2, o3;
                return l2.type = "text/html", l2.html = e2, (n4 = t4.delegate) != null && n4.inputControllerWillPaste(l2), (i2 = t4.responder) != null && i2.insertHTML(l2.html), t4.requestRender(), (o3 = t4.delegate) != null ? o3.inputControllerDidPaste(l2) : void 0;
              };
            }(this)) : ((a2 = n3.getData("URL")) ? (l2.type = "text/html", L2 = (c2 = n3.getData("public.url-name")) ? e.squishBreakableWhitespace(c2).trim() : a2, l2.html = this.createLinkHTML(a2, L2), (f2 = this.delegate) != null && f2.inputControllerWillPaste(l2), this.setInputSummary({textAdded: L2, didDelete: this.selectionIsExpanded()}), (C3 = this.responder) != null && C3.insertHTML(l2.html), this.requestRender(), (x = this.delegate) != null && x.inputControllerDidPaste(l2)) : i(n3) ? (l2.type = "text/plain", l2.string = n3.getData("text/plain"), (w = this.delegate) != null && w.inputControllerWillPaste(l2), this.setInputSummary({textAdded: l2.string, didDelete: this.selectionIsExpanded()}), (E = this.responder) != null && E.insertString(l2.string), this.requestRender(), (S2 = this.delegate) != null && S2.inputControllerDidPaste(l2)) : (u2 = n3.getData("text/html")) ? (l2.type = "text/html", l2.html = u2, (R = this.delegate) != null && R.inputControllerWillPaste(l2), (k = this.responder) != null && k.insertHTML(l2.html), this.requestRender(), (D2 = this.delegate) != null && D2.inputControllerDidPaste(l2)) : m.call(n3.types, "Files") >= 0 && (s3 = (g2 = n3.items) != null && (v = g2[0]) != null && typeof v.getAsFile == "function" ? v.getAsFile() : void 0) && (!s3.name && (o2 = r(s3)) && (s3.name = "pasted-file-" + ++d2 + "." + o2), l2.type = "File", l2.file = s3, (y = this.delegate) != null && y.inputControllerWillAttachFiles(), (b = this.responder) != null && b.insertFile(l2.file), this.requestRender(), (A = this.delegate) != null && A.inputControllerDidPaste(l2)), t3.preventDefault());
          }, compositionstart: function(t3) {
            return this.getCompositionInput().start(t3.data);
          }, compositionupdate: function(t3) {
            return this.getCompositionInput().update(t3.data);
          }, compositionend: function(t3) {
            return this.getCompositionInput().end(t3.data);
          }, beforeinput: function() {
            return this.inputSummary.didInput = true;
          }, input: function(t3) {
            return this.inputSummary.didInput = true, t3.stopPropagation();
          }}, s2.prototype.keys = {backspace: function(t3) {
            var e2;
            return (e2 = this.delegate) != null && e2.inputControllerWillPerformTyping(), this.deleteInDirection("backward", t3);
          }, delete: function(t3) {
            var e2;
            return (e2 = this.delegate) != null && e2.inputControllerWillPerformTyping(), this.deleteInDirection("forward", t3);
          }, return: function() {
            var t3, e2;
            return this.setInputSummary({preferDocument: true}), (t3 = this.delegate) != null && t3.inputControllerWillPerformTyping(), (e2 = this.responder) != null ? e2.insertLineBreak() : void 0;
          }, tab: function(t3) {
            var e2, n3;
            return ((e2 = this.responder) != null ? e2.canIncreaseNestingLevel() : void 0) ? ((n3 = this.responder) != null && n3.increaseNestingLevel(), this.requestRender(), t3.preventDefault()) : void 0;
          }, left: function(t3) {
            var e2;
            return this.selectionIsInCursorTarget() ? (t3.preventDefault(), (e2 = this.responder) != null ? e2.moveCursorInDirection("backward") : void 0) : void 0;
          }, right: function(t3) {
            var e2;
            return this.selectionIsInCursorTarget() ? (t3.preventDefault(), (e2 = this.responder) != null ? e2.moveCursorInDirection("forward") : void 0) : void 0;
          }, control: {d: function(t3) {
            var e2;
            return (e2 = this.delegate) != null && e2.inputControllerWillPerformTyping(), this.deleteInDirection("forward", t3);
          }, h: function(t3) {
            var e2;
            return (e2 = this.delegate) != null && e2.inputControllerWillPerformTyping(), this.deleteInDirection("backward", t3);
          }, o: function(t3) {
            var e2, n3;
            return t3.preventDefault(), (e2 = this.delegate) != null && e2.inputControllerWillPerformTyping(), (n3 = this.responder) != null && n3.insertString("\n", {updatePosition: false}), this.requestRender();
          }}, shift: {return: function(t3) {
            var e2, n3;
            return (e2 = this.delegate) != null && e2.inputControllerWillPerformTyping(), (n3 = this.responder) != null && n3.insertString("\n"), this.requestRender(), t3.preventDefault();
          }, tab: function(t3) {
            var e2, n3;
            return ((e2 = this.responder) != null ? e2.canDecreaseNestingLevel() : void 0) ? ((n3 = this.responder) != null && n3.decreaseNestingLevel(), this.requestRender(), t3.preventDefault()) : void 0;
          }, left: function(t3) {
            return this.selectionIsInCursorTarget() ? (t3.preventDefault(), this.expandSelectionInDirection("backward")) : void 0;
          }, right: function(t3) {
            return this.selectionIsInCursorTarget() ? (t3.preventDefault(), this.expandSelectionInDirection("forward")) : void 0;
          }}, alt: {backspace: function() {
            var t3;
            return this.setInputSummary({preferDocument: false}), (t3 = this.delegate) != null ? t3.inputControllerWillPerformTyping() : void 0;
          }}, meta: {backspace: function() {
            var t3;
            return this.setInputSummary({preferDocument: false}), (t3 = this.delegate) != null ? t3.inputControllerWillPerformTyping() : void 0;
          }}}, s2.prototype.getCompositionInput = function() {
            return this.isComposing() ? this.compositionInput : this.compositionInput = new t2(this);
          }, s2.prototype.isComposing = function() {
            return this.compositionInput != null && !this.compositionInput.isEnded();
          }, s2.prototype.deleteInDirection = function(t3, e2) {
            var n3;
            return ((n3 = this.responder) != null ? n3.deleteInDirection(t3) : void 0) !== false ? this.setInputSummary({didDelete: true}) : e2 ? (e2.preventDefault(), this.requestRender()) : void 0;
          }, s2.prototype.serializeSelectionToDataTransfer = function(t3) {
            var n3, i2;
            if (o(t3))
              return n3 = (i2 = this.responder) != null ? i2.getSelectedDocument().toSerializableDocument() : void 0, t3.setData("application/x-trix-document", JSON.stringify(n3)), t3.setData("text/html", e.DocumentView.render(n3).innerHTML), t3.setData("text/plain", n3.toString().replace(/\n$/, "")), true;
          }, s2.prototype.canAcceptDataTransfer = function(t3) {
            var e2, n3, i2, o2, r2, s3;
            for (s3 = {}, o2 = (i2 = t3 != null ? t3.types : void 0) != null ? i2 : [], e2 = 0, n3 = o2.length; n3 > e2; e2++)
              r2 = o2[e2], s3[r2] = true;
            return s3.Files || s3["application/x-trix-document"] || s3["text/html"] || s3["text/plain"];
          }, s2.prototype.getPastedHTMLUsingHiddenElement = function(t3) {
            var n3, i2, o2;
            return i2 = this.getSelectedRange(), o2 = {position: "absolute", left: window.pageXOffset + "px", top: window.pageYOffset + "px", opacity: 0}, n3 = c({style: o2, tagName: "div", editable: true}), document.body.appendChild(n3), n3.focus(), requestAnimationFrame(function(o3) {
              return function() {
                var r2;
                return r2 = n3.innerHTML, e.removeNode(n3), o3.setSelectedRange(i2), t3(r2);
              };
            }(this));
          }, s2.proxyMethod("responder?.getSelectedRange"), s2.proxyMethod("responder?.setSelectedRange"), s2.proxyMethod("responder?.expandSelectionInDirection"), s2.proxyMethod("responder?.selectionIsInCursorTarget"), s2.proxyMethod("responder?.selectionIsExpanded"), s2;
        }(e.InputController), r = function(t3) {
          var e2, n2;
          return (e2 = t3.type) != null && (n2 = e2.match(/\/(\w+)$/)) != null ? n2[1] : void 0;
        }, s = (typeof " ".codePointAt == "function" ? " ".codePointAt(0) : void 0) != null, p = function(t3) {
          var n2;
          return t3.key && s && t3.key.codePointAt(0) === t3.keyCode ? t3.key : (t3.which === null ? n2 = t3.keyCode : t3.which !== 0 && t3.charCode !== 0 && (n2 = t3.charCode), n2 != null && u[n2] !== "escape" ? e.UTF16String.fromCodepoints([n2]).toString() : void 0);
        }, h = function(t3) {
          var e2, n2, i2, o2, r2, s2, a2, u2, c2, l2;
          if (u2 = t3.clipboardData) {
            if (m.call(u2.types, "text/html") >= 0) {
              for (c2 = u2.types, i2 = 0, s2 = c2.length; s2 > i2; i2++)
                if (l2 = c2[i2], e2 = /^CorePasteboardFlavorType/.test(l2), n2 = /^dyn\./.test(l2) && u2.getData(l2), a2 = e2 || n2)
                  return true;
              return false;
            }
            return o2 = m.call(u2.types, "com.apple.webarchive") >= 0, r2 = m.call(u2.types, "com.apple.flat-rtfd") >= 0, o2 || r2;
          }
        }, t2 = function(t3) {
          function e2(t4) {
            var e3;
            this.inputController = t4, e3 = this.inputController, this.responder = e3.responder, this.delegate = e3.delegate, this.inputSummary = e3.inputSummary, this.data = {};
          }
          return f(e2, t3), e2.prototype.start = function(t4) {
            var e3, n2;
            return this.data.start = t4, this.isSignificant() ? (this.inputSummary.eventName === "keypress" && this.inputSummary.textAdded && (e3 = this.responder) != null && e3.deleteInDirection("left"), this.selectionIsExpanded() || (this.insertPlaceholder(), this.requestRender()), this.range = (n2 = this.responder) != null ? n2.getSelectedRange() : void 0) : void 0;
          }, e2.prototype.update = function(t4) {
            var e3;
            return this.data.update = t4, this.isSignificant() && (e3 = this.selectPlaceholder()) ? (this.forgetPlaceholder(), this.range = e3) : void 0;
          }, e2.prototype.end = function(t4) {
            var e3, n2, i2, o2;
            return this.data.end = t4, this.isSignificant() ? (this.forgetPlaceholder(), this.canApplyToDocument() ? (this.setInputSummary({preferDocument: true, didInput: false}), (e3 = this.delegate) != null && e3.inputControllerWillPerformTyping(), (n2 = this.responder) != null && n2.setSelectedRange(this.range), (i2 = this.responder) != null && i2.insertString(this.data.end), (o2 = this.responder) != null ? o2.setSelectedRange(this.range[0] + this.data.end.length) : void 0) : this.data.start != null || this.data.update != null ? (this.requestReparse(), this.inputController.reset()) : void 0) : this.inputController.reset();
          }, e2.prototype.getEndData = function() {
            return this.data.end;
          }, e2.prototype.isEnded = function() {
            return this.getEndData() != null;
          }, e2.prototype.isSignificant = function() {
            return n.composesExistingText ? this.inputSummary.didInput : true;
          }, e2.prototype.canApplyToDocument = function() {
            var t4, e3;
            return ((t4 = this.data.start) != null ? t4.length : void 0) === 0 && ((e3 = this.data.end) != null ? e3.length : void 0) > 0 && this.range != null;
          }, e2.proxyMethod("inputController.setInputSummary"), e2.proxyMethod("inputController.requestRender"), e2.proxyMethod("inputController.requestReparse"), e2.proxyMethod("responder?.selectionIsExpanded"), e2.proxyMethod("responder?.insertPlaceholder"), e2.proxyMethod("responder?.selectPlaceholder"), e2.proxyMethod("responder?.forgetPlaceholder"), e2;
        }(e.BasicObject);
      }.call(this), function() {
        var t2, n, i, o = function(t3, e2) {
          return function() {
            return t3.apply(e2, arguments);
          };
        }, r = function(t3, e2) {
          function n2() {
            this.constructor = t3;
          }
          for (var i2 in e2)
            s.call(e2, i2) && (t3[i2] = e2[i2]);
          return n2.prototype = e2.prototype, t3.prototype = new n2(), t3.__super__ = e2.prototype, t3;
        }, s = {}.hasOwnProperty, a = [].indexOf || function(t3) {
          for (var e2 = 0, n2 = this.length; n2 > e2; e2++)
            if (e2 in this && this[e2] === t3)
              return e2;
          return -1;
        };
        t2 = e.dataTransferIsPlainText, n = e.keyEventIsKeyboardCommand, i = e.objectsAreEqual, e.Level2InputController = function(s2) {
          function u() {
            return this.render = o(this.render, this), u.__super__.constructor.apply(this, arguments);
          }
          var c, l, h, p, d, f;
          return r(u, s2), u.prototype.elementDidMutate = function() {
            var t3;
            return this.scheduledRender ? this.composing && (t3 = this.delegate) != null && typeof t3.inputControllerDidAllowUnhandledInput == "function" ? t3.inputControllerDidAllowUnhandledInput() : void 0 : this.reparse();
          }, u.prototype.scheduleRender = function() {
            return this.scheduledRender != null ? this.scheduledRender : this.scheduledRender = requestAnimationFrame(this.render);
          }, u.prototype.render = function() {
            var t3;
            return cancelAnimationFrame(this.scheduledRender), this.scheduledRender = null, this.composing || (t3 = this.delegate) != null && t3.render(), typeof this.afterRender == "function" && this.afterRender(), this.afterRender = null;
          }, u.prototype.reparse = function() {
            var t3;
            return (t3 = this.delegate) != null ? t3.reparse() : void 0;
          }, u.prototype.events = {keydown: function(t3) {
            var e2, i2, o2, r2;
            if (n(t3)) {
              if (e2 = l(t3), (r2 = this.delegate) != null ? r2.inputControllerDidReceiveKeyboardCommand(e2) : void 0)
                return t3.preventDefault();
            } else if (o2 = t3.key, t3.altKey && (o2 += "+Alt"), t3.shiftKey && (o2 += "+Shift"), i2 = this.keys[o2])
              return this.withEvent(t3, i2);
          }, paste: function(t3) {
            var e2, n2, i2, o2, r2, s3, a2, u2, c2;
            return h(t3) ? (t3.preventDefault(), this.attachFiles(t3.clipboardData.files)) : p(t3) ? (t3.preventDefault(), n2 = {type: "text/plain", string: t3.clipboardData.getData("text/plain")}, (i2 = this.delegate) != null && i2.inputControllerWillPaste(n2), (o2 = this.responder) != null && o2.insertString(n2.string), this.render(), (r2 = this.delegate) != null ? r2.inputControllerDidPaste(n2) : void 0) : (e2 = (s3 = t3.clipboardData) != null ? s3.getData("URL") : void 0) ? (t3.preventDefault(), n2 = {type: "text/html", html: this.createLinkHTML(e2)}, (a2 = this.delegate) != null && a2.inputControllerWillPaste(n2), (u2 = this.responder) != null && u2.insertHTML(n2.html), this.render(), (c2 = this.delegate) != null ? c2.inputControllerDidPaste(n2) : void 0) : void 0;
          }, beforeinput: function(t3) {
            var e2;
            return (e2 = this.inputTypes[t3.inputType]) ? (this.withEvent(t3, e2), this.scheduleRender()) : void 0;
          }, input: function() {
            return e.selectionChangeObserver.reset();
          }, dragstart: function(t3) {
            var e2, n2;
            return ((e2 = this.responder) != null ? e2.selectionContainsAttachments() : void 0) ? (t3.dataTransfer.setData("application/x-trix-dragging", true), this.dragging = {range: (n2 = this.responder) != null ? n2.getSelectedRange() : void 0, point: d(t3)}) : void 0;
          }, dragenter: function(t3) {
            return c(t3) ? t3.preventDefault() : void 0;
          }, dragover: function(t3) {
            var e2, n2;
            if (this.dragging) {
              if (t3.preventDefault(), e2 = d(t3), !i(e2, this.dragging.point))
                return this.dragging.point = e2, (n2 = this.responder) != null ? n2.setLocationRangeFromPointRange(e2) : void 0;
            } else if (c(t3))
              return t3.preventDefault();
          }, drop: function(t3) {
            var e2, n2, i2, o2;
            return this.dragging ? (t3.preventDefault(), (n2 = this.delegate) != null && n2.inputControllerWillMoveText(), (i2 = this.responder) != null && i2.moveTextFromRange(this.dragging.range), this.dragging = null, this.scheduleRender()) : c(t3) ? (t3.preventDefault(), e2 = d(t3), (o2 = this.responder) != null && o2.setLocationRangeFromPointRange(e2), this.attachFiles(t3.dataTransfer.files)) : void 0;
          }, dragend: function() {
            var t3;
            return this.dragging ? ((t3 = this.responder) != null && t3.setSelectedRange(this.dragging.range), this.dragging = null) : void 0;
          }, compositionend: function() {
            return this.composing ? (this.composing = false, this.scheduleRender()) : void 0;
          }}, u.prototype.keys = {ArrowLeft: function() {
            var t3, e2;
            return ((t3 = this.responder) != null ? t3.shouldManageMovingCursorInDirection("backward") : void 0) ? (this.event.preventDefault(), (e2 = this.responder) != null ? e2.moveCursorInDirection("backward") : void 0) : void 0;
          }, ArrowRight: function() {
            var t3, e2;
            return ((t3 = this.responder) != null ? t3.shouldManageMovingCursorInDirection("forward") : void 0) ? (this.event.preventDefault(), (e2 = this.responder) != null ? e2.moveCursorInDirection("forward") : void 0) : void 0;
          }, Backspace: function() {
            var t3, e2, n2;
            return ((t3 = this.responder) != null ? t3.shouldManageDeletingInDirection("backward") : void 0) ? (this.event.preventDefault(), (e2 = this.delegate) != null && e2.inputControllerWillPerformTyping(), (n2 = this.responder) != null && n2.deleteInDirection("backward"), this.render()) : void 0;
          }, Tab: function() {
            var t3, e2;
            return ((t3 = this.responder) != null ? t3.canIncreaseNestingLevel() : void 0) ? (this.event.preventDefault(), (e2 = this.responder) != null && e2.increaseNestingLevel(), this.render()) : void 0;
          }, "Tab+Shift": function() {
            var t3, e2;
            return ((t3 = this.responder) != null ? t3.canDecreaseNestingLevel() : void 0) ? (this.event.preventDefault(), (e2 = this.responder) != null && e2.decreaseNestingLevel(), this.render()) : void 0;
          }}, u.prototype.inputTypes = {deleteByComposition: function() {
            return this.deleteInDirection("backward", {recordUndoEntry: false});
          }, deleteByCut: function() {
            return this.deleteInDirection("backward");
          }, deleteByDrag: function() {
            return this.event.preventDefault(), this.withTargetDOMRange(function() {
              var t3;
              return this.deleteByDragRange = (t3 = this.responder) != null ? t3.getSelectedRange() : void 0;
            });
          }, deleteCompositionText: function() {
            return this.deleteInDirection("backward", {recordUndoEntry: false});
          }, deleteContent: function() {
            return this.deleteInDirection("backward");
          }, deleteContentBackward: function() {
            return this.deleteInDirection("backward");
          }, deleteContentForward: function() {
            return this.deleteInDirection("forward");
          }, deleteEntireSoftLine: function() {
            return this.deleteInDirection("forward");
          }, deleteHardLineBackward: function() {
            return this.deleteInDirection("backward");
          }, deleteHardLineForward: function() {
            return this.deleteInDirection("forward");
          }, deleteSoftLineBackward: function() {
            return this.deleteInDirection("backward");
          }, deleteSoftLineForward: function() {
            return this.deleteInDirection("forward");
          }, deleteWordBackward: function() {
            return this.deleteInDirection("backward");
          }, deleteWordForward: function() {
            return this.deleteInDirection("forward");
          }, formatBackColor: function() {
            return this.activateAttributeIfSupported("backgroundColor", this.event.data);
          }, formatBold: function() {
            return this.toggleAttributeIfSupported("bold");
          }, formatFontColor: function() {
            return this.activateAttributeIfSupported("color", this.event.data);
          }, formatFontName: function() {
            return this.activateAttributeIfSupported("font", this.event.data);
          }, formatIndent: function() {
            var t3;
            return ((t3 = this.responder) != null ? t3.canIncreaseNestingLevel() : void 0) ? this.withTargetDOMRange(function() {
              var t4;
              return (t4 = this.responder) != null ? t4.increaseNestingLevel() : void 0;
            }) : void 0;
          }, formatItalic: function() {
            return this.toggleAttributeIfSupported("italic");
          }, formatJustifyCenter: function() {
            return this.toggleAttributeIfSupported("justifyCenter");
          }, formatJustifyFull: function() {
            return this.toggleAttributeIfSupported("justifyFull");
          }, formatJustifyLeft: function() {
            return this.toggleAttributeIfSupported("justifyLeft");
          }, formatJustifyRight: function() {
            return this.toggleAttributeIfSupported("justifyRight");
          }, formatOutdent: function() {
            var t3;
            return ((t3 = this.responder) != null ? t3.canDecreaseNestingLevel() : void 0) ? this.withTargetDOMRange(function() {
              var t4;
              return (t4 = this.responder) != null ? t4.decreaseNestingLevel() : void 0;
            }) : void 0;
          }, formatRemove: function() {
            return this.withTargetDOMRange(function() {
              var t3, e2, n2, i2;
              i2 = [];
              for (t3 in (e2 = this.responder) != null ? e2.getCurrentAttributes() : void 0)
                i2.push((n2 = this.responder) != null ? n2.removeCurrentAttribute(t3) : void 0);
              return i2;
            });
          }, formatSetBlockTextDirection: function() {
            return this.activateAttributeIfSupported("blockDir", this.event.data);
          }, formatSetInlineTextDirection: function() {
            return this.activateAttributeIfSupported("textDir", this.event.data);
          }, formatStrikeThrough: function() {
            return this.toggleAttributeIfSupported("strike");
          }, formatSubscript: function() {
            return this.toggleAttributeIfSupported("sub");
          }, formatSuperscript: function() {
            return this.toggleAttributeIfSupported("sup");
          }, formatUnderline: function() {
            return this.toggleAttributeIfSupported("underline");
          }, historyRedo: function() {
            var t3;
            return (t3 = this.delegate) != null ? t3.inputControllerWillPerformRedo() : void 0;
          }, historyUndo: function() {
            var t3;
            return (t3 = this.delegate) != null ? t3.inputControllerWillPerformUndo() : void 0;
          }, insertCompositionText: function() {
            return this.composing = true, this.insertString(this.event.data);
          }, insertFromComposition: function() {
            return this.composing = false, this.insertString(this.event.data);
          }, insertFromDrop: function() {
            var t3, e2;
            return (t3 = this.deleteByDragRange) ? (this.deleteByDragRange = null, (e2 = this.delegate) != null && e2.inputControllerWillMoveText(), this.withTargetDOMRange(function() {
              var e3;
              return (e3 = this.responder) != null ? e3.moveTextFromRange(t3) : void 0;
            })) : void 0;
          }, insertFromPaste: function() {
            var n2, i2, o2, r2, s3, a2, u2, c2, l2, h2, p2;
            return n2 = this.event.dataTransfer, s3 = {dataTransfer: n2}, (i2 = n2.getData("URL")) ? (this.event.preventDefault(), s3.type = "text/html", p2 = (r2 = n2.getData("public.url-name")) ? e.squishBreakableWhitespace(r2).trim() : i2, s3.html = this.createLinkHTML(i2, p2), (a2 = this.delegate) != null && a2.inputControllerWillPaste(s3), this.withTargetDOMRange(function() {
              var t3;
              return (t3 = this.responder) != null ? t3.insertHTML(s3.html) : void 0;
            }), this.afterRender = function(t3) {
              return function() {
                var e2;
                return (e2 = t3.delegate) != null ? e2.inputControllerDidPaste(s3) : void 0;
              };
            }(this)) : t2(n2) ? (s3.type = "text/plain", s3.string = n2.getData("text/plain"), (u2 = this.delegate) != null && u2.inputControllerWillPaste(s3), this.withTargetDOMRange(function() {
              var t3;
              return (t3 = this.responder) != null ? t3.insertString(s3.string) : void 0;
            }), this.afterRender = function(t3) {
              return function() {
                var e2;
                return (e2 = t3.delegate) != null ? e2.inputControllerDidPaste(s3) : void 0;
              };
            }(this)) : (o2 = n2.getData("text/html")) ? (this.event.preventDefault(), s3.type = "text/html", s3.html = o2, (c2 = this.delegate) != null && c2.inputControllerWillPaste(s3), this.withTargetDOMRange(function() {
              var t3;
              return (t3 = this.responder) != null ? t3.insertHTML(s3.html) : void 0;
            }), this.afterRender = function(t3) {
              return function() {
                var e2;
                return (e2 = t3.delegate) != null ? e2.inputControllerDidPaste(s3) : void 0;
              };
            }(this)) : ((l2 = n2.files) != null ? l2.length : void 0) ? (s3.type = "File", s3.file = n2.files[0], (h2 = this.delegate) != null && h2.inputControllerWillPaste(s3), this.withTargetDOMRange(function() {
              var t3;
              return (t3 = this.responder) != null ? t3.insertFile(s3.file) : void 0;
            }), this.afterRender = function(t3) {
              return function() {
                var e2;
                return (e2 = t3.delegate) != null ? e2.inputControllerDidPaste(s3) : void 0;
              };
            }(this)) : void 0;
          }, insertFromYank: function() {
            return this.insertString(this.event.data);
          }, insertLineBreak: function() {
            return this.insertString("\n");
          }, insertLink: function() {
            return this.activateAttributeIfSupported("href", this.event.data);
          }, insertOrderedList: function() {
            return this.toggleAttributeIfSupported("number");
          }, insertParagraph: function() {
            var t3;
            return (t3 = this.delegate) != null && t3.inputControllerWillPerformTyping(), this.withTargetDOMRange(function() {
              var t4;
              return (t4 = this.responder) != null ? t4.insertLineBreak() : void 0;
            });
          }, insertReplacementText: function() {
            return this.insertString(this.event.dataTransfer.getData("text/plain"), {updatePosition: false});
          }, insertText: function() {
            var t3, e2;
            return this.insertString((t3 = this.event.data) != null ? t3 : (e2 = this.event.dataTransfer) != null ? e2.getData("text/plain") : void 0);
          }, insertTranspose: function() {
            return this.insertString(this.event.data);
          }, insertUnorderedList: function() {
            return this.toggleAttributeIfSupported("bullet");
          }}, u.prototype.insertString = function(t3, e2) {
            var n2;
            return t3 == null && (t3 = ""), (n2 = this.delegate) != null && n2.inputControllerWillPerformTyping(), this.withTargetDOMRange(function() {
              var n3;
              return (n3 = this.responder) != null ? n3.insertString(t3, e2) : void 0;
            });
          }, u.prototype.toggleAttributeIfSupported = function(t3) {
            var n2;
            return a.call(e.getAllAttributeNames(), t3) >= 0 ? ((n2 = this.delegate) != null && n2.inputControllerWillPerformFormatting(t3), this.withTargetDOMRange(function() {
              var e2;
              return (e2 = this.responder) != null ? e2.toggleCurrentAttribute(t3) : void 0;
            })) : void 0;
          }, u.prototype.activateAttributeIfSupported = function(t3, n2) {
            var i2;
            return a.call(e.getAllAttributeNames(), t3) >= 0 ? ((i2 = this.delegate) != null && i2.inputControllerWillPerformFormatting(t3), this.withTargetDOMRange(function() {
              var e2;
              return (e2 = this.responder) != null ? e2.setCurrentAttribute(t3, n2) : void 0;
            })) : void 0;
          }, u.prototype.deleteInDirection = function(t3, e2) {
            var n2, i2, o2, r2;
            return o2 = (e2 != null ? e2 : {recordUndoEntry: true}).recordUndoEntry, o2 && (r2 = this.delegate) != null && r2.inputControllerWillPerformTyping(), i2 = function(e3) {
              return function() {
                var n3;
                return (n3 = e3.responder) != null ? n3.deleteInDirection(t3) : void 0;
              };
            }(this), (n2 = this.getTargetDOMRange({minLength: 2})) ? this.withTargetDOMRange(n2, i2) : i2();
          }, u.prototype.withTargetDOMRange = function(t3, n2) {
            var i2;
            return typeof t3 == "function" && (n2 = t3, t3 = this.getTargetDOMRange()), t3 ? (i2 = this.responder) != null ? i2.withTargetDOMRange(t3, n2.bind(this)) : void 0 : (e.selectionChangeObserver.reset(), n2.call(this));
          }, u.prototype.getTargetDOMRange = function(t3) {
            var e2, n2, i2, o2;
            return i2 = (t3 != null ? t3 : {minLength: 0}).minLength, (o2 = typeof (e2 = this.event).getTargetRanges == "function" ? e2.getTargetRanges() : void 0) && o2.length && (n2 = f(o2[0]), i2 === 0 || n2.toString().length >= i2) ? n2 : void 0;
          }, f = function(t3) {
            var e2;
            return e2 = document.createRange(), e2.setStart(t3.startContainer, t3.startOffset), e2.setEnd(t3.endContainer, t3.endOffset), e2;
          }, u.prototype.withEvent = function(t3, e2) {
            var n2;
            this.event = t3;
            try {
              n2 = e2.call(this);
            } finally {
              this.event = null;
            }
            return n2;
          }, c = function(t3) {
            var e2, n2;
            return a.call((e2 = (n2 = t3.dataTransfer) != null ? n2.types : void 0) != null ? e2 : [], "Files") >= 0;
          }, h = function(t3) {
            var e2;
            return (e2 = t3.clipboardData) ? a.call(e2.types, "Files") >= 0 && e2.types.length === 1 && e2.files.length >= 1 : void 0;
          }, p = function(t3) {
            var e2;
            return (e2 = t3.clipboardData) ? a.call(e2.types, "text/plain") >= 0 && e2.types.length === 1 : void 0;
          }, l = function(t3) {
            var e2;
            return e2 = [], t3.altKey && e2.push("alt"), t3.shiftKey && e2.push("shift"), e2.push(t3.key), e2;
          }, d = function(t3) {
            return {x: t3.clientX, y: t3.clientY};
          }, u;
        }(e.InputController);
      }.call(this), function() {
        var t2, n, i, o, r, s, a, u, c = function(t3, e2) {
          return function() {
            return t3.apply(e2, arguments);
          };
        }, l = function(t3, e2) {
          function n2() {
            this.constructor = t3;
          }
          for (var i2 in e2)
            h.call(e2, i2) && (t3[i2] = e2[i2]);
          return n2.prototype = e2.prototype, t3.prototype = new n2(), t3.__super__ = e2.prototype, t3;
        }, h = {}.hasOwnProperty;
        n = e.defer, i = e.handleEvent, s = e.makeElement, u = e.tagName, a = e.config, r = a.lang, t2 = a.css, o = a.keyNames, e.AttachmentEditorController = function(a2) {
          function h2(t3, e2, n2, i2) {
            this.attachmentPiece = t3, this.element = e2, this.container = n2, this.options = i2 != null ? i2 : {}, this.didBlurCaption = c(this.didBlurCaption, this), this.didChangeCaption = c(this.didChangeCaption, this), this.didInputCaption = c(this.didInputCaption, this), this.didKeyDownCaption = c(this.didKeyDownCaption, this), this.didClickActionButton = c(this.didClickActionButton, this), this.didClickToolbar = c(this.didClickToolbar, this), this.attachment = this.attachmentPiece.attachment, u(this.element) === "a" && (this.element = this.element.firstChild), this.install();
          }
          var p;
          return l(h2, a2), p = function(t3) {
            return function() {
              var e2;
              return e2 = t3.apply(this, arguments), e2["do"](), this.undos == null && (this.undos = []), this.undos.push(e2.undo);
            };
          }, h2.prototype.install = function() {
            return this.makeElementMutable(), this.addToolbar(), this.attachment.isPreviewable() ? this.installCaptionEditor() : void 0;
          }, h2.prototype.uninstall = function() {
            var t3, e2;
            for (this.savePendingCaption(); e2 = this.undos.pop(); )
              e2();
            return (t3 = this.delegate) != null ? t3.didUninstallAttachmentEditor(this) : void 0;
          }, h2.prototype.savePendingCaption = function() {
            var t3, e2, n2;
            return this.pendingCaption != null ? (t3 = this.pendingCaption, this.pendingCaption = null, t3 ? (e2 = this.delegate) != null && typeof e2.attachmentEditorDidRequestUpdatingAttributesForAttachment == "function" ? e2.attachmentEditorDidRequestUpdatingAttributesForAttachment({caption: t3}, this.attachment) : void 0 : (n2 = this.delegate) != null && typeof n2.attachmentEditorDidRequestRemovingAttributeForAttachment == "function" ? n2.attachmentEditorDidRequestRemovingAttributeForAttachment("caption", this.attachment) : void 0) : void 0;
          }, h2.prototype.makeElementMutable = p(function() {
            return {do: function(t3) {
              return function() {
                return t3.element.dataset.trixMutable = true;
              };
            }(this), undo: function(t3) {
              return function() {
                return delete t3.element.dataset.trixMutable;
              };
            }(this)};
          }), h2.prototype.addToolbar = p(function() {
            var n2;
            return n2 = s({tagName: "div", className: t2.attachmentToolbar, data: {trixMutable: true}, childNodes: s({tagName: "div", className: "trix-button-row", childNodes: s({tagName: "span", className: "trix-button-group trix-button-group--actions", childNodes: s({tagName: "button", className: "trix-button trix-button--remove", textContent: r.remove, attributes: {title: r.remove}, data: {trixAction: "remove"}})})})}), this.attachment.isPreviewable() && n2.appendChild(s({tagName: "div", className: t2.attachmentMetadataContainer, childNodes: s({tagName: "span", className: t2.attachmentMetadata, childNodes: [s({tagName: "span", className: t2.attachmentName, textContent: this.attachment.getFilename(), attributes: {title: this.attachment.getFilename()}}), s({tagName: "span", className: t2.attachmentSize, textContent: this.attachment.getFormattedFilesize()})]})})), i("click", {onElement: n2, withCallback: this.didClickToolbar}), i("click", {onElement: n2, matchingSelector: "[data-trix-action]", withCallback: this.didClickActionButton}), {do: function(t3) {
              return function() {
                return t3.element.appendChild(n2);
              };
            }(this), undo: function() {
              return function() {
                return e.removeNode(n2);
              };
            }(this)};
          }), h2.prototype.installCaptionEditor = p(function() {
            var o2, a3, u2, c2, l2;
            return c2 = s({tagName: "textarea", className: t2.attachmentCaptionEditor, attributes: {placeholder: r.captionPlaceholder}, data: {trixMutable: true}}), c2.value = this.attachmentPiece.getCaption(), l2 = c2.cloneNode(), l2.classList.add("trix-autoresize-clone"), l2.tabIndex = -1, o2 = function() {
              return l2.value = c2.value, c2.style.height = l2.scrollHeight + "px";
            }, i("input", {onElement: c2, withCallback: o2}), i("input", {onElement: c2, withCallback: this.didInputCaption}), i("keydown", {onElement: c2, withCallback: this.didKeyDownCaption}), i("change", {onElement: c2, withCallback: this.didChangeCaption}), i("blur", {onElement: c2, withCallback: this.didBlurCaption}), u2 = this.element.querySelector("figcaption"), a3 = u2.cloneNode(), {do: function(e2) {
              return function() {
                return u2.style.display = "none", a3.appendChild(c2), a3.appendChild(l2), a3.classList.add(t2.attachmentCaption + "--editing"), u2.parentElement.insertBefore(a3, u2), o2(), e2.options.editCaption ? n(function() {
                  return c2.focus();
                }) : void 0;
              };
            }(this), undo: function() {
              return e.removeNode(a3), u2.style.display = null;
            }};
          }), h2.prototype.didClickToolbar = function(t3) {
            return t3.preventDefault(), t3.stopPropagation();
          }, h2.prototype.didClickActionButton = function(t3) {
            var e2, n2;
            switch (e2 = t3.target.getAttribute("data-trix-action")) {
              case "remove":
                return (n2 = this.delegate) != null ? n2.attachmentEditorDidRequestRemovalOfAttachment(this.attachment) : void 0;
            }
          }, h2.prototype.didKeyDownCaption = function(t3) {
            var e2;
            return o[t3.keyCode] === "return" ? (t3.preventDefault(), this.savePendingCaption(), (e2 = this.delegate) != null && typeof e2.attachmentEditorDidRequestDeselectingAttachment == "function" ? e2.attachmentEditorDidRequestDeselectingAttachment(this.attachment) : void 0) : void 0;
          }, h2.prototype.didInputCaption = function(t3) {
            return this.pendingCaption = t3.target.value.replace(/\s/g, " ").trim();
          }, h2.prototype.didChangeCaption = function() {
            return this.savePendingCaption();
          }, h2.prototype.didBlurCaption = function() {
            return this.savePendingCaption();
          }, h2;
        }(e.BasicObject);
      }.call(this), function() {
        var t2, n, i, o = function(t3, e2) {
          function n2() {
            this.constructor = t3;
          }
          for (var i2 in e2)
            r.call(e2, i2) && (t3[i2] = e2[i2]);
          return n2.prototype = e2.prototype, t3.prototype = new n2(), t3.__super__ = e2.prototype, t3;
        }, r = {}.hasOwnProperty;
        i = e.makeElement, t2 = e.config.css, e.AttachmentView = function(r2) {
          function s() {
            s.__super__.constructor.apply(this, arguments), this.attachment = this.object, this.attachment.uploadProgressDelegate = this, this.attachmentPiece = this.options.piece;
          }
          var a;
          return o(s, r2), s.attachmentSelector = "[data-trix-attachment]", s.prototype.createContentNodes = function() {
            return [];
          }, s.prototype.createNodes = function() {
            var e2, n2, o2, r3, s2, u, c;
            if (e2 = r3 = i({tagName: "figure", className: this.getClassName(), data: this.getData(), editable: false}), (n2 = this.getHref()) && (r3 = i({tagName: "a", editable: false, attributes: {href: n2, tabindex: -1}}), e2.appendChild(r3)), this.attachment.hasContent())
              r3.innerHTML = this.attachment.getContent();
            else
              for (c = this.createContentNodes(), o2 = 0, s2 = c.length; s2 > o2; o2++)
                u = c[o2], r3.appendChild(u);
            return r3.appendChild(this.createCaptionElement()), this.attachment.isPending() && (this.progressElement = i({tagName: "progress", attributes: {class: t2.attachmentProgress, value: this.attachment.getUploadProgress(), max: 100}, data: {trixMutable: true, trixStoreKey: ["progressElement", this.attachment.id].join("/")}}), e2.appendChild(this.progressElement)), [a("left"), e2, a("right")];
          }, s.prototype.createCaptionElement = function() {
            var e2, n2, o2, r3, s2, a2, u;
            return o2 = i({tagName: "figcaption", className: t2.attachmentCaption}), (e2 = this.attachmentPiece.getCaption()) ? (o2.classList.add(t2.attachmentCaption + "--edited"), o2.textContent = e2) : (n2 = this.getCaptionConfig(), n2.name && (r3 = this.attachment.getFilename()), n2.size && (a2 = this.attachment.getFormattedFilesize()), r3 && (s2 = i({tagName: "span", className: t2.attachmentName, textContent: r3}), o2.appendChild(s2)), a2 && (r3 && o2.appendChild(document.createTextNode(" ")), u = i({tagName: "span", className: t2.attachmentSize, textContent: a2}), o2.appendChild(u))), o2;
          }, s.prototype.getClassName = function() {
            var e2, n2;
            return n2 = [t2.attachment, t2.attachment + "--" + this.attachment.getType()], (e2 = this.attachment.getExtension()) && n2.push(t2.attachment + "--" + e2), n2.join(" ");
          }, s.prototype.getData = function() {
            var t3, e2;
            return e2 = {trixAttachment: JSON.stringify(this.attachment), trixContentType: this.attachment.getContentType(), trixId: this.attachment.id}, t3 = this.attachmentPiece.attributes, t3.isEmpty() || (e2.trixAttributes = JSON.stringify(t3)), this.attachment.isPending() && (e2.trixSerialize = false), e2;
          }, s.prototype.getHref = function() {
            return n(this.attachment.getContent(), "a") ? void 0 : this.attachment.getHref();
          }, s.prototype.getCaptionConfig = function() {
            var t3, n2, i2;
            return i2 = this.attachment.getType(), t3 = e.copyObject((n2 = e.config.attachments[i2]) != null ? n2.caption : void 0), i2 === "file" && (t3.name = true), t3;
          }, s.prototype.findProgressElement = function() {
            var t3;
            return (t3 = this.findElement()) != null ? t3.querySelector("progress") : void 0;
          }, a = function(t3) {
            return i({tagName: "span", textContent: e.ZERO_WIDTH_SPACE, data: {trixCursorTarget: t3, trixSerialize: false}});
          }, s.prototype.attachmentDidChangeUploadProgress = function() {
            var t3, e2;
            return e2 = this.attachment.getUploadProgress(), (t3 = this.findProgressElement()) != null ? t3.value = e2 : void 0;
          }, s;
        }(e.ObjectView), n = function(t3, e2) {
          var n2;
          return n2 = i("div"), n2.innerHTML = t3 != null ? t3 : "", n2.querySelector(e2);
        };
      }.call(this), function() {
        var t2, n = function(t3, e2) {
          function n2() {
            this.constructor = t3;
          }
          for (var o in e2)
            i.call(e2, o) && (t3[o] = e2[o]);
          return n2.prototype = e2.prototype, t3.prototype = new n2(), t3.__super__ = e2.prototype, t3;
        }, i = {}.hasOwnProperty;
        t2 = e.makeElement, e.PreviewableAttachmentView = function(i2) {
          function o() {
            o.__super__.constructor.apply(this, arguments), this.attachment.previewDelegate = this;
          }
          return n(o, i2), o.prototype.createContentNodes = function() {
            return this.image = t2({tagName: "img", attributes: {src: ""}, data: {trixMutable: true}}), this.refresh(this.image), [this.image];
          }, o.prototype.createCaptionElement = function() {
            var t3;
            return t3 = o.__super__.createCaptionElement.apply(this, arguments), t3.textContent || t3.setAttribute("data-trix-placeholder", e.config.lang.captionPlaceholder), t3;
          }, o.prototype.refresh = function(t3) {
            var e2;
            return t3 == null && (t3 = (e2 = this.findElement()) != null ? e2.querySelector("img") : void 0), t3 ? this.updateAttributesForImage(t3) : void 0;
          }, o.prototype.updateAttributesForImage = function(t3) {
            var e2, n2, i3, o2, r, s;
            return r = this.attachment.getURL(), n2 = this.attachment.getPreviewURL(), t3.src = n2 || r, n2 === r ? t3.removeAttribute("data-trix-serialized-attributes") : (i3 = JSON.stringify({src: r}), t3.setAttribute("data-trix-serialized-attributes", i3)), s = this.attachment.getWidth(), e2 = this.attachment.getHeight(), s != null && (t3.width = s), e2 != null && (t3.height = e2), o2 = ["imageElement", this.attachment.id, t3.src, t3.width, t3.height].join("/"), t3.dataset.trixStoreKey = o2;
          }, o.prototype.attachmentDidChangeAttributes = function() {
            return this.refresh(this.image), this.refresh();
          }, o;
        }(e.AttachmentView);
      }.call(this), function() {
        var t2, n, i, o = function(t3, e2) {
          function n2() {
            this.constructor = t3;
          }
          for (var i2 in e2)
            r.call(e2, i2) && (t3[i2] = e2[i2]);
          return n2.prototype = e2.prototype, t3.prototype = new n2(), t3.__super__ = e2.prototype, t3;
        }, r = {}.hasOwnProperty;
        i = e.makeElement, t2 = e.findInnerElement, n = e.getTextConfig, e.PieceView = function(r2) {
          function s() {
            var t3;
            s.__super__.constructor.apply(this, arguments), this.piece = this.object, this.attributes = this.piece.getAttributes(), t3 = this.options, this.textConfig = t3.textConfig, this.context = t3.context, this.piece.attachment ? this.attachment = this.piece.attachment : this.string = this.piece.toString();
          }
          var a;
          return o(s, r2), s.prototype.createNodes = function() {
            var e2, n2, i2, o2, r3, s2;
            if (s2 = this.attachment ? this.createAttachmentNodes() : this.createStringNodes(), e2 = this.createElement()) {
              for (i2 = t2(e2), n2 = 0, o2 = s2.length; o2 > n2; n2++)
                r3 = s2[n2], i2.appendChild(r3);
              s2 = [e2];
            }
            return s2;
          }, s.prototype.createAttachmentNodes = function() {
            var t3, n2;
            return t3 = this.attachment.isPreviewable() ? e.PreviewableAttachmentView : e.AttachmentView, n2 = this.createChildView(t3, this.piece.attachment, {piece: this.piece}), n2.getNodes();
          }, s.prototype.createStringNodes = function() {
            var t3, e2, n2, o2, r3, s2, a2, u, c, l;
            if ((u = this.textConfig) != null ? u.plaintext : void 0)
              return [document.createTextNode(this.string)];
            for (a2 = [], c = this.string.split("\n"), n2 = e2 = 0, o2 = c.length; o2 > e2; n2 = ++e2)
              l = c[n2], n2 > 0 && (t3 = i("br"), a2.push(t3)), (r3 = l.length) && (s2 = document.createTextNode(this.preserveSpaces(l)), a2.push(s2));
            return a2;
          }, s.prototype.createElement = function() {
            var t3, e2, o2, r3, s2, a2, u, c, l;
            c = {}, a2 = this.attributes;
            for (r3 in a2)
              if (l = a2[r3], (t3 = n(r3)) && (t3.tagName && (s2 = i(t3.tagName), o2 ? (o2.appendChild(s2), o2 = s2) : e2 = o2 = s2), t3.styleProperty && (c[t3.styleProperty] = l), t3.style)) {
                u = t3.style;
                for (r3 in u)
                  l = u[r3], c[r3] = l;
              }
            if (Object.keys(c).length) {
              e2 == null && (e2 = i("span"));
              for (r3 in c)
                l = c[r3], e2.style[r3] = l;
            }
            return e2;
          }, s.prototype.createContainerElement = function() {
            var t3, e2, o2, r3, s2;
            r3 = this.attributes;
            for (o2 in r3)
              if (s2 = r3[o2], (e2 = n(o2)) && e2.groupTagName)
                return t3 = {}, t3[o2] = s2, i(e2.groupTagName, t3);
          }, a = e.NON_BREAKING_SPACE, s.prototype.preserveSpaces = function(t3) {
            return this.context.isLast && (t3 = t3.replace(/\ $/, a)), t3 = t3.replace(/(\S)\ {3}(\S)/g, "$1 " + a + " $2").replace(/\ {2}/g, a + " ").replace(/\ {2}/g, " " + a), (this.context.isFirst || this.context.followsWhitespace) && (t3 = t3.replace(/^\ /, a)), t3;
          }, s;
        }(e.ObjectView);
      }.call(this), function() {
        var t2 = function(t3, e2) {
          function i() {
            this.constructor = t3;
          }
          for (var o in e2)
            n.call(e2, o) && (t3[o] = e2[o]);
          return i.prototype = e2.prototype, t3.prototype = new i(), t3.__super__ = e2.prototype, t3;
        }, n = {}.hasOwnProperty;
        e.TextView = function(n2) {
          function i() {
            i.__super__.constructor.apply(this, arguments), this.text = this.object, this.textConfig = this.options.textConfig;
          }
          var o;
          return t2(i, n2), i.prototype.createNodes = function() {
            var t3, n3, i2, r, s, a, u, c, l, h;
            for (a = [], c = e.ObjectGroup.groupObjects(this.getPieces()), r = c.length - 1, i2 = n3 = 0, s = c.length; s > n3; i2 = ++n3)
              u = c[i2], t3 = {}, i2 === 0 && (t3.isFirst = true), i2 === r && (t3.isLast = true), o(l) && (t3.followsWhitespace = true), h = this.findOrCreateCachedChildView(e.PieceView, u, {textConfig: this.textConfig, context: t3}), a.push.apply(a, h.getNodes()), l = u;
            return a;
          }, i.prototype.getPieces = function() {
            var t3, e2, n3, i2, o2;
            for (i2 = this.text.getPieces(), o2 = [], t3 = 0, e2 = i2.length; e2 > t3; t3++)
              n3 = i2[t3], n3.hasAttribute("blockBreak") || o2.push(n3);
            return o2;
          }, o = function(t3) {
            return /\s$/.test(t3 != null ? t3.toString() : void 0);
          }, i;
        }(e.ObjectView);
      }.call(this), function() {
        var t2, n, i, o = function(t3, e2) {
          function n2() {
            this.constructor = t3;
          }
          for (var i2 in e2)
            r.call(e2, i2) && (t3[i2] = e2[i2]);
          return n2.prototype = e2.prototype, t3.prototype = new n2(), t3.__super__ = e2.prototype, t3;
        }, r = {}.hasOwnProperty;
        i = e.makeElement, n = e.getBlockConfig, t2 = e.config.css, e.BlockView = function(r2) {
          function s() {
            s.__super__.constructor.apply(this, arguments), this.block = this.object, this.attributes = this.block.getAttributes();
          }
          return o(s, r2), s.prototype.createNodes = function() {
            var t3, o2, r3, s2, a, u, c, l, h, p, d;
            if (o2 = document.createComment("block"), c = [o2], this.block.isEmpty() ? c.push(i("br")) : (p = (l = n(this.block.getLastAttribute())) != null ? l.text : void 0, d = this.findOrCreateCachedChildView(e.TextView, this.block.text, {textConfig: p}), c.push.apply(c, d.getNodes()), this.shouldAddExtraNewlineElement() && c.push(i("br"))), this.attributes.length)
              return c;
            for (h = e.config.blockAttributes["default"].tagName, this.block.isRTL() && (t3 = {dir: "rtl"}), r3 = i({tagName: h, attributes: t3}), s2 = 0, a = c.length; a > s2; s2++)
              u = c[s2], r3.appendChild(u);
            return [r3];
          }, s.prototype.createContainerElement = function(e2) {
            var o2, r3, s2, a, u;
            return o2 = this.attributes[e2], u = n(o2).tagName, e2 === 0 && this.block.isRTL() && (r3 = {dir: "rtl"}), o2 === "attachmentGallery" && (a = this.block.getBlockBreakPosition(), s2 = t2.attachmentGallery + " " + t2.attachmentGallery + "--" + a), i({tagName: u, className: s2, attributes: r3});
          }, s.prototype.shouldAddExtraNewlineElement = function() {
            return /\n\n$/.test(this.block.toString());
          }, s;
        }(e.ObjectView);
      }.call(this), function() {
        var t2, n, i = function(t3, e2) {
          function n2() {
            this.constructor = t3;
          }
          for (var i2 in e2)
            o.call(e2, i2) && (t3[i2] = e2[i2]);
          return n2.prototype = e2.prototype, t3.prototype = new n2(), t3.__super__ = e2.prototype, t3;
        }, o = {}.hasOwnProperty;
        t2 = e.defer, n = e.makeElement, e.DocumentView = function(o2) {
          function r() {
            r.__super__.constructor.apply(this, arguments), this.element = this.options.element, this.elementStore = new e.ElementStore(), this.setDocument(this.object);
          }
          var s, a, u;
          return i(r, o2), r.render = function(t3) {
            var e2, i2;
            return e2 = n("div"), i2 = new this(t3, {element: e2}), i2.render(), i2.sync(), e2;
          }, r.prototype.setDocument = function(t3) {
            return t3.isEqualTo(this.document) ? void 0 : this.document = this.object = t3;
          }, r.prototype.render = function() {
            var t3, i2, o3, r2, s2, a2, u2;
            if (this.childViews = [], this.shadowElement = n("div"), !this.document.isEmpty()) {
              for (s2 = e.ObjectGroup.groupObjects(this.document.getBlocks(), {asTree: true}), a2 = [], t3 = 0, i2 = s2.length; i2 > t3; t3++)
                r2 = s2[t3], u2 = this.findOrCreateCachedChildView(e.BlockView, r2), a2.push(function() {
                  var t4, e2, n2, i3;
                  for (n2 = u2.getNodes(), i3 = [], t4 = 0, e2 = n2.length; e2 > t4; t4++)
                    o3 = n2[t4], i3.push(this.shadowElement.appendChild(o3));
                  return i3;
                }.call(this));
              return a2;
            }
          }, r.prototype.isSynced = function() {
            return s(this.shadowElement, this.element);
          }, r.prototype.sync = function() {
            var t3;
            for (t3 = this.createDocumentFragmentForSync(); this.element.lastChild; )
              this.element.removeChild(this.element.lastChild);
            return this.element.appendChild(t3), this.didSync();
          }, r.prototype.didSync = function() {
            return this.elementStore.reset(a(this.element)), t2(function(t3) {
              return function() {
                return t3.garbageCollectCachedViews();
              };
            }(this));
          }, r.prototype.createDocumentFragmentForSync = function() {
            var t3, e2, n2, i2, o3, r2, s2, u2, c, l;
            for (e2 = document.createDocumentFragment(), u2 = this.shadowElement.childNodes, n2 = 0, o3 = u2.length; o3 > n2; n2++)
              s2 = u2[n2], e2.appendChild(s2.cloneNode(true));
            for (c = a(e2), i2 = 0, r2 = c.length; r2 > i2; i2++)
              t3 = c[i2], (l = this.elementStore.remove(t3)) && t3.parentNode.replaceChild(l, t3);
            return e2;
          }, a = function(t3) {
            return t3.querySelectorAll("[data-trix-store-key]");
          }, s = function(t3, e2) {
            return u(t3.innerHTML) === u(e2.innerHTML);
          }, u = function(t3) {
            return t3.replace(/&nbsp;/g, " ");
          }, r;
        }(e.ObjectView);
      }.call(this), function() {
        var t2, n, i, o, r, s = function(t3, e2) {
          return function() {
            return t3.apply(e2, arguments);
          };
        }, a = function(t3, e2) {
          function n2() {
            this.constructor = t3;
          }
          for (var i2 in e2)
            u.call(e2, i2) && (t3[i2] = e2[i2]);
          return n2.prototype = e2.prototype, t3.prototype = new n2(), t3.__super__ = e2.prototype, t3;
        }, u = {}.hasOwnProperty;
        i = e.findClosestElementFromNode, o = e.handleEvent, r = e.innerElementIsActive, n = e.defer, t2 = e.AttachmentView.attachmentSelector, e.CompositionController = function(u2) {
          function c(n2, i2) {
            this.element = n2, this.composition = i2, this.didClickAttachment = s(this.didClickAttachment, this), this.didBlur = s(this.didBlur, this), this.didFocus = s(this.didFocus, this), this.documentView = new e.DocumentView(this.composition.document, {element: this.element}), o("focus", {onElement: this.element, withCallback: this.didFocus}), o("blur", {onElement: this.element, withCallback: this.didBlur}), o("click", {onElement: this.element, matchingSelector: "a[contenteditable=false]", preventDefault: true}), o("mousedown", {onElement: this.element, matchingSelector: t2, withCallback: this.didClickAttachment}), o("click", {onElement: this.element, matchingSelector: "a" + t2, preventDefault: true});
          }
          return a(c, u2), c.prototype.didFocus = function() {
            var t3, e2, n2;
            return t3 = function(t4) {
              return function() {
                var e3;
                return t4.focused ? void 0 : (t4.focused = true, (e3 = t4.delegate) != null && typeof e3.compositionControllerDidFocus == "function" ? e3.compositionControllerDidFocus() : void 0);
              };
            }(this), (e2 = (n2 = this.blurPromise) != null ? n2.then(t3) : void 0) != null ? e2 : t3();
          }, c.prototype.didBlur = function() {
            return this.blurPromise = new Promise(function(t3) {
              return function(e2) {
                return n(function() {
                  var n2;
                  return r(t3.element) || (t3.focused = null, (n2 = t3.delegate) != null && typeof n2.compositionControllerDidBlur == "function" && n2.compositionControllerDidBlur()), t3.blurPromise = null, e2();
                });
              };
            }(this));
          }, c.prototype.didClickAttachment = function(t3, e2) {
            var n2, o2, r2;
            return n2 = this.findAttachmentForElement(e2), o2 = i(t3.target, {matchingSelector: "figcaption"}) != null, (r2 = this.delegate) != null && typeof r2.compositionControllerDidSelectAttachment == "function" ? r2.compositionControllerDidSelectAttachment(n2, {editCaption: o2}) : void 0;
          }, c.prototype.getSerializableElement = function() {
            return this.isEditingAttachment() ? this.documentView.shadowElement : this.element;
          }, c.prototype.render = function() {
            var t3, e2, n2;
            return this.revision !== this.composition.revision && (this.documentView.setDocument(this.composition.document), this.documentView.render(), this.revision = this.composition.revision), this.canSyncDocumentView() && !this.documentView.isSynced() && ((t3 = this.delegate) != null && typeof t3.compositionControllerWillSyncDocumentView == "function" && t3.compositionControllerWillSyncDocumentView(), this.documentView.sync(), (e2 = this.delegate) != null && typeof e2.compositionControllerDidSyncDocumentView == "function" && e2.compositionControllerDidSyncDocumentView()), (n2 = this.delegate) != null && typeof n2.compositionControllerDidRender == "function" ? n2.compositionControllerDidRender() : void 0;
          }, c.prototype.rerenderViewForObject = function(t3) {
            return this.invalidateViewForObject(t3), this.render();
          }, c.prototype.invalidateViewForObject = function(t3) {
            return this.documentView.invalidateViewForObject(t3);
          }, c.prototype.isViewCachingEnabled = function() {
            return this.documentView.isViewCachingEnabled();
          }, c.prototype.enableViewCaching = function() {
            return this.documentView.enableViewCaching();
          }, c.prototype.disableViewCaching = function() {
            return this.documentView.disableViewCaching();
          }, c.prototype.refreshViewCache = function() {
            return this.documentView.garbageCollectCachedViews();
          }, c.prototype.isEditingAttachment = function() {
            return this.attachmentEditor != null;
          }, c.prototype.installAttachmentEditorForAttachment = function(t3, n2) {
            var i2, o2, r2;
            if (((r2 = this.attachmentEditor) != null ? r2.attachment : void 0) !== t3 && (o2 = this.documentView.findElementForObject(t3)))
              return this.uninstallAttachmentEditor(), i2 = this.composition.document.getAttachmentPieceForAttachment(t3), this.attachmentEditor = new e.AttachmentEditorController(i2, o2, this.element, n2), this.attachmentEditor.delegate = this;
          }, c.prototype.uninstallAttachmentEditor = function() {
            var t3;
            return (t3 = this.attachmentEditor) != null ? t3.uninstall() : void 0;
          }, c.prototype.didUninstallAttachmentEditor = function() {
            return this.attachmentEditor = null, this.render();
          }, c.prototype.attachmentEditorDidRequestUpdatingAttributesForAttachment = function(t3, e2) {
            var n2;
            return (n2 = this.delegate) != null && typeof n2.compositionControllerWillUpdateAttachment == "function" && n2.compositionControllerWillUpdateAttachment(e2), this.composition.updateAttributesForAttachment(t3, e2);
          }, c.prototype.attachmentEditorDidRequestRemovingAttributeForAttachment = function(t3, e2) {
            var n2;
            return (n2 = this.delegate) != null && typeof n2.compositionControllerWillUpdateAttachment == "function" && n2.compositionControllerWillUpdateAttachment(e2), this.composition.removeAttributeForAttachment(t3, e2);
          }, c.prototype.attachmentEditorDidRequestRemovalOfAttachment = function(t3) {
            var e2;
            return (e2 = this.delegate) != null && typeof e2.compositionControllerDidRequestRemovalOfAttachment == "function" ? e2.compositionControllerDidRequestRemovalOfAttachment(t3) : void 0;
          }, c.prototype.attachmentEditorDidRequestDeselectingAttachment = function(t3) {
            var e2;
            return (e2 = this.delegate) != null && typeof e2.compositionControllerDidRequestDeselectingAttachment == "function" ? e2.compositionControllerDidRequestDeselectingAttachment(t3) : void 0;
          }, c.prototype.canSyncDocumentView = function() {
            return !this.isEditingAttachment();
          }, c.prototype.findAttachmentForElement = function(t3) {
            return this.composition.document.getAttachmentById(parseInt(t3.dataset.trixId, 10));
          }, c;
        }(e.BasicObject);
      }.call(this), function() {
        var t2, n, i, o = function(t3, e2) {
          return function() {
            return t3.apply(e2, arguments);
          };
        }, r = function(t3, e2) {
          function n2() {
            this.constructor = t3;
          }
          for (var i2 in e2)
            s.call(e2, i2) && (t3[i2] = e2[i2]);
          return n2.prototype = e2.prototype, t3.prototype = new n2(), t3.__super__ = e2.prototype, t3;
        }, s = {}.hasOwnProperty;
        n = e.handleEvent, i = e.triggerEvent, t2 = e.findClosestElementFromNode, e.ToolbarController = function(e2) {
          function s2(t3) {
            this.element = t3, this.didKeyDownDialogInput = o(this.didKeyDownDialogInput, this), this.didClickDialogButton = o(this.didClickDialogButton, this), this.didClickAttributeButton = o(this.didClickAttributeButton, this), this.didClickActionButton = o(this.didClickActionButton, this), this.attributes = {}, this.actions = {}, this.resetDialogInputs(), n("mousedown", {onElement: this.element, matchingSelector: a, withCallback: this.didClickActionButton}), n("mousedown", {onElement: this.element, matchingSelector: c, withCallback: this.didClickAttributeButton}), n("click", {onElement: this.element, matchingSelector: v, preventDefault: true}), n("click", {onElement: this.element, matchingSelector: l, withCallback: this.didClickDialogButton}), n("keydown", {onElement: this.element, matchingSelector: h, withCallback: this.didKeyDownDialogInput});
          }
          var a, u, c, l, h, p, d, f, g, m, v;
          return r(s2, e2), c = "[data-trix-attribute]", a = "[data-trix-action]", v = c + ", " + a, p = "[data-trix-dialog]", u = p + "[data-trix-active]", l = p + " [data-trix-method]", h = p + " [data-trix-input]", s2.prototype.didClickActionButton = function(t3, e3) {
            var n2, i2, o2;
            return (i2 = this.delegate) != null && i2.toolbarDidClickButton(), t3.preventDefault(), n2 = d(e3), this.getDialog(n2) ? this.toggleDialog(n2) : (o2 = this.delegate) != null ? o2.toolbarDidInvokeAction(n2) : void 0;
          }, s2.prototype.didClickAttributeButton = function(t3, e3) {
            var n2, i2, o2;
            return (i2 = this.delegate) != null && i2.toolbarDidClickButton(), t3.preventDefault(), n2 = f(e3), this.getDialog(n2) ? this.toggleDialog(n2) : (o2 = this.delegate) != null && o2.toolbarDidToggleAttribute(n2), this.refreshAttributeButtons();
          }, s2.prototype.didClickDialogButton = function(e3, n2) {
            var i2, o2;
            return i2 = t2(n2, {matchingSelector: p}), o2 = n2.getAttribute("data-trix-method"), this[o2].call(this, i2);
          }, s2.prototype.didKeyDownDialogInput = function(t3, e3) {
            var n2, i2;
            return t3.keyCode === 13 && (t3.preventDefault(), n2 = e3.getAttribute("name"), i2 = this.getDialog(n2), this.setAttribute(i2)), t3.keyCode === 27 ? (t3.preventDefault(), this.hideDialog()) : void 0;
          }, s2.prototype.updateActions = function(t3) {
            return this.actions = t3, this.refreshActionButtons();
          }, s2.prototype.refreshActionButtons = function() {
            return this.eachActionButton(function(t3) {
              return function(e3, n2) {
                return e3.disabled = t3.actions[n2] === false;
              };
            }(this));
          }, s2.prototype.eachActionButton = function(t3) {
            var e3, n2, i2, o2, r2;
            for (o2 = this.element.querySelectorAll(a), r2 = [], n2 = 0, i2 = o2.length; i2 > n2; n2++)
              e3 = o2[n2], r2.push(t3(e3, d(e3)));
            return r2;
          }, s2.prototype.updateAttributes = function(t3) {
            return this.attributes = t3, this.refreshAttributeButtons();
          }, s2.prototype.refreshAttributeButtons = function() {
            return this.eachAttributeButton(function(t3) {
              return function(e3, n2) {
                return e3.disabled = t3.attributes[n2] === false, t3.attributes[n2] || t3.dialogIsVisible(n2) ? (e3.setAttribute("data-trix-active", ""), e3.classList.add("trix-active")) : (e3.removeAttribute("data-trix-active"), e3.classList.remove("trix-active"));
              };
            }(this));
          }, s2.prototype.eachAttributeButton = function(t3) {
            var e3, n2, i2, o2, r2;
            for (o2 = this.element.querySelectorAll(c), r2 = [], n2 = 0, i2 = o2.length; i2 > n2; n2++)
              e3 = o2[n2], r2.push(t3(e3, f(e3)));
            return r2;
          }, s2.prototype.applyKeyboardCommand = function(t3) {
            var e3, n2, o2, r2, s3, a2, u2;
            for (s3 = JSON.stringify(t3.sort()), u2 = this.element.querySelectorAll("[data-trix-key]"), r2 = 0, a2 = u2.length; a2 > r2; r2++)
              if (e3 = u2[r2], o2 = e3.getAttribute("data-trix-key").split("+"), n2 = JSON.stringify(o2.sort()), n2 === s3)
                return i("mousedown", {onElement: e3}), true;
            return false;
          }, s2.prototype.dialogIsVisible = function(t3) {
            var e3;
            return (e3 = this.getDialog(t3)) ? e3.hasAttribute("data-trix-active") : void 0;
          }, s2.prototype.toggleDialog = function(t3) {
            return this.dialogIsVisible(t3) ? this.hideDialog() : this.showDialog(t3);
          }, s2.prototype.showDialog = function(t3) {
            var e3, n2, i2, o2, r2, s3, a2, u2, c2, l2;
            for (this.hideDialog(), (a2 = this.delegate) != null && a2.toolbarWillShowDialog(), i2 = this.getDialog(t3), i2.setAttribute("data-trix-active", ""), i2.classList.add("trix-active"), u2 = i2.querySelectorAll("input[disabled]"), o2 = 0, s3 = u2.length; s3 > o2; o2++)
              n2 = u2[o2], n2.removeAttribute("disabled");
            return (e3 = f(i2)) && (r2 = m(i2, t3)) && (r2.value = (c2 = this.attributes[e3]) != null ? c2 : "", r2.select()), (l2 = this.delegate) != null ? l2.toolbarDidShowDialog(t3) : void 0;
          }, s2.prototype.setAttribute = function(t3) {
            var e3, n2, i2;
            return e3 = f(t3), n2 = m(t3, e3), n2.willValidate && !n2.checkValidity() ? (n2.setAttribute("data-trix-validate", ""), n2.classList.add("trix-validate"), n2.focus()) : ((i2 = this.delegate) != null && i2.toolbarDidUpdateAttribute(e3, n2.value), this.hideDialog());
          }, s2.prototype.removeAttribute = function(t3) {
            var e3, n2;
            return e3 = f(t3), (n2 = this.delegate) != null && n2.toolbarDidRemoveAttribute(e3), this.hideDialog();
          }, s2.prototype.hideDialog = function() {
            var t3, e3;
            return (t3 = this.element.querySelector(u)) ? (t3.removeAttribute("data-trix-active"), t3.classList.remove("trix-active"), this.resetDialogInputs(), (e3 = this.delegate) != null ? e3.toolbarDidHideDialog(g(t3)) : void 0) : void 0;
          }, s2.prototype.resetDialogInputs = function() {
            var t3, e3, n2, i2, o2;
            for (i2 = this.element.querySelectorAll(h), o2 = [], t3 = 0, n2 = i2.length; n2 > t3; t3++)
              e3 = i2[t3], e3.setAttribute("disabled", "disabled"), e3.removeAttribute("data-trix-validate"), o2.push(e3.classList.remove("trix-validate"));
            return o2;
          }, s2.prototype.getDialog = function(t3) {
            return this.element.querySelector("[data-trix-dialog=" + t3 + "]");
          }, m = function(t3, e3) {
            return e3 == null && (e3 = f(t3)), t3.querySelector("[data-trix-input][name='" + e3 + "']");
          }, d = function(t3) {
            return t3.getAttribute("data-trix-action");
          }, f = function(t3) {
            var e3;
            return (e3 = t3.getAttribute("data-trix-attribute")) != null ? e3 : t3.getAttribute("data-trix-dialog-attribute");
          }, g = function(t3) {
            return t3.getAttribute("data-trix-dialog");
          }, s2;
        }(e.BasicObject);
      }.call(this), function() {
        var t2 = function(t3, e2) {
          function i() {
            this.constructor = t3;
          }
          for (var o in e2)
            n.call(e2, o) && (t3[o] = e2[o]);
          return i.prototype = e2.prototype, t3.prototype = new i(), t3.__super__ = e2.prototype, t3;
        }, n = {}.hasOwnProperty;
        e.ImagePreloadOperation = function(e2) {
          function n2(t3) {
            this.url = t3;
          }
          return t2(n2, e2), n2.prototype.perform = function(t3) {
            var e3;
            return e3 = new Image(), e3.onload = function(n3) {
              return function() {
                return e3.width = n3.width = e3.naturalWidth, e3.height = n3.height = e3.naturalHeight, t3(true, e3);
              };
            }(this), e3.onerror = function() {
              return t3(false);
            }, e3.src = this.url;
          }, n2;
        }(e.Operation);
      }.call(this), function() {
        var t2 = function(t3, e2) {
          return function() {
            return t3.apply(e2, arguments);
          };
        }, n = function(t3, e2) {
          function n2() {
            this.constructor = t3;
          }
          for (var o in e2)
            i.call(e2, o) && (t3[o] = e2[o]);
          return n2.prototype = e2.prototype, t3.prototype = new n2(), t3.__super__ = e2.prototype, t3;
        }, i = {}.hasOwnProperty;
        e.Attachment = function(i2) {
          function o(n2) {
            n2 == null && (n2 = {}), this.releaseFile = t2(this.releaseFile, this), o.__super__.constructor.apply(this, arguments), this.attributes = e.Hash.box(n2), this.didChangeAttributes();
          }
          return n(o, i2), o.previewablePattern = /^image(\/(gif|png|jpe?g)|$)/, o.attachmentForFile = function(t3) {
            var e2, n2;
            return n2 = this.attributesForFile(t3), e2 = new this(n2), e2.setFile(t3), e2;
          }, o.attributesForFile = function(t3) {
            return new e.Hash({filename: t3.name, filesize: t3.size, contentType: t3.type});
          }, o.fromJSON = function(t3) {
            return new this(t3);
          }, o.prototype.getAttribute = function(t3) {
            return this.attributes.get(t3);
          }, o.prototype.hasAttribute = function(t3) {
            return this.attributes.has(t3);
          }, o.prototype.getAttributes = function() {
            return this.attributes.toObject();
          }, o.prototype.setAttributes = function(t3) {
            var e2, n2, i3;
            return t3 == null && (t3 = {}), e2 = this.attributes.merge(t3), this.attributes.isEqualTo(e2) ? void 0 : (this.attributes = e2, this.didChangeAttributes(), (n2 = this.previewDelegate) != null && typeof n2.attachmentDidChangeAttributes == "function" && n2.attachmentDidChangeAttributes(this), (i3 = this.delegate) != null && typeof i3.attachmentDidChangeAttributes == "function" ? i3.attachmentDidChangeAttributes(this) : void 0);
          }, o.prototype.didChangeAttributes = function() {
            return this.isPreviewable() ? this.preloadURL() : void 0;
          }, o.prototype.isPending = function() {
            return this.file != null && !(this.getURL() || this.getHref());
          }, o.prototype.isPreviewable = function() {
            return this.attributes.has("previewable") ? this.attributes.get("previewable") : this.constructor.previewablePattern.test(this.getContentType());
          }, o.prototype.getType = function() {
            return this.hasContent() ? "content" : this.isPreviewable() ? "preview" : "file";
          }, o.prototype.getURL = function() {
            return this.attributes.get("url");
          }, o.prototype.getHref = function() {
            return this.attributes.get("href");
          }, o.prototype.getFilename = function() {
            var t3;
            return (t3 = this.attributes.get("filename")) != null ? t3 : "";
          }, o.prototype.getFilesize = function() {
            return this.attributes.get("filesize");
          }, o.prototype.getFormattedFilesize = function() {
            var t3;
            return t3 = this.attributes.get("filesize"), typeof t3 == "number" ? e.config.fileSize.formatter(t3) : "";
          }, o.prototype.getExtension = function() {
            var t3;
            return (t3 = this.getFilename().match(/\.(\w+)$/)) != null ? t3[1].toLowerCase() : void 0;
          }, o.prototype.getContentType = function() {
            return this.attributes.get("contentType");
          }, o.prototype.hasContent = function() {
            return this.attributes.has("content");
          }, o.prototype.getContent = function() {
            return this.attributes.get("content");
          }, o.prototype.getWidth = function() {
            return this.attributes.get("width");
          }, o.prototype.getHeight = function() {
            return this.attributes.get("height");
          }, o.prototype.getFile = function() {
            return this.file;
          }, o.prototype.setFile = function(t3) {
            return this.file = t3, this.isPreviewable() ? this.preloadFile() : void 0;
          }, o.prototype.releaseFile = function() {
            return this.releasePreloadedFile(), this.file = null;
          }, o.prototype.getUploadProgress = function() {
            var t3;
            return (t3 = this.uploadProgress) != null ? t3 : 0;
          }, o.prototype.setUploadProgress = function(t3) {
            var e2;
            return this.uploadProgress !== t3 ? (this.uploadProgress = t3, (e2 = this.uploadProgressDelegate) != null && typeof e2.attachmentDidChangeUploadProgress == "function" ? e2.attachmentDidChangeUploadProgress(this) : void 0) : void 0;
          }, o.prototype.toJSON = function() {
            return this.getAttributes();
          }, o.prototype.getCacheKey = function() {
            return [o.__super__.getCacheKey.apply(this, arguments), this.attributes.getCacheKey(), this.getPreviewURL()].join("/");
          }, o.prototype.getPreviewURL = function() {
            return this.previewURL || this.preloadingURL;
          }, o.prototype.setPreviewURL = function(t3) {
            var e2, n2;
            return t3 !== this.getPreviewURL() ? (this.previewURL = t3, (e2 = this.previewDelegate) != null && typeof e2.attachmentDidChangeAttributes == "function" && e2.attachmentDidChangeAttributes(this), (n2 = this.delegate) != null && typeof n2.attachmentDidChangePreviewURL == "function" ? n2.attachmentDidChangePreviewURL(this) : void 0) : void 0;
          }, o.prototype.preloadURL = function() {
            return this.preload(this.getURL(), this.releaseFile);
          }, o.prototype.preloadFile = function() {
            return this.file ? (this.fileObjectURL = URL.createObjectURL(this.file), this.preload(this.fileObjectURL)) : void 0;
          }, o.prototype.releasePreloadedFile = function() {
            return this.fileObjectURL ? (URL.revokeObjectURL(this.fileObjectURL), this.fileObjectURL = null) : void 0;
          }, o.prototype.preload = function(t3, n2) {
            var i3;
            return t3 && t3 !== this.getPreviewURL() ? (this.preloadingURL = t3, i3 = new e.ImagePreloadOperation(t3), i3.then(function(e2) {
              return function(i4) {
                var o2, r;
                return r = i4.width, o2 = i4.height, e2.getWidth() && e2.getHeight() || e2.setAttributes({width: r, height: o2}), e2.preloadingURL = null, e2.setPreviewURL(t3), typeof n2 == "function" ? n2() : void 0;
              };
            }(this))["catch"](function(t4) {
              return function() {
                return t4.preloadingURL = null, typeof n2 == "function" ? n2() : void 0;
              };
            }(this))) : void 0;
          }, o;
        }(e.Object);
      }.call(this), function() {
        var t2 = function(t3, e2) {
          function i() {
            this.constructor = t3;
          }
          for (var o in e2)
            n.call(e2, o) && (t3[o] = e2[o]);
          return i.prototype = e2.prototype, t3.prototype = new i(), t3.__super__ = e2.prototype, t3;
        }, n = {}.hasOwnProperty;
        e.Piece = function(n2) {
          function i(t3, n3) {
            n3 == null && (n3 = {}), i.__super__.constructor.apply(this, arguments), this.attributes = e.Hash.box(n3);
          }
          return t2(i, n2), i.types = {}, i.registerType = function(t3, e2) {
            return e2.type = t3, this.types[t3] = e2;
          }, i.fromJSON = function(t3) {
            var e2;
            return (e2 = this.types[t3.type]) ? e2.fromJSON(t3) : void 0;
          }, i.prototype.copyWithAttributes = function(t3) {
            return new this.constructor(this.getValue(), t3);
          }, i.prototype.copyWithAdditionalAttributes = function(t3) {
            return this.copyWithAttributes(this.attributes.merge(t3));
          }, i.prototype.copyWithoutAttribute = function(t3) {
            return this.copyWithAttributes(this.attributes.remove(t3));
          }, i.prototype.copy = function() {
            return this.copyWithAttributes(this.attributes);
          }, i.prototype.getAttribute = function(t3) {
            return this.attributes.get(t3);
          }, i.prototype.getAttributesHash = function() {
            return this.attributes;
          }, i.prototype.getAttributes = function() {
            return this.attributes.toObject();
          }, i.prototype.getCommonAttributes = function() {
            var t3, e2, n3;
            return (n3 = pieceList.getPieceAtIndex(0)) ? (t3 = n3.attributes, e2 = t3.getKeys(), pieceList.eachPiece(function(n4) {
              return e2 = t3.getKeysCommonToHash(n4.attributes), t3 = t3.slice(e2);
            }), t3.toObject()) : {};
          }, i.prototype.hasAttribute = function(t3) {
            return this.attributes.has(t3);
          }, i.prototype.hasSameStringValueAsPiece = function(t3) {
            return t3 != null && this.toString() === t3.toString();
          }, i.prototype.hasSameAttributesAsPiece = function(t3) {
            return t3 != null && (this.attributes === t3.attributes || this.attributes.isEqualTo(t3.attributes));
          }, i.prototype.isBlockBreak = function() {
            return false;
          }, i.prototype.isEqualTo = function(t3) {
            return i.__super__.isEqualTo.apply(this, arguments) || this.hasSameConstructorAs(t3) && this.hasSameStringValueAsPiece(t3) && this.hasSameAttributesAsPiece(t3);
          }, i.prototype.isEmpty = function() {
            return this.length === 0;
          }, i.prototype.isSerializable = function() {
            return true;
          }, i.prototype.toJSON = function() {
            return {type: this.constructor.type, attributes: this.getAttributes()};
          }, i.prototype.contentsForInspection = function() {
            return {type: this.constructor.type, attributes: this.attributes.inspect()};
          }, i.prototype.canBeGrouped = function() {
            return this.hasAttribute("href");
          }, i.prototype.canBeGroupedWith = function(t3) {
            return this.getAttribute("href") === t3.getAttribute("href");
          }, i.prototype.getLength = function() {
            return this.length;
          }, i.prototype.canBeConsolidatedWith = function() {
            return false;
          }, i;
        }(e.Object);
      }.call(this), function() {
        var t2 = function(t3, e2) {
          function i() {
            this.constructor = t3;
          }
          for (var o in e2)
            n.call(e2, o) && (t3[o] = e2[o]);
          return i.prototype = e2.prototype, t3.prototype = new i(), t3.__super__ = e2.prototype, t3;
        }, n = {}.hasOwnProperty;
        e.Piece.registerType("attachment", e.AttachmentPiece = function(n2) {
          function i(t3) {
            this.attachment = t3, i.__super__.constructor.apply(this, arguments), this.length = 1, this.ensureAttachmentExclusivelyHasAttribute("href"), this.attachment.hasContent() || this.removeProhibitedAttributes();
          }
          return t2(i, n2), i.fromJSON = function(t3) {
            return new this(e.Attachment.fromJSON(t3.attachment), t3.attributes);
          }, i.permittedAttributes = ["caption", "presentation"], i.prototype.ensureAttachmentExclusivelyHasAttribute = function(t3) {
            return this.hasAttribute(t3) ? (this.attachment.hasAttribute(t3) || this.attachment.setAttributes(this.attributes.slice(t3)), this.attributes = this.attributes.remove(t3)) : void 0;
          }, i.prototype.removeProhibitedAttributes = function() {
            var t3;
            return t3 = this.attributes.slice(this.constructor.permittedAttributes), t3.isEqualTo(this.attributes) ? void 0 : this.attributes = t3;
          }, i.prototype.getValue = function() {
            return this.attachment;
          }, i.prototype.isSerializable = function() {
            return !this.attachment.isPending();
          }, i.prototype.getCaption = function() {
            var t3;
            return (t3 = this.attributes.get("caption")) != null ? t3 : "";
          }, i.prototype.isEqualTo = function(t3) {
            var e2;
            return i.__super__.isEqualTo.apply(this, arguments) && this.attachment.id === (t3 != null && (e2 = t3.attachment) != null ? e2.id : void 0);
          }, i.prototype.toString = function() {
            return e.OBJECT_REPLACEMENT_CHARACTER;
          }, i.prototype.toJSON = function() {
            var t3;
            return t3 = i.__super__.toJSON.apply(this, arguments), t3.attachment = this.attachment, t3;
          }, i.prototype.getCacheKey = function() {
            return [i.__super__.getCacheKey.apply(this, arguments), this.attachment.getCacheKey()].join("/");
          }, i.prototype.toConsole = function() {
            return JSON.stringify(this.toString());
          }, i;
        }(e.Piece));
      }.call(this), function() {
        var t2, n = function(t3, e2) {
          function n2() {
            this.constructor = t3;
          }
          for (var o in e2)
            i.call(e2, o) && (t3[o] = e2[o]);
          return n2.prototype = e2.prototype, t3.prototype = new n2(), t3.__super__ = e2.prototype, t3;
        }, i = {}.hasOwnProperty;
        t2 = e.normalizeNewlines, e.Piece.registerType("string", e.StringPiece = function(e2) {
          function i2(e3) {
            i2.__super__.constructor.apply(this, arguments), this.string = t2(e3), this.length = this.string.length;
          }
          return n(i2, e2), i2.fromJSON = function(t3) {
            return new this(t3.string, t3.attributes);
          }, i2.prototype.getValue = function() {
            return this.string;
          }, i2.prototype.toString = function() {
            return this.string.toString();
          }, i2.prototype.isBlockBreak = function() {
            return this.toString() === "\n" && this.getAttribute("blockBreak") === true;
          }, i2.prototype.toJSON = function() {
            var t3;
            return t3 = i2.__super__.toJSON.apply(this, arguments), t3.string = this.string, t3;
          }, i2.prototype.canBeConsolidatedWith = function(t3) {
            return t3 != null && this.hasSameConstructorAs(t3) && this.hasSameAttributesAsPiece(t3);
          }, i2.prototype.consolidateWith = function(t3) {
            return new this.constructor(this.toString() + t3.toString(), this.attributes);
          }, i2.prototype.splitAtOffset = function(t3) {
            var e3, n2;
            return t3 === 0 ? (e3 = null, n2 = this) : t3 === this.length ? (e3 = this, n2 = null) : (e3 = new this.constructor(this.string.slice(0, t3), this.attributes), n2 = new this.constructor(this.string.slice(t3), this.attributes)), [e3, n2];
          }, i2.prototype.toConsole = function() {
            var t3;
            return t3 = this.string, t3.length > 15 && (t3 = t3.slice(0, 14) + "\u2026"), JSON.stringify(t3.toString());
          }, i2;
        }(e.Piece));
      }.call(this), function() {
        var t2, n = function(t3, e2) {
          function n2() {
            this.constructor = t3;
          }
          for (var o2 in e2)
            i.call(e2, o2) && (t3[o2] = e2[o2]);
          return n2.prototype = e2.prototype, t3.prototype = new n2(), t3.__super__ = e2.prototype, t3;
        }, i = {}.hasOwnProperty, o = [].slice;
        t2 = e.spliceArray, e.SplittableList = function(e2) {
          function i2(t3) {
            t3 == null && (t3 = []), i2.__super__.constructor.apply(this, arguments), this.objects = t3.slice(0), this.length = this.objects.length;
          }
          var r, s, a;
          return n(i2, e2), i2.box = function(t3) {
            return t3 instanceof this ? t3 : new this(t3);
          }, i2.prototype.indexOf = function(t3) {
            return this.objects.indexOf(t3);
          }, i2.prototype.splice = function() {
            var e3;
            return e3 = 1 <= arguments.length ? o.call(arguments, 0) : [], new this.constructor(t2.apply(null, [this.objects].concat(o.call(e3))));
          }, i2.prototype.eachObject = function(t3) {
            var e3, n2, i3, o2, r2, s2;
            for (r2 = this.objects, s2 = [], n2 = e3 = 0, i3 = r2.length; i3 > e3; n2 = ++e3)
              o2 = r2[n2], s2.push(t3(o2, n2));
            return s2;
          }, i2.prototype.insertObjectAtIndex = function(t3, e3) {
            return this.splice(e3, 0, t3);
          }, i2.prototype.insertSplittableListAtIndex = function(t3, e3) {
            return this.splice.apply(this, [e3, 0].concat(o.call(t3.objects)));
          }, i2.prototype.insertSplittableListAtPosition = function(t3, e3) {
            var n2, i3, o2;
            return o2 = this.splitObjectAtPosition(e3), i3 = o2[0], n2 = o2[1], new this.constructor(i3).insertSplittableListAtIndex(t3, n2);
          }, i2.prototype.editObjectAtIndex = function(t3, e3) {
            return this.replaceObjectAtIndex(e3(this.objects[t3]), t3);
          }, i2.prototype.replaceObjectAtIndex = function(t3, e3) {
            return this.splice(e3, 1, t3);
          }, i2.prototype.removeObjectAtIndex = function(t3) {
            return this.splice(t3, 1);
          }, i2.prototype.getObjectAtIndex = function(t3) {
            return this.objects[t3];
          }, i2.prototype.getSplittableListInRange = function(t3) {
            var e3, n2, i3, o2;
            return i3 = this.splitObjectsAtRange(t3), n2 = i3[0], e3 = i3[1], o2 = i3[2], new this.constructor(n2.slice(e3, o2 + 1));
          }, i2.prototype.selectSplittableList = function(t3) {
            var e3, n2;
            return n2 = function() {
              var n3, i3, o2, r2;
              for (o2 = this.objects, r2 = [], n3 = 0, i3 = o2.length; i3 > n3; n3++)
                e3 = o2[n3], t3(e3) && r2.push(e3);
              return r2;
            }.call(this), new this.constructor(n2);
          }, i2.prototype.removeObjectsInRange = function(t3) {
            var e3, n2, i3, o2;
            return i3 = this.splitObjectsAtRange(t3), n2 = i3[0], e3 = i3[1], o2 = i3[2], new this.constructor(n2).splice(e3, o2 - e3 + 1);
          }, i2.prototype.transformObjectsInRange = function(t3, e3) {
            var n2, i3, o2, r2, s2, a2, u;
            return s2 = this.splitObjectsAtRange(t3), r2 = s2[0], i3 = s2[1], a2 = s2[2], u = function() {
              var t4, s3, u2;
              for (u2 = [], n2 = t4 = 0, s3 = r2.length; s3 > t4; n2 = ++t4)
                o2 = r2[n2], u2.push(n2 >= i3 && a2 >= n2 ? e3(o2) : o2);
              return u2;
            }(), new this.constructor(u);
          }, i2.prototype.splitObjectsAtRange = function(t3) {
            var e3, n2, i3, o2, s2, u;
            return o2 = this.splitObjectAtPosition(a(t3)), n2 = o2[0], e3 = o2[1], i3 = o2[2], s2 = new this.constructor(n2).splitObjectAtPosition(r(t3) + i3), n2 = s2[0], u = s2[1], [n2, e3, u - 1];
          }, i2.prototype.getObjectAtPosition = function(t3) {
            var e3, n2, i3;
            return i3 = this.findIndexAndOffsetAtPosition(t3), e3 = i3.index, n2 = i3.offset, this.objects[e3];
          }, i2.prototype.splitObjectAtPosition = function(t3) {
            var e3, n2, i3, o2, r2, s2, a2, u, c, l;
            return s2 = this.findIndexAndOffsetAtPosition(t3), e3 = s2.index, r2 = s2.offset, o2 = this.objects.slice(0), e3 != null ? r2 === 0 ? (c = e3, l = 0) : (i3 = this.getObjectAtIndex(e3), a2 = i3.splitAtOffset(r2), n2 = a2[0], u = a2[1], o2.splice(e3, 1, n2, u), c = e3 + 1, l = n2.getLength() - r2) : (c = o2.length, l = 0), [o2, c, l];
          }, i2.prototype.consolidate = function() {
            var t3, e3, n2, i3, o2, r2;
            for (i3 = [], o2 = this.objects[0], r2 = this.objects.slice(1), t3 = 0, e3 = r2.length; e3 > t3; t3++)
              n2 = r2[t3], (typeof o2.canBeConsolidatedWith == "function" ? o2.canBeConsolidatedWith(n2) : void 0) ? o2 = o2.consolidateWith(n2) : (i3.push(o2), o2 = n2);
            return o2 != null && i3.push(o2), new this.constructor(i3);
          }, i2.prototype.consolidateFromIndexToIndex = function(t3, e3) {
            var n2, i3, r2;
            return i3 = this.objects.slice(0), r2 = i3.slice(t3, e3 + 1), n2 = new this.constructor(r2).consolidate().toArray(), this.splice.apply(this, [t3, r2.length].concat(o.call(n2)));
          }, i2.prototype.findIndexAndOffsetAtPosition = function(t3) {
            var e3, n2, i3, o2, r2, s2, a2;
            for (e3 = 0, a2 = this.objects, i3 = n2 = 0, o2 = a2.length; o2 > n2; i3 = ++n2) {
              if (s2 = a2[i3], r2 = e3 + s2.getLength(), t3 >= e3 && r2 > t3)
                return {index: i3, offset: t3 - e3};
              e3 = r2;
            }
            return {index: null, offset: null};
          }, i2.prototype.findPositionAtIndexAndOffset = function(t3, e3) {
            var n2, i3, o2, r2, s2, a2;
            for (s2 = 0, a2 = this.objects, n2 = i3 = 0, o2 = a2.length; o2 > i3; n2 = ++i3)
              if (r2 = a2[n2], t3 > n2)
                s2 += r2.getLength();
              else if (n2 === t3) {
                s2 += e3;
                break;
              }
            return s2;
          }, i2.prototype.getEndPosition = function() {
            var t3, e3;
            return this.endPosition != null ? this.endPosition : this.endPosition = function() {
              var n2, i3, o2;
              for (e3 = 0, o2 = this.objects, n2 = 0, i3 = o2.length; i3 > n2; n2++)
                t3 = o2[n2], e3 += t3.getLength();
              return e3;
            }.call(this);
          }, i2.prototype.toString = function() {
            return this.objects.join("");
          }, i2.prototype.toArray = function() {
            return this.objects.slice(0);
          }, i2.prototype.toJSON = function() {
            return this.toArray();
          }, i2.prototype.isEqualTo = function(t3) {
            return i2.__super__.isEqualTo.apply(this, arguments) || s(this.objects, t3 != null ? t3.objects : void 0);
          }, s = function(t3, e3) {
            var n2, i3, o2, r2, s2;
            if (e3 == null && (e3 = []), t3.length !== e3.length)
              return false;
            for (s2 = true, i3 = n2 = 0, o2 = t3.length; o2 > n2; i3 = ++n2)
              r2 = t3[i3], s2 && !r2.isEqualTo(e3[i3]) && (s2 = false);
            return s2;
          }, i2.prototype.contentsForInspection = function() {
            var t3;
            return {objects: "[" + function() {
              var e3, n2, i3, o2;
              for (i3 = this.objects, o2 = [], e3 = 0, n2 = i3.length; n2 > e3; e3++)
                t3 = i3[e3], o2.push(t3.inspect());
              return o2;
            }.call(this).join(", ") + "]"};
          }, a = function(t3) {
            return t3[0];
          }, r = function(t3) {
            return t3[1];
          }, i2;
        }(e.Object);
      }.call(this), function() {
        var t2 = function(t3, e2) {
          function i() {
            this.constructor = t3;
          }
          for (var o in e2)
            n.call(e2, o) && (t3[o] = e2[o]);
          return i.prototype = e2.prototype, t3.prototype = new i(), t3.__super__ = e2.prototype, t3;
        }, n = {}.hasOwnProperty;
        e.Text = function(n2) {
          function i(t3) {
            var n3;
            t3 == null && (t3 = []), i.__super__.constructor.apply(this, arguments), this.pieceList = new e.SplittableList(function() {
              var e2, i2, o;
              for (o = [], e2 = 0, i2 = t3.length; i2 > e2; e2++)
                n3 = t3[e2], n3.isEmpty() || o.push(n3);
              return o;
            }());
          }
          return t2(i, n2), i.textForAttachmentWithAttributes = function(t3, n3) {
            var i2;
            return i2 = new e.AttachmentPiece(t3, n3), new this([i2]);
          }, i.textForStringWithAttributes = function(t3, n3) {
            var i2;
            return i2 = new e.StringPiece(t3, n3), new this([i2]);
          }, i.fromJSON = function(t3) {
            var n3, i2;
            return i2 = function() {
              var i3, o, r;
              for (r = [], i3 = 0, o = t3.length; o > i3; i3++)
                n3 = t3[i3], r.push(e.Piece.fromJSON(n3));
              return r;
            }(), new this(i2);
          }, i.prototype.copy = function() {
            return this.copyWithPieceList(this.pieceList);
          }, i.prototype.copyWithPieceList = function(t3) {
            return new this.constructor(t3.consolidate().toArray());
          }, i.prototype.copyUsingObjectMap = function(t3) {
            var e2, n3;
            return n3 = function() {
              var n4, i2, o, r, s;
              for (o = this.getPieces(), s = [], n4 = 0, i2 = o.length; i2 > n4; n4++)
                e2 = o[n4], s.push((r = t3.find(e2)) != null ? r : e2);
              return s;
            }.call(this), new this.constructor(n3);
          }, i.prototype.appendText = function(t3) {
            return this.insertTextAtPosition(t3, this.getLength());
          }, i.prototype.insertTextAtPosition = function(t3, e2) {
            return this.copyWithPieceList(this.pieceList.insertSplittableListAtPosition(t3.pieceList, e2));
          }, i.prototype.removeTextAtRange = function(t3) {
            return this.copyWithPieceList(this.pieceList.removeObjectsInRange(t3));
          }, i.prototype.replaceTextAtRange = function(t3, e2) {
            return this.removeTextAtRange(e2).insertTextAtPosition(t3, e2[0]);
          }, i.prototype.moveTextFromRangeToPosition = function(t3, e2) {
            var n3, i2;
            if (!(t3[0] <= e2 && e2 <= t3[1]))
              return i2 = this.getTextAtRange(t3), n3 = i2.getLength(), t3[0] < e2 && (e2 -= n3), this.removeTextAtRange(t3).insertTextAtPosition(i2, e2);
          }, i.prototype.addAttributeAtRange = function(t3, e2, n3) {
            var i2;
            return i2 = {}, i2[t3] = e2, this.addAttributesAtRange(i2, n3);
          }, i.prototype.addAttributesAtRange = function(t3, e2) {
            return this.copyWithPieceList(this.pieceList.transformObjectsInRange(e2, function(e3) {
              return e3.copyWithAdditionalAttributes(t3);
            }));
          }, i.prototype.removeAttributeAtRange = function(t3, e2) {
            return this.copyWithPieceList(this.pieceList.transformObjectsInRange(e2, function(e3) {
              return e3.copyWithoutAttribute(t3);
            }));
          }, i.prototype.setAttributesAtRange = function(t3, e2) {
            return this.copyWithPieceList(this.pieceList.transformObjectsInRange(e2, function(e3) {
              return e3.copyWithAttributes(t3);
            }));
          }, i.prototype.getAttributesAtPosition = function(t3) {
            var e2, n3;
            return (e2 = (n3 = this.pieceList.getObjectAtPosition(t3)) != null ? n3.getAttributes() : void 0) != null ? e2 : {};
          }, i.prototype.getCommonAttributes = function() {
            var t3, n3;
            return t3 = function() {
              var t4, e2, i2, o;
              for (i2 = this.pieceList.toArray(), o = [], t4 = 0, e2 = i2.length; e2 > t4; t4++)
                n3 = i2[t4], o.push(n3.getAttributes());
              return o;
            }.call(this), e.Hash.fromCommonAttributesOfObjects(t3).toObject();
          }, i.prototype.getCommonAttributesAtRange = function(t3) {
            var e2;
            return (e2 = this.getTextAtRange(t3).getCommonAttributes()) != null ? e2 : {};
          }, i.prototype.getExpandedRangeForAttributeAtOffset = function(t3, e2) {
            var n3, i2, o;
            for (n3 = o = e2, i2 = this.getLength(); n3 > 0 && this.getCommonAttributesAtRange([n3 - 1, o])[t3]; )
              n3--;
            for (; i2 > o && this.getCommonAttributesAtRange([e2, o + 1])[t3]; )
              o++;
            return [n3, o];
          }, i.prototype.getTextAtRange = function(t3) {
            return this.copyWithPieceList(this.pieceList.getSplittableListInRange(t3));
          }, i.prototype.getStringAtRange = function(t3) {
            return this.pieceList.getSplittableListInRange(t3).toString();
          }, i.prototype.getStringAtPosition = function(t3) {
            return this.getStringAtRange([t3, t3 + 1]);
          }, i.prototype.startsWithString = function(t3) {
            return this.getStringAtRange([0, t3.length]) === t3;
          }, i.prototype.endsWithString = function(t3) {
            var e2;
            return e2 = this.getLength(), this.getStringAtRange([e2 - t3.length, e2]) === t3;
          }, i.prototype.getAttachmentPieces = function() {
            var t3, e2, n3, i2, o;
            for (i2 = this.pieceList.toArray(), o = [], t3 = 0, e2 = i2.length; e2 > t3; t3++)
              n3 = i2[t3], n3.attachment != null && o.push(n3);
            return o;
          }, i.prototype.getAttachments = function() {
            var t3, e2, n3, i2, o;
            for (i2 = this.getAttachmentPieces(), o = [], t3 = 0, e2 = i2.length; e2 > t3; t3++)
              n3 = i2[t3], o.push(n3.attachment);
            return o;
          }, i.prototype.getAttachmentAndPositionById = function(t3) {
            var e2, n3, i2, o, r, s;
            for (o = 0, r = this.pieceList.toArray(), e2 = 0, n3 = r.length; n3 > e2; e2++) {
              if (i2 = r[e2], ((s = i2.attachment) != null ? s.id : void 0) === t3)
                return {attachment: i2.attachment, position: o};
              o += i2.length;
            }
            return {attachment: null, position: null};
          }, i.prototype.getAttachmentById = function(t3) {
            var e2, n3, i2;
            return i2 = this.getAttachmentAndPositionById(t3), e2 = i2.attachment, n3 = i2.position, e2;
          }, i.prototype.getRangeOfAttachment = function(t3) {
            var e2, n3;
            return n3 = this.getAttachmentAndPositionById(t3.id), t3 = n3.attachment, e2 = n3.position, t3 != null ? [e2, e2 + 1] : void 0;
          }, i.prototype.updateAttributesForAttachment = function(t3, e2) {
            var n3;
            return (n3 = this.getRangeOfAttachment(e2)) ? this.addAttributesAtRange(t3, n3) : this;
          }, i.prototype.getLength = function() {
            return this.pieceList.getEndPosition();
          }, i.prototype.isEmpty = function() {
            return this.getLength() === 0;
          }, i.prototype.isEqualTo = function(t3) {
            var e2;
            return i.__super__.isEqualTo.apply(this, arguments) || (t3 != null && (e2 = t3.pieceList) != null ? e2.isEqualTo(this.pieceList) : void 0);
          }, i.prototype.isBlockBreak = function() {
            return this.getLength() === 1 && this.pieceList.getObjectAtIndex(0).isBlockBreak();
          }, i.prototype.eachPiece = function(t3) {
            return this.pieceList.eachObject(t3);
          }, i.prototype.getPieces = function() {
            return this.pieceList.toArray();
          }, i.prototype.getPieceAtPosition = function(t3) {
            return this.pieceList.getObjectAtPosition(t3);
          }, i.prototype.contentsForInspection = function() {
            return {pieceList: this.pieceList.inspect()};
          }, i.prototype.toSerializableText = function() {
            var t3;
            return t3 = this.pieceList.selectSplittableList(function(t4) {
              return t4.isSerializable();
            }), this.copyWithPieceList(t3);
          }, i.prototype.toString = function() {
            return this.pieceList.toString();
          }, i.prototype.toJSON = function() {
            return this.pieceList.toJSON();
          }, i.prototype.toConsole = function() {
            var t3;
            return JSON.stringify(function() {
              var e2, n3, i2, o;
              for (i2 = this.pieceList.toArray(), o = [], e2 = 0, n3 = i2.length; n3 > e2; e2++)
                t3 = i2[e2], o.push(JSON.parse(t3.toConsole()));
              return o;
            }.call(this));
          }, i.prototype.getDirection = function() {
            return e.getDirection(this.toString());
          }, i.prototype.isRTL = function() {
            return this.getDirection() === "rtl";
          }, i;
        }(e.Object);
      }.call(this), function() {
        var t2, n, i, o, r, s = function(t3, e2) {
          function n2() {
            this.constructor = t3;
          }
          for (var i2 in e2)
            a.call(e2, i2) && (t3[i2] = e2[i2]);
          return n2.prototype = e2.prototype, t3.prototype = new n2(), t3.__super__ = e2.prototype, t3;
        }, a = {}.hasOwnProperty, u = [].indexOf || function(t3) {
          for (var e2 = 0, n2 = this.length; n2 > e2; e2++)
            if (e2 in this && this[e2] === t3)
              return e2;
          return -1;
        }, c = [].slice;
        t2 = e.arraysAreEqual, r = e.spliceArray, i = e.getBlockConfig, n = e.getBlockAttributeNames, o = e.getListAttributeNames, e.Block = function(n2) {
          function a2(t3, n3) {
            t3 == null && (t3 = new e.Text()), n3 == null && (n3 = []), a2.__super__.constructor.apply(this, arguments), this.text = h(t3), this.attributes = n3;
          }
          var l, h, p, d, f, g, m, v, y;
          return s(a2, n2), a2.fromJSON = function(t3) {
            var n3;
            return n3 = e.Text.fromJSON(t3.text), new this(n3, t3.attributes);
          }, a2.prototype.isEmpty = function() {
            return this.text.isBlockBreak();
          }, a2.prototype.isEqualTo = function(e2) {
            return a2.__super__.isEqualTo.apply(this, arguments) || this.text.isEqualTo(e2 != null ? e2.text : void 0) && t2(this.attributes, e2 != null ? e2.attributes : void 0);
          }, a2.prototype.copyWithText = function(t3) {
            return new this.constructor(t3, this.attributes);
          }, a2.prototype.copyWithoutText = function() {
            return this.copyWithText(null);
          }, a2.prototype.copyWithAttributes = function(t3) {
            return new this.constructor(this.text, t3);
          }, a2.prototype.copyWithoutAttributes = function() {
            return this.copyWithAttributes(null);
          }, a2.prototype.copyUsingObjectMap = function(t3) {
            var e2;
            return this.copyWithText((e2 = t3.find(this.text)) ? e2 : this.text.copyUsingObjectMap(t3));
          }, a2.prototype.addAttribute = function(t3) {
            var e2;
            return e2 = this.attributes.concat(d(t3)), this.copyWithAttributes(e2);
          }, a2.prototype.removeAttribute = function(t3) {
            var e2, n3;
            return n3 = i(t3).listAttribute, e2 = g(g(this.attributes, t3), n3), this.copyWithAttributes(e2);
          }, a2.prototype.removeLastAttribute = function() {
            return this.removeAttribute(this.getLastAttribute());
          }, a2.prototype.getLastAttribute = function() {
            return f(this.attributes);
          }, a2.prototype.getAttributes = function() {
            return this.attributes.slice(0);
          }, a2.prototype.getAttributeLevel = function() {
            return this.attributes.length;
          }, a2.prototype.getAttributeAtLevel = function(t3) {
            return this.attributes[t3 - 1];
          }, a2.prototype.hasAttribute = function(t3) {
            return u.call(this.attributes, t3) >= 0;
          }, a2.prototype.hasAttributes = function() {
            return this.getAttributeLevel() > 0;
          }, a2.prototype.getLastNestableAttribute = function() {
            return f(this.getNestableAttributes());
          }, a2.prototype.getNestableAttributes = function() {
            var t3, e2, n3, o2, r2;
            for (o2 = this.attributes, r2 = [], e2 = 0, n3 = o2.length; n3 > e2; e2++)
              t3 = o2[e2], i(t3).nestable && r2.push(t3);
            return r2;
          }, a2.prototype.getNestingLevel = function() {
            return this.getNestableAttributes().length;
          }, a2.prototype.decreaseNestingLevel = function() {
            var t3;
            return (t3 = this.getLastNestableAttribute()) ? this.removeAttribute(t3) : this;
          }, a2.prototype.increaseNestingLevel = function() {
            var t3, e2, n3;
            return (t3 = this.getLastNestableAttribute()) ? (n3 = this.attributes.lastIndexOf(t3), e2 = r.apply(null, [this.attributes, n3 + 1, 0].concat(c.call(d(t3)))), this.copyWithAttributes(e2)) : this;
          }, a2.prototype.getListItemAttributes = function() {
            var t3, e2, n3, o2, r2;
            for (o2 = this.attributes, r2 = [], e2 = 0, n3 = o2.length; n3 > e2; e2++)
              t3 = o2[e2], i(t3).listAttribute && r2.push(t3);
            return r2;
          }, a2.prototype.isListItem = function() {
            var t3;
            return (t3 = i(this.getLastAttribute())) != null ? t3.listAttribute : void 0;
          }, a2.prototype.isTerminalBlock = function() {
            var t3;
            return (t3 = i(this.getLastAttribute())) != null ? t3.terminal : void 0;
          }, a2.prototype.breaksOnReturn = function() {
            var t3;
            return (t3 = i(this.getLastAttribute())) != null ? t3.breakOnReturn : void 0;
          }, a2.prototype.findLineBreakInDirectionFromPosition = function(t3, e2) {
            var n3, i2;
            return i2 = this.toString(), n3 = function() {
              switch (t3) {
                case "forward":
                  return i2.indexOf("\n", e2);
                case "backward":
                  return i2.slice(0, e2).lastIndexOf("\n");
              }
            }(), n3 !== -1 ? n3 : void 0;
          }, a2.prototype.contentsForInspection = function() {
            return {text: this.text.inspect(), attributes: this.attributes};
          }, a2.prototype.toString = function() {
            return this.text.toString();
          }, a2.prototype.toJSON = function() {
            return {text: this.text, attributes: this.attributes};
          }, a2.prototype.getDirection = function() {
            return this.text.getDirection();
          }, a2.prototype.isRTL = function() {
            return this.text.isRTL();
          }, a2.prototype.getLength = function() {
            return this.text.getLength();
          }, a2.prototype.canBeConsolidatedWith = function(t3) {
            return !this.hasAttributes() && !t3.hasAttributes() && this.getDirection() === t3.getDirection();
          }, a2.prototype.consolidateWith = function(t3) {
            var n3, i2;
            return n3 = e.Text.textForStringWithAttributes("\n"), i2 = this.getTextWithoutBlockBreak().appendText(n3), this.copyWithText(i2.appendText(t3.text));
          }, a2.prototype.splitAtOffset = function(t3) {
            var e2, n3;
            return t3 === 0 ? (e2 = null, n3 = this) : t3 === this.getLength() ? (e2 = this, n3 = null) : (e2 = this.copyWithText(this.text.getTextAtRange([0, t3])), n3 = this.copyWithText(this.text.getTextAtRange([t3, this.getLength()]))), [e2, n3];
          }, a2.prototype.getBlockBreakPosition = function() {
            return this.text.getLength() - 1;
          }, a2.prototype.getTextWithoutBlockBreak = function() {
            return m(this.text) ? this.text.getTextAtRange([0, this.getBlockBreakPosition()]) : this.text.copy();
          }, a2.prototype.canBeGrouped = function(t3) {
            return this.attributes[t3];
          }, a2.prototype.canBeGroupedWith = function(t3, e2) {
            var n3, r2, s2, a3;
            return s2 = t3.getAttributes(), r2 = s2[e2], n3 = this.attributes[e2], !(n3 !== r2 || i(n3).group === false && (a3 = s2[e2 + 1], u.call(o(), a3) < 0) || this.getDirection() !== t3.getDirection() && !t3.isEmpty());
          }, h = function(t3) {
            return t3 = y(t3), t3 = l(t3);
          }, y = function(t3) {
            var n3, i2, o2, r2, s2, a3;
            return r2 = false, a3 = t3.getPieces(), i2 = 2 <= a3.length ? c.call(a3, 0, n3 = a3.length - 1) : (n3 = 0, []), o2 = a3[n3++], o2 == null ? t3 : (i2 = function() {
              var t4, e2, n4;
              for (n4 = [], t4 = 0, e2 = i2.length; e2 > t4; t4++)
                s2 = i2[t4], s2.isBlockBreak() ? (r2 = true, n4.push(v(s2))) : n4.push(s2);
              return n4;
            }(), r2 ? new e.Text(c.call(i2).concat([o2])) : t3);
          }, p = e.Text.textForStringWithAttributes("\n", {blockBreak: true}), l = function(t3) {
            return m(t3) ? t3 : t3.appendText(p);
          }, m = function(t3) {
            var e2, n3;
            return n3 = t3.getLength(), n3 === 0 ? false : (e2 = t3.getTextAtRange([n3 - 1, n3]), e2.isBlockBreak());
          }, v = function(t3) {
            return t3.copyWithoutAttribute("blockBreak");
          }, d = function(t3) {
            var e2;
            return e2 = i(t3).listAttribute, e2 != null ? [e2, t3] : [t3];
          }, f = function(t3) {
            return t3.slice(-1)[0];
          }, g = function(t3, e2) {
            var n3;
            return n3 = t3.lastIndexOf(e2), n3 === -1 ? t3 : r(t3, n3, 1);
          }, a2;
        }(e.Object);
      }.call(this), function() {
        var t2, n, i, o = function(t3, e2) {
          function n2() {
            this.constructor = t3;
          }
          for (var i2 in e2)
            r.call(e2, i2) && (t3[i2] = e2[i2]);
          return n2.prototype = e2.prototype, t3.prototype = new n2(), t3.__super__ = e2.prototype, t3;
        }, r = {}.hasOwnProperty, s = [].indexOf || function(t3) {
          for (var e2 = 0, n2 = this.length; n2 > e2; e2++)
            if (e2 in this && this[e2] === t3)
              return e2;
          return -1;
        }, a = [].slice;
        n = e.tagName, i = e.walkTree, t2 = e.nodeIsAttachmentElement, e.HTMLSanitizer = function(r2) {
          function u(t3, e2) {
            var n2;
            n2 = e2 != null ? e2 : {}, this.allowedAttributes = n2.allowedAttributes, this.forbiddenProtocols = n2.forbiddenProtocols, this.forbiddenElements = n2.forbiddenElements, this.allowedAttributes == null && (this.allowedAttributes = c), this.forbiddenProtocols == null && (this.forbiddenProtocols = h), this.forbiddenElements == null && (this.forbiddenElements = l), this.body = p(t3);
          }
          var c, l, h, p;
          return o(u, r2), c = "style href src width height class".split(" "), h = "javascript:".split(" "), l = "script iframe".split(" "), u.sanitize = function(t3, e2) {
            var n2;
            return n2 = new this(t3, e2), n2.sanitize(), n2;
          }, u.prototype.sanitize = function() {
            return this.sanitizeElements(), this.normalizeListElementNesting();
          }, u.prototype.getHTML = function() {
            return this.body.innerHTML;
          }, u.prototype.getBody = function() {
            return this.body;
          }, u.prototype.sanitizeElements = function() {
            var t3, n2, o2, r3, s2;
            for (s2 = i(this.body), r3 = []; s2.nextNode(); )
              switch (o2 = s2.currentNode, o2.nodeType) {
                case Node.ELEMENT_NODE:
                  this.elementIsRemovable(o2) ? r3.push(o2) : this.sanitizeElement(o2);
                  break;
                case Node.COMMENT_NODE:
                  r3.push(o2);
              }
            for (t3 = 0, n2 = r3.length; n2 > t3; t3++)
              o2 = r3[t3], e.removeNode(o2);
            return this.body;
          }, u.prototype.sanitizeElement = function(t3) {
            var e2, n2, i2, o2, r3;
            for (t3.hasAttribute("href") && (o2 = t3.protocol, s.call(this.forbiddenProtocols, o2) >= 0 && t3.removeAttribute("href")), r3 = a.call(t3.attributes), e2 = 0, n2 = r3.length; n2 > e2; e2++)
              i2 = r3[e2].name, s.call(this.allowedAttributes, i2) >= 0 || i2.indexOf("data-trix") === 0 || t3.removeAttribute(i2);
            return t3;
          }, u.prototype.normalizeListElementNesting = function() {
            var t3, e2, i2, o2, r3;
            for (r3 = a.call(this.body.querySelectorAll("ul,ol")), t3 = 0, e2 = r3.length; e2 > t3; t3++)
              i2 = r3[t3], (o2 = i2.previousElementSibling) && n(o2) === "li" && o2.appendChild(i2);
            return this.body;
          }, u.prototype.elementIsRemovable = function(t3) {
            return (t3 != null ? t3.nodeType : void 0) === Node.ELEMENT_NODE ? this.elementIsForbidden(t3) || this.elementIsntSerializable(t3) : void 0;
          }, u.prototype.elementIsForbidden = function(t3) {
            var e2;
            return e2 = n(t3), s.call(this.forbiddenElements, e2) >= 0;
          }, u.prototype.elementIsntSerializable = function(e2) {
            return e2.getAttribute("data-trix-serialize") === "false" && !t2(e2);
          }, p = function(t3) {
            var e2, n2, i2, o2, r3;
            for (t3 == null && (t3 = ""), t3 = t3.replace(/<\/html[^>]*>[^]*$/i, "</html>"), e2 = document.implementation.createHTMLDocument(""), e2.documentElement.innerHTML = t3, r3 = e2.head.querySelectorAll("style"), i2 = 0, o2 = r3.length; o2 > i2; i2++)
              n2 = r3[i2], e2.body.appendChild(n2);
            return e2.body;
          }, u;
        }(e.BasicObject);
      }.call(this), function() {
        var t2, n, i, o, r, s, a, u, c, l, h, p = function(t3, e2) {
          function n2() {
            this.constructor = t3;
          }
          for (var i2 in e2)
            d.call(e2, i2) && (t3[i2] = e2[i2]);
          return n2.prototype = e2.prototype, t3.prototype = new n2(), t3.__super__ = e2.prototype, t3;
        }, d = {}.hasOwnProperty, f = [].indexOf || function(t3) {
          for (var e2 = 0, n2 = this.length; n2 > e2; e2++)
            if (e2 in this && this[e2] === t3)
              return e2;
          return -1;
        };
        t2 = e.arraysAreEqual, s = e.makeElement, l = e.tagName, r = e.getBlockTagNames, h = e.walkTree, o = e.findClosestElementFromNode, i = e.elementContainsNode, a = e.nodeIsAttachmentElement, u = e.normalizeSpaces, n = e.breakableWhitespacePattern, c = e.squishBreakableWhitespace, e.HTMLParser = function(d2) {
          function g(t3, e2) {
            this.html = t3, this.referenceElement = (e2 != null ? e2 : {}).referenceElement, this.blocks = [], this.blockElements = [], this.processedElements = [];
          }
          var m, v, y, b, A, C3, x, w, E, S2, R, k;
          return p(g, d2), g.parse = function(t3, e2) {
            var n2;
            return n2 = new this(t3, e2), n2.parse(), n2;
          }, g.prototype.getDocument = function() {
            return e.Document.fromJSON(this.blocks);
          }, g.prototype.parse = function() {
            var t3, n2;
            try {
              for (this.createHiddenContainer(), t3 = e.HTMLSanitizer.sanitize(this.html).getHTML(), this.containerElement.innerHTML = t3, n2 = h(this.containerElement, {usingFilter: x}); n2.nextNode(); )
                this.processNode(n2.currentNode);
              return this.translateBlockElementMarginsToNewlines();
            } finally {
              this.removeHiddenContainer();
            }
          }, g.prototype.createHiddenContainer = function() {
            return this.referenceElement ? (this.containerElement = this.referenceElement.cloneNode(false), this.containerElement.removeAttribute("id"), this.containerElement.setAttribute("data-trix-internal", ""), this.containerElement.style.display = "none", this.referenceElement.parentNode.insertBefore(this.containerElement, this.referenceElement.nextSibling)) : (this.containerElement = s({tagName: "div", style: {display: "none"}}), document.body.appendChild(this.containerElement));
          }, g.prototype.removeHiddenContainer = function() {
            return e.removeNode(this.containerElement);
          }, x = function(t3) {
            return l(t3) === "style" ? NodeFilter.FILTER_REJECT : NodeFilter.FILTER_ACCEPT;
          }, g.prototype.processNode = function(t3) {
            switch (t3.nodeType) {
              case Node.TEXT_NODE:
                if (!this.isInsignificantTextNode(t3))
                  return this.appendBlockForTextNode(t3), this.processTextNode(t3);
                break;
              case Node.ELEMENT_NODE:
                return this.appendBlockForElement(t3), this.processElement(t3);
            }
          }, g.prototype.appendBlockForTextNode = function(e2) {
            var n2, i2, o2;
            return i2 = e2.parentNode, i2 === this.currentBlockElement && this.isBlockElement(e2.previousSibling) ? this.appendStringWithAttributes("\n") : i2 !== this.containerElement && !this.isBlockElement(i2) || (n2 = this.getBlockAttributes(i2), t2(n2, (o2 = this.currentBlock) != null ? o2.attributes : void 0)) ? void 0 : (this.currentBlock = this.appendBlockForAttributesWithElement(n2, i2), this.currentBlockElement = i2);
          }, g.prototype.appendBlockForElement = function(e2) {
            var n2, o2, r2, s2;
            if (r2 = this.isBlockElement(e2), o2 = i(this.currentBlockElement, e2), r2 && !this.isBlockElement(e2.firstChild)) {
              if ((!this.isInsignificantTextNode(e2.firstChild) || !this.isBlockElement(e2.firstElementChild)) && (n2 = this.getBlockAttributes(e2), e2.firstChild))
                return o2 && t2(n2, this.currentBlock.attributes) ? this.appendStringWithAttributes("\n") : (this.currentBlock = this.appendBlockForAttributesWithElement(n2, e2), this.currentBlockElement = e2);
            } else if (this.currentBlockElement && !o2 && !r2)
              return (s2 = this.findParentBlockElement(e2)) ? this.appendBlockForElement(s2) : (this.currentBlock = this.appendEmptyBlock(), this.currentBlockElement = null);
          }, g.prototype.findParentBlockElement = function(t3) {
            var e2;
            for (e2 = t3.parentElement; e2 && e2 !== this.containerElement; ) {
              if (this.isBlockElement(e2) && f.call(this.blockElements, e2) >= 0)
                return e2;
              e2 = e2.parentElement;
            }
            return null;
          }, g.prototype.processTextNode = function(t3) {
            var e2, n2;
            return n2 = t3.data, v(t3.parentNode) || (n2 = c(n2), R((e2 = t3.previousSibling) != null ? e2.textContent : void 0) && (n2 = A(n2))), this.appendStringWithAttributes(n2, this.getTextAttributes(t3.parentNode));
          }, g.prototype.processElement = function(t3) {
            var e2, n2, i2, o2, r2;
            if (a(t3))
              return e2 = w(t3, "attachment"), Object.keys(e2).length && (o2 = this.getTextAttributes(t3), this.appendAttachmentWithAttributes(e2, o2), t3.innerHTML = ""), this.processedElements.push(t3);
            switch (l(t3)) {
              case "br":
                return this.isExtraBR(t3) || this.isBlockElement(t3.nextSibling) || this.appendStringWithAttributes("\n", this.getTextAttributes(t3)), this.processedElements.push(t3);
              case "img":
                e2 = {url: t3.getAttribute("src"), contentType: "image"}, i2 = b(t3);
                for (n2 in i2)
                  r2 = i2[n2], e2[n2] = r2;
                return this.appendAttachmentWithAttributes(e2, this.getTextAttributes(t3)), this.processedElements.push(t3);
              case "tr":
                if (t3.parentNode.firstChild !== t3)
                  return this.appendStringWithAttributes("\n");
                break;
              case "td":
                if (t3.parentNode.firstChild !== t3)
                  return this.appendStringWithAttributes(" | ");
            }
          }, g.prototype.appendBlockForAttributesWithElement = function(t3, e2) {
            var n2;
            return this.blockElements.push(e2), n2 = m(t3), this.blocks.push(n2), n2;
          }, g.prototype.appendEmptyBlock = function() {
            return this.appendBlockForAttributesWithElement([], null);
          }, g.prototype.appendStringWithAttributes = function(t3, e2) {
            return this.appendPiece(S2(t3, e2));
          }, g.prototype.appendAttachmentWithAttributes = function(t3, e2) {
            return this.appendPiece(E(t3, e2));
          }, g.prototype.appendPiece = function(t3) {
            return this.blocks.length === 0 && this.appendEmptyBlock(), this.blocks[this.blocks.length - 1].text.push(t3);
          }, g.prototype.appendStringToTextAtIndex = function(t3, e2) {
            var n2, i2;
            return i2 = this.blocks[e2].text, n2 = i2[i2.length - 1], (n2 != null ? n2.type : void 0) === "string" ? n2.string += t3 : i2.push(S2(t3));
          }, g.prototype.prependStringToTextAtIndex = function(t3, e2) {
            var n2, i2;
            return i2 = this.blocks[e2].text, n2 = i2[0], (n2 != null ? n2.type : void 0) === "string" ? n2.string = t3 + n2.string : i2.unshift(S2(t3));
          }, S2 = function(t3, e2) {
            var n2;
            return e2 == null && (e2 = {}), n2 = "string", t3 = u(t3), {string: t3, attributes: e2, type: n2};
          }, E = function(t3, e2) {
            var n2;
            return e2 == null && (e2 = {}), n2 = "attachment", {attachment: t3, attributes: e2, type: n2};
          }, m = function(t3) {
            var e2;
            return t3 == null && (t3 = {}), e2 = [], {text: e2, attributes: t3};
          }, g.prototype.getTextAttributes = function(t3) {
            var n2, i2, r2, s2, u2, c2, l2, h2, p2, d3, f2, g2;
            r2 = {}, p2 = e.config.textAttributes;
            for (n2 in p2)
              if (u2 = p2[n2], u2.tagName && o(t3, {matchingSelector: u2.tagName, untilNode: this.containerElement}))
                r2[n2] = true;
              else if (u2.parser) {
                if (g2 = u2.parser(t3)) {
                  for (i2 = false, d3 = this.findBlockElementAncestors(t3), c2 = 0, h2 = d3.length; h2 > c2; c2++)
                    if (s2 = d3[c2], u2.parser(s2) === g2) {
                      i2 = true;
                      break;
                    }
                  i2 || (r2[n2] = g2);
                }
              } else
                u2.styleProperty && (g2 = t3.style[u2.styleProperty]) && (r2[n2] = g2);
            if (a(t3)) {
              f2 = w(t3, "attributes");
              for (l2 in f2)
                g2 = f2[l2], r2[l2] = g2;
            }
            return r2;
          }, g.prototype.getBlockAttributes = function(t3) {
            var n2, i2, o2, r2;
            for (i2 = []; t3 && t3 !== this.containerElement; ) {
              r2 = e.config.blockAttributes;
              for (n2 in r2)
                o2 = r2[n2], o2.parse !== false && l(t3) === o2.tagName && ((typeof o2.test == "function" ? o2.test(t3) : void 0) || !o2.test) && (i2.push(n2), o2.listAttribute && i2.push(o2.listAttribute));
              t3 = t3.parentNode;
            }
            return i2.reverse();
          }, g.prototype.findBlockElementAncestors = function(t3) {
            var e2, n2;
            for (e2 = []; t3 && t3 !== this.containerElement; )
              n2 = l(t3), f.call(r(), n2) >= 0 && e2.push(t3), t3 = t3.parentNode;
            return e2;
          }, w = function(t3, e2) {
            try {
              return JSON.parse(t3.getAttribute("data-trix-" + e2));
            } catch (n2) {
              return {};
            }
          }, b = function(t3) {
            var e2, n2, i2;
            return i2 = t3.getAttribute("width"), n2 = t3.getAttribute("height"), e2 = {}, i2 && (e2.width = parseInt(i2, 10)), n2 && (e2.height = parseInt(n2, 10)), e2;
          }, g.prototype.isBlockElement = function(t3) {
            var e2;
            if ((t3 != null ? t3.nodeType : void 0) === Node.ELEMENT_NODE && !a(t3) && !o(t3, {matchingSelector: "td", untilNode: this.containerElement}))
              return e2 = l(t3), f.call(r(), e2) >= 0 || window.getComputedStyle(t3).display === "block";
          }, g.prototype.isInsignificantTextNode = function(t3) {
            var e2, n2, i2;
            if ((t3 != null ? t3.nodeType : void 0) === Node.TEXT_NODE && k(t3.data) && (n2 = t3.parentNode, i2 = t3.previousSibling, e2 = t3.nextSibling, (!C3(n2.previousSibling) || this.isBlockElement(n2.previousSibling)) && !v(n2)))
              return !i2 || this.isBlockElement(i2) || !e2 || this.isBlockElement(e2);
          }, g.prototype.isExtraBR = function(t3) {
            return l(t3) === "br" && this.isBlockElement(t3.parentNode) && t3.parentNode.lastChild === t3;
          }, v = function(t3) {
            var e2;
            return e2 = window.getComputedStyle(t3).whiteSpace, e2 === "pre" || e2 === "pre-wrap" || e2 === "pre-line";
          }, C3 = function(t3) {
            return t3 && !R(t3.textContent);
          }, g.prototype.translateBlockElementMarginsToNewlines = function() {
            var t3, e2, n2, i2, o2, r2, s2, a2;
            for (e2 = this.getMarginOfDefaultBlockElement(), s2 = this.blocks, a2 = [], i2 = n2 = 0, o2 = s2.length; o2 > n2; i2 = ++n2)
              t3 = s2[i2], (r2 = this.getMarginOfBlockElementAtIndex(i2)) && (r2.top > 2 * e2.top && this.prependStringToTextAtIndex("\n", i2), a2.push(r2.bottom > 2 * e2.bottom ? this.appendStringToTextAtIndex("\n", i2) : void 0));
            return a2;
          }, g.prototype.getMarginOfBlockElementAtIndex = function(t3) {
            var e2, n2;
            return !(e2 = this.blockElements[t3]) || !e2.textContent || (n2 = l(e2), f.call(r(), n2) >= 0 || f.call(this.processedElements, e2) >= 0) ? void 0 : y(e2);
          }, g.prototype.getMarginOfDefaultBlockElement = function() {
            var t3;
            return t3 = s(e.config.blockAttributes["default"].tagName), this.containerElement.appendChild(t3), y(t3);
          }, y = function(t3) {
            var e2;
            return e2 = window.getComputedStyle(t3), e2.display === "block" ? {top: parseInt(e2.marginTop), bottom: parseInt(e2.marginBottom)} : void 0;
          }, A = function(t3) {
            return t3.replace(RegExp("^" + n.source + "+"), "");
          }, k = function(t3) {
            return RegExp("^" + n.source + "*$").test(t3);
          }, R = function(t3) {
            return /\s$/.test(t3);
          }, g;
        }(e.BasicObject);
      }.call(this), function() {
        var t2, n, i, o, r = function(t3, e2) {
          function n2() {
            this.constructor = t3;
          }
          for (var i2 in e2)
            s.call(e2, i2) && (t3[i2] = e2[i2]);
          return n2.prototype = e2.prototype, t3.prototype = new n2(), t3.__super__ = e2.prototype, t3;
        }, s = {}.hasOwnProperty, a = [].slice, u = [].indexOf || function(t3) {
          for (var e2 = 0, n2 = this.length; n2 > e2; e2++)
            if (e2 in this && this[e2] === t3)
              return e2;
          return -1;
        };
        t2 = e.arraysAreEqual, i = e.normalizeRange, o = e.rangeIsCollapsed, n = e.getBlockConfig, e.Document = function(s2) {
          function c(t3) {
            t3 == null && (t3 = []), c.__super__.constructor.apply(this, arguments), t3.length === 0 && (t3 = [new e.Block()]), this.blockList = e.SplittableList.box(t3);
          }
          var l;
          return r(c, s2), c.fromJSON = function(t3) {
            var n2, i2;
            return i2 = function() {
              var i3, o2, r2;
              for (r2 = [], i3 = 0, o2 = t3.length; o2 > i3; i3++)
                n2 = t3[i3], r2.push(e.Block.fromJSON(n2));
              return r2;
            }(), new this(i2);
          }, c.fromHTML = function(t3, n2) {
            return e.HTMLParser.parse(t3, n2).getDocument();
          }, c.fromString = function(t3, n2) {
            var i2;
            return i2 = e.Text.textForStringWithAttributes(t3, n2), new this([new e.Block(i2)]);
          }, c.prototype.isEmpty = function() {
            var t3;
            return this.blockList.length === 1 && (t3 = this.getBlockAtIndex(0), t3.isEmpty() && !t3.hasAttributes());
          }, c.prototype.copy = function(t3) {
            var e2;
            return t3 == null && (t3 = {}), e2 = t3.consolidateBlocks ? this.blockList.consolidate().toArray() : this.blockList.toArray(), new this.constructor(e2);
          }, c.prototype.copyUsingObjectsFromDocument = function(t3) {
            var n2;
            return n2 = new e.ObjectMap(t3.getObjects()), this.copyUsingObjectMap(n2);
          }, c.prototype.copyUsingObjectMap = function(t3) {
            var e2, n2, i2;
            return n2 = function() {
              var n3, o2, r2, s3;
              for (r2 = this.getBlocks(), s3 = [], n3 = 0, o2 = r2.length; o2 > n3; n3++)
                e2 = r2[n3], s3.push((i2 = t3.find(e2)) ? i2 : e2.copyUsingObjectMap(t3));
              return s3;
            }.call(this), new this.constructor(n2);
          }, c.prototype.copyWithBaseBlockAttributes = function(t3) {
            var e2, n2, i2;
            return t3 == null && (t3 = []), i2 = function() {
              var i3, o2, r2, s3;
              for (r2 = this.getBlocks(), s3 = [], i3 = 0, o2 = r2.length; o2 > i3; i3++)
                n2 = r2[i3], e2 = t3.concat(n2.getAttributes()), s3.push(n2.copyWithAttributes(e2));
              return s3;
            }.call(this), new this.constructor(i2);
          }, c.prototype.replaceBlock = function(t3, e2) {
            var n2;
            return n2 = this.blockList.indexOf(t3), n2 === -1 ? this : new this.constructor(this.blockList.replaceObjectAtIndex(e2, n2));
          }, c.prototype.insertDocumentAtRange = function(t3, e2) {
            var n2, r2, s3, a2, u2, c2, l2;
            return r2 = t3.blockList, u2 = (e2 = i(e2))[0], c2 = this.locationFromPosition(u2), s3 = c2.index, a2 = c2.offset, l2 = this, n2 = this.getBlockAtPosition(u2), o(e2) && n2.isEmpty() && !n2.hasAttributes() ? l2 = new this.constructor(l2.blockList.removeObjectAtIndex(s3)) : n2.getBlockBreakPosition() === a2 && u2++, l2 = l2.removeTextAtRange(e2), new this.constructor(l2.blockList.insertSplittableListAtPosition(r2, u2));
          }, c.prototype.mergeDocumentAtRange = function(e2, n2) {
            var o2, r2, s3, a2, u2, c2, l2, h, p, d, f, g;
            return f = (n2 = i(n2))[0], d = this.locationFromPosition(f), r2 = this.getBlockAtIndex(d.index).getAttributes(), o2 = e2.getBaseBlockAttributes(), g = r2.slice(-o2.length), t2(o2, g) ? (l2 = r2.slice(0, -o2.length), c2 = e2.copyWithBaseBlockAttributes(l2)) : c2 = e2.copy({consolidateBlocks: true}).copyWithBaseBlockAttributes(r2), s3 = c2.getBlockCount(), a2 = c2.getBlockAtIndex(0), t2(r2, a2.getAttributes()) ? (u2 = a2.getTextWithoutBlockBreak(), p = this.insertTextAtRange(u2, n2), s3 > 1 && (c2 = new this.constructor(c2.getBlocks().slice(1)), h = f + u2.getLength(), p = p.insertDocumentAtRange(c2, h))) : p = this.insertDocumentAtRange(c2, n2), p;
          }, c.prototype.insertTextAtRange = function(t3, e2) {
            var n2, o2, r2, s3, a2;
            return a2 = (e2 = i(e2))[0], s3 = this.locationFromPosition(a2), o2 = s3.index, r2 = s3.offset, n2 = this.removeTextAtRange(e2), new this.constructor(n2.blockList.editObjectAtIndex(o2, function(e3) {
              return e3.copyWithText(e3.text.insertTextAtPosition(t3, r2));
            }));
          }, c.prototype.removeTextAtRange = function(t3) {
            var e2, n2, r2, s3, a2, u2, c2, l2, h, p, d, f, g, m, v, y, b, A, C3, x, w;
            return p = t3 = i(t3), l2 = p[0], A = p[1], o(t3) ? this : (d = this.locationRangeFromRange(t3), u2 = d[0], y = d[1], a2 = u2.index, c2 = u2.offset, s3 = this.getBlockAtIndex(a2), v = y.index, b = y.offset, m = this.getBlockAtIndex(v), f = A - l2 === 1 && s3.getBlockBreakPosition() === c2 && m.getBlockBreakPosition() !== b && m.text.getStringAtPosition(b) === "\n", f ? r2 = this.blockList.editObjectAtIndex(v, function(t4) {
              return t4.copyWithText(t4.text.removeTextAtRange([b, b + 1]));
            }) : (h = s3.text.getTextAtRange([0, c2]), C3 = m.text.getTextAtRange([b, m.getLength()]), x = h.appendText(C3), g = a2 !== v && c2 === 0, w = g && s3.getAttributeLevel() >= m.getAttributeLevel(), n2 = w ? m.copyWithText(x) : s3.copyWithText(x), e2 = v + 1 - a2, r2 = this.blockList.splice(a2, e2, n2)), new this.constructor(r2));
          }, c.prototype.moveTextFromRangeToPosition = function(t3, e2) {
            var n2, o2, r2, s3, u2, c2, l2, h, p, d;
            return c2 = t3 = i(t3), p = c2[0], r2 = c2[1], e2 >= p && r2 >= e2 ? this : (o2 = this.getDocumentAtRange(t3), h = this.removeTextAtRange(t3), u2 = e2 > p, u2 && (e2 -= o2.getLength()), l2 = o2.getBlocks(), s3 = l2[0], n2 = 2 <= l2.length ? a.call(l2, 1) : [], n2.length === 0 ? (d = s3.getTextWithoutBlockBreak(), u2 && (e2 += 1)) : d = s3.text, h = h.insertTextAtRange(d, e2), n2.length === 0 ? h : (o2 = new this.constructor(n2), e2 += d.getLength(), h.insertDocumentAtRange(o2, e2)));
          }, c.prototype.addAttributeAtRange = function(t3, e2, i2) {
            var o2;
            return o2 = this.blockList, this.eachBlockAtRange(i2, function(i3, r2, s3) {
              return o2 = o2.editObjectAtIndex(s3, function() {
                return n(t3) ? i3.addAttribute(t3, e2) : r2[0] === r2[1] ? i3 : i3.copyWithText(i3.text.addAttributeAtRange(t3, e2, r2));
              });
            }), new this.constructor(o2);
          }, c.prototype.addAttribute = function(t3, e2) {
            var n2;
            return n2 = this.blockList, this.eachBlock(function(i2, o2) {
              return n2 = n2.editObjectAtIndex(o2, function() {
                return i2.addAttribute(t3, e2);
              });
            }), new this.constructor(n2);
          }, c.prototype.removeAttributeAtRange = function(t3, e2) {
            var i2;
            return i2 = this.blockList, this.eachBlockAtRange(e2, function(e3, o2, r2) {
              return n(t3) ? i2 = i2.editObjectAtIndex(r2, function() {
                return e3.removeAttribute(t3);
              }) : o2[0] !== o2[1] ? i2 = i2.editObjectAtIndex(r2, function() {
                return e3.copyWithText(e3.text.removeAttributeAtRange(t3, o2));
              }) : void 0;
            }), new this.constructor(i2);
          }, c.prototype.updateAttributesForAttachment = function(t3, e2) {
            var n2, i2, o2, r2;
            return o2 = (i2 = this.getRangeOfAttachment(e2))[0], n2 = this.locationFromPosition(o2).index, r2 = this.getTextAtIndex(n2), new this.constructor(this.blockList.editObjectAtIndex(n2, function(n3) {
              return n3.copyWithText(r2.updateAttributesForAttachment(t3, e2));
            }));
          }, c.prototype.removeAttributeForAttachment = function(t3, e2) {
            var n2;
            return n2 = this.getRangeOfAttachment(e2), this.removeAttributeAtRange(t3, n2);
          }, c.prototype.insertBlockBreakAtRange = function(t3) {
            var n2, o2, r2, s3;
            return s3 = (t3 = i(t3))[0], r2 = this.locationFromPosition(s3).offset, o2 = this.removeTextAtRange(t3), r2 === 0 && (n2 = [new e.Block()]), new this.constructor(o2.blockList.insertSplittableListAtPosition(new e.SplittableList(n2), s3));
          }, c.prototype.applyBlockAttributeAtRange = function(t3, e2, i2) {
            var o2, r2, s3, a2;
            return s3 = this.expandRangeToLineBreaksAndSplitBlocks(i2), r2 = s3.document, i2 = s3.range, o2 = n(t3), o2.listAttribute ? (r2 = r2.removeLastListAttributeAtRange(i2, {exceptAttributeName: t3}), a2 = r2.convertLineBreaksToBlockBreaksInRange(i2), r2 = a2.document, i2 = a2.range) : r2 = o2.exclusive ? r2.removeBlockAttributesAtRange(i2) : o2.terminal ? r2.removeLastTerminalAttributeAtRange(i2) : r2.consolidateBlocksAtRange(i2), r2.addAttributeAtRange(t3, e2, i2);
          }, c.prototype.removeLastListAttributeAtRange = function(t3, e2) {
            var i2;
            return e2 == null && (e2 = {}), i2 = this.blockList, this.eachBlockAtRange(t3, function(t4, o2, r2) {
              var s3;
              if ((s3 = t4.getLastAttribute()) && n(s3).listAttribute && s3 !== e2.exceptAttributeName)
                return i2 = i2.editObjectAtIndex(r2, function() {
                  return t4.removeAttribute(s3);
                });
            }), new this.constructor(i2);
          }, c.prototype.removeLastTerminalAttributeAtRange = function(t3) {
            var e2;
            return e2 = this.blockList, this.eachBlockAtRange(t3, function(t4, i2, o2) {
              var r2;
              if ((r2 = t4.getLastAttribute()) && n(r2).terminal)
                return e2 = e2.editObjectAtIndex(o2, function() {
                  return t4.removeAttribute(r2);
                });
            }), new this.constructor(e2);
          }, c.prototype.removeBlockAttributesAtRange = function(t3) {
            var e2;
            return e2 = this.blockList, this.eachBlockAtRange(t3, function(t4, n2, i2) {
              return t4.hasAttributes() ? e2 = e2.editObjectAtIndex(i2, function() {
                return t4.copyWithoutAttributes();
              }) : void 0;
            }), new this.constructor(e2);
          }, c.prototype.expandRangeToLineBreaksAndSplitBlocks = function(t3) {
            var e2, n2, o2, r2, s3, a2, u2, c2, l2;
            return a2 = t3 = i(t3), l2 = a2[0], r2 = a2[1], c2 = this.locationFromPosition(l2), o2 = this.locationFromPosition(r2), e2 = this, u2 = e2.getBlockAtIndex(c2.index), (c2.offset = u2.findLineBreakInDirectionFromPosition("backward", c2.offset)) != null && (s3 = e2.positionFromLocation(c2), e2 = e2.insertBlockBreakAtRange([s3, s3 + 1]), o2.index += 1, o2.offset -= e2.getBlockAtIndex(c2.index).getLength(), c2.index += 1), c2.offset = 0, o2.offset === 0 && o2.index > c2.index ? (o2.index -= 1, o2.offset = e2.getBlockAtIndex(o2.index).getBlockBreakPosition()) : (n2 = e2.getBlockAtIndex(o2.index), n2.text.getStringAtRange([o2.offset - 1, o2.offset]) === "\n" ? o2.offset -= 1 : o2.offset = n2.findLineBreakInDirectionFromPosition("forward", o2.offset), o2.offset !== n2.getBlockBreakPosition() && (s3 = e2.positionFromLocation(o2), e2 = e2.insertBlockBreakAtRange([s3, s3 + 1]))), l2 = e2.positionFromLocation(c2), r2 = e2.positionFromLocation(o2), t3 = i([l2, r2]), {document: e2, range: t3};
          }, c.prototype.convertLineBreaksToBlockBreaksInRange = function(t3) {
            var e2, n2, o2;
            return n2 = (t3 = i(t3))[0], o2 = this.getStringAtRange(t3).slice(0, -1), e2 = this, o2.replace(/.*?\n/g, function(t4) {
              return n2 += t4.length, e2 = e2.insertBlockBreakAtRange([n2 - 1, n2]);
            }), {document: e2, range: t3};
          }, c.prototype.consolidateBlocksAtRange = function(t3) {
            var e2, n2, o2, r2, s3;
            return o2 = t3 = i(t3), s3 = o2[0], n2 = o2[1], r2 = this.locationFromPosition(s3).index, e2 = this.locationFromPosition(n2).index, new this.constructor(this.blockList.consolidateFromIndexToIndex(r2, e2));
          }, c.prototype.getDocumentAtRange = function(t3) {
            var e2;
            return t3 = i(t3), e2 = this.blockList.getSplittableListInRange(t3).toArray(), new this.constructor(e2);
          }, c.prototype.getStringAtRange = function(t3) {
            var e2, n2, o2;
            return o2 = t3 = i(t3), n2 = o2[o2.length - 1], n2 !== this.getLength() && (e2 = -1), this.getDocumentAtRange(t3).toString().slice(0, e2);
          }, c.prototype.getBlockAtIndex = function(t3) {
            return this.blockList.getObjectAtIndex(t3);
          }, c.prototype.getBlockAtPosition = function(t3) {
            var e2;
            return e2 = this.locationFromPosition(t3).index, this.getBlockAtIndex(e2);
          }, c.prototype.getTextAtIndex = function(t3) {
            var e2;
            return (e2 = this.getBlockAtIndex(t3)) != null ? e2.text : void 0;
          }, c.prototype.getTextAtPosition = function(t3) {
            var e2;
            return e2 = this.locationFromPosition(t3).index, this.getTextAtIndex(e2);
          }, c.prototype.getPieceAtPosition = function(t3) {
            var e2, n2, i2;
            return i2 = this.locationFromPosition(t3), e2 = i2.index, n2 = i2.offset, this.getTextAtIndex(e2).getPieceAtPosition(n2);
          }, c.prototype.getCharacterAtPosition = function(t3) {
            var e2, n2, i2;
            return i2 = this.locationFromPosition(t3), e2 = i2.index, n2 = i2.offset, this.getTextAtIndex(e2).getStringAtRange([n2, n2 + 1]);
          }, c.prototype.getLength = function() {
            return this.blockList.getEndPosition();
          }, c.prototype.getBlocks = function() {
            return this.blockList.toArray();
          }, c.prototype.getBlockCount = function() {
            return this.blockList.length;
          }, c.prototype.getEditCount = function() {
            return this.editCount;
          }, c.prototype.eachBlock = function(t3) {
            return this.blockList.eachObject(t3);
          }, c.prototype.eachBlockAtRange = function(t3, e2) {
            var n2, o2, r2, s3, a2, u2, c2, l2, h, p, d, f;
            if (u2 = t3 = i(t3), d = u2[0], r2 = u2[1], p = this.locationFromPosition(d), o2 = this.locationFromPosition(r2), p.index === o2.index)
              return n2 = this.getBlockAtIndex(p.index), f = [p.offset, o2.offset], e2(n2, f, p.index);
            for (h = [], a2 = s3 = c2 = p.index, l2 = o2.index; l2 >= c2 ? l2 >= s3 : s3 >= l2; a2 = l2 >= c2 ? ++s3 : --s3)
              (n2 = this.getBlockAtIndex(a2)) ? (f = function() {
                switch (a2) {
                  case p.index:
                    return [p.offset, n2.text.getLength()];
                  case o2.index:
                    return [0, o2.offset];
                  default:
                    return [0, n2.text.getLength()];
                }
              }(), h.push(e2(n2, f, a2))) : h.push(void 0);
            return h;
          }, c.prototype.getCommonAttributesAtRange = function(t3) {
            var n2, r2, s3;
            return r2 = (t3 = i(t3))[0], o(t3) ? this.getCommonAttributesAtPosition(r2) : (s3 = [], n2 = [], this.eachBlockAtRange(t3, function(t4, e2) {
              return e2[0] !== e2[1] ? (s3.push(t4.text.getCommonAttributesAtRange(e2)), n2.push(l(t4))) : void 0;
            }), e.Hash.fromCommonAttributesOfObjects(s3).merge(e.Hash.fromCommonAttributesOfObjects(n2)).toObject());
          }, c.prototype.getCommonAttributesAtPosition = function(t3) {
            var n2, i2, o2, r2, s3, a2, c2, h, p, d;
            if (p = this.locationFromPosition(t3), s3 = p.index, h = p.offset, o2 = this.getBlockAtIndex(s3), !o2)
              return {};
            r2 = l(o2), n2 = o2.text.getAttributesAtPosition(h), i2 = o2.text.getAttributesAtPosition(h - 1), a2 = function() {
              var t4, n3;
              t4 = e.config.textAttributes, n3 = [];
              for (c2 in t4)
                d = t4[c2], d.inheritable && n3.push(c2);
              return n3;
            }();
            for (c2 in i2)
              d = i2[c2], (d === n2[c2] || u.call(a2, c2) >= 0) && (r2[c2] = d);
            return r2;
          }, c.prototype.getRangeOfCommonAttributeAtPosition = function(t3, e2) {
            var n2, o2, r2, s3, a2, u2, c2, l2, h;
            return a2 = this.locationFromPosition(e2), r2 = a2.index, s3 = a2.offset, h = this.getTextAtIndex(r2), u2 = h.getExpandedRangeForAttributeAtOffset(t3, s3), l2 = u2[0], o2 = u2[1], c2 = this.positionFromLocation({index: r2, offset: l2}), n2 = this.positionFromLocation({index: r2, offset: o2}), i([c2, n2]);
          }, c.prototype.getBaseBlockAttributes = function() {
            var t3, e2, n2, i2, o2, r2, s3;
            for (t3 = this.getBlockAtIndex(0).getAttributes(), n2 = i2 = 1, s3 = this.getBlockCount(); s3 >= 1 ? s3 > i2 : i2 > s3; n2 = s3 >= 1 ? ++i2 : --i2)
              e2 = this.getBlockAtIndex(n2).getAttributes(), r2 = Math.min(t3.length, e2.length), t3 = function() {
                var n3, i3, s4;
                for (s4 = [], o2 = n3 = 0, i3 = r2; (i3 >= 0 ? i3 > n3 : n3 > i3) && e2[o2] === t3[o2]; o2 = i3 >= 0 ? ++n3 : --n3)
                  s4.push(e2[o2]);
                return s4;
              }();
            return t3;
          }, l = function(t3) {
            var e2, n2;
            return n2 = {}, (e2 = t3.getLastAttribute()) && (n2[e2] = true), n2;
          }, c.prototype.getAttachmentById = function(t3) {
            var e2, n2, i2, o2;
            for (o2 = this.getAttachments(), n2 = 0, i2 = o2.length; i2 > n2; n2++)
              if (e2 = o2[n2], e2.id === t3)
                return e2;
          }, c.prototype.getAttachmentPieces = function() {
            var t3;
            return t3 = [], this.blockList.eachObject(function(e2) {
              var n2;
              return n2 = e2.text, t3 = t3.concat(n2.getAttachmentPieces());
            }), t3;
          }, c.prototype.getAttachments = function() {
            var t3, e2, n2, i2, o2;
            for (i2 = this.getAttachmentPieces(), o2 = [], t3 = 0, e2 = i2.length; e2 > t3; t3++)
              n2 = i2[t3], o2.push(n2.attachment);
            return o2;
          }, c.prototype.getRangeOfAttachment = function(t3) {
            var e2, n2, o2, r2, s3, a2, u2;
            for (r2 = 0, s3 = this.blockList.toArray(), n2 = e2 = 0, o2 = s3.length; o2 > e2; n2 = ++e2) {
              if (a2 = s3[n2].text, u2 = a2.getRangeOfAttachment(t3))
                return i([r2 + u2[0], r2 + u2[1]]);
              r2 += a2.getLength();
            }
          }, c.prototype.getLocationRangeOfAttachment = function(t3) {
            var e2;
            return e2 = this.getRangeOfAttachment(t3), this.locationRangeFromRange(e2);
          }, c.prototype.getAttachmentPieceForAttachment = function(t3) {
            var e2, n2, i2, o2;
            for (o2 = this.getAttachmentPieces(), e2 = 0, n2 = o2.length; n2 > e2; e2++)
              if (i2 = o2[e2], i2.attachment === t3)
                return i2;
          }, c.prototype.findRangesForBlockAttribute = function(t3) {
            var e2, n2, i2, o2, r2, s3, a2;
            for (r2 = 0, s3 = [], a2 = this.getBlocks(), n2 = 0, i2 = a2.length; i2 > n2; n2++)
              e2 = a2[n2], o2 = e2.getLength(), e2.hasAttribute(t3) && s3.push([r2, r2 + o2]), r2 += o2;
            return s3;
          }, c.prototype.findRangesForTextAttribute = function(t3, e2) {
            var n2, i2, o2, r2, s3, a2, u2, c2, l2, h;
            for (h = (e2 != null ? e2 : {}).withValue, a2 = 0, u2 = [], c2 = [], r2 = function(e3) {
              return h != null ? e3.getAttribute(t3) === h : e3.hasAttribute(t3);
            }, l2 = this.getPieces(), n2 = 0, i2 = l2.length; i2 > n2; n2++)
              s3 = l2[n2], o2 = s3.getLength(), r2(s3) && (u2[1] === a2 ? u2[1] = a2 + o2 : c2.push(u2 = [a2, a2 + o2])), a2 += o2;
            return c2;
          }, c.prototype.locationFromPosition = function(t3) {
            var e2, n2;
            return n2 = this.blockList.findIndexAndOffsetAtPosition(Math.max(0, t3)), n2.index != null ? n2 : (e2 = this.getBlocks(), {index: e2.length - 1, offset: e2[e2.length - 1].getLength()});
          }, c.prototype.positionFromLocation = function(t3) {
            return this.blockList.findPositionAtIndexAndOffset(t3.index, t3.offset);
          }, c.prototype.locationRangeFromPosition = function(t3) {
            return i(this.locationFromPosition(t3));
          }, c.prototype.locationRangeFromRange = function(t3) {
            var e2, n2, o2, r2;
            if (t3 = i(t3))
              return r2 = t3[0], n2 = t3[1], o2 = this.locationFromPosition(r2), e2 = this.locationFromPosition(n2), i([o2, e2]);
          }, c.prototype.rangeFromLocationRange = function(t3) {
            var e2, n2;
            return t3 = i(t3), e2 = this.positionFromLocation(t3[0]), o(t3) || (n2 = this.positionFromLocation(t3[1])), i([e2, n2]);
          }, c.prototype.isEqualTo = function(t3) {
            return this.blockList.isEqualTo(t3 != null ? t3.blockList : void 0);
          }, c.prototype.getTexts = function() {
            var t3, e2, n2, i2, o2;
            for (i2 = this.getBlocks(), o2 = [], e2 = 0, n2 = i2.length; n2 > e2; e2++)
              t3 = i2[e2], o2.push(t3.text);
            return o2;
          }, c.prototype.getPieces = function() {
            var t3, e2, n2, i2, o2;
            for (n2 = [], i2 = this.getTexts(), t3 = 0, e2 = i2.length; e2 > t3; t3++)
              o2 = i2[t3], n2.push.apply(n2, o2.getPieces());
            return n2;
          }, c.prototype.getObjects = function() {
            return this.getBlocks().concat(this.getTexts()).concat(this.getPieces());
          }, c.prototype.toSerializableDocument = function() {
            var t3;
            return t3 = [], this.blockList.eachObject(function(e2) {
              return t3.push(e2.copyWithText(e2.text.toSerializableText()));
            }), new this.constructor(t3);
          }, c.prototype.toString = function() {
            return this.blockList.toString();
          }, c.prototype.toJSON = function() {
            return this.blockList.toJSON();
          }, c.prototype.toConsole = function() {
            var t3;
            return JSON.stringify(function() {
              var e2, n2, i2, o2;
              for (i2 = this.blockList.toArray(), o2 = [], e2 = 0, n2 = i2.length; n2 > e2; e2++)
                t3 = i2[e2], o2.push(JSON.parse(t3.text.toConsole()));
              return o2;
            }.call(this));
          }, c;
        }(e.Object);
      }.call(this), function() {
        e.LineBreakInsertion = function() {
          function t2(t3) {
            var e2;
            this.composition = t3, this.document = this.composition.document, e2 = this.composition.getSelectedRange(), this.startPosition = e2[0], this.endPosition = e2[1], this.startLocation = this.document.locationFromPosition(this.startPosition), this.endLocation = this.document.locationFromPosition(this.endPosition), this.block = this.document.getBlockAtIndex(this.endLocation.index), this.breaksOnReturn = this.block.breaksOnReturn(), this.previousCharacter = this.block.text.getStringAtPosition(this.endLocation.offset - 1), this.nextCharacter = this.block.text.getStringAtPosition(this.endLocation.offset);
          }
          return t2.prototype.shouldInsertBlockBreak = function() {
            return this.block.hasAttributes() && this.block.isListItem() && !this.block.isEmpty() ? this.startLocation.offset !== 0 : this.breaksOnReturn && this.nextCharacter !== "\n";
          }, t2.prototype.shouldBreakFormattedBlock = function() {
            return this.block.hasAttributes() && !this.block.isListItem() && (this.breaksOnReturn && this.nextCharacter === "\n" || this.previousCharacter === "\n");
          }, t2.prototype.shouldDecreaseListLevel = function() {
            return this.block.hasAttributes() && this.block.isListItem() && this.block.isEmpty();
          }, t2.prototype.shouldPrependListItem = function() {
            return this.block.isListItem() && this.startLocation.offset === 0 && !this.block.isEmpty();
          }, t2.prototype.shouldRemoveLastBlockAttribute = function() {
            return this.block.hasAttributes() && !this.block.isListItem() && this.block.isEmpty();
          }, t2;
        }();
      }.call(this), function() {
        var t2, n, i, o, r, s, a, u, c, l, h = function(t3, e2) {
          function n2() {
            this.constructor = t3;
          }
          for (var i2 in e2)
            p.call(e2, i2) && (t3[i2] = e2[i2]);
          return n2.prototype = e2.prototype, t3.prototype = new n2(), t3.__super__ = e2.prototype, t3;
        }, p = {}.hasOwnProperty;
        s = e.normalizeRange, c = e.rangesAreEqual, u = e.rangeIsCollapsed, a = e.objectsAreEqual, t2 = e.arrayStartsWith, l = e.summarizeArrayChange, i = e.getAllAttributeNames, o = e.getBlockConfig, r = e.getTextConfig, n = e.extend, e.Composition = function(p2) {
          function d() {
            this.document = new e.Document(), this.attachments = [], this.currentAttributes = {}, this.revision = 0;
          }
          var f;
          return h(d, p2), d.prototype.setDocument = function(t3) {
            var e2;
            return t3.isEqualTo(this.document) ? void 0 : (this.document = t3, this.refreshAttachments(), this.revision++, (e2 = this.delegate) != null && typeof e2.compositionDidChangeDocument == "function" ? e2.compositionDidChangeDocument(t3) : void 0);
          }, d.prototype.getSnapshot = function() {
            return {document: this.document, selectedRange: this.getSelectedRange()};
          }, d.prototype.loadSnapshot = function(t3) {
            var n2, i2, o2, r2;
            return n2 = t3.document, r2 = t3.selectedRange, (i2 = this.delegate) != null && typeof i2.compositionWillLoadSnapshot == "function" && i2.compositionWillLoadSnapshot(), this.setDocument(n2 != null ? n2 : new e.Document()), this.setSelection(r2 != null ? r2 : [0, 0]), (o2 = this.delegate) != null && typeof o2.compositionDidLoadSnapshot == "function" ? o2.compositionDidLoadSnapshot() : void 0;
          }, d.prototype.insertText = function(t3, e2) {
            var n2, i2, o2, r2;
            return r2 = (e2 != null ? e2 : {updatePosition: true}).updatePosition, i2 = this.getSelectedRange(), this.setDocument(this.document.insertTextAtRange(t3, i2)), o2 = i2[0], n2 = o2 + t3.getLength(), r2 && this.setSelection(n2), this.notifyDelegateOfInsertionAtRange([o2, n2]);
          }, d.prototype.insertBlock = function(t3) {
            var n2;
            return t3 == null && (t3 = new e.Block()), n2 = new e.Document([t3]), this.insertDocument(n2);
          }, d.prototype.insertDocument = function(t3) {
            var n2, i2, o2;
            return t3 == null && (t3 = new e.Document()), i2 = this.getSelectedRange(), this.setDocument(this.document.insertDocumentAtRange(t3, i2)), o2 = i2[0], n2 = o2 + t3.getLength(), this.setSelection(n2), this.notifyDelegateOfInsertionAtRange([o2, n2]);
          }, d.prototype.insertString = function(t3, n2) {
            var i2, o2;
            return i2 = this.getCurrentTextAttributes(), o2 = e.Text.textForStringWithAttributes(t3, i2), this.insertText(o2, n2);
          }, d.prototype.insertBlockBreak = function() {
            var t3, e2, n2;
            return e2 = this.getSelectedRange(), this.setDocument(this.document.insertBlockBreakAtRange(e2)), n2 = e2[0], t3 = n2 + 1, this.setSelection(t3), this.notifyDelegateOfInsertionAtRange([n2, t3]);
          }, d.prototype.insertLineBreak = function() {
            var t3, n2;
            return n2 = new e.LineBreakInsertion(this), n2.shouldDecreaseListLevel() ? (this.decreaseListLevel(), this.setSelection(n2.startPosition)) : n2.shouldPrependListItem() ? (t3 = new e.Document([n2.block.copyWithoutText()]), this.insertDocument(t3)) : n2.shouldInsertBlockBreak() ? this.insertBlockBreak() : n2.shouldRemoveLastBlockAttribute() ? this.removeLastBlockAttribute() : n2.shouldBreakFormattedBlock() ? this.breakFormattedBlock(n2) : this.insertString("\n");
          }, d.prototype.insertHTML = function(t3) {
            var n2, i2, o2, r2;
            return n2 = e.Document.fromHTML(t3), o2 = this.getSelectedRange(), this.setDocument(this.document.mergeDocumentAtRange(n2, o2)), r2 = o2[0], i2 = r2 + n2.getLength() - 1, this.setSelection(i2), this.notifyDelegateOfInsertionAtRange([r2, i2]);
          }, d.prototype.replaceHTML = function(t3) {
            var n2, i2, o2;
            return n2 = e.Document.fromHTML(t3).copyUsingObjectsFromDocument(this.document), i2 = this.getLocationRange({strict: false}), o2 = this.document.rangeFromLocationRange(i2), this.setDocument(n2), this.setSelection(o2);
          }, d.prototype.insertFile = function(t3) {
            return this.insertFiles([t3]);
          }, d.prototype.insertFiles = function(t3) {
            var n2, i2, o2, r2, s2, a2;
            for (i2 = [], r2 = 0, s2 = t3.length; s2 > r2; r2++)
              o2 = t3[r2], ((a2 = this.delegate) != null ? a2.compositionShouldAcceptFile(o2) : void 0) && (n2 = e.Attachment.attachmentForFile(o2), i2.push(n2));
            return this.insertAttachments(i2);
          }, d.prototype.insertAttachment = function(t3) {
            return this.insertAttachments([t3]);
          }, d.prototype.insertAttachments = function(t3) {
            var n2, i2, o2, r2, s2, a2, u2, c2, l2;
            for (c2 = new e.Text(), r2 = 0, s2 = t3.length; s2 > r2; r2++)
              n2 = t3[r2], l2 = n2.getType(), a2 = (u2 = e.config.attachments[l2]) != null ? u2.presentation : void 0, o2 = this.getCurrentTextAttributes(), a2 && (o2.presentation = a2), i2 = e.Text.textForAttachmentWithAttributes(n2, o2), c2 = c2.appendText(i2);
            return this.insertText(c2);
          }, d.prototype.shouldManageDeletingInDirection = function(t3) {
            var e2;
            if (e2 = this.getLocationRange(), u(e2)) {
              if (t3 === "backward" && e2[0].offset === 0)
                return true;
              if (this.shouldManageMovingCursorInDirection(t3))
                return true;
            } else if (e2[0].index !== e2[1].index)
              return true;
            return false;
          }, d.prototype.deleteInDirection = function(t3, e2) {
            var n2, i2, o2, r2, s2, a2, c2, l2;
            return r2 = (e2 != null ? e2 : {}).length, s2 = this.getLocationRange(), a2 = this.getSelectedRange(), c2 = u(a2), c2 ? o2 = t3 === "backward" && s2[0].offset === 0 : l2 = s2[0].index !== s2[1].index, o2 && this.canDecreaseBlockAttributeLevel() && (i2 = this.getBlock(), i2.isListItem() ? this.decreaseListLevel() : this.decreaseBlockAttributeLevel(), this.setSelection(a2[0]), i2.isEmpty()) ? false : (c2 && (a2 = this.getExpandedRangeInDirection(t3, {length: r2}), t3 === "backward" && (n2 = this.getAttachmentAtRange(a2))), n2 ? (this.editAttachment(n2), false) : (this.setDocument(this.document.removeTextAtRange(a2)), this.setSelection(a2[0]), o2 || l2 ? false : void 0));
          }, d.prototype.moveTextFromRange = function(t3) {
            var e2;
            return e2 = this.getSelectedRange()[0], this.setDocument(this.document.moveTextFromRangeToPosition(t3, e2)), this.setSelection(e2);
          }, d.prototype.removeAttachment = function(t3) {
            var e2;
            return (e2 = this.document.getRangeOfAttachment(t3)) ? (this.stopEditingAttachment(), this.setDocument(this.document.removeTextAtRange(e2)), this.setSelection(e2[0])) : void 0;
          }, d.prototype.removeLastBlockAttribute = function() {
            var t3, e2, n2, i2;
            return n2 = this.getSelectedRange(), i2 = n2[0], e2 = n2[1], t3 = this.document.getBlockAtPosition(e2), this.removeCurrentAttribute(t3.getLastAttribute()), this.setSelection(i2);
          }, f = " ", d.prototype.insertPlaceholder = function() {
            return this.placeholderPosition = this.getPosition(), this.insertString(f);
          }, d.prototype.selectPlaceholder = function() {
            return this.placeholderPosition != null ? (this.setSelectedRange([this.placeholderPosition, this.placeholderPosition + f.length]), this.getSelectedRange()) : void 0;
          }, d.prototype.forgetPlaceholder = function() {
            return this.placeholderPosition = null;
          }, d.prototype.hasCurrentAttribute = function(t3) {
            var e2;
            return e2 = this.currentAttributes[t3], e2 != null && e2 !== false;
          }, d.prototype.toggleCurrentAttribute = function(t3) {
            var e2;
            return (e2 = !this.currentAttributes[t3]) ? this.setCurrentAttribute(t3, e2) : this.removeCurrentAttribute(t3);
          }, d.prototype.canSetCurrentAttribute = function(t3) {
            return o(t3) ? this.canSetCurrentBlockAttribute(t3) : this.canSetCurrentTextAttribute(t3);
          }, d.prototype.canSetCurrentTextAttribute = function() {
            var t3, e2, n2, i2, o2;
            if (e2 = this.getSelectedDocument()) {
              for (o2 = e2.getAttachments(), n2 = 0, i2 = o2.length; i2 > n2; n2++)
                if (t3 = o2[n2], !t3.hasContent())
                  return false;
              return true;
            }
          }, d.prototype.canSetCurrentBlockAttribute = function() {
            var t3;
            if (t3 = this.getBlock())
              return !t3.isTerminalBlock();
          }, d.prototype.setCurrentAttribute = function(t3, e2) {
            return o(t3) ? this.setBlockAttribute(t3, e2) : (this.setTextAttribute(t3, e2), this.currentAttributes[t3] = e2, this.notifyDelegateOfCurrentAttributesChange());
          }, d.prototype.setTextAttribute = function(t3, n2) {
            var i2, o2, r2, s2;
            if (o2 = this.getSelectedRange())
              return r2 = o2[0], i2 = o2[1], r2 !== i2 ? this.setDocument(this.document.addAttributeAtRange(t3, n2, o2)) : t3 === "href" ? (s2 = e.Text.textForStringWithAttributes(n2, {href: n2}), this.insertText(s2)) : void 0;
          }, d.prototype.setBlockAttribute = function(t3, e2) {
            var n2, i2;
            if (i2 = this.getSelectedRange())
              return this.canSetCurrentAttribute(t3) ? (n2 = this.getBlock(), this.setDocument(this.document.applyBlockAttributeAtRange(t3, e2, i2)), this.setSelection(i2)) : void 0;
          }, d.prototype.removeCurrentAttribute = function(t3) {
            return o(t3) ? (this.removeBlockAttribute(t3), this.updateCurrentAttributes()) : (this.removeTextAttribute(t3), delete this.currentAttributes[t3], this.notifyDelegateOfCurrentAttributesChange());
          }, d.prototype.removeTextAttribute = function(t3) {
            var e2;
            if (e2 = this.getSelectedRange())
              return this.setDocument(this.document.removeAttributeAtRange(t3, e2));
          }, d.prototype.removeBlockAttribute = function(t3) {
            var e2;
            if (e2 = this.getSelectedRange())
              return this.setDocument(this.document.removeAttributeAtRange(t3, e2));
          }, d.prototype.canDecreaseNestingLevel = function() {
            var t3;
            return ((t3 = this.getBlock()) != null ? t3.getNestingLevel() : void 0) > 0;
          }, d.prototype.canIncreaseNestingLevel = function() {
            var e2, n2, i2;
            if (e2 = this.getBlock())
              return ((i2 = o(e2.getLastNestableAttribute())) != null ? i2.listAttribute : 0) ? (n2 = this.getPreviousBlock()) ? t2(n2.getListItemAttributes(), e2.getListItemAttributes()) : void 0 : e2.getNestingLevel() > 0;
          }, d.prototype.decreaseNestingLevel = function() {
            var t3;
            if (t3 = this.getBlock())
              return this.setDocument(this.document.replaceBlock(t3, t3.decreaseNestingLevel()));
          }, d.prototype.increaseNestingLevel = function() {
            var t3;
            if (t3 = this.getBlock())
              return this.setDocument(this.document.replaceBlock(t3, t3.increaseNestingLevel()));
          }, d.prototype.canDecreaseBlockAttributeLevel = function() {
            var t3;
            return ((t3 = this.getBlock()) != null ? t3.getAttributeLevel() : void 0) > 0;
          }, d.prototype.decreaseBlockAttributeLevel = function() {
            var t3, e2;
            return (t3 = (e2 = this.getBlock()) != null ? e2.getLastAttribute() : void 0) ? this.removeCurrentAttribute(t3) : void 0;
          }, d.prototype.decreaseListLevel = function() {
            var t3, e2, n2, i2, o2, r2;
            for (r2 = this.getSelectedRange()[0], o2 = this.document.locationFromPosition(r2).index, n2 = o2, t3 = this.getBlock().getAttributeLevel(); (e2 = this.document.getBlockAtIndex(n2 + 1)) && e2.isListItem() && e2.getAttributeLevel() > t3; )
              n2++;
            return r2 = this.document.positionFromLocation({index: o2, offset: 0}), i2 = this.document.positionFromLocation({index: n2, offset: 0}), this.setDocument(this.document.removeLastListAttributeAtRange([r2, i2]));
          }, d.prototype.updateCurrentAttributes = function() {
            var t3, e2, n2, o2, r2, s2;
            if (s2 = this.getSelectedRange({ignoreLock: true})) {
              for (e2 = this.document.getCommonAttributesAtRange(s2), r2 = i(), n2 = 0, o2 = r2.length; o2 > n2; n2++)
                t3 = r2[n2], e2[t3] || this.canSetCurrentAttribute(t3) || (e2[t3] = false);
              if (!a(e2, this.currentAttributes))
                return this.currentAttributes = e2, this.notifyDelegateOfCurrentAttributesChange();
            }
          }, d.prototype.getCurrentAttributes = function() {
            return n.call({}, this.currentAttributes);
          }, d.prototype.getCurrentTextAttributes = function() {
            var t3, e2, n2, i2;
            t3 = {}, n2 = this.currentAttributes;
            for (e2 in n2)
              i2 = n2[e2], i2 !== false && r(e2) && (t3[e2] = i2);
            return t3;
          }, d.prototype.freezeSelection = function() {
            return this.setCurrentAttribute("frozen", true);
          }, d.prototype.thawSelection = function() {
            return this.removeCurrentAttribute("frozen");
          }, d.prototype.hasFrozenSelection = function() {
            return this.hasCurrentAttribute("frozen");
          }, d.proxyMethod("getSelectionManager().getPointRange"), d.proxyMethod("getSelectionManager().setLocationRangeFromPointRange"), d.proxyMethod("getSelectionManager().createLocationRangeFromDOMRange"), d.proxyMethod("getSelectionManager().locationIsCursorTarget"), d.proxyMethod("getSelectionManager().selectionIsExpanded"), d.proxyMethod("delegate?.getSelectionManager"), d.prototype.setSelection = function(t3) {
            var e2, n2;
            return e2 = this.document.locationRangeFromRange(t3), (n2 = this.delegate) != null ? n2.compositionDidRequestChangingSelectionToLocationRange(e2) : void 0;
          }, d.prototype.getSelectedRange = function() {
            var t3;
            return (t3 = this.getLocationRange()) ? this.document.rangeFromLocationRange(t3) : void 0;
          }, d.prototype.setSelectedRange = function(t3) {
            var e2;
            return e2 = this.document.locationRangeFromRange(t3), this.getSelectionManager().setLocationRange(e2);
          }, d.prototype.getPosition = function() {
            var t3;
            return (t3 = this.getLocationRange()) ? this.document.positionFromLocation(t3[0]) : void 0;
          }, d.prototype.getLocationRange = function(t3) {
            var e2, n2;
            return (e2 = (n2 = this.targetLocationRange) != null ? n2 : this.getSelectionManager().getLocationRange(t3)) != null ? e2 : s({index: 0, offset: 0});
          }, d.prototype.withTargetLocationRange = function(t3, e2) {
            var n2;
            this.targetLocationRange = t3;
            try {
              n2 = e2();
            } finally {
              this.targetLocationRange = null;
            }
            return n2;
          }, d.prototype.withTargetRange = function(t3, e2) {
            var n2;
            return n2 = this.document.locationRangeFromRange(t3), this.withTargetLocationRange(n2, e2);
          }, d.prototype.withTargetDOMRange = function(t3, e2) {
            var n2;
            return n2 = this.createLocationRangeFromDOMRange(t3, {strict: false}), this.withTargetLocationRange(n2, e2);
          }, d.prototype.getExpandedRangeInDirection = function(t3, e2) {
            var n2, i2, o2, r2;
            return i2 = (e2 != null ? e2 : {}).length, o2 = this.getSelectedRange(), r2 = o2[0], n2 = o2[1], t3 === "backward" ? i2 ? r2 -= i2 : r2 = this.translateUTF16PositionFromOffset(r2, -1) : i2 ? n2 += i2 : n2 = this.translateUTF16PositionFromOffset(n2, 1), s([r2, n2]);
          }, d.prototype.shouldManageMovingCursorInDirection = function(t3) {
            var e2;
            return this.editingAttachment ? true : (e2 = this.getExpandedRangeInDirection(t3), this.getAttachmentAtRange(e2) != null);
          }, d.prototype.moveCursorInDirection = function(t3) {
            var e2, n2, i2, o2;
            return this.editingAttachment ? i2 = this.document.getRangeOfAttachment(this.editingAttachment) : (o2 = this.getSelectedRange(), i2 = this.getExpandedRangeInDirection(t3), n2 = !c(o2, i2)), this.setSelectedRange(t3 === "backward" ? i2[0] : i2[1]), n2 && (e2 = this.getAttachmentAtRange(i2)) ? this.editAttachment(e2) : void 0;
          }, d.prototype.expandSelectionInDirection = function(t3, e2) {
            var n2, i2;
            return n2 = (e2 != null ? e2 : {}).length, i2 = this.getExpandedRangeInDirection(t3, {length: n2}), this.setSelectedRange(i2);
          }, d.prototype.expandSelectionForEditing = function() {
            return this.hasCurrentAttribute("href") ? this.expandSelectionAroundCommonAttribute("href") : void 0;
          }, d.prototype.expandSelectionAroundCommonAttribute = function(t3) {
            var e2, n2;
            return e2 = this.getPosition(), n2 = this.document.getRangeOfCommonAttributeAtPosition(t3, e2), this.setSelectedRange(n2);
          }, d.prototype.selectionContainsAttachments = function() {
            var t3;
            return ((t3 = this.getSelectedAttachments()) != null ? t3.length : void 0) > 0;
          }, d.prototype.selectionIsInCursorTarget = function() {
            return this.editingAttachment || this.positionIsCursorTarget(this.getPosition());
          }, d.prototype.positionIsCursorTarget = function(t3) {
            var e2;
            return (e2 = this.document.locationFromPosition(t3)) ? this.locationIsCursorTarget(e2) : void 0;
          }, d.prototype.positionIsBlockBreak = function(t3) {
            var e2;
            return (e2 = this.document.getPieceAtPosition(t3)) != null ? e2.isBlockBreak() : void 0;
          }, d.prototype.getSelectedDocument = function() {
            var t3;
            return (t3 = this.getSelectedRange()) ? this.document.getDocumentAtRange(t3) : void 0;
          }, d.prototype.getSelectedAttachments = function() {
            var t3;
            return (t3 = this.getSelectedDocument()) != null ? t3.getAttachments() : void 0;
          }, d.prototype.getAttachments = function() {
            return this.attachments.slice(0);
          }, d.prototype.refreshAttachments = function() {
            var t3, e2, n2, i2, o2, r2, s2, a2, u2, c2, h2, p3;
            for (n2 = this.document.getAttachments(), a2 = l(this.attachments, n2), t3 = a2.added, h2 = a2.removed, this.attachments = n2, i2 = 0, r2 = h2.length; r2 > i2; i2++)
              e2 = h2[i2], e2.delegate = null, (u2 = this.delegate) != null && typeof u2.compositionDidRemoveAttachment == "function" && u2.compositionDidRemoveAttachment(e2);
            for (p3 = [], o2 = 0, s2 = t3.length; s2 > o2; o2++)
              e2 = t3[o2], e2.delegate = this, p3.push((c2 = this.delegate) != null && typeof c2.compositionDidAddAttachment == "function" ? c2.compositionDidAddAttachment(e2) : void 0);
            return p3;
          }, d.prototype.attachmentDidChangeAttributes = function(t3) {
            var e2;
            return this.revision++, (e2 = this.delegate) != null && typeof e2.compositionDidEditAttachment == "function" ? e2.compositionDidEditAttachment(t3) : void 0;
          }, d.prototype.attachmentDidChangePreviewURL = function(t3) {
            var e2;
            return this.revision++, (e2 = this.delegate) != null && typeof e2.compositionDidChangeAttachmentPreviewURL == "function" ? e2.compositionDidChangeAttachmentPreviewURL(t3) : void 0;
          }, d.prototype.editAttachment = function(t3, e2) {
            var n2;
            if (t3 !== this.editingAttachment)
              return this.stopEditingAttachment(), this.editingAttachment = t3, (n2 = this.delegate) != null && typeof n2.compositionDidStartEditingAttachment == "function" ? n2.compositionDidStartEditingAttachment(this.editingAttachment, e2) : void 0;
          }, d.prototype.stopEditingAttachment = function() {
            var t3;
            if (this.editingAttachment)
              return (t3 = this.delegate) != null && typeof t3.compositionDidStopEditingAttachment == "function" && t3.compositionDidStopEditingAttachment(this.editingAttachment), this.editingAttachment = null;
          }, d.prototype.updateAttributesForAttachment = function(t3, e2) {
            return this.setDocument(this.document.updateAttributesForAttachment(t3, e2));
          }, d.prototype.removeAttributeForAttachment = function(t3, e2) {
            return this.setDocument(this.document.removeAttributeForAttachment(t3, e2));
          }, d.prototype.breakFormattedBlock = function(t3) {
            var n2, i2, o2, r2, s2;
            return i2 = t3.document, n2 = t3.block, r2 = t3.startPosition, s2 = [r2 - 1, r2], n2.getBlockBreakPosition() === t3.startLocation.offset ? (n2.breaksOnReturn() && t3.nextCharacter === "\n" ? r2 += 1 : i2 = i2.removeTextAtRange(s2), s2 = [r2, r2]) : t3.nextCharacter === "\n" ? t3.previousCharacter === "\n" ? s2 = [r2 - 1, r2 + 1] : (s2 = [r2, r2 + 1], r2 += 1) : t3.startLocation.offset - 1 !== 0 && (r2 += 1), o2 = new e.Document([n2.removeLastAttribute().copyWithoutText()]), this.setDocument(i2.insertDocumentAtRange(o2, s2)), this.setSelection(r2);
          }, d.prototype.getPreviousBlock = function() {
            var t3, e2;
            return (e2 = this.getLocationRange()) && (t3 = e2[0].index, t3 > 0) ? this.document.getBlockAtIndex(t3 - 1) : void 0;
          }, d.prototype.getBlock = function() {
            var t3;
            return (t3 = this.getLocationRange()) ? this.document.getBlockAtIndex(t3[0].index) : void 0;
          }, d.prototype.getAttachmentAtRange = function(t3) {
            var n2;
            return n2 = this.document.getDocumentAtRange(t3), n2.toString() === e.OBJECT_REPLACEMENT_CHARACTER + "\n" ? n2.getAttachments()[0] : void 0;
          }, d.prototype.notifyDelegateOfCurrentAttributesChange = function() {
            var t3;
            return (t3 = this.delegate) != null && typeof t3.compositionDidChangeCurrentAttributes == "function" ? t3.compositionDidChangeCurrentAttributes(this.currentAttributes) : void 0;
          }, d.prototype.notifyDelegateOfInsertionAtRange = function(t3) {
            var e2;
            return (e2 = this.delegate) != null && typeof e2.compositionDidPerformInsertionAtRange == "function" ? e2.compositionDidPerformInsertionAtRange(t3) : void 0;
          }, d.prototype.translateUTF16PositionFromOffset = function(t3, e2) {
            var n2, i2;
            return i2 = this.document.toUTF16String(), n2 = i2.offsetFromUCS2Offset(t3), i2.offsetToUCS2Offset(n2 + e2);
          }, d;
        }(e.BasicObject);
      }.call(this), function() {
        var t2 = function(t3, e2) {
          function i() {
            this.constructor = t3;
          }
          for (var o in e2)
            n.call(e2, o) && (t3[o] = e2[o]);
          return i.prototype = e2.prototype, t3.prototype = new i(), t3.__super__ = e2.prototype, t3;
        }, n = {}.hasOwnProperty;
        e.UndoManager = function(e2) {
          function n2(t3) {
            this.composition = t3, this.undoEntries = [], this.redoEntries = [];
          }
          var i;
          return t2(n2, e2), n2.prototype.recordUndoEntry = function(t3, e3) {
            var n3, o, r, s, a;
            return s = e3 != null ? e3 : {}, o = s.context, n3 = s.consolidatable, r = this.undoEntries.slice(-1)[0], n3 && i(r, t3, o) ? void 0 : (a = this.createEntry({description: t3, context: o}), this.undoEntries.push(a), this.redoEntries = []);
          }, n2.prototype.undo = function() {
            var t3, e3;
            return (e3 = this.undoEntries.pop()) ? (t3 = this.createEntry(e3), this.redoEntries.push(t3), this.composition.loadSnapshot(e3.snapshot)) : void 0;
          }, n2.prototype.redo = function() {
            var t3, e3;
            return (t3 = this.redoEntries.pop()) ? (e3 = this.createEntry(t3), this.undoEntries.push(e3), this.composition.loadSnapshot(t3.snapshot)) : void 0;
          }, n2.prototype.canUndo = function() {
            return this.undoEntries.length > 0;
          }, n2.prototype.canRedo = function() {
            return this.redoEntries.length > 0;
          }, n2.prototype.createEntry = function(t3) {
            var e3, n3, i2;
            return i2 = t3 != null ? t3 : {}, n3 = i2.description, e3 = i2.context, {description: n3 != null ? n3.toString() : void 0, context: JSON.stringify(e3), snapshot: this.composition.getSnapshot()};
          }, i = function(t3, e3, n3) {
            return (t3 != null ? t3.description : void 0) === (e3 != null ? e3.toString() : void 0) && (t3 != null ? t3.context : void 0) === JSON.stringify(n3);
          }, n2;
        }(e.BasicObject);
      }.call(this), function() {
        var t2;
        e.attachmentGalleryFilter = function(e2) {
          var n;
          return n = new t2(e2), n.perform(), n.getSnapshot();
        }, t2 = function() {
          function t3(t4) {
            this.document = t4.document, this.selectedRange = t4.selectedRange;
          }
          var e2, n, i;
          return e2 = "attachmentGallery", n = "presentation", i = "gallery", t3.prototype.perform = function() {
            return this.removeBlockAttribute(), this.applyBlockAttribute();
          }, t3.prototype.getSnapshot = function() {
            return {document: this.document, selectedRange: this.selectedRange};
          }, t3.prototype.removeBlockAttribute = function() {
            var t4, n2, i2, o, r;
            for (o = this.findRangesOfBlocks(), r = [], t4 = 0, n2 = o.length; n2 > t4; t4++)
              i2 = o[t4], r.push(this.document = this.document.removeAttributeAtRange(e2, i2));
            return r;
          }, t3.prototype.applyBlockAttribute = function() {
            var t4, n2, i2, o, r, s;
            for (i2 = 0, r = this.findRangesOfPieces(), s = [], t4 = 0, n2 = r.length; n2 > t4; t4++)
              o = r[t4], o[1] - o[0] > 1 && (o[0] += i2, o[1] += i2, this.document.getCharacterAtPosition(o[1]) !== "\n" && (this.document = this.document.insertBlockBreakAtRange(o[1]), o[1] < this.selectedRange[1] && this.moveSelectedRangeForward(), o[1]++, i2++), o[0] !== 0 && this.document.getCharacterAtPosition(o[0] - 1) !== "\n" && (this.document = this.document.insertBlockBreakAtRange(o[0]), o[0] < this.selectedRange[0] && this.moveSelectedRangeForward(), o[0]++, i2++), s.push(this.document = this.document.applyBlockAttributeAtRange(e2, true, o)));
            return s;
          }, t3.prototype.findRangesOfBlocks = function() {
            return this.document.findRangesForBlockAttribute(e2);
          }, t3.prototype.findRangesOfPieces = function() {
            return this.document.findRangesForTextAttribute(n, {withValue: i});
          }, t3.prototype.moveSelectedRangeForward = function() {
            return this.selectedRange[0] += 1, this.selectedRange[1] += 1;
          }, t3;
        }();
      }.call(this), function() {
        var t2 = function(t3, e2) {
          return function() {
            return t3.apply(e2, arguments);
          };
        };
        e.Editor = function() {
          function n(n2, o, r) {
            this.composition = n2, this.selectionManager = o, this.element = r, this.insertFiles = t2(this.insertFiles, this), this.undoManager = new e.UndoManager(this.composition), this.filters = i.slice(0);
          }
          var i;
          return i = [e.attachmentGalleryFilter], n.prototype.loadDocument = function(t3) {
            return this.loadSnapshot({document: t3, selectedRange: [0, 0]});
          }, n.prototype.loadHTML = function(t3) {
            return t3 == null && (t3 = ""), this.loadDocument(e.Document.fromHTML(t3, {referenceElement: this.element}));
          }, n.prototype.loadJSON = function(t3) {
            var n2, i2;
            return n2 = t3.document, i2 = t3.selectedRange, n2 = e.Document.fromJSON(n2), this.loadSnapshot({document: n2, selectedRange: i2});
          }, n.prototype.loadSnapshot = function(t3) {
            return this.undoManager = new e.UndoManager(this.composition), this.composition.loadSnapshot(t3);
          }, n.prototype.getDocument = function() {
            return this.composition.document;
          }, n.prototype.getSelectedDocument = function() {
            return this.composition.getSelectedDocument();
          }, n.prototype.getSnapshot = function() {
            return this.composition.getSnapshot();
          }, n.prototype.toJSON = function() {
            return this.getSnapshot();
          }, n.prototype.deleteInDirection = function(t3) {
            return this.composition.deleteInDirection(t3);
          }, n.prototype.insertAttachment = function(t3) {
            return this.composition.insertAttachment(t3);
          }, n.prototype.insertAttachments = function(t3) {
            return this.composition.insertAttachments(t3);
          }, n.prototype.insertDocument = function(t3) {
            return this.composition.insertDocument(t3);
          }, n.prototype.insertFile = function(t3) {
            return this.composition.insertFile(t3);
          }, n.prototype.insertFiles = function(t3) {
            return this.composition.insertFiles(t3);
          }, n.prototype.insertHTML = function(t3) {
            return this.composition.insertHTML(t3);
          }, n.prototype.insertString = function(t3) {
            return this.composition.insertString(t3);
          }, n.prototype.insertText = function(t3) {
            return this.composition.insertText(t3);
          }, n.prototype.insertLineBreak = function() {
            return this.composition.insertLineBreak();
          }, n.prototype.getSelectedRange = function() {
            return this.composition.getSelectedRange();
          }, n.prototype.getPosition = function() {
            return this.composition.getPosition();
          }, n.prototype.getClientRectAtPosition = function(t3) {
            var e2;
            return e2 = this.getDocument().locationRangeFromRange([t3, t3 + 1]), this.selectionManager.getClientRectAtLocationRange(e2);
          }, n.prototype.expandSelectionInDirection = function(t3) {
            return this.composition.expandSelectionInDirection(t3);
          }, n.prototype.moveCursorInDirection = function(t3) {
            return this.composition.moveCursorInDirection(t3);
          }, n.prototype.setSelectedRange = function(t3) {
            return this.composition.setSelectedRange(t3);
          }, n.prototype.activateAttribute = function(t3, e2) {
            return e2 == null && (e2 = true), this.composition.setCurrentAttribute(t3, e2);
          }, n.prototype.attributeIsActive = function(t3) {
            return this.composition.hasCurrentAttribute(t3);
          }, n.prototype.canActivateAttribute = function(t3) {
            return this.composition.canSetCurrentAttribute(t3);
          }, n.prototype.deactivateAttribute = function(t3) {
            return this.composition.removeCurrentAttribute(t3);
          }, n.prototype.canDecreaseNestingLevel = function() {
            return this.composition.canDecreaseNestingLevel();
          }, n.prototype.canIncreaseNestingLevel = function() {
            return this.composition.canIncreaseNestingLevel();
          }, n.prototype.decreaseNestingLevel = function() {
            return this.canDecreaseNestingLevel() ? this.composition.decreaseNestingLevel() : void 0;
          }, n.prototype.increaseNestingLevel = function() {
            return this.canIncreaseNestingLevel() ? this.composition.increaseNestingLevel() : void 0;
          }, n.prototype.canRedo = function() {
            return this.undoManager.canRedo();
          }, n.prototype.canUndo = function() {
            return this.undoManager.canUndo();
          }, n.prototype.recordUndoEntry = function(t3, e2) {
            var n2, i2, o;
            return o = e2 != null ? e2 : {}, i2 = o.context, n2 = o.consolidatable, this.undoManager.recordUndoEntry(t3, {context: i2, consolidatable: n2});
          }, n.prototype.redo = function() {
            return this.canRedo() ? this.undoManager.redo() : void 0;
          }, n.prototype.undo = function() {
            return this.canUndo() ? this.undoManager.undo() : void 0;
          }, n;
        }();
      }.call(this), function() {
        var t2 = function(t3, e2) {
          function i() {
            this.constructor = t3;
          }
          for (var o in e2)
            n.call(e2, o) && (t3[o] = e2[o]);
          return i.prototype = e2.prototype, t3.prototype = new i(), t3.__super__ = e2.prototype, t3;
        }, n = {}.hasOwnProperty;
        e.ManagedAttachment = function(e2) {
          function n2(t3, e3) {
            var n3;
            this.attachmentManager = t3, this.attachment = e3, n3 = this.attachment, this.id = n3.id, this.file = n3.file;
          }
          return t2(n2, e2), n2.prototype.remove = function() {
            return this.attachmentManager.requestRemovalOfAttachment(this.attachment);
          }, n2.proxyMethod("attachment.getAttribute"), n2.proxyMethod("attachment.hasAttribute"), n2.proxyMethod("attachment.setAttribute"), n2.proxyMethod("attachment.getAttributes"), n2.proxyMethod("attachment.setAttributes"), n2.proxyMethod("attachment.isPending"), n2.proxyMethod("attachment.isPreviewable"), n2.proxyMethod("attachment.getURL"), n2.proxyMethod("attachment.getHref"), n2.proxyMethod("attachment.getFilename"), n2.proxyMethod("attachment.getFilesize"), n2.proxyMethod("attachment.getFormattedFilesize"), n2.proxyMethod("attachment.getExtension"), n2.proxyMethod("attachment.getContentType"), n2.proxyMethod("attachment.getFile"), n2.proxyMethod("attachment.setFile"), n2.proxyMethod("attachment.releaseFile"), n2.proxyMethod("attachment.getUploadProgress"), n2.proxyMethod("attachment.setUploadProgress"), n2;
        }(e.BasicObject);
      }.call(this), function() {
        var t2 = function(t3, e2) {
          function i() {
            this.constructor = t3;
          }
          for (var o in e2)
            n.call(e2, o) && (t3[o] = e2[o]);
          return i.prototype = e2.prototype, t3.prototype = new i(), t3.__super__ = e2.prototype, t3;
        }, n = {}.hasOwnProperty;
        e.AttachmentManager = function(n2) {
          function i(t3) {
            var e2, n3, i2;
            for (t3 == null && (t3 = []), this.managedAttachments = {}, n3 = 0, i2 = t3.length; i2 > n3; n3++)
              e2 = t3[n3], this.manageAttachment(e2);
          }
          return t2(i, n2), i.prototype.getAttachments = function() {
            var t3, e2, n3, i2;
            n3 = this.managedAttachments, i2 = [];
            for (e2 in n3)
              t3 = n3[e2], i2.push(t3);
            return i2;
          }, i.prototype.manageAttachment = function(t3) {
            var n3, i2;
            return (n3 = this.managedAttachments)[i2 = t3.id] != null ? n3[i2] : n3[i2] = new e.ManagedAttachment(this, t3);
          }, i.prototype.attachmentIsManaged = function(t3) {
            return t3.id in this.managedAttachments;
          }, i.prototype.requestRemovalOfAttachment = function(t3) {
            var e2;
            return this.attachmentIsManaged(t3) && (e2 = this.delegate) != null && typeof e2.attachmentManagerDidRequestRemovalOfAttachment == "function" ? e2.attachmentManagerDidRequestRemovalOfAttachment(t3) : void 0;
          }, i.prototype.unmanageAttachment = function(t3) {
            var e2;
            return e2 = this.managedAttachments[t3.id], delete this.managedAttachments[t3.id], e2;
          }, i;
        }(e.BasicObject);
      }.call(this), function() {
        var t2, n, i, o, r, s, a, u, c, l, h;
        t2 = e.elementContainsNode, n = e.findChildIndexOfNode, r = e.nodeIsBlockStart, s = e.nodeIsBlockStartComment, o = e.nodeIsBlockContainer, a = e.nodeIsCursorTarget, u = e.nodeIsEmptyTextNode, c = e.nodeIsTextNode, i = e.nodeIsAttachmentElement, l = e.tagName, h = e.walkTree, e.LocationMapper = function() {
          function e2(t3) {
            this.element = t3;
          }
          var p, d, f, g;
          return e2.prototype.findLocationFromContainerAndOffset = function(e3, i2, o2) {
            var s2, u2, l2, p2, g2, m, v;
            for (m = (o2 != null ? o2 : {strict: true}).strict, u2 = 0, l2 = false, p2 = {index: 0, offset: 0}, (s2 = this.findAttachmentElementParentForNode(e3)) && (e3 = s2.parentNode, i2 = n(s2)), v = h(this.element, {usingFilter: f}); v.nextNode(); ) {
              if (g2 = v.currentNode, g2 === e3 && c(e3)) {
                a(g2) || (p2.offset += i2);
                break;
              }
              if (g2.parentNode === e3) {
                if (u2++ === i2)
                  break;
              } else if (!t2(e3, g2) && u2 > 0)
                break;
              r(g2, {strict: m}) ? (l2 && p2.index++, p2.offset = 0, l2 = true) : p2.offset += d(g2);
            }
            return p2;
          }, e2.prototype.findContainerAndOffsetFromLocation = function(t3) {
            var e3, i2, s2, u2, l2;
            if (t3.index === 0 && t3.offset === 0) {
              for (e3 = this.element, u2 = 0; e3.firstChild; )
                if (e3 = e3.firstChild, o(e3)) {
                  u2 = 1;
                  break;
                }
              return [e3, u2];
            }
            if (l2 = this.findNodeAndOffsetFromLocation(t3), i2 = l2[0], s2 = l2[1], i2) {
              if (c(i2))
                d(i2) === 0 ? (e3 = i2.parentNode.parentNode, u2 = n(i2.parentNode), a(i2, {name: "right"}) && u2++) : (e3 = i2, u2 = t3.offset - s2);
              else {
                if (e3 = i2.parentNode, !r(i2.previousSibling) && !o(e3))
                  for (; i2 === e3.lastChild && (i2 = e3, e3 = e3.parentNode, !o(e3)); )
                    ;
                u2 = n(i2), t3.offset !== 0 && u2++;
              }
              return [e3, u2];
            }
          }, e2.prototype.findNodeAndOffsetFromLocation = function(t3) {
            var e3, n2, i2, o2, r2, s2, u2, l2;
            for (u2 = 0, l2 = this.getSignificantNodesForIndex(t3.index), n2 = 0, i2 = l2.length; i2 > n2; n2++) {
              if (e3 = l2[n2], o2 = d(e3), t3.offset <= u2 + o2)
                if (c(e3)) {
                  if (r2 = e3, s2 = u2, t3.offset === s2 && a(r2))
                    break;
                } else
                  r2 || (r2 = e3, s2 = u2);
              if (u2 += o2, u2 > t3.offset)
                break;
            }
            return [r2, s2];
          }, e2.prototype.findAttachmentElementParentForNode = function(t3) {
            for (; t3 && t3 !== this.element; ) {
              if (i(t3))
                return t3;
              t3 = t3.parentNode;
            }
          }, e2.prototype.getSignificantNodesForIndex = function(t3) {
            var e3, n2, i2, o2, r2;
            for (i2 = [], r2 = h(this.element, {usingFilter: p}), o2 = false; r2.nextNode(); )
              if (n2 = r2.currentNode, s(n2)) {
                if (typeof e3 != "undefined" && e3 !== null ? e3++ : e3 = 0, e3 === t3)
                  o2 = true;
                else if (o2)
                  break;
              } else
                o2 && i2.push(n2);
            return i2;
          }, d = function(t3) {
            var e3;
            return t3.nodeType === Node.TEXT_NODE ? a(t3) ? 0 : (e3 = t3.textContent, e3.length) : l(t3) === "br" || i(t3) ? 1 : 0;
          }, p = function(t3) {
            return g(t3) === NodeFilter.FILTER_ACCEPT ? f(t3) : NodeFilter.FILTER_REJECT;
          }, g = function(t3) {
            return u(t3) ? NodeFilter.FILTER_REJECT : NodeFilter.FILTER_ACCEPT;
          }, f = function(t3) {
            return i(t3.parentNode) ? NodeFilter.FILTER_REJECT : NodeFilter.FILTER_ACCEPT;
          }, e2;
        }();
      }.call(this), function() {
        var t2, n, i = [].slice;
        t2 = e.getDOMRange, n = e.setDOMRange, e.PointMapper = function() {
          function e2() {
          }
          return e2.prototype.createDOMRangeFromPoint = function(e3) {
            var i2, o, r, s, a, u, c, l;
            if (c = e3.x, l = e3.y, document.caretPositionFromPoint)
              return a = document.caretPositionFromPoint(c, l), r = a.offsetNode, o = a.offset, i2 = document.createRange(), i2.setStart(r, o), i2;
            if (document.caretRangeFromPoint)
              return document.caretRangeFromPoint(c, l);
            if (document.body.createTextRange) {
              s = t2();
              try {
                u = document.body.createTextRange(), u.moveToPoint(c, l), u.select();
              } catch (h) {
              }
              return i2 = t2(), n(s), i2;
            }
          }, e2.prototype.getClientRectsForDOMRange = function(t3) {
            var e3, n2, o;
            return n2 = i.call(t3.getClientRects()), o = n2[0], e3 = n2[n2.length - 1], [o, e3];
          }, e2;
        }();
      }.call(this), function() {
        var t2, n = function(t3, e2) {
          return function() {
            return t3.apply(e2, arguments);
          };
        }, i = function(t3, e2) {
          function n2() {
            this.constructor = t3;
          }
          for (var i2 in e2)
            o.call(e2, i2) && (t3[i2] = e2[i2]);
          return n2.prototype = e2.prototype, t3.prototype = new n2(), t3.__super__ = e2.prototype, t3;
        }, o = {}.hasOwnProperty, r = [].indexOf || function(t3) {
          for (var e2 = 0, n2 = this.length; n2 > e2; e2++)
            if (e2 in this && this[e2] === t3)
              return e2;
          return -1;
        };
        t2 = e.getDOMRange, e.SelectionChangeObserver = function(e2) {
          function o2() {
            this.run = n(this.run, this), this.update = n(this.update, this), this.selectionManagers = [];
          }
          var s;
          return i(o2, e2), o2.prototype.start = function() {
            return this.started ? void 0 : (this.started = true, "onselectionchange" in document ? document.addEventListener("selectionchange", this.update, true) : this.run());
          }, o2.prototype.stop = function() {
            return this.started ? (this.started = false, document.removeEventListener("selectionchange", this.update, true)) : void 0;
          }, o2.prototype.registerSelectionManager = function(t3) {
            return r.call(this.selectionManagers, t3) < 0 ? (this.selectionManagers.push(t3), this.start()) : void 0;
          }, o2.prototype.unregisterSelectionManager = function(t3) {
            var e3;
            return this.selectionManagers = function() {
              var n2, i2, o3, r2;
              for (o3 = this.selectionManagers, r2 = [], n2 = 0, i2 = o3.length; i2 > n2; n2++)
                e3 = o3[n2], e3 !== t3 && r2.push(e3);
              return r2;
            }.call(this), this.selectionManagers.length === 0 ? this.stop() : void 0;
          }, o2.prototype.notifySelectionManagersOfSelectionChange = function() {
            var t3, e3, n2, i2, o3;
            for (n2 = this.selectionManagers, i2 = [], t3 = 0, e3 = n2.length; e3 > t3; t3++)
              o3 = n2[t3], i2.push(o3.selectionDidChange());
            return i2;
          }, o2.prototype.update = function() {
            var e3;
            return e3 = t2(), s(e3, this.domRange) ? void 0 : (this.domRange = e3, this.notifySelectionManagersOfSelectionChange());
          }, o2.prototype.reset = function() {
            return this.domRange = null, this.update();
          }, o2.prototype.run = function() {
            return this.started ? (this.update(), requestAnimationFrame(this.run)) : void 0;
          }, s = function(t3, e3) {
            return (t3 != null ? t3.startContainer : void 0) === (e3 != null ? e3.startContainer : void 0) && (t3 != null ? t3.startOffset : void 0) === (e3 != null ? e3.startOffset : void 0) && (t3 != null ? t3.endContainer : void 0) === (e3 != null ? e3.endContainer : void 0) && (t3 != null ? t3.endOffset : void 0) === (e3 != null ? e3.endOffset : void 0);
          }, o2;
        }(e.BasicObject), e.selectionChangeObserver == null && (e.selectionChangeObserver = new e.SelectionChangeObserver());
      }.call(this), function() {
        var t2, n, i, o, r, s, a, u, c, l, h = function(t3, e2) {
          return function() {
            return t3.apply(e2, arguments);
          };
        }, p = function(t3, e2) {
          function n2() {
            this.constructor = t3;
          }
          for (var i2 in e2)
            d.call(e2, i2) && (t3[i2] = e2[i2]);
          return n2.prototype = e2.prototype, t3.prototype = new n2(), t3.__super__ = e2.prototype, t3;
        }, d = {}.hasOwnProperty;
        i = e.getDOMSelection, n = e.getDOMRange, l = e.setDOMRange, t2 = e.elementContainsNode, s = e.nodeIsCursorTarget, r = e.innerElementIsActive, o = e.handleEvent, a = e.normalizeRange, u = e.rangeIsCollapsed, c = e.rangesAreEqual, e.SelectionManager = function(d2) {
          function f(t3) {
            this.element = t3, this.selectionDidChange = h(this.selectionDidChange, this), this.didMouseDown = h(this.didMouseDown, this), this.locationMapper = new e.LocationMapper(this.element), this.pointMapper = new e.PointMapper(), this.lockCount = 0, o("mousedown", {onElement: this.element, withCallback: this.didMouseDown});
          }
          return p(f, d2), f.prototype.getLocationRange = function(t3) {
            var e2, i2;
            return t3 == null && (t3 = {}), e2 = t3.strict === false ? this.createLocationRangeFromDOMRange(n(), {strict: false}) : t3.ignoreLock ? this.currentLocationRange : (i2 = this.lockedLocationRange) != null ? i2 : this.currentLocationRange;
          }, f.prototype.setLocationRange = function(t3) {
            var e2;
            if (!this.lockedLocationRange)
              return t3 = a(t3), (e2 = this.createDOMRangeFromLocationRange(t3)) ? (l(e2), this.updateCurrentLocationRange(t3)) : void 0;
          }, f.prototype.setLocationRangeFromPointRange = function(t3) {
            var e2, n2;
            return t3 = a(t3), n2 = this.getLocationAtPoint(t3[0]), e2 = this.getLocationAtPoint(t3[1]), this.setLocationRange([n2, e2]);
          }, f.prototype.getClientRectAtLocationRange = function(t3) {
            var e2;
            return (e2 = this.createDOMRangeFromLocationRange(t3)) ? this.getClientRectsForDOMRange(e2)[1] : void 0;
          }, f.prototype.locationIsCursorTarget = function(t3) {
            var e2, n2, i2;
            return i2 = this.findNodeAndOffsetFromLocation(t3), e2 = i2[0], n2 = i2[1], s(e2);
          }, f.prototype.lock = function() {
            return this.lockCount++ === 0 ? (this.updateCurrentLocationRange(), this.lockedLocationRange = this.getLocationRange()) : void 0;
          }, f.prototype.unlock = function() {
            var t3;
            return --this.lockCount === 0 && (t3 = this.lockedLocationRange, this.lockedLocationRange = null, t3 != null) ? this.setLocationRange(t3) : void 0;
          }, f.prototype.clearSelection = function() {
            var t3;
            return (t3 = i()) != null ? t3.removeAllRanges() : void 0;
          }, f.prototype.selectionIsCollapsed = function() {
            var t3;
            return ((t3 = n()) != null ? t3.collapsed : void 0) === true;
          }, f.prototype.selectionIsExpanded = function() {
            return !this.selectionIsCollapsed();
          }, f.prototype.createLocationRangeFromDOMRange = function(t3, e2) {
            var n2, i2;
            if (t3 != null && this.domRangeWithinElement(t3) && (i2 = this.findLocationFromContainerAndOffset(t3.startContainer, t3.startOffset, e2)))
              return t3.collapsed || (n2 = this.findLocationFromContainerAndOffset(t3.endContainer, t3.endOffset, e2)), a([i2, n2]);
          }, f.proxyMethod("locationMapper.findLocationFromContainerAndOffset"), f.proxyMethod("locationMapper.findContainerAndOffsetFromLocation"), f.proxyMethod("locationMapper.findNodeAndOffsetFromLocation"), f.proxyMethod("pointMapper.createDOMRangeFromPoint"), f.proxyMethod("pointMapper.getClientRectsForDOMRange"), f.prototype.didMouseDown = function() {
            return this.pauseTemporarily();
          }, f.prototype.pauseTemporarily = function() {
            var e2, n2, i2, r2;
            return this.paused = true, n2 = function(e3) {
              return function() {
                var n3, o2, s2;
                for (e3.paused = false, clearTimeout(r2), o2 = 0, s2 = i2.length; s2 > o2; o2++)
                  n3 = i2[o2], n3.destroy();
                return t2(document, e3.element) ? e3.selectionDidChange() : void 0;
              };
            }(this), r2 = setTimeout(n2, 200), i2 = function() {
              var t3, i3, r3, s2;
              for (r3 = ["mousemove", "keydown"], s2 = [], t3 = 0, i3 = r3.length; i3 > t3; t3++)
                e2 = r3[t3], s2.push(o(e2, {onElement: document, withCallback: n2}));
              return s2;
            }();
          }, f.prototype.selectionDidChange = function() {
            return this.paused || r(this.element) ? void 0 : this.updateCurrentLocationRange();
          }, f.prototype.updateCurrentLocationRange = function(t3) {
            var e2;
            return (t3 != null ? t3 : t3 = this.createLocationRangeFromDOMRange(n())) && !c(t3, this.currentLocationRange) ? (this.currentLocationRange = t3, (e2 = this.delegate) != null && typeof e2.locationRangeDidChange == "function" ? e2.locationRangeDidChange(this.currentLocationRange.slice(0)) : void 0) : void 0;
          }, f.prototype.createDOMRangeFromLocationRange = function(t3) {
            var e2, n2, i2, o2;
            return i2 = this.findContainerAndOffsetFromLocation(t3[0]), n2 = u(t3) ? i2 : (o2 = this.findContainerAndOffsetFromLocation(t3[1])) != null ? o2 : i2, i2 != null && n2 != null ? (e2 = document.createRange(), e2.setStart.apply(e2, i2), e2.setEnd.apply(e2, n2), e2) : void 0;
          }, f.prototype.getLocationAtPoint = function(t3) {
            var e2, n2;
            return (e2 = this.createDOMRangeFromPoint(t3)) && (n2 = this.createLocationRangeFromDOMRange(e2)) != null ? n2[0] : void 0;
          }, f.prototype.domRangeWithinElement = function(e2) {
            return e2.collapsed ? t2(this.element, e2.startContainer) : t2(this.element, e2.startContainer) && t2(this.element, e2.endContainer);
          }, f;
        }(e.BasicObject);
      }.call(this), function() {
        var t2, n, i, o, r = function(t3, e2) {
          function n2() {
            this.constructor = t3;
          }
          for (var i2 in e2)
            s.call(e2, i2) && (t3[i2] = e2[i2]);
          return n2.prototype = e2.prototype, t3.prototype = new n2(), t3.__super__ = e2.prototype, t3;
        }, s = {}.hasOwnProperty, a = [].slice;
        i = e.rangeIsCollapsed, o = e.rangesAreEqual, n = e.objectsAreEqual, t2 = e.getBlockConfig, e.EditorController = function(s2) {
          function u(t3) {
            var n2, i2;
            this.editorElement = t3.editorElement, n2 = t3.document, i2 = t3.html, this.selectionManager = new e.SelectionManager(this.editorElement), this.selectionManager.delegate = this, this.composition = new e.Composition(), this.composition.delegate = this, this.attachmentManager = new e.AttachmentManager(this.composition.getAttachments()), this.attachmentManager.delegate = this, this.inputController = new e["Level" + e.config.input.getLevel() + "InputController"](this.editorElement), this.inputController.delegate = this, this.inputController.responder = this.composition, this.compositionController = new e.CompositionController(this.editorElement, this.composition), this.compositionController.delegate = this, this.toolbarController = new e.ToolbarController(this.editorElement.toolbarElement), this.toolbarController.delegate = this, this.editor = new e.Editor(this.composition, this.selectionManager, this.editorElement), n2 != null ? this.editor.loadDocument(n2) : this.editor.loadHTML(i2);
          }
          var c;
          return r(u, s2), u.prototype.registerSelectionManager = function() {
            return e.selectionChangeObserver.registerSelectionManager(this.selectionManager);
          }, u.prototype.unregisterSelectionManager = function() {
            return e.selectionChangeObserver.unregisterSelectionManager(this.selectionManager);
          }, u.prototype.render = function() {
            return this.compositionController.render();
          }, u.prototype.reparse = function() {
            return this.composition.replaceHTML(this.editorElement.innerHTML);
          }, u.prototype.compositionDidChangeDocument = function() {
            return this.notifyEditorElement("document-change"), this.handlingInput ? void 0 : this.render();
          }, u.prototype.compositionDidChangeCurrentAttributes = function(t3) {
            return this.currentAttributes = t3, this.toolbarController.updateAttributes(this.currentAttributes), this.updateCurrentActions(), this.notifyEditorElement("attributes-change", {attributes: this.currentAttributes});
          }, u.prototype.compositionDidPerformInsertionAtRange = function(t3) {
            return this.pasting ? this.pastedRange = t3 : void 0;
          }, u.prototype.compositionShouldAcceptFile = function(t3) {
            return this.notifyEditorElement("file-accept", {file: t3});
          }, u.prototype.compositionDidAddAttachment = function(t3) {
            var e2;
            return e2 = this.attachmentManager.manageAttachment(t3), this.notifyEditorElement("attachment-add", {attachment: e2});
          }, u.prototype.compositionDidEditAttachment = function(t3) {
            var e2;
            return this.compositionController.rerenderViewForObject(t3), e2 = this.attachmentManager.manageAttachment(t3), this.notifyEditorElement("attachment-edit", {attachment: e2}), this.notifyEditorElement("change");
          }, u.prototype.compositionDidChangeAttachmentPreviewURL = function(t3) {
            return this.compositionController.invalidateViewForObject(t3), this.notifyEditorElement("change");
          }, u.prototype.compositionDidRemoveAttachment = function(t3) {
            var e2;
            return e2 = this.attachmentManager.unmanageAttachment(t3), this.notifyEditorElement("attachment-remove", {attachment: e2});
          }, u.prototype.compositionDidStartEditingAttachment = function(t3, e2) {
            return this.attachmentLocationRange = this.composition.document.getLocationRangeOfAttachment(t3), this.compositionController.installAttachmentEditorForAttachment(t3, e2), this.selectionManager.setLocationRange(this.attachmentLocationRange);
          }, u.prototype.compositionDidStopEditingAttachment = function() {
            return this.compositionController.uninstallAttachmentEditor(), this.attachmentLocationRange = null;
          }, u.prototype.compositionDidRequestChangingSelectionToLocationRange = function(t3) {
            return !this.loadingSnapshot || this.isFocused() ? (this.requestedLocationRange = t3, this.compositionRevisionWhenLocationRangeRequested = this.composition.revision, this.handlingInput ? void 0 : this.render()) : void 0;
          }, u.prototype.compositionWillLoadSnapshot = function() {
            return this.loadingSnapshot = true;
          }, u.prototype.compositionDidLoadSnapshot = function() {
            return this.compositionController.refreshViewCache(), this.render(), this.loadingSnapshot = false;
          }, u.prototype.getSelectionManager = function() {
            return this.selectionManager;
          }, u.proxyMethod("getSelectionManager().setLocationRange"), u.proxyMethod("getSelectionManager().getLocationRange"), u.prototype.attachmentManagerDidRequestRemovalOfAttachment = function(t3) {
            return this.removeAttachment(t3);
          }, u.prototype.compositionControllerWillSyncDocumentView = function() {
            return this.inputController.editorWillSyncDocumentView(), this.selectionManager.lock(), this.selectionManager.clearSelection();
          }, u.prototype.compositionControllerDidSyncDocumentView = function() {
            return this.inputController.editorDidSyncDocumentView(), this.selectionManager.unlock(), this.updateCurrentActions(), this.notifyEditorElement("sync");
          }, u.prototype.compositionControllerDidRender = function() {
            return this.requestedLocationRange != null && (this.compositionRevisionWhenLocationRangeRequested === this.composition.revision && this.selectionManager.setLocationRange(this.requestedLocationRange), this.requestedLocationRange = null, this.compositionRevisionWhenLocationRangeRequested = null), this.renderedCompositionRevision !== this.composition.revision && (this.runEditorFilters(), this.composition.updateCurrentAttributes(), this.notifyEditorElement("render")), this.renderedCompositionRevision = this.composition.revision;
          }, u.prototype.compositionControllerDidFocus = function() {
            return this.isFocusedInvisibly() && this.setLocationRange({index: 0, offset: 0}), this.toolbarController.hideDialog(), this.notifyEditorElement("focus");
          }, u.prototype.compositionControllerDidBlur = function() {
            return this.notifyEditorElement("blur");
          }, u.prototype.compositionControllerDidSelectAttachment = function(t3, e2) {
            return this.toolbarController.hideDialog(), this.composition.editAttachment(t3, e2);
          }, u.prototype.compositionControllerDidRequestDeselectingAttachment = function(t3) {
            var e2, n2;
            return e2 = (n2 = this.attachmentLocationRange) != null ? n2 : this.composition.document.getLocationRangeOfAttachment(t3), this.selectionManager.setLocationRange(e2[1]);
          }, u.prototype.compositionControllerWillUpdateAttachment = function(t3) {
            return this.editor.recordUndoEntry("Edit Attachment", {context: t3.id, consolidatable: true});
          }, u.prototype.compositionControllerDidRequestRemovalOfAttachment = function(t3) {
            return this.removeAttachment(t3);
          }, u.prototype.inputControllerWillHandleInput = function() {
            return this.handlingInput = true, this.requestedRender = false;
          }, u.prototype.inputControllerDidRequestRender = function() {
            return this.requestedRender = true;
          }, u.prototype.inputControllerDidHandleInput = function() {
            return this.handlingInput = false, this.requestedRender ? (this.requestedRender = false, this.render()) : void 0;
          }, u.prototype.inputControllerDidAllowUnhandledInput = function() {
            return this.notifyEditorElement("change");
          }, u.prototype.inputControllerDidRequestReparse = function() {
            return this.reparse();
          }, u.prototype.inputControllerWillPerformTyping = function() {
            return this.recordTypingUndoEntry();
          }, u.prototype.inputControllerWillPerformFormatting = function(t3) {
            return this.recordFormattingUndoEntry(t3);
          }, u.prototype.inputControllerWillCutText = function() {
            return this.editor.recordUndoEntry("Cut");
          }, u.prototype.inputControllerWillPaste = function(t3) {
            return this.editor.recordUndoEntry("Paste"), this.pasting = true, this.notifyEditorElement("before-paste", {paste: t3});
          }, u.prototype.inputControllerDidPaste = function(t3) {
            return t3.range = this.pastedRange, this.pastedRange = null, this.pasting = null, this.notifyEditorElement("paste", {paste: t3});
          }, u.prototype.inputControllerWillMoveText = function() {
            return this.editor.recordUndoEntry("Move");
          }, u.prototype.inputControllerWillAttachFiles = function() {
            return this.editor.recordUndoEntry("Drop Files");
          }, u.prototype.inputControllerWillPerformUndo = function() {
            return this.editor.undo();
          }, u.prototype.inputControllerWillPerformRedo = function() {
            return this.editor.redo();
          }, u.prototype.inputControllerDidReceiveKeyboardCommand = function(t3) {
            return this.toolbarController.applyKeyboardCommand(t3);
          }, u.prototype.inputControllerDidStartDrag = function() {
            return this.locationRangeBeforeDrag = this.selectionManager.getLocationRange();
          }, u.prototype.inputControllerDidReceiveDragOverPoint = function(t3) {
            return this.selectionManager.setLocationRangeFromPointRange(t3);
          }, u.prototype.inputControllerDidCancelDrag = function() {
            return this.selectionManager.setLocationRange(this.locationRangeBeforeDrag), this.locationRangeBeforeDrag = null;
          }, u.prototype.locationRangeDidChange = function(t3) {
            return this.composition.updateCurrentAttributes(), this.updateCurrentActions(), this.attachmentLocationRange && !o(this.attachmentLocationRange, t3) && this.composition.stopEditingAttachment(), this.notifyEditorElement("selection-change");
          }, u.prototype.toolbarDidClickButton = function() {
            return this.getLocationRange() ? void 0 : this.setLocationRange({index: 0, offset: 0});
          }, u.prototype.toolbarDidInvokeAction = function(t3) {
            return this.invokeAction(t3);
          }, u.prototype.toolbarDidToggleAttribute = function(t3) {
            return this.recordFormattingUndoEntry(t3), this.composition.toggleCurrentAttribute(t3), this.render(), this.selectionFrozen ? void 0 : this.editorElement.focus();
          }, u.prototype.toolbarDidUpdateAttribute = function(t3, e2) {
            return this.recordFormattingUndoEntry(t3), this.composition.setCurrentAttribute(t3, e2), this.render(), this.selectionFrozen ? void 0 : this.editorElement.focus();
          }, u.prototype.toolbarDidRemoveAttribute = function(t3) {
            return this.recordFormattingUndoEntry(t3), this.composition.removeCurrentAttribute(t3), this.render(), this.selectionFrozen ? void 0 : this.editorElement.focus();
          }, u.prototype.toolbarWillShowDialog = function() {
            return this.composition.expandSelectionForEditing(), this.freezeSelection();
          }, u.prototype.toolbarDidShowDialog = function(t3) {
            return this.notifyEditorElement("toolbar-dialog-show", {dialogName: t3});
          }, u.prototype.toolbarDidHideDialog = function(t3) {
            return this.thawSelection(), this.editorElement.focus(), this.notifyEditorElement("toolbar-dialog-hide", {dialogName: t3});
          }, u.prototype.freezeSelection = function() {
            return this.selectionFrozen ? void 0 : (this.selectionManager.lock(), this.composition.freezeSelection(), this.selectionFrozen = true, this.render());
          }, u.prototype.thawSelection = function() {
            return this.selectionFrozen ? (this.composition.thawSelection(), this.selectionManager.unlock(), this.selectionFrozen = false, this.render()) : void 0;
          }, u.prototype.actions = {undo: {test: function() {
            return this.editor.canUndo();
          }, perform: function() {
            return this.editor.undo();
          }}, redo: {test: function() {
            return this.editor.canRedo();
          }, perform: function() {
            return this.editor.redo();
          }}, link: {test: function() {
            return this.editor.canActivateAttribute("href");
          }}, increaseNestingLevel: {test: function() {
            return this.editor.canIncreaseNestingLevel();
          }, perform: function() {
            return this.editor.increaseNestingLevel() && this.render();
          }}, decreaseNestingLevel: {test: function() {
            return this.editor.canDecreaseNestingLevel();
          }, perform: function() {
            return this.editor.decreaseNestingLevel() && this.render();
          }}, attachFiles: {test: function() {
            return true;
          }, perform: function() {
            return e.config.input.pickFiles(this.editor.insertFiles);
          }}}, u.prototype.canInvokeAction = function(t3) {
            var e2, n2;
            return this.actionIsExternal(t3) ? true : !!((e2 = this.actions[t3]) != null && (n2 = e2.test) != null ? n2.call(this) : void 0);
          }, u.prototype.invokeAction = function(t3) {
            var e2, n2;
            return this.actionIsExternal(t3) ? this.notifyEditorElement("action-invoke", {actionName: t3}) : (e2 = this.actions[t3]) != null && (n2 = e2.perform) != null ? n2.call(this) : void 0;
          }, u.prototype.actionIsExternal = function(t3) {
            return /^x-./.test(t3);
          }, u.prototype.getCurrentActions = function() {
            var t3, e2;
            e2 = {};
            for (t3 in this.actions)
              e2[t3] = this.canInvokeAction(t3);
            return e2;
          }, u.prototype.updateCurrentActions = function() {
            var t3;
            return t3 = this.getCurrentActions(), n(t3, this.currentActions) ? void 0 : (this.currentActions = t3, this.toolbarController.updateActions(this.currentActions), this.notifyEditorElement("actions-change", {actions: this.currentActions}));
          }, u.prototype.runEditorFilters = function() {
            var t3, e2, n2, i2, o2, r2, s3, a2;
            for (a2 = this.composition.getSnapshot(), o2 = this.editor.filters, n2 = 0, i2 = o2.length; i2 > n2; n2++)
              e2 = o2[n2], t3 = a2.document, s3 = a2.selectedRange, a2 = (r2 = e2.call(this.editor, a2)) != null ? r2 : {}, a2.document == null && (a2.document = t3), a2.selectedRange == null && (a2.selectedRange = s3);
            return c(a2, this.composition.getSnapshot()) ? void 0 : this.composition.loadSnapshot(a2);
          }, c = function(t3, e2) {
            return o(t3.selectedRange, e2.selectedRange) && t3.document.isEqualTo(e2.document);
          }, u.prototype.updateInputElement = function() {
            var t3, n2;
            return t3 = this.compositionController.getSerializableElement(), n2 = e.serializeToContentType(t3, "text/html"), this.editorElement.setInputElementValue(n2);
          }, u.prototype.notifyEditorElement = function(t3, e2) {
            switch (t3) {
              case "document-change":
                this.documentChangedSinceLastRender = true;
                break;
              case "render":
                this.documentChangedSinceLastRender && (this.documentChangedSinceLastRender = false, this.notifyEditorElement("change"));
                break;
              case "change":
              case "attachment-add":
              case "attachment-edit":
              case "attachment-remove":
                this.updateInputElement();
            }
            return this.editorElement.notify(t3, e2);
          }, u.prototype.removeAttachment = function(t3) {
            return this.editor.recordUndoEntry("Delete Attachment"), this.composition.removeAttachment(t3), this.render();
          }, u.prototype.recordFormattingUndoEntry = function(e2) {
            var n2, o2;
            return n2 = t2(e2), o2 = this.selectionManager.getLocationRange(), n2 || !i(o2) ? this.editor.recordUndoEntry("Formatting", {context: this.getUndoContext(), consolidatable: true}) : void 0;
          }, u.prototype.recordTypingUndoEntry = function() {
            return this.editor.recordUndoEntry("Typing", {context: this.getUndoContext(this.currentAttributes), consolidatable: true});
          }, u.prototype.getUndoContext = function() {
            var t3;
            return t3 = 1 <= arguments.length ? a.call(arguments, 0) : [], [this.getLocationContext(), this.getTimeContext()].concat(a.call(t3));
          }, u.prototype.getLocationContext = function() {
            var t3;
            return t3 = this.selectionManager.getLocationRange(), i(t3) ? t3[0].index : t3;
          }, u.prototype.getTimeContext = function() {
            return e.config.undoInterval > 0 ? Math.floor(new Date().getTime() / e.config.undoInterval) : 0;
          }, u.prototype.isFocused = function() {
            var t3;
            return this.editorElement === ((t3 = this.editorElement.ownerDocument) != null ? t3.activeElement : void 0);
          }, u.prototype.isFocusedInvisibly = function() {
            return this.isFocused() && !this.getLocationRange();
          }, u;
        }(e.Controller);
      }.call(this), function() {
        var t2, n, i, o, r, s, a, u = [].indexOf || function(t3) {
          for (var e2 = 0, n2 = this.length; n2 > e2; e2++)
            if (e2 in this && this[e2] === t3)
              return e2;
          return -1;
        };
        n = e.browser, s = e.makeElement, a = e.triggerEvent, o = e.handleEvent, r = e.handleEventOnce, i = e.findClosestElementFromNode, t2 = e.AttachmentView.attachmentSelector, e.registerElement("trix-editor", function() {
          var c, l, h, p, d, f, g, m, v;
          return g = 0, l = function(t3) {
            return !document.querySelector(":focus") && t3.hasAttribute("autofocus") && document.querySelector("[autofocus]") === t3 ? t3.focus() : void 0;
          }, m = function(t3) {
            return t3.hasAttribute("contenteditable") ? void 0 : (t3.setAttribute("contenteditable", ""), r("focus", {onElement: t3, withCallback: function() {
              return h(t3);
            }}));
          }, h = function(t3) {
            return d(t3), v(t3);
          }, d = function(t3) {
            return (typeof document.queryCommandSupported == "function" ? document.queryCommandSupported("enableObjectResizing") : void 0) ? (document.execCommand("enableObjectResizing", false, false), o("mscontrolselect", {onElement: t3, preventDefault: true})) : void 0;
          }, v = function() {
            var t3;
            return (typeof document.queryCommandSupported == "function" ? document.queryCommandSupported("DefaultParagraphSeparator") : void 0) && (t3 = e.config.blockAttributes["default"].tagName, t3 === "div" || t3 === "p") ? document.execCommand("DefaultParagraphSeparator", false, t3) : void 0;
          }, c = function(t3) {
            return t3.hasAttribute("role") ? void 0 : t3.setAttribute("role", "textbox");
          }, f = function(t3) {
            var e2;
            if (!t3.hasAttribute("aria-label") && !t3.hasAttribute("aria-labelledby"))
              return (e2 = function() {
                var e3, n2, i2;
                return i2 = function() {
                  var n3, i3, o2, r2;
                  for (o2 = t3.labels, r2 = [], n3 = 0, i3 = o2.length; i3 > n3; n3++)
                    e3 = o2[n3], e3.contains(t3) || r2.push(e3.textContent);
                  return r2;
                }(), (n2 = i2.join(" ")) ? t3.setAttribute("aria-label", n2) : t3.removeAttribute("aria-label");
              })(), o("focus", {onElement: t3, withCallback: e2});
          }, p = function() {
            return n.forcesObjectResizing ? {display: "inline", width: "auto"} : {display: "inline-block", width: "1px"};
          }(), {defaultCSS: "%t {\n  display: block;\n}\n\n%t:empty:not(:focus)::before {\n  content: attr(placeholder);\n  color: graytext;\n  cursor: text;\n  pointer-events: none;\n}\n\n%t a[contenteditable=false] {\n  cursor: text;\n}\n\n%t img {\n  max-width: 100%;\n  height: auto;\n}\n\n%t " + t2 + " figcaption textarea {\n  resize: none;\n}\n\n%t " + t2 + " figcaption textarea.trix-autoresize-clone {\n  position: absolute;\n  left: -9999px;\n  max-height: 0px;\n}\n\n%t " + t2 + " figcaption[data-trix-placeholder]:empty::before {\n  content: attr(data-trix-placeholder);\n  color: graytext;\n}\n\n%t [data-trix-cursor-target] {\n  display: " + p.display + " !important;\n  width: " + p.width + " !important;\n  padding: 0 !important;\n  margin: 0 !important;\n  border: none !important;\n}\n\n%t [data-trix-cursor-target=left] {\n  vertical-align: top !important;\n  margin-left: -1px !important;\n}\n\n%t [data-trix-cursor-target=right] {\n  vertical-align: bottom !important;\n  margin-right: -1px !important;\n}", trixId: {get: function() {
            return this.hasAttribute("trix-id") ? this.getAttribute("trix-id") : (this.setAttribute("trix-id", ++g), this.trixId);
          }}, labels: {get: function() {
            var t3, e2, n2;
            return e2 = [], this.id && this.ownerDocument && e2.push.apply(e2, this.ownerDocument.querySelectorAll("label[for='" + this.id + "']")), (t3 = i(this, {matchingSelector: "label"})) && ((n2 = t3.control) === this || n2 === null) && e2.push(t3), e2;
          }}, toolbarElement: {get: function() {
            var t3, e2, n2;
            return this.hasAttribute("toolbar") ? (e2 = this.ownerDocument) != null ? e2.getElementById(this.getAttribute("toolbar")) : void 0 : this.parentNode ? (n2 = "trix-toolbar-" + this.trixId, this.setAttribute("toolbar", n2), t3 = s("trix-toolbar", {id: n2}), this.parentNode.insertBefore(t3, this), t3) : void 0;
          }}, inputElement: {get: function() {
            var t3, e2, n2;
            return this.hasAttribute("input") ? (n2 = this.ownerDocument) != null ? n2.getElementById(this.getAttribute("input")) : void 0 : this.parentNode ? (e2 = "trix-input-" + this.trixId, this.setAttribute("input", e2), t3 = s("input", {type: "hidden", id: e2}), this.parentNode.insertBefore(t3, this.nextElementSibling), t3) : void 0;
          }}, editor: {get: function() {
            var t3;
            return (t3 = this.editorController) != null ? t3.editor : void 0;
          }}, name: {get: function() {
            var t3;
            return (t3 = this.inputElement) != null ? t3.name : void 0;
          }}, value: {get: function() {
            var t3;
            return (t3 = this.inputElement) != null ? t3.value : void 0;
          }, set: function(t3) {
            var e2;
            return this.defaultValue = t3, (e2 = this.editor) != null ? e2.loadHTML(this.defaultValue) : void 0;
          }}, notify: function(t3, e2) {
            return this.editorController ? a("trix-" + t3, {onElement: this, attributes: e2}) : void 0;
          }, setInputElementValue: function(t3) {
            var e2;
            return (e2 = this.inputElement) != null ? e2.value = t3 : void 0;
          }, initialize: function() {
            return this.hasAttribute("data-trix-internal") ? void 0 : (m(this), c(this), f(this));
          }, connect: function() {
            return this.hasAttribute("data-trix-internal") ? void 0 : (this.editorController || (a("trix-before-initialize", {onElement: this}), this.editorController = new e.EditorController({editorElement: this, html: this.defaultValue = this.value}), requestAnimationFrame(function(t3) {
              return function() {
                return a("trix-initialize", {onElement: t3});
              };
            }(this))), this.editorController.registerSelectionManager(), this.registerResetListener(), this.registerClickListener(), l(this));
          }, disconnect: function() {
            var t3;
            return (t3 = this.editorController) != null && t3.unregisterSelectionManager(), this.unregisterResetListener(), this.unregisterClickListener();
          }, registerResetListener: function() {
            return this.resetListener = this.resetBubbled.bind(this), window.addEventListener("reset", this.resetListener, false);
          }, unregisterResetListener: function() {
            return window.removeEventListener("reset", this.resetListener, false);
          }, registerClickListener: function() {
            return this.clickListener = this.clickBubbled.bind(this), window.addEventListener("click", this.clickListener, false);
          }, unregisterClickListener: function() {
            return window.removeEventListener("click", this.clickListener, false);
          }, resetBubbled: function(t3) {
            var e2;
            if (!t3.defaultPrevented && t3.target === ((e2 = this.inputElement) != null ? e2.form : void 0))
              return this.reset();
          }, clickBubbled: function(t3) {
            var e2;
            if (!(t3.defaultPrevented || this.contains(t3.target) || !(e2 = i(t3.target, {matchingSelector: "label"})) || u.call(this.labels, e2) < 0))
              return this.focus();
          }, reset: function() {
            return this.value = this.defaultValue;
          }};
        }());
      }.call(this), function() {
      }.call(this);
    }).call(this), typeof module == "object" && module.exports ? module.exports = e : typeof define == "function" && define.amd && define(e);
  }.call(exports);
});

// node_modules/choices.js/public/assets/scripts/choices.js
var require_choices = __commonJS((exports, module) => {
  /*! choices.js v10.1.0 | © 2022 Josh Johnson | https://github.com/jshjohnson/Choices#readme */
  (function webpackUniversalModuleDefinition(root, factory) {
    if (typeof exports === "object" && typeof module === "object")
      module.exports = factory();
    else if (typeof define === "function" && define.amd)
      define([], factory);
    else if (typeof exports === "object")
      exports["Choices"] = factory();
    else
      root["Choices"] = factory();
  })(window, function() {
    return function() {
      "use strict";
      var __webpack_modules__ = {
        282: function(__unused_webpack_module, exports2, __webpack_require__2) {
          Object.defineProperty(exports2, "__esModule", {
            value: true
          });
          exports2.clearChoices = exports2.activateChoices = exports2.filterChoices = exports2.addChoice = void 0;
          var constants_1 = __webpack_require__2(883);
          var addChoice = function(_a) {
            var value = _a.value, label = _a.label, id = _a.id, groupId = _a.groupId, disabled = _a.disabled, elementId = _a.elementId, customProperties = _a.customProperties, placeholder = _a.placeholder, keyCode = _a.keyCode;
            return {
              type: constants_1.ACTION_TYPES.ADD_CHOICE,
              value,
              label,
              id,
              groupId,
              disabled,
              elementId,
              customProperties,
              placeholder,
              keyCode
            };
          };
          exports2.addChoice = addChoice;
          var filterChoices = function(results) {
            return {
              type: constants_1.ACTION_TYPES.FILTER_CHOICES,
              results
            };
          };
          exports2.filterChoices = filterChoices;
          var activateChoices = function(active) {
            if (active === void 0) {
              active = true;
            }
            return {
              type: constants_1.ACTION_TYPES.ACTIVATE_CHOICES,
              active
            };
          };
          exports2.activateChoices = activateChoices;
          var clearChoices = function() {
            return {
              type: constants_1.ACTION_TYPES.CLEAR_CHOICES
            };
          };
          exports2.clearChoices = clearChoices;
        },
        783: function(__unused_webpack_module, exports2, __webpack_require__2) {
          Object.defineProperty(exports2, "__esModule", {
            value: true
          });
          exports2.addGroup = void 0;
          var constants_1 = __webpack_require__2(883);
          var addGroup = function(_a) {
            var value = _a.value, id = _a.id, active = _a.active, disabled = _a.disabled;
            return {
              type: constants_1.ACTION_TYPES.ADD_GROUP,
              value,
              id,
              active,
              disabled
            };
          };
          exports2.addGroup = addGroup;
        },
        464: function(__unused_webpack_module, exports2, __webpack_require__2) {
          Object.defineProperty(exports2, "__esModule", {
            value: true
          });
          exports2.highlightItem = exports2.removeItem = exports2.addItem = void 0;
          var constants_1 = __webpack_require__2(883);
          var addItem = function(_a) {
            var value = _a.value, label = _a.label, id = _a.id, choiceId = _a.choiceId, groupId = _a.groupId, customProperties = _a.customProperties, placeholder = _a.placeholder, keyCode = _a.keyCode;
            return {
              type: constants_1.ACTION_TYPES.ADD_ITEM,
              value,
              label,
              id,
              choiceId,
              groupId,
              customProperties,
              placeholder,
              keyCode
            };
          };
          exports2.addItem = addItem;
          var removeItem = function(id, choiceId) {
            return {
              type: constants_1.ACTION_TYPES.REMOVE_ITEM,
              id,
              choiceId
            };
          };
          exports2.removeItem = removeItem;
          var highlightItem = function(id, highlighted) {
            return {
              type: constants_1.ACTION_TYPES.HIGHLIGHT_ITEM,
              id,
              highlighted
            };
          };
          exports2.highlightItem = highlightItem;
        },
        137: function(__unused_webpack_module, exports2, __webpack_require__2) {
          Object.defineProperty(exports2, "__esModule", {
            value: true
          });
          exports2.setIsLoading = exports2.resetTo = exports2.clearAll = void 0;
          var constants_1 = __webpack_require__2(883);
          var clearAll = function() {
            return {
              type: constants_1.ACTION_TYPES.CLEAR_ALL
            };
          };
          exports2.clearAll = clearAll;
          var resetTo = function(state) {
            return {
              type: constants_1.ACTION_TYPES.RESET_TO,
              state
            };
          };
          exports2.resetTo = resetTo;
          var setIsLoading = function(isLoading) {
            return {
              type: constants_1.ACTION_TYPES.SET_IS_LOADING,
              isLoading
            };
          };
          exports2.setIsLoading = setIsLoading;
        },
        373: function(__unused_webpack_module, exports2, __webpack_require__2) {
          var __spreadArray = this && this.__spreadArray || function(to, from, pack) {
            if (pack || arguments.length === 2)
              for (var i = 0, l = from.length, ar; i < l; i++) {
                if (ar || !(i in from)) {
                  if (!ar)
                    ar = Array.prototype.slice.call(from, 0, i);
                  ar[i] = from[i];
                }
              }
            return to.concat(ar || Array.prototype.slice.call(from));
          };
          var __importDefault = this && this.__importDefault || function(mod) {
            return mod && mod.__esModule ? mod : {
              default: mod
            };
          };
          Object.defineProperty(exports2, "__esModule", {
            value: true
          });
          var deepmerge_1 = __importDefault(__webpack_require__2(996));
          var fuse_js_1 = __importDefault(__webpack_require__2(221));
          var choices_1 = __webpack_require__2(282);
          var groups_1 = __webpack_require__2(783);
          var items_1 = __webpack_require__2(464);
          var misc_1 = __webpack_require__2(137);
          var components_1 = __webpack_require__2(520);
          var constants_1 = __webpack_require__2(883);
          var defaults_1 = __webpack_require__2(789);
          var utils_1 = __webpack_require__2(799);
          var reducers_1 = __webpack_require__2(655);
          var store_1 = __importDefault(__webpack_require__2(744));
          var templates_1 = __importDefault(__webpack_require__2(686));
          var IS_IE11 = "-ms-scroll-limit" in document.documentElement.style && "-ms-ime-align" in document.documentElement.style;
          var USER_DEFAULTS = {};
          var Choices2 = function() {
            function Choices3(element, userConfig) {
              var _this = this;
              if (element === void 0) {
                element = "[data-choice]";
              }
              if (userConfig === void 0) {
                userConfig = {};
              }
              if (userConfig.allowHTML === void 0) {
                console.warn("Deprecation warning: allowHTML will default to false in a future release. To render HTML in Choices, you will need to set it to true. Setting allowHTML will suppress this message.");
              }
              this.config = deepmerge_1.default.all([defaults_1.DEFAULT_CONFIG, Choices3.defaults.options, userConfig], {
                arrayMerge: function(_, sourceArray) {
                  return __spreadArray([], sourceArray, true);
                }
              });
              var invalidConfigOptions = (0, utils_1.diff)(this.config, defaults_1.DEFAULT_CONFIG);
              if (invalidConfigOptions.length) {
                console.warn("Unknown config option(s) passed", invalidConfigOptions.join(", "));
              }
              var passedElement = typeof element === "string" ? document.querySelector(element) : element;
              if (!(passedElement instanceof HTMLInputElement || passedElement instanceof HTMLSelectElement)) {
                throw TypeError("Expected one of the following types text|select-one|select-multiple");
              }
              this._isTextElement = passedElement.type === constants_1.TEXT_TYPE;
              this._isSelectOneElement = passedElement.type === constants_1.SELECT_ONE_TYPE;
              this._isSelectMultipleElement = passedElement.type === constants_1.SELECT_MULTIPLE_TYPE;
              this._isSelectElement = this._isSelectOneElement || this._isSelectMultipleElement;
              this.config.searchEnabled = this._isSelectMultipleElement || this.config.searchEnabled;
              if (!["auto", "always"].includes("".concat(this.config.renderSelectedChoices))) {
                this.config.renderSelectedChoices = "auto";
              }
              if (userConfig.addItemFilter && typeof userConfig.addItemFilter !== "function") {
                var re = userConfig.addItemFilter instanceof RegExp ? userConfig.addItemFilter : new RegExp(userConfig.addItemFilter);
                this.config.addItemFilter = re.test.bind(re);
              }
              if (this._isTextElement) {
                this.passedElement = new components_1.WrappedInput({
                  element: passedElement,
                  classNames: this.config.classNames,
                  delimiter: this.config.delimiter
                });
              } else {
                this.passedElement = new components_1.WrappedSelect({
                  element: passedElement,
                  classNames: this.config.classNames,
                  template: function(data2) {
                    return _this._templates.option(data2);
                  }
                });
              }
              this.initialised = false;
              this._store = new store_1.default();
              this._initialState = reducers_1.defaultState;
              this._currentState = reducers_1.defaultState;
              this._prevState = reducers_1.defaultState;
              this._currentValue = "";
              this._canSearch = !!this.config.searchEnabled;
              this._isScrollingOnIe = false;
              this._highlightPosition = 0;
              this._wasTap = true;
              this._placeholderValue = this._generatePlaceholderValue();
              this._baseId = (0, utils_1.generateId)(this.passedElement.element, "choices-");
              this._direction = this.passedElement.dir;
              if (!this._direction) {
                var elementDirection = window.getComputedStyle(this.passedElement.element).direction;
                var documentDirection = window.getComputedStyle(document.documentElement).direction;
                if (elementDirection !== documentDirection) {
                  this._direction = elementDirection;
                }
              }
              this._idNames = {
                itemChoice: "item-choice"
              };
              if (this._isSelectElement) {
                this._presetGroups = this.passedElement.optionGroups;
                this._presetOptions = this.passedElement.options;
              }
              this._presetChoices = this.config.choices;
              this._presetItems = this.config.items;
              if (this.passedElement.value && this._isTextElement) {
                var splitValues = this.passedElement.value.split(this.config.delimiter);
                this._presetItems = this._presetItems.concat(splitValues);
              }
              if (this.passedElement.options) {
                this.passedElement.options.forEach(function(option2) {
                  _this._presetChoices.push({
                    value: option2.value,
                    label: option2.innerHTML,
                    selected: !!option2.selected,
                    disabled: option2.disabled || option2.parentNode.disabled,
                    placeholder: option2.value === "" || option2.hasAttribute("placeholder"),
                    customProperties: option2.dataset["custom-properties"]
                  });
                });
              }
              this._render = this._render.bind(this);
              this._onFocus = this._onFocus.bind(this);
              this._onBlur = this._onBlur.bind(this);
              this._onKeyUp = this._onKeyUp.bind(this);
              this._onKeyDown = this._onKeyDown.bind(this);
              this._onClick = this._onClick.bind(this);
              this._onTouchMove = this._onTouchMove.bind(this);
              this._onTouchEnd = this._onTouchEnd.bind(this);
              this._onMouseDown = this._onMouseDown.bind(this);
              this._onMouseOver = this._onMouseOver.bind(this);
              this._onFormReset = this._onFormReset.bind(this);
              this._onSelectKey = this._onSelectKey.bind(this);
              this._onEnterKey = this._onEnterKey.bind(this);
              this._onEscapeKey = this._onEscapeKey.bind(this);
              this._onDirectionKey = this._onDirectionKey.bind(this);
              this._onDeleteKey = this._onDeleteKey.bind(this);
              if (this.passedElement.isActive) {
                if (!this.config.silent) {
                  console.warn("Trying to initialise Choices on element already initialised", {
                    element
                  });
                }
                this.initialised = true;
                return;
              }
              this.init();
            }
            Object.defineProperty(Choices3, "defaults", {
              get: function() {
                return Object.preventExtensions({
                  get options() {
                    return USER_DEFAULTS;
                  },
                  get templates() {
                    return templates_1.default;
                  }
                });
              },
              enumerable: false,
              configurable: true
            });
            Choices3.prototype.init = function() {
              if (this.initialised) {
                return;
              }
              this._createTemplates();
              this._createElements();
              this._createStructure();
              this._store.subscribe(this._render);
              this._render();
              this._addEventListeners();
              var shouldDisable = !this.config.addItems || this.passedElement.element.hasAttribute("disabled");
              if (shouldDisable) {
                this.disable();
              }
              this.initialised = true;
              var callbackOnInit = this.config.callbackOnInit;
              if (callbackOnInit && typeof callbackOnInit === "function") {
                callbackOnInit.call(this);
              }
            };
            Choices3.prototype.destroy = function() {
              if (!this.initialised) {
                return;
              }
              this._removeEventListeners();
              this.passedElement.reveal();
              this.containerOuter.unwrap(this.passedElement.element);
              this.clearStore();
              if (this._isSelectElement) {
                this.passedElement.options = this._presetOptions;
              }
              this._templates = templates_1.default;
              this.initialised = false;
            };
            Choices3.prototype.enable = function() {
              if (this.passedElement.isDisabled) {
                this.passedElement.enable();
              }
              if (this.containerOuter.isDisabled) {
                this._addEventListeners();
                this.input.enable();
                this.containerOuter.enable();
              }
              return this;
            };
            Choices3.prototype.disable = function() {
              if (!this.passedElement.isDisabled) {
                this.passedElement.disable();
              }
              if (!this.containerOuter.isDisabled) {
                this._removeEventListeners();
                this.input.disable();
                this.containerOuter.disable();
              }
              return this;
            };
            Choices3.prototype.highlightItem = function(item, runEvent) {
              if (runEvent === void 0) {
                runEvent = true;
              }
              if (!item || !item.id) {
                return this;
              }
              var id = item.id, _a = item.groupId, groupId = _a === void 0 ? -1 : _a, _b = item.value, value = _b === void 0 ? "" : _b, _c = item.label, label = _c === void 0 ? "" : _c;
              var group = groupId >= 0 ? this._store.getGroupById(groupId) : null;
              this._store.dispatch((0, items_1.highlightItem)(id, true));
              if (runEvent) {
                this.passedElement.triggerEvent(constants_1.EVENTS.highlightItem, {
                  id,
                  value,
                  label,
                  groupValue: group && group.value ? group.value : null
                });
              }
              return this;
            };
            Choices3.prototype.unhighlightItem = function(item) {
              if (!item || !item.id) {
                return this;
              }
              var id = item.id, _a = item.groupId, groupId = _a === void 0 ? -1 : _a, _b = item.value, value = _b === void 0 ? "" : _b, _c = item.label, label = _c === void 0 ? "" : _c;
              var group = groupId >= 0 ? this._store.getGroupById(groupId) : null;
              this._store.dispatch((0, items_1.highlightItem)(id, false));
              this.passedElement.triggerEvent(constants_1.EVENTS.highlightItem, {
                id,
                value,
                label,
                groupValue: group && group.value ? group.value : null
              });
              return this;
            };
            Choices3.prototype.highlightAll = function() {
              var _this = this;
              this._store.items.forEach(function(item) {
                return _this.highlightItem(item);
              });
              return this;
            };
            Choices3.prototype.unhighlightAll = function() {
              var _this = this;
              this._store.items.forEach(function(item) {
                return _this.unhighlightItem(item);
              });
              return this;
            };
            Choices3.prototype.removeActiveItemsByValue = function(value) {
              var _this = this;
              this._store.activeItems.filter(function(item) {
                return item.value === value;
              }).forEach(function(item) {
                return _this._removeItem(item);
              });
              return this;
            };
            Choices3.prototype.removeActiveItems = function(excludedId) {
              var _this = this;
              this._store.activeItems.filter(function(_a) {
                var id = _a.id;
                return id !== excludedId;
              }).forEach(function(item) {
                return _this._removeItem(item);
              });
              return this;
            };
            Choices3.prototype.removeHighlightedItems = function(runEvent) {
              var _this = this;
              if (runEvent === void 0) {
                runEvent = false;
              }
              this._store.highlightedActiveItems.forEach(function(item) {
                _this._removeItem(item);
                if (runEvent) {
                  _this._triggerChange(item.value);
                }
              });
              return this;
            };
            Choices3.prototype.showDropdown = function(preventInputFocus) {
              var _this = this;
              if (this.dropdown.isActive) {
                return this;
              }
              requestAnimationFrame(function() {
                _this.dropdown.show();
                _this.containerOuter.open(_this.dropdown.distanceFromTopWindow);
                if (!preventInputFocus && _this._canSearch) {
                  _this.input.focus();
                }
                _this.passedElement.triggerEvent(constants_1.EVENTS.showDropdown, {});
              });
              return this;
            };
            Choices3.prototype.hideDropdown = function(preventInputBlur) {
              var _this = this;
              if (!this.dropdown.isActive) {
                return this;
              }
              requestAnimationFrame(function() {
                _this.dropdown.hide();
                _this.containerOuter.close();
                if (!preventInputBlur && _this._canSearch) {
                  _this.input.removeActiveDescendant();
                  _this.input.blur();
                }
                _this.passedElement.triggerEvent(constants_1.EVENTS.hideDropdown, {});
              });
              return this;
            };
            Choices3.prototype.getValue = function(valueOnly) {
              if (valueOnly === void 0) {
                valueOnly = false;
              }
              var values = this._store.activeItems.reduce(function(selectedItems, item) {
                var itemValue = valueOnly ? item.value : item;
                selectedItems.push(itemValue);
                return selectedItems;
              }, []);
              return this._isSelectOneElement ? values[0] : values;
            };
            Choices3.prototype.setValue = function(items) {
              var _this = this;
              if (!this.initialised) {
                return this;
              }
              items.forEach(function(value) {
                return _this._setChoiceOrItem(value);
              });
              return this;
            };
            Choices3.prototype.setChoiceByValue = function(value) {
              var _this = this;
              if (!this.initialised || this._isTextElement) {
                return this;
              }
              var choiceValue = Array.isArray(value) ? value : [value];
              choiceValue.forEach(function(val) {
                return _this._findAndSelectChoiceByValue(val);
              });
              return this;
            };
            Choices3.prototype.setChoices = function(choicesArrayOrFetcher, value, label, replaceChoices) {
              var _this = this;
              if (choicesArrayOrFetcher === void 0) {
                choicesArrayOrFetcher = [];
              }
              if (value === void 0) {
                value = "value";
              }
              if (label === void 0) {
                label = "label";
              }
              if (replaceChoices === void 0) {
                replaceChoices = false;
              }
              if (!this.initialised) {
                throw new ReferenceError("setChoices was called on a non-initialized instance of Choices");
              }
              if (!this._isSelectElement) {
                throw new TypeError("setChoices can't be used with INPUT based Choices");
              }
              if (typeof value !== "string" || !value) {
                throw new TypeError("value parameter must be a name of 'value' field in passed objects");
              }
              if (replaceChoices) {
                this.clearChoices();
              }
              if (typeof choicesArrayOrFetcher === "function") {
                var fetcher_1 = choicesArrayOrFetcher(this);
                if (typeof Promise === "function" && fetcher_1 instanceof Promise) {
                  return new Promise(function(resolve) {
                    return requestAnimationFrame(resolve);
                  }).then(function() {
                    return _this._handleLoadingState(true);
                  }).then(function() {
                    return fetcher_1;
                  }).then(function(data2) {
                    return _this.setChoices(data2, value, label, replaceChoices);
                  }).catch(function(err) {
                    if (!_this.config.silent) {
                      console.error(err);
                    }
                  }).then(function() {
                    return _this._handleLoadingState(false);
                  }).then(function() {
                    return _this;
                  });
                }
                if (!Array.isArray(fetcher_1)) {
                  throw new TypeError(".setChoices first argument function must return either array of choices or Promise, got: ".concat(typeof fetcher_1));
                }
                return this.setChoices(fetcher_1, value, label, false);
              }
              if (!Array.isArray(choicesArrayOrFetcher)) {
                throw new TypeError(".setChoices must be called either with array of choices with a function resulting into Promise of array of choices");
              }
              this.containerOuter.removeLoadingState();
              this._startLoading();
              choicesArrayOrFetcher.forEach(function(groupOrChoice) {
                if (groupOrChoice.choices) {
                  _this._addGroup({
                    id: groupOrChoice.id ? parseInt("".concat(groupOrChoice.id), 10) : null,
                    group: groupOrChoice,
                    valueKey: value,
                    labelKey: label
                  });
                } else {
                  var choice = groupOrChoice;
                  _this._addChoice({
                    value: choice[value],
                    label: choice[label],
                    isSelected: !!choice.selected,
                    isDisabled: !!choice.disabled,
                    placeholder: !!choice.placeholder,
                    customProperties: choice.customProperties
                  });
                }
              });
              this._stopLoading();
              return this;
            };
            Choices3.prototype.clearChoices = function() {
              this._store.dispatch((0, choices_1.clearChoices)());
              return this;
            };
            Choices3.prototype.clearStore = function() {
              this._store.dispatch((0, misc_1.clearAll)());
              return this;
            };
            Choices3.prototype.clearInput = function() {
              var shouldSetInputWidth = !this._isSelectOneElement;
              this.input.clear(shouldSetInputWidth);
              if (!this._isTextElement && this._canSearch) {
                this._isSearching = false;
                this._store.dispatch((0, choices_1.activateChoices)(true));
              }
              return this;
            };
            Choices3.prototype._render = function() {
              if (this._store.isLoading()) {
                return;
              }
              this._currentState = this._store.state;
              var stateChanged = this._currentState.choices !== this._prevState.choices || this._currentState.groups !== this._prevState.groups || this._currentState.items !== this._prevState.items;
              var shouldRenderChoices = this._isSelectElement;
              var shouldRenderItems = this._currentState.items !== this._prevState.items;
              if (!stateChanged) {
                return;
              }
              if (shouldRenderChoices) {
                this._renderChoices();
              }
              if (shouldRenderItems) {
                this._renderItems();
              }
              this._prevState = this._currentState;
            };
            Choices3.prototype._renderChoices = function() {
              var _this = this;
              var _a = this._store, activeGroups = _a.activeGroups, activeChoices = _a.activeChoices;
              var choiceListFragment = document.createDocumentFragment();
              this.choiceList.clear();
              if (this.config.resetScrollPosition) {
                requestAnimationFrame(function() {
                  return _this.choiceList.scrollToTop();
                });
              }
              if (activeGroups.length >= 1 && !this._isSearching) {
                var activePlaceholders = activeChoices.filter(function(activeChoice) {
                  return activeChoice.placeholder === true && activeChoice.groupId === -1;
                });
                if (activePlaceholders.length >= 1) {
                  choiceListFragment = this._createChoicesFragment(activePlaceholders, choiceListFragment);
                }
                choiceListFragment = this._createGroupsFragment(activeGroups, activeChoices, choiceListFragment);
              } else if (activeChoices.length >= 1) {
                choiceListFragment = this._createChoicesFragment(activeChoices, choiceListFragment);
              }
              if (choiceListFragment.childNodes && choiceListFragment.childNodes.length > 0) {
                var activeItems = this._store.activeItems;
                var canAddItem = this._canAddItem(activeItems, this.input.value);
                if (canAddItem.response) {
                  this.choiceList.append(choiceListFragment);
                  this._highlightChoice();
                } else {
                  var notice = this._getTemplate("notice", canAddItem.notice);
                  this.choiceList.append(notice);
                }
              } else {
                var dropdownItem = void 0;
                var notice = void 0;
                if (this._isSearching) {
                  notice = typeof this.config.noResultsText === "function" ? this.config.noResultsText() : this.config.noResultsText;
                  dropdownItem = this._getTemplate("notice", notice, "no-results");
                } else {
                  notice = typeof this.config.noChoicesText === "function" ? this.config.noChoicesText() : this.config.noChoicesText;
                  dropdownItem = this._getTemplate("notice", notice, "no-choices");
                }
                this.choiceList.append(dropdownItem);
              }
            };
            Choices3.prototype._renderItems = function() {
              var activeItems = this._store.activeItems || [];
              this.itemList.clear();
              var itemListFragment = this._createItemsFragment(activeItems);
              if (itemListFragment.childNodes) {
                this.itemList.append(itemListFragment);
              }
            };
            Choices3.prototype._createGroupsFragment = function(groups, choices, fragment) {
              var _this = this;
              if (fragment === void 0) {
                fragment = document.createDocumentFragment();
              }
              var getGroupChoices = function(group) {
                return choices.filter(function(choice) {
                  if (_this._isSelectOneElement) {
                    return choice.groupId === group.id;
                  }
                  return choice.groupId === group.id && (_this.config.renderSelectedChoices === "always" || !choice.selected);
                });
              };
              if (this.config.shouldSort) {
                groups.sort(this.config.sorter);
              }
              groups.forEach(function(group) {
                var groupChoices = getGroupChoices(group);
                if (groupChoices.length >= 1) {
                  var dropdownGroup = _this._getTemplate("choiceGroup", group);
                  fragment.appendChild(dropdownGroup);
                  _this._createChoicesFragment(groupChoices, fragment, true);
                }
              });
              return fragment;
            };
            Choices3.prototype._createChoicesFragment = function(choices, fragment, withinGroup) {
              var _this = this;
              if (fragment === void 0) {
                fragment = document.createDocumentFragment();
              }
              if (withinGroup === void 0) {
                withinGroup = false;
              }
              var _a = this.config, renderSelectedChoices = _a.renderSelectedChoices, searchResultLimit = _a.searchResultLimit, renderChoiceLimit = _a.renderChoiceLimit;
              var filter = this._isSearching ? utils_1.sortByScore : this.config.sorter;
              var appendChoice = function(choice) {
                var shouldRender = renderSelectedChoices === "auto" ? _this._isSelectOneElement || !choice.selected : true;
                if (shouldRender) {
                  var dropdownItem = _this._getTemplate("choice", choice, _this.config.itemSelectText);
                  fragment.appendChild(dropdownItem);
                }
              };
              var rendererableChoices = choices;
              if (renderSelectedChoices === "auto" && !this._isSelectOneElement) {
                rendererableChoices = choices.filter(function(choice) {
                  return !choice.selected;
                });
              }
              var _b = rendererableChoices.reduce(function(acc, choice) {
                if (choice.placeholder) {
                  acc.placeholderChoices.push(choice);
                } else {
                  acc.normalChoices.push(choice);
                }
                return acc;
              }, {
                placeholderChoices: [],
                normalChoices: []
              }), placeholderChoices = _b.placeholderChoices, normalChoices = _b.normalChoices;
              if (this.config.shouldSort || this._isSearching) {
                normalChoices.sort(filter);
              }
              var choiceLimit = rendererableChoices.length;
              var sortedChoices = this._isSelectOneElement ? __spreadArray(__spreadArray([], placeholderChoices, true), normalChoices, true) : normalChoices;
              if (this._isSearching) {
                choiceLimit = searchResultLimit;
              } else if (renderChoiceLimit && renderChoiceLimit > 0 && !withinGroup) {
                choiceLimit = renderChoiceLimit;
              }
              for (var i = 0; i < choiceLimit; i += 1) {
                if (sortedChoices[i]) {
                  appendChoice(sortedChoices[i]);
                }
              }
              return fragment;
            };
            Choices3.prototype._createItemsFragment = function(items, fragment) {
              var _this = this;
              if (fragment === void 0) {
                fragment = document.createDocumentFragment();
              }
              var _a = this.config, shouldSortItems = _a.shouldSortItems, sorter = _a.sorter, removeItemButton = _a.removeItemButton;
              if (shouldSortItems && !this._isSelectOneElement) {
                items.sort(sorter);
              }
              if (this._isTextElement) {
                this.passedElement.value = items.map(function(_a2) {
                  var value = _a2.value;
                  return value;
                }).join(this.config.delimiter);
              } else {
                this.passedElement.options = items;
              }
              var addItemToFragment = function(item) {
                var listItem = _this._getTemplate("item", item, removeItemButton);
                fragment.appendChild(listItem);
              };
              items.forEach(addItemToFragment);
              return fragment;
            };
            Choices3.prototype._triggerChange = function(value) {
              if (value === void 0 || value === null) {
                return;
              }
              this.passedElement.triggerEvent(constants_1.EVENTS.change, {
                value
              });
            };
            Choices3.prototype._selectPlaceholderChoice = function(placeholderChoice) {
              this._addItem({
                value: placeholderChoice.value,
                label: placeholderChoice.label,
                choiceId: placeholderChoice.id,
                groupId: placeholderChoice.groupId,
                placeholder: placeholderChoice.placeholder
              });
              this._triggerChange(placeholderChoice.value);
            };
            Choices3.prototype._handleButtonAction = function(activeItems, element) {
              if (!activeItems || !element || !this.config.removeItems || !this.config.removeItemButton) {
                return;
              }
              var itemId = element.parentNode && element.parentNode.dataset.id;
              var itemToRemove = itemId && activeItems.find(function(item) {
                return item.id === parseInt(itemId, 10);
              });
              if (!itemToRemove) {
                return;
              }
              this._removeItem(itemToRemove);
              this._triggerChange(itemToRemove.value);
              if (this._isSelectOneElement && this._store.placeholderChoice) {
                this._selectPlaceholderChoice(this._store.placeholderChoice);
              }
            };
            Choices3.prototype._handleItemAction = function(activeItems, element, hasShiftKey) {
              var _this = this;
              if (hasShiftKey === void 0) {
                hasShiftKey = false;
              }
              if (!activeItems || !element || !this.config.removeItems || this._isSelectOneElement) {
                return;
              }
              var passedId = element.dataset.id;
              activeItems.forEach(function(item) {
                if (item.id === parseInt("".concat(passedId), 10) && !item.highlighted) {
                  _this.highlightItem(item);
                } else if (!hasShiftKey && item.highlighted) {
                  _this.unhighlightItem(item);
                }
              });
              this.input.focus();
            };
            Choices3.prototype._handleChoiceAction = function(activeItems, element) {
              if (!activeItems || !element) {
                return;
              }
              var id = element.dataset.id;
              var choice = id && this._store.getChoiceById(id);
              if (!choice) {
                return;
              }
              var passedKeyCode = activeItems[0] && activeItems[0].keyCode ? activeItems[0].keyCode : void 0;
              var hasActiveDropdown = this.dropdown.isActive;
              choice.keyCode = passedKeyCode;
              this.passedElement.triggerEvent(constants_1.EVENTS.choice, {
                choice
              });
              if (!choice.selected && !choice.disabled) {
                var canAddItem = this._canAddItem(activeItems, choice.value);
                if (canAddItem.response) {
                  this._addItem({
                    value: choice.value,
                    label: choice.label,
                    choiceId: choice.id,
                    groupId: choice.groupId,
                    customProperties: choice.customProperties,
                    placeholder: choice.placeholder,
                    keyCode: choice.keyCode
                  });
                  this._triggerChange(choice.value);
                }
              }
              this.clearInput();
              if (hasActiveDropdown && this._isSelectOneElement) {
                this.hideDropdown(true);
                this.containerOuter.focus();
              }
            };
            Choices3.prototype._handleBackspace = function(activeItems) {
              if (!this.config.removeItems || !activeItems) {
                return;
              }
              var lastItem = activeItems[activeItems.length - 1];
              var hasHighlightedItems = activeItems.some(function(item) {
                return item.highlighted;
              });
              if (this.config.editItems && !hasHighlightedItems && lastItem) {
                this.input.value = lastItem.value;
                this.input.setWidth();
                this._removeItem(lastItem);
                this._triggerChange(lastItem.value);
              } else {
                if (!hasHighlightedItems) {
                  this.highlightItem(lastItem, false);
                }
                this.removeHighlightedItems(true);
              }
            };
            Choices3.prototype._startLoading = function() {
              this._store.dispatch((0, misc_1.setIsLoading)(true));
            };
            Choices3.prototype._stopLoading = function() {
              this._store.dispatch((0, misc_1.setIsLoading)(false));
            };
            Choices3.prototype._handleLoadingState = function(setLoading) {
              if (setLoading === void 0) {
                setLoading = true;
              }
              var placeholderItem = this.itemList.getChild(".".concat(this.config.classNames.placeholder));
              if (setLoading) {
                this.disable();
                this.containerOuter.addLoadingState();
                if (this._isSelectOneElement) {
                  if (!placeholderItem) {
                    placeholderItem = this._getTemplate("placeholder", this.config.loadingText);
                    if (placeholderItem) {
                      this.itemList.append(placeholderItem);
                    }
                  } else {
                    placeholderItem.innerHTML = this.config.loadingText;
                  }
                } else {
                  this.input.placeholder = this.config.loadingText;
                }
              } else {
                this.enable();
                this.containerOuter.removeLoadingState();
                if (this._isSelectOneElement) {
                  if (placeholderItem) {
                    placeholderItem.innerHTML = this._placeholderValue || "";
                  }
                } else {
                  this.input.placeholder = this._placeholderValue || "";
                }
              }
            };
            Choices3.prototype._handleSearch = function(value) {
              if (!this.input.isFocussed) {
                return;
              }
              var choices = this._store.choices;
              var _a = this.config, searchFloor = _a.searchFloor, searchChoices = _a.searchChoices;
              var hasUnactiveChoices = choices.some(function(option2) {
                return !option2.active;
              });
              if (value !== null && typeof value !== "undefined" && value.length >= searchFloor) {
                var resultCount = searchChoices ? this._searchChoices(value) : 0;
                this.passedElement.triggerEvent(constants_1.EVENTS.search, {
                  value,
                  resultCount
                });
              } else if (hasUnactiveChoices) {
                this._isSearching = false;
                this._store.dispatch((0, choices_1.activateChoices)(true));
              }
            };
            Choices3.prototype._canAddItem = function(activeItems, value) {
              var canAddItem = true;
              var notice = typeof this.config.addItemText === "function" ? this.config.addItemText(value) : this.config.addItemText;
              if (!this._isSelectOneElement) {
                var isDuplicateValue = (0, utils_1.existsInArray)(activeItems, value);
                if (this.config.maxItemCount > 0 && this.config.maxItemCount <= activeItems.length) {
                  canAddItem = false;
                  notice = typeof this.config.maxItemText === "function" ? this.config.maxItemText(this.config.maxItemCount) : this.config.maxItemText;
                }
                if (!this.config.duplicateItemsAllowed && isDuplicateValue && canAddItem) {
                  canAddItem = false;
                  notice = typeof this.config.uniqueItemText === "function" ? this.config.uniqueItemText(value) : this.config.uniqueItemText;
                }
                if (this._isTextElement && this.config.addItems && canAddItem && typeof this.config.addItemFilter === "function" && !this.config.addItemFilter(value)) {
                  canAddItem = false;
                  notice = typeof this.config.customAddItemText === "function" ? this.config.customAddItemText(value) : this.config.customAddItemText;
                }
              }
              return {
                response: canAddItem,
                notice
              };
            };
            Choices3.prototype._searchChoices = function(value) {
              var newValue = typeof value === "string" ? value.trim() : value;
              var currentValue = typeof this._currentValue === "string" ? this._currentValue.trim() : this._currentValue;
              if (newValue.length < 1 && newValue === "".concat(currentValue, " ")) {
                return 0;
              }
              var haystack = this._store.searchableChoices;
              var needle = newValue;
              var options = Object.assign(this.config.fuseOptions, {
                keys: __spreadArray([], this.config.searchFields, true),
                includeMatches: true
              });
              var fuse = new fuse_js_1.default(haystack, options);
              var results = fuse.search(needle);
              this._currentValue = newValue;
              this._highlightPosition = 0;
              this._isSearching = true;
              this._store.dispatch((0, choices_1.filterChoices)(results));
              return results.length;
            };
            Choices3.prototype._addEventListeners = function() {
              var documentElement = document.documentElement;
              documentElement.addEventListener("touchend", this._onTouchEnd, true);
              this.containerOuter.element.addEventListener("keydown", this._onKeyDown, true);
              this.containerOuter.element.addEventListener("mousedown", this._onMouseDown, true);
              documentElement.addEventListener("click", this._onClick, {
                passive: true
              });
              documentElement.addEventListener("touchmove", this._onTouchMove, {
                passive: true
              });
              this.dropdown.element.addEventListener("mouseover", this._onMouseOver, {
                passive: true
              });
              if (this._isSelectOneElement) {
                this.containerOuter.element.addEventListener("focus", this._onFocus, {
                  passive: true
                });
                this.containerOuter.element.addEventListener("blur", this._onBlur, {
                  passive: true
                });
              }
              this.input.element.addEventListener("keyup", this._onKeyUp, {
                passive: true
              });
              this.input.element.addEventListener("focus", this._onFocus, {
                passive: true
              });
              this.input.element.addEventListener("blur", this._onBlur, {
                passive: true
              });
              if (this.input.element.form) {
                this.input.element.form.addEventListener("reset", this._onFormReset, {
                  passive: true
                });
              }
              this.input.addEventListeners();
            };
            Choices3.prototype._removeEventListeners = function() {
              var documentElement = document.documentElement;
              documentElement.removeEventListener("touchend", this._onTouchEnd, true);
              this.containerOuter.element.removeEventListener("keydown", this._onKeyDown, true);
              this.containerOuter.element.removeEventListener("mousedown", this._onMouseDown, true);
              documentElement.removeEventListener("click", this._onClick);
              documentElement.removeEventListener("touchmove", this._onTouchMove);
              this.dropdown.element.removeEventListener("mouseover", this._onMouseOver);
              if (this._isSelectOneElement) {
                this.containerOuter.element.removeEventListener("focus", this._onFocus);
                this.containerOuter.element.removeEventListener("blur", this._onBlur);
              }
              this.input.element.removeEventListener("keyup", this._onKeyUp);
              this.input.element.removeEventListener("focus", this._onFocus);
              this.input.element.removeEventListener("blur", this._onBlur);
              if (this.input.element.form) {
                this.input.element.form.removeEventListener("reset", this._onFormReset);
              }
              this.input.removeEventListeners();
            };
            Choices3.prototype._onKeyDown = function(event) {
              var keyCode = event.keyCode;
              var activeItems = this._store.activeItems;
              var hasFocusedInput = this.input.isFocussed;
              var hasActiveDropdown = this.dropdown.isActive;
              var hasItems = this.itemList.hasChildren();
              var keyString = String.fromCharCode(keyCode);
              var wasAlphaNumericChar = /[a-zA-Z0-9-_ ]/.test(keyString);
              var BACK_KEY = constants_1.KEY_CODES.BACK_KEY, DELETE_KEY = constants_1.KEY_CODES.DELETE_KEY, ENTER_KEY = constants_1.KEY_CODES.ENTER_KEY, A_KEY = constants_1.KEY_CODES.A_KEY, ESC_KEY = constants_1.KEY_CODES.ESC_KEY, UP_KEY = constants_1.KEY_CODES.UP_KEY, DOWN_KEY = constants_1.KEY_CODES.DOWN_KEY, PAGE_UP_KEY = constants_1.KEY_CODES.PAGE_UP_KEY, PAGE_DOWN_KEY = constants_1.KEY_CODES.PAGE_DOWN_KEY;
              if (!this._isTextElement && !hasActiveDropdown && wasAlphaNumericChar) {
                this.showDropdown();
                if (!this.input.isFocussed) {
                  this.input.value += keyString.toLowerCase();
                }
              }
              switch (keyCode) {
                case A_KEY:
                  return this._onSelectKey(event, hasItems);
                case ENTER_KEY:
                  return this._onEnterKey(event, activeItems, hasActiveDropdown);
                case ESC_KEY:
                  return this._onEscapeKey(hasActiveDropdown);
                case UP_KEY:
                case PAGE_UP_KEY:
                case DOWN_KEY:
                case PAGE_DOWN_KEY:
                  return this._onDirectionKey(event, hasActiveDropdown);
                case DELETE_KEY:
                case BACK_KEY:
                  return this._onDeleteKey(event, activeItems, hasFocusedInput);
                default:
              }
            };
            Choices3.prototype._onKeyUp = function(_a) {
              var target = _a.target, keyCode = _a.keyCode;
              var value = this.input.value;
              var activeItems = this._store.activeItems;
              var canAddItem = this._canAddItem(activeItems, value);
              var backKey = constants_1.KEY_CODES.BACK_KEY, deleteKey = constants_1.KEY_CODES.DELETE_KEY;
              if (this._isTextElement) {
                var canShowDropdownNotice = canAddItem.notice && value;
                if (canShowDropdownNotice) {
                  var dropdownItem = this._getTemplate("notice", canAddItem.notice);
                  this.dropdown.element.innerHTML = dropdownItem.outerHTML;
                  this.showDropdown(true);
                } else {
                  this.hideDropdown(true);
                }
              } else {
                var wasRemovalKeyCode = keyCode === backKey || keyCode === deleteKey;
                var userHasRemovedValue = wasRemovalKeyCode && target && !target.value;
                var canReactivateChoices = !this._isTextElement && this._isSearching;
                var canSearch = this._canSearch && canAddItem.response;
                if (userHasRemovedValue && canReactivateChoices) {
                  this._isSearching = false;
                  this._store.dispatch((0, choices_1.activateChoices)(true));
                } else if (canSearch) {
                  this._handleSearch(this.input.rawValue);
                }
              }
              this._canSearch = this.config.searchEnabled;
            };
            Choices3.prototype._onSelectKey = function(event, hasItems) {
              var ctrlKey = event.ctrlKey, metaKey = event.metaKey;
              var hasCtrlDownKeyPressed = ctrlKey || metaKey;
              if (hasCtrlDownKeyPressed && hasItems) {
                this._canSearch = false;
                var shouldHightlightAll = this.config.removeItems && !this.input.value && this.input.element === document.activeElement;
                if (shouldHightlightAll) {
                  this.highlightAll();
                }
              }
            };
            Choices3.prototype._onEnterKey = function(event, activeItems, hasActiveDropdown) {
              var target = event.target;
              var enterKey = constants_1.KEY_CODES.ENTER_KEY;
              var targetWasButton = target && target.hasAttribute("data-button");
              if (this._isTextElement && target && target.value) {
                var value = this.input.value;
                var canAddItem = this._canAddItem(activeItems, value);
                if (canAddItem.response) {
                  this.hideDropdown(true);
                  this._addItem({
                    value
                  });
                  this._triggerChange(value);
                  this.clearInput();
                }
              }
              if (targetWasButton) {
                this._handleButtonAction(activeItems, target);
                event.preventDefault();
              }
              if (hasActiveDropdown) {
                var highlightedChoice = this.dropdown.getChild(".".concat(this.config.classNames.highlightedState));
                if (highlightedChoice) {
                  if (activeItems[0]) {
                    activeItems[0].keyCode = enterKey;
                  }
                  this._handleChoiceAction(activeItems, highlightedChoice);
                }
                event.preventDefault();
              } else if (this._isSelectOneElement) {
                this.showDropdown();
                event.preventDefault();
              }
            };
            Choices3.prototype._onEscapeKey = function(hasActiveDropdown) {
              if (hasActiveDropdown) {
                this.hideDropdown(true);
                this.containerOuter.focus();
              }
            };
            Choices3.prototype._onDirectionKey = function(event, hasActiveDropdown) {
              var keyCode = event.keyCode, metaKey = event.metaKey;
              var downKey = constants_1.KEY_CODES.DOWN_KEY, pageUpKey = constants_1.KEY_CODES.PAGE_UP_KEY, pageDownKey = constants_1.KEY_CODES.PAGE_DOWN_KEY;
              if (hasActiveDropdown || this._isSelectOneElement) {
                this.showDropdown();
                this._canSearch = false;
                var directionInt = keyCode === downKey || keyCode === pageDownKey ? 1 : -1;
                var skipKey = metaKey || keyCode === pageDownKey || keyCode === pageUpKey;
                var selectableChoiceIdentifier = "[data-choice-selectable]";
                var nextEl = void 0;
                if (skipKey) {
                  if (directionInt > 0) {
                    nextEl = this.dropdown.element.querySelector("".concat(selectableChoiceIdentifier, ":last-of-type"));
                  } else {
                    nextEl = this.dropdown.element.querySelector(selectableChoiceIdentifier);
                  }
                } else {
                  var currentEl = this.dropdown.element.querySelector(".".concat(this.config.classNames.highlightedState));
                  if (currentEl) {
                    nextEl = (0, utils_1.getAdjacentEl)(currentEl, selectableChoiceIdentifier, directionInt);
                  } else {
                    nextEl = this.dropdown.element.querySelector(selectableChoiceIdentifier);
                  }
                }
                if (nextEl) {
                  if (!(0, utils_1.isScrolledIntoView)(nextEl, this.choiceList.element, directionInt)) {
                    this.choiceList.scrollToChildElement(nextEl, directionInt);
                  }
                  this._highlightChoice(nextEl);
                }
                event.preventDefault();
              }
            };
            Choices3.prototype._onDeleteKey = function(event, activeItems, hasFocusedInput) {
              var target = event.target;
              if (!this._isSelectOneElement && !target.value && hasFocusedInput) {
                this._handleBackspace(activeItems);
                event.preventDefault();
              }
            };
            Choices3.prototype._onTouchMove = function() {
              if (this._wasTap) {
                this._wasTap = false;
              }
            };
            Choices3.prototype._onTouchEnd = function(event) {
              var target = (event || event.touches[0]).target;
              var touchWasWithinContainer = this._wasTap && this.containerOuter.element.contains(target);
              if (touchWasWithinContainer) {
                var containerWasExactTarget = target === this.containerOuter.element || target === this.containerInner.element;
                if (containerWasExactTarget) {
                  if (this._isTextElement) {
                    this.input.focus();
                  } else if (this._isSelectMultipleElement) {
                    this.showDropdown();
                  }
                }
                event.stopPropagation();
              }
              this._wasTap = true;
            };
            Choices3.prototype._onMouseDown = function(event) {
              var target = event.target;
              if (!(target instanceof HTMLElement)) {
                return;
              }
              if (IS_IE11 && this.choiceList.element.contains(target)) {
                var firstChoice = this.choiceList.element.firstElementChild;
                var isOnScrollbar = this._direction === "ltr" ? event.offsetX >= firstChoice.offsetWidth : event.offsetX < firstChoice.offsetLeft;
                this._isScrollingOnIe = isOnScrollbar;
              }
              if (target === this.input.element) {
                return;
              }
              var item = target.closest("[data-button],[data-item],[data-choice]");
              if (item instanceof HTMLElement) {
                var hasShiftKey = event.shiftKey;
                var activeItems = this._store.activeItems;
                var dataset = item.dataset;
                if ("button" in dataset) {
                  this._handleButtonAction(activeItems, item);
                } else if ("item" in dataset) {
                  this._handleItemAction(activeItems, item, hasShiftKey);
                } else if ("choice" in dataset) {
                  this._handleChoiceAction(activeItems, item);
                }
              }
              event.preventDefault();
            };
            Choices3.prototype._onMouseOver = function(_a) {
              var target = _a.target;
              if (target instanceof HTMLElement && "choice" in target.dataset) {
                this._highlightChoice(target);
              }
            };
            Choices3.prototype._onClick = function(_a) {
              var target = _a.target;
              var clickWasWithinContainer = this.containerOuter.element.contains(target);
              if (clickWasWithinContainer) {
                if (!this.dropdown.isActive && !this.containerOuter.isDisabled) {
                  if (this._isTextElement) {
                    if (document.activeElement !== this.input.element) {
                      this.input.focus();
                    }
                  } else {
                    this.showDropdown();
                    this.containerOuter.focus();
                  }
                } else if (this._isSelectOneElement && target !== this.input.element && !this.dropdown.element.contains(target)) {
                  this.hideDropdown();
                }
              } else {
                var hasHighlightedItems = this._store.highlightedActiveItems.length > 0;
                if (hasHighlightedItems) {
                  this.unhighlightAll();
                }
                this.containerOuter.removeFocusState();
                this.hideDropdown(true);
              }
            };
            Choices3.prototype._onFocus = function(_a) {
              var _b;
              var _this = this;
              var target = _a.target;
              var focusWasWithinContainer = target && this.containerOuter.element.contains(target);
              if (!focusWasWithinContainer) {
                return;
              }
              var focusActions = (_b = {}, _b[constants_1.TEXT_TYPE] = function() {
                if (target === _this.input.element) {
                  _this.containerOuter.addFocusState();
                }
              }, _b[constants_1.SELECT_ONE_TYPE] = function() {
                _this.containerOuter.addFocusState();
                if (target === _this.input.element) {
                  _this.showDropdown(true);
                }
              }, _b[constants_1.SELECT_MULTIPLE_TYPE] = function() {
                if (target === _this.input.element) {
                  _this.showDropdown(true);
                  _this.containerOuter.addFocusState();
                }
              }, _b);
              focusActions[this.passedElement.element.type]();
            };
            Choices3.prototype._onBlur = function(_a) {
              var _b;
              var _this = this;
              var target = _a.target;
              var blurWasWithinContainer = target && this.containerOuter.element.contains(target);
              if (blurWasWithinContainer && !this._isScrollingOnIe) {
                var activeItems = this._store.activeItems;
                var hasHighlightedItems_1 = activeItems.some(function(item) {
                  return item.highlighted;
                });
                var blurActions = (_b = {}, _b[constants_1.TEXT_TYPE] = function() {
                  if (target === _this.input.element) {
                    _this.containerOuter.removeFocusState();
                    if (hasHighlightedItems_1) {
                      _this.unhighlightAll();
                    }
                    _this.hideDropdown(true);
                  }
                }, _b[constants_1.SELECT_ONE_TYPE] = function() {
                  _this.containerOuter.removeFocusState();
                  if (target === _this.input.element || target === _this.containerOuter.element && !_this._canSearch) {
                    _this.hideDropdown(true);
                  }
                }, _b[constants_1.SELECT_MULTIPLE_TYPE] = function() {
                  if (target === _this.input.element) {
                    _this.containerOuter.removeFocusState();
                    _this.hideDropdown(true);
                    if (hasHighlightedItems_1) {
                      _this.unhighlightAll();
                    }
                  }
                }, _b);
                blurActions[this.passedElement.element.type]();
              } else {
                this._isScrollingOnIe = false;
                this.input.element.focus();
              }
            };
            Choices3.prototype._onFormReset = function() {
              this._store.dispatch((0, misc_1.resetTo)(this._initialState));
            };
            Choices3.prototype._highlightChoice = function(el) {
              var _this = this;
              if (el === void 0) {
                el = null;
              }
              var choices = Array.from(this.dropdown.element.querySelectorAll("[data-choice-selectable]"));
              if (!choices.length) {
                return;
              }
              var passedEl = el;
              var highlightedChoices = Array.from(this.dropdown.element.querySelectorAll(".".concat(this.config.classNames.highlightedState)));
              highlightedChoices.forEach(function(choice) {
                choice.classList.remove(_this.config.classNames.highlightedState);
                choice.setAttribute("aria-selected", "false");
              });
              if (passedEl) {
                this._highlightPosition = choices.indexOf(passedEl);
              } else {
                if (choices.length > this._highlightPosition) {
                  passedEl = choices[this._highlightPosition];
                } else {
                  passedEl = choices[choices.length - 1];
                }
                if (!passedEl) {
                  passedEl = choices[0];
                }
              }
              passedEl.classList.add(this.config.classNames.highlightedState);
              passedEl.setAttribute("aria-selected", "true");
              this.passedElement.triggerEvent(constants_1.EVENTS.highlightChoice, {
                el: passedEl
              });
              if (this.dropdown.isActive) {
                this.input.setActiveDescendant(passedEl.id);
                this.containerOuter.setActiveDescendant(passedEl.id);
              }
            };
            Choices3.prototype._addItem = function(_a) {
              var value = _a.value, _b = _a.label, label = _b === void 0 ? null : _b, _c = _a.choiceId, choiceId = _c === void 0 ? -1 : _c, _d = _a.groupId, groupId = _d === void 0 ? -1 : _d, _e = _a.customProperties, customProperties = _e === void 0 ? {} : _e, _f = _a.placeholder, placeholder = _f === void 0 ? false : _f, _g = _a.keyCode, keyCode = _g === void 0 ? -1 : _g;
              var passedValue = typeof value === "string" ? value.trim() : value;
              var items = this._store.items;
              var passedLabel = label || passedValue;
              var passedOptionId = choiceId || -1;
              var group = groupId >= 0 ? this._store.getGroupById(groupId) : null;
              var id = items ? items.length + 1 : 1;
              if (this.config.prependValue) {
                passedValue = this.config.prependValue + passedValue.toString();
              }
              if (this.config.appendValue) {
                passedValue += this.config.appendValue.toString();
              }
              this._store.dispatch((0, items_1.addItem)({
                value: passedValue,
                label: passedLabel,
                id,
                choiceId: passedOptionId,
                groupId,
                customProperties,
                placeholder,
                keyCode
              }));
              if (this._isSelectOneElement) {
                this.removeActiveItems(id);
              }
              this.passedElement.triggerEvent(constants_1.EVENTS.addItem, {
                id,
                value: passedValue,
                label: passedLabel,
                customProperties,
                groupValue: group && group.value ? group.value : null,
                keyCode
              });
            };
            Choices3.prototype._removeItem = function(item) {
              var id = item.id, value = item.value, label = item.label, customProperties = item.customProperties, choiceId = item.choiceId, groupId = item.groupId;
              var group = groupId && groupId >= 0 ? this._store.getGroupById(groupId) : null;
              if (!id || !choiceId) {
                return;
              }
              this._store.dispatch((0, items_1.removeItem)(id, choiceId));
              this.passedElement.triggerEvent(constants_1.EVENTS.removeItem, {
                id,
                value,
                label,
                customProperties,
                groupValue: group && group.value ? group.value : null
              });
            };
            Choices3.prototype._addChoice = function(_a) {
              var value = _a.value, _b = _a.label, label = _b === void 0 ? null : _b, _c = _a.isSelected, isSelected = _c === void 0 ? false : _c, _d = _a.isDisabled, isDisabled = _d === void 0 ? false : _d, _e = _a.groupId, groupId = _e === void 0 ? -1 : _e, _f = _a.customProperties, customProperties = _f === void 0 ? {} : _f, _g = _a.placeholder, placeholder = _g === void 0 ? false : _g, _h = _a.keyCode, keyCode = _h === void 0 ? -1 : _h;
              if (typeof value === "undefined" || value === null) {
                return;
              }
              var choices = this._store.choices;
              var choiceLabel = label || value;
              var choiceId = choices ? choices.length + 1 : 1;
              var choiceElementId = "".concat(this._baseId, "-").concat(this._idNames.itemChoice, "-").concat(choiceId);
              this._store.dispatch((0, choices_1.addChoice)({
                id: choiceId,
                groupId,
                elementId: choiceElementId,
                value,
                label: choiceLabel,
                disabled: isDisabled,
                customProperties,
                placeholder,
                keyCode
              }));
              if (isSelected) {
                this._addItem({
                  value,
                  label: choiceLabel,
                  choiceId,
                  customProperties,
                  placeholder,
                  keyCode
                });
              }
            };
            Choices3.prototype._addGroup = function(_a) {
              var _this = this;
              var group = _a.group, id = _a.id, _b = _a.valueKey, valueKey = _b === void 0 ? "value" : _b, _c = _a.labelKey, labelKey = _c === void 0 ? "label" : _c;
              var groupChoices = (0, utils_1.isType)("Object", group) ? group.choices : Array.from(group.getElementsByTagName("OPTION"));
              var groupId = id || Math.floor(new Date().valueOf() * Math.random());
              var isDisabled = group.disabled ? group.disabled : false;
              if (groupChoices) {
                this._store.dispatch((0, groups_1.addGroup)({
                  value: group.label,
                  id: groupId,
                  active: true,
                  disabled: isDisabled
                }));
                var addGroupChoices = function(choice) {
                  var isOptDisabled = choice.disabled || choice.parentNode && choice.parentNode.disabled;
                  _this._addChoice({
                    value: choice[valueKey],
                    label: (0, utils_1.isType)("Object", choice) ? choice[labelKey] : choice.innerHTML,
                    isSelected: choice.selected,
                    isDisabled: isOptDisabled,
                    groupId,
                    customProperties: choice.customProperties,
                    placeholder: choice.placeholder
                  });
                };
                groupChoices.forEach(addGroupChoices);
              } else {
                this._store.dispatch((0, groups_1.addGroup)({
                  value: group.label,
                  id: group.id,
                  active: false,
                  disabled: group.disabled
                }));
              }
            };
            Choices3.prototype._getTemplate = function(template) {
              var _a;
              var args = [];
              for (var _i = 1; _i < arguments.length; _i++) {
                args[_i - 1] = arguments[_i];
              }
              return (_a = this._templates[template]).call.apply(_a, __spreadArray([this, this.config], args, false));
            };
            Choices3.prototype._createTemplates = function() {
              var callbackOnCreateTemplates = this.config.callbackOnCreateTemplates;
              var userTemplates = {};
              if (callbackOnCreateTemplates && typeof callbackOnCreateTemplates === "function") {
                userTemplates = callbackOnCreateTemplates.call(this, utils_1.strToEl);
              }
              this._templates = (0, deepmerge_1.default)(templates_1.default, userTemplates);
            };
            Choices3.prototype._createElements = function() {
              this.containerOuter = new components_1.Container({
                element: this._getTemplate("containerOuter", this._direction, this._isSelectElement, this._isSelectOneElement, this.config.searchEnabled, this.passedElement.element.type, this.config.labelId),
                classNames: this.config.classNames,
                type: this.passedElement.element.type,
                position: this.config.position
              });
              this.containerInner = new components_1.Container({
                element: this._getTemplate("containerInner"),
                classNames: this.config.classNames,
                type: this.passedElement.element.type,
                position: this.config.position
              });
              this.input = new components_1.Input({
                element: this._getTemplate("input", this._placeholderValue),
                classNames: this.config.classNames,
                type: this.passedElement.element.type,
                preventPaste: !this.config.paste
              });
              this.choiceList = new components_1.List({
                element: this._getTemplate("choiceList", this._isSelectOneElement)
              });
              this.itemList = new components_1.List({
                element: this._getTemplate("itemList", this._isSelectOneElement)
              });
              this.dropdown = new components_1.Dropdown({
                element: this._getTemplate("dropdown"),
                classNames: this.config.classNames,
                type: this.passedElement.element.type
              });
            };
            Choices3.prototype._createStructure = function() {
              this.passedElement.conceal();
              this.containerInner.wrap(this.passedElement.element);
              this.containerOuter.wrap(this.containerInner.element);
              if (this._isSelectOneElement) {
                this.input.placeholder = this.config.searchPlaceholderValue || "";
              } else if (this._placeholderValue) {
                this.input.placeholder = this._placeholderValue;
                this.input.setWidth();
              }
              this.containerOuter.element.appendChild(this.containerInner.element);
              this.containerOuter.element.appendChild(this.dropdown.element);
              this.containerInner.element.appendChild(this.itemList.element);
              if (!this._isTextElement) {
                this.dropdown.element.appendChild(this.choiceList.element);
              }
              if (!this._isSelectOneElement) {
                this.containerInner.element.appendChild(this.input.element);
              } else if (this.config.searchEnabled) {
                this.dropdown.element.insertBefore(this.input.element, this.dropdown.element.firstChild);
              }
              if (this._isSelectElement) {
                this._highlightPosition = 0;
                this._isSearching = false;
                this._startLoading();
                if (this._presetGroups.length) {
                  this._addPredefinedGroups(this._presetGroups);
                } else {
                  this._addPredefinedChoices(this._presetChoices);
                }
                this._stopLoading();
              }
              if (this._isTextElement) {
                this._addPredefinedItems(this._presetItems);
              }
            };
            Choices3.prototype._addPredefinedGroups = function(groups) {
              var _this = this;
              var placeholderChoice = this.passedElement.placeholderOption;
              if (placeholderChoice && placeholderChoice.parentNode && placeholderChoice.parentNode.tagName === "SELECT") {
                this._addChoice({
                  value: placeholderChoice.value,
                  label: placeholderChoice.innerHTML,
                  isSelected: placeholderChoice.selected,
                  isDisabled: placeholderChoice.disabled,
                  placeholder: true
                });
              }
              groups.forEach(function(group) {
                return _this._addGroup({
                  group,
                  id: group.id || null
                });
              });
            };
            Choices3.prototype._addPredefinedChoices = function(choices) {
              var _this = this;
              if (this.config.shouldSort) {
                choices.sort(this.config.sorter);
              }
              var hasSelectedChoice = choices.some(function(choice) {
                return choice.selected;
              });
              var firstEnabledChoiceIndex = choices.findIndex(function(choice) {
                return choice.disabled === void 0 || !choice.disabled;
              });
              choices.forEach(function(choice, index) {
                var _a = choice.value, value = _a === void 0 ? "" : _a, label = choice.label, customProperties = choice.customProperties, placeholder = choice.placeholder;
                if (_this._isSelectElement) {
                  if (choice.choices) {
                    _this._addGroup({
                      group: choice,
                      id: choice.id || null
                    });
                  } else {
                    var shouldPreselect = _this._isSelectOneElement && !hasSelectedChoice && index === firstEnabledChoiceIndex;
                    var isSelected = shouldPreselect ? true : choice.selected;
                    var isDisabled = choice.disabled;
                    _this._addChoice({
                      value,
                      label,
                      isSelected: !!isSelected,
                      isDisabled: !!isDisabled,
                      placeholder: !!placeholder,
                      customProperties
                    });
                  }
                } else {
                  _this._addChoice({
                    value,
                    label,
                    isSelected: !!choice.selected,
                    isDisabled: !!choice.disabled,
                    placeholder: !!choice.placeholder,
                    customProperties
                  });
                }
              });
            };
            Choices3.prototype._addPredefinedItems = function(items) {
              var _this = this;
              items.forEach(function(item) {
                if (typeof item === "object" && item.value) {
                  _this._addItem({
                    value: item.value,
                    label: item.label,
                    choiceId: item.id,
                    customProperties: item.customProperties,
                    placeholder: item.placeholder
                  });
                }
                if (typeof item === "string") {
                  _this._addItem({
                    value: item
                  });
                }
              });
            };
            Choices3.prototype._setChoiceOrItem = function(item) {
              var _this = this;
              var itemType = (0, utils_1.getType)(item).toLowerCase();
              var handleType = {
                object: function() {
                  if (!item.value) {
                    return;
                  }
                  if (!_this._isTextElement) {
                    _this._addChoice({
                      value: item.value,
                      label: item.label,
                      isSelected: true,
                      isDisabled: false,
                      customProperties: item.customProperties,
                      placeholder: item.placeholder
                    });
                  } else {
                    _this._addItem({
                      value: item.value,
                      label: item.label,
                      choiceId: item.id,
                      customProperties: item.customProperties,
                      placeholder: item.placeholder
                    });
                  }
                },
                string: function() {
                  if (!_this._isTextElement) {
                    _this._addChoice({
                      value: item,
                      label: item,
                      isSelected: true,
                      isDisabled: false
                    });
                  } else {
                    _this._addItem({
                      value: item
                    });
                  }
                }
              };
              handleType[itemType]();
            };
            Choices3.prototype._findAndSelectChoiceByValue = function(value) {
              var _this = this;
              var choices = this._store.choices;
              var foundChoice = choices.find(function(choice) {
                return _this.config.valueComparer(choice.value, value);
              });
              if (foundChoice && !foundChoice.selected) {
                this._addItem({
                  value: foundChoice.value,
                  label: foundChoice.label,
                  choiceId: foundChoice.id,
                  groupId: foundChoice.groupId,
                  customProperties: foundChoice.customProperties,
                  placeholder: foundChoice.placeholder,
                  keyCode: foundChoice.keyCode
                });
              }
            };
            Choices3.prototype._generatePlaceholderValue = function() {
              if (this._isSelectElement && this.passedElement.placeholderOption) {
                var placeholderOption = this.passedElement.placeholderOption;
                return placeholderOption ? placeholderOption.text : null;
              }
              var _a = this.config, placeholder = _a.placeholder, placeholderValue = _a.placeholderValue;
              var dataset = this.passedElement.element.dataset;
              if (placeholder) {
                if (placeholderValue) {
                  return placeholderValue;
                }
                if (dataset.placeholder) {
                  return dataset.placeholder;
                }
              }
              return null;
            };
            return Choices3;
          }();
          exports2["default"] = Choices2;
        },
        613: function(__unused_webpack_module, exports2, __webpack_require__2) {
          Object.defineProperty(exports2, "__esModule", {
            value: true
          });
          var utils_1 = __webpack_require__2(799);
          var constants_1 = __webpack_require__2(883);
          var Container = function() {
            function Container2(_a) {
              var element = _a.element, type = _a.type, classNames = _a.classNames, position = _a.position;
              this.element = element;
              this.classNames = classNames;
              this.type = type;
              this.position = position;
              this.isOpen = false;
              this.isFlipped = false;
              this.isFocussed = false;
              this.isDisabled = false;
              this.isLoading = false;
              this._onFocus = this._onFocus.bind(this);
              this._onBlur = this._onBlur.bind(this);
            }
            Container2.prototype.addEventListeners = function() {
              this.element.addEventListener("focus", this._onFocus);
              this.element.addEventListener("blur", this._onBlur);
            };
            Container2.prototype.removeEventListeners = function() {
              this.element.removeEventListener("focus", this._onFocus);
              this.element.removeEventListener("blur", this._onBlur);
            };
            Container2.prototype.shouldFlip = function(dropdownPos) {
              if (typeof dropdownPos !== "number") {
                return false;
              }
              var shouldFlip = false;
              if (this.position === "auto") {
                shouldFlip = !window.matchMedia("(min-height: ".concat(dropdownPos + 1, "px)")).matches;
              } else if (this.position === "top") {
                shouldFlip = true;
              }
              return shouldFlip;
            };
            Container2.prototype.setActiveDescendant = function(activeDescendantID) {
              this.element.setAttribute("aria-activedescendant", activeDescendantID);
            };
            Container2.prototype.removeActiveDescendant = function() {
              this.element.removeAttribute("aria-activedescendant");
            };
            Container2.prototype.open = function(dropdownPos) {
              this.element.classList.add(this.classNames.openState);
              this.element.setAttribute("aria-expanded", "true");
              this.isOpen = true;
              if (this.shouldFlip(dropdownPos)) {
                this.element.classList.add(this.classNames.flippedState);
                this.isFlipped = true;
              }
            };
            Container2.prototype.close = function() {
              this.element.classList.remove(this.classNames.openState);
              this.element.setAttribute("aria-expanded", "false");
              this.removeActiveDescendant();
              this.isOpen = false;
              if (this.isFlipped) {
                this.element.classList.remove(this.classNames.flippedState);
                this.isFlipped = false;
              }
            };
            Container2.prototype.focus = function() {
              if (!this.isFocussed) {
                this.element.focus();
              }
            };
            Container2.prototype.addFocusState = function() {
              this.element.classList.add(this.classNames.focusState);
            };
            Container2.prototype.removeFocusState = function() {
              this.element.classList.remove(this.classNames.focusState);
            };
            Container2.prototype.enable = function() {
              this.element.classList.remove(this.classNames.disabledState);
              this.element.removeAttribute("aria-disabled");
              if (this.type === constants_1.SELECT_ONE_TYPE) {
                this.element.setAttribute("tabindex", "0");
              }
              this.isDisabled = false;
            };
            Container2.prototype.disable = function() {
              this.element.classList.add(this.classNames.disabledState);
              this.element.setAttribute("aria-disabled", "true");
              if (this.type === constants_1.SELECT_ONE_TYPE) {
                this.element.setAttribute("tabindex", "-1");
              }
              this.isDisabled = true;
            };
            Container2.prototype.wrap = function(element) {
              (0, utils_1.wrap)(element, this.element);
            };
            Container2.prototype.unwrap = function(element) {
              if (this.element.parentNode) {
                this.element.parentNode.insertBefore(element, this.element);
                this.element.parentNode.removeChild(this.element);
              }
            };
            Container2.prototype.addLoadingState = function() {
              this.element.classList.add(this.classNames.loadingState);
              this.element.setAttribute("aria-busy", "true");
              this.isLoading = true;
            };
            Container2.prototype.removeLoadingState = function() {
              this.element.classList.remove(this.classNames.loadingState);
              this.element.removeAttribute("aria-busy");
              this.isLoading = false;
            };
            Container2.prototype._onFocus = function() {
              this.isFocussed = true;
            };
            Container2.prototype._onBlur = function() {
              this.isFocussed = false;
            };
            return Container2;
          }();
          exports2["default"] = Container;
        },
        217: function(__unused_webpack_module, exports2) {
          Object.defineProperty(exports2, "__esModule", {
            value: true
          });
          var Dropdown = function() {
            function Dropdown2(_a) {
              var element = _a.element, type = _a.type, classNames = _a.classNames;
              this.element = element;
              this.classNames = classNames;
              this.type = type;
              this.isActive = false;
            }
            Object.defineProperty(Dropdown2.prototype, "distanceFromTopWindow", {
              get: function() {
                return this.element.getBoundingClientRect().bottom;
              },
              enumerable: false,
              configurable: true
            });
            Dropdown2.prototype.getChild = function(selector) {
              return this.element.querySelector(selector);
            };
            Dropdown2.prototype.show = function() {
              this.element.classList.add(this.classNames.activeState);
              this.element.setAttribute("aria-expanded", "true");
              this.isActive = true;
              return this;
            };
            Dropdown2.prototype.hide = function() {
              this.element.classList.remove(this.classNames.activeState);
              this.element.setAttribute("aria-expanded", "false");
              this.isActive = false;
              return this;
            };
            return Dropdown2;
          }();
          exports2["default"] = Dropdown;
        },
        520: function(__unused_webpack_module, exports2, __webpack_require__2) {
          var __importDefault = this && this.__importDefault || function(mod) {
            return mod && mod.__esModule ? mod : {
              default: mod
            };
          };
          Object.defineProperty(exports2, "__esModule", {
            value: true
          });
          exports2.WrappedSelect = exports2.WrappedInput = exports2.List = exports2.Input = exports2.Container = exports2.Dropdown = void 0;
          var dropdown_1 = __importDefault(__webpack_require__2(217));
          exports2.Dropdown = dropdown_1.default;
          var container_1 = __importDefault(__webpack_require__2(613));
          exports2.Container = container_1.default;
          var input_1 = __importDefault(__webpack_require__2(11));
          exports2.Input = input_1.default;
          var list_1 = __importDefault(__webpack_require__2(624));
          exports2.List = list_1.default;
          var wrapped_input_1 = __importDefault(__webpack_require__2(541));
          exports2.WrappedInput = wrapped_input_1.default;
          var wrapped_select_1 = __importDefault(__webpack_require__2(982));
          exports2.WrappedSelect = wrapped_select_1.default;
        },
        11: function(__unused_webpack_module, exports2, __webpack_require__2) {
          Object.defineProperty(exports2, "__esModule", {
            value: true
          });
          var utils_1 = __webpack_require__2(799);
          var constants_1 = __webpack_require__2(883);
          var Input = function() {
            function Input2(_a) {
              var element = _a.element, type = _a.type, classNames = _a.classNames, preventPaste = _a.preventPaste;
              this.element = element;
              this.type = type;
              this.classNames = classNames;
              this.preventPaste = preventPaste;
              this.isFocussed = this.element.isEqualNode(document.activeElement);
              this.isDisabled = element.disabled;
              this._onPaste = this._onPaste.bind(this);
              this._onInput = this._onInput.bind(this);
              this._onFocus = this._onFocus.bind(this);
              this._onBlur = this._onBlur.bind(this);
            }
            Object.defineProperty(Input2.prototype, "placeholder", {
              set: function(placeholder) {
                this.element.placeholder = placeholder;
              },
              enumerable: false,
              configurable: true
            });
            Object.defineProperty(Input2.prototype, "value", {
              get: function() {
                return (0, utils_1.sanitise)(this.element.value);
              },
              set: function(value) {
                this.element.value = value;
              },
              enumerable: false,
              configurable: true
            });
            Object.defineProperty(Input2.prototype, "rawValue", {
              get: function() {
                return this.element.value;
              },
              enumerable: false,
              configurable: true
            });
            Input2.prototype.addEventListeners = function() {
              this.element.addEventListener("paste", this._onPaste);
              this.element.addEventListener("input", this._onInput, {
                passive: true
              });
              this.element.addEventListener("focus", this._onFocus, {
                passive: true
              });
              this.element.addEventListener("blur", this._onBlur, {
                passive: true
              });
            };
            Input2.prototype.removeEventListeners = function() {
              this.element.removeEventListener("input", this._onInput);
              this.element.removeEventListener("paste", this._onPaste);
              this.element.removeEventListener("focus", this._onFocus);
              this.element.removeEventListener("blur", this._onBlur);
            };
            Input2.prototype.enable = function() {
              this.element.removeAttribute("disabled");
              this.isDisabled = false;
            };
            Input2.prototype.disable = function() {
              this.element.setAttribute("disabled", "");
              this.isDisabled = true;
            };
            Input2.prototype.focus = function() {
              if (!this.isFocussed) {
                this.element.focus();
              }
            };
            Input2.prototype.blur = function() {
              if (this.isFocussed) {
                this.element.blur();
              }
            };
            Input2.prototype.clear = function(setWidth) {
              if (setWidth === void 0) {
                setWidth = true;
              }
              if (this.element.value) {
                this.element.value = "";
              }
              if (setWidth) {
                this.setWidth();
              }
              return this;
            };
            Input2.prototype.setWidth = function() {
              var _a = this.element, style = _a.style, value = _a.value, placeholder = _a.placeholder;
              style.minWidth = "".concat(placeholder.length + 1, "ch");
              style.width = "".concat(value.length + 1, "ch");
            };
            Input2.prototype.setActiveDescendant = function(activeDescendantID) {
              this.element.setAttribute("aria-activedescendant", activeDescendantID);
            };
            Input2.prototype.removeActiveDescendant = function() {
              this.element.removeAttribute("aria-activedescendant");
            };
            Input2.prototype._onInput = function() {
              if (this.type !== constants_1.SELECT_ONE_TYPE) {
                this.setWidth();
              }
            };
            Input2.prototype._onPaste = function(event) {
              if (this.preventPaste) {
                event.preventDefault();
              }
            };
            Input2.prototype._onFocus = function() {
              this.isFocussed = true;
            };
            Input2.prototype._onBlur = function() {
              this.isFocussed = false;
            };
            return Input2;
          }();
          exports2["default"] = Input;
        },
        624: function(__unused_webpack_module, exports2, __webpack_require__2) {
          Object.defineProperty(exports2, "__esModule", {
            value: true
          });
          var constants_1 = __webpack_require__2(883);
          var List = function() {
            function List2(_a) {
              var element = _a.element;
              this.element = element;
              this.scrollPos = this.element.scrollTop;
              this.height = this.element.offsetHeight;
            }
            List2.prototype.clear = function() {
              this.element.innerHTML = "";
            };
            List2.prototype.append = function(node) {
              this.element.appendChild(node);
            };
            List2.prototype.getChild = function(selector) {
              return this.element.querySelector(selector);
            };
            List2.prototype.hasChildren = function() {
              return this.element.hasChildNodes();
            };
            List2.prototype.scrollToTop = function() {
              this.element.scrollTop = 0;
            };
            List2.prototype.scrollToChildElement = function(element, direction) {
              var _this = this;
              if (!element) {
                return;
              }
              var listHeight = this.element.offsetHeight;
              var listScrollPosition = this.element.scrollTop + listHeight;
              var elementHeight = element.offsetHeight;
              var elementPos = element.offsetTop + elementHeight;
              var destination = direction > 0 ? this.element.scrollTop + elementPos - listScrollPosition : element.offsetTop;
              requestAnimationFrame(function() {
                _this._animateScroll(destination, direction);
              });
            };
            List2.prototype._scrollDown = function(scrollPos, strength, destination) {
              var easing = (destination - scrollPos) / strength;
              var distance = easing > 1 ? easing : 1;
              this.element.scrollTop = scrollPos + distance;
            };
            List2.prototype._scrollUp = function(scrollPos, strength, destination) {
              var easing = (scrollPos - destination) / strength;
              var distance = easing > 1 ? easing : 1;
              this.element.scrollTop = scrollPos - distance;
            };
            List2.prototype._animateScroll = function(destination, direction) {
              var _this = this;
              var strength = constants_1.SCROLLING_SPEED;
              var choiceListScrollTop = this.element.scrollTop;
              var continueAnimation = false;
              if (direction > 0) {
                this._scrollDown(choiceListScrollTop, strength, destination);
                if (choiceListScrollTop < destination) {
                  continueAnimation = true;
                }
              } else {
                this._scrollUp(choiceListScrollTop, strength, destination);
                if (choiceListScrollTop > destination) {
                  continueAnimation = true;
                }
              }
              if (continueAnimation) {
                requestAnimationFrame(function() {
                  _this._animateScroll(destination, direction);
                });
              }
            };
            return List2;
          }();
          exports2["default"] = List;
        },
        730: function(__unused_webpack_module, exports2, __webpack_require__2) {
          Object.defineProperty(exports2, "__esModule", {
            value: true
          });
          var utils_1 = __webpack_require__2(799);
          var WrappedElement = function() {
            function WrappedElement2(_a) {
              var element = _a.element, classNames = _a.classNames;
              this.element = element;
              this.classNames = classNames;
              if (!(element instanceof HTMLInputElement) && !(element instanceof HTMLSelectElement)) {
                throw new TypeError("Invalid element passed");
              }
              this.isDisabled = false;
            }
            Object.defineProperty(WrappedElement2.prototype, "isActive", {
              get: function() {
                return this.element.dataset.choice === "active";
              },
              enumerable: false,
              configurable: true
            });
            Object.defineProperty(WrappedElement2.prototype, "dir", {
              get: function() {
                return this.element.dir;
              },
              enumerable: false,
              configurable: true
            });
            Object.defineProperty(WrappedElement2.prototype, "value", {
              get: function() {
                return this.element.value;
              },
              set: function(value) {
                this.element.value = value;
              },
              enumerable: false,
              configurable: true
            });
            WrappedElement2.prototype.conceal = function() {
              this.element.classList.add(this.classNames.input);
              this.element.hidden = true;
              this.element.tabIndex = -1;
              var origStyle = this.element.getAttribute("style");
              if (origStyle) {
                this.element.setAttribute("data-choice-orig-style", origStyle);
              }
              this.element.setAttribute("data-choice", "active");
            };
            WrappedElement2.prototype.reveal = function() {
              this.element.classList.remove(this.classNames.input);
              this.element.hidden = false;
              this.element.removeAttribute("tabindex");
              var origStyle = this.element.getAttribute("data-choice-orig-style");
              if (origStyle) {
                this.element.removeAttribute("data-choice-orig-style");
                this.element.setAttribute("style", origStyle);
              } else {
                this.element.removeAttribute("style");
              }
              this.element.removeAttribute("data-choice");
              this.element.value = this.element.value;
            };
            WrappedElement2.prototype.enable = function() {
              this.element.removeAttribute("disabled");
              this.element.disabled = false;
              this.isDisabled = false;
            };
            WrappedElement2.prototype.disable = function() {
              this.element.setAttribute("disabled", "");
              this.element.disabled = true;
              this.isDisabled = true;
            };
            WrappedElement2.prototype.triggerEvent = function(eventType, data2) {
              (0, utils_1.dispatchEvent)(this.element, eventType, data2);
            };
            return WrappedElement2;
          }();
          exports2["default"] = WrappedElement;
        },
        541: function(__unused_webpack_module, exports2, __webpack_require__2) {
          var __extends = this && this.__extends || function() {
            var extendStatics = function(d, b) {
              extendStatics = Object.setPrototypeOf || {
                __proto__: []
              } instanceof Array && function(d2, b2) {
                d2.__proto__ = b2;
              } || function(d2, b2) {
                for (var p in b2)
                  if (Object.prototype.hasOwnProperty.call(b2, p))
                    d2[p] = b2[p];
              };
              return extendStatics(d, b);
            };
            return function(d, b) {
              if (typeof b !== "function" && b !== null)
                throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
              extendStatics(d, b);
              function __() {
                this.constructor = d;
              }
              d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
            };
          }();
          var __importDefault = this && this.__importDefault || function(mod) {
            return mod && mod.__esModule ? mod : {
              default: mod
            };
          };
          Object.defineProperty(exports2, "__esModule", {
            value: true
          });
          var wrapped_element_1 = __importDefault(__webpack_require__2(730));
          var WrappedInput = function(_super) {
            __extends(WrappedInput2, _super);
            function WrappedInput2(_a) {
              var element = _a.element, classNames = _a.classNames, delimiter = _a.delimiter;
              var _this = _super.call(this, {
                element,
                classNames
              }) || this;
              _this.delimiter = delimiter;
              return _this;
            }
            Object.defineProperty(WrappedInput2.prototype, "value", {
              get: function() {
                return this.element.value;
              },
              set: function(value) {
                this.element.setAttribute("value", value);
                this.element.value = value;
              },
              enumerable: false,
              configurable: true
            });
            return WrappedInput2;
          }(wrapped_element_1.default);
          exports2["default"] = WrappedInput;
        },
        982: function(__unused_webpack_module, exports2, __webpack_require__2) {
          var __extends = this && this.__extends || function() {
            var extendStatics = function(d, b) {
              extendStatics = Object.setPrototypeOf || {
                __proto__: []
              } instanceof Array && function(d2, b2) {
                d2.__proto__ = b2;
              } || function(d2, b2) {
                for (var p in b2)
                  if (Object.prototype.hasOwnProperty.call(b2, p))
                    d2[p] = b2[p];
              };
              return extendStatics(d, b);
            };
            return function(d, b) {
              if (typeof b !== "function" && b !== null)
                throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
              extendStatics(d, b);
              function __() {
                this.constructor = d;
              }
              d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
            };
          }();
          var __importDefault = this && this.__importDefault || function(mod) {
            return mod && mod.__esModule ? mod : {
              default: mod
            };
          };
          Object.defineProperty(exports2, "__esModule", {
            value: true
          });
          var wrapped_element_1 = __importDefault(__webpack_require__2(730));
          var WrappedSelect = function(_super) {
            __extends(WrappedSelect2, _super);
            function WrappedSelect2(_a) {
              var element = _a.element, classNames = _a.classNames, template = _a.template;
              var _this = _super.call(this, {
                element,
                classNames
              }) || this;
              _this.template = template;
              return _this;
            }
            Object.defineProperty(WrappedSelect2.prototype, "placeholderOption", {
              get: function() {
                return this.element.querySelector('option[value=""]') || this.element.querySelector("option[placeholder]");
              },
              enumerable: false,
              configurable: true
            });
            Object.defineProperty(WrappedSelect2.prototype, "optionGroups", {
              get: function() {
                return Array.from(this.element.getElementsByTagName("OPTGROUP"));
              },
              enumerable: false,
              configurable: true
            });
            Object.defineProperty(WrappedSelect2.prototype, "options", {
              get: function() {
                return Array.from(this.element.options);
              },
              set: function(options) {
                var _this = this;
                var fragment = document.createDocumentFragment();
                var addOptionToFragment = function(data2) {
                  var option2 = _this.template(data2);
                  fragment.appendChild(option2);
                };
                options.forEach(function(optionData) {
                  return addOptionToFragment(optionData);
                });
                this.appendDocFragment(fragment);
              },
              enumerable: false,
              configurable: true
            });
            WrappedSelect2.prototype.appendDocFragment = function(fragment) {
              this.element.innerHTML = "";
              this.element.appendChild(fragment);
            };
            return WrappedSelect2;
          }(wrapped_element_1.default);
          exports2["default"] = WrappedSelect;
        },
        883: function(__unused_webpack_module, exports2) {
          Object.defineProperty(exports2, "__esModule", {
            value: true
          });
          exports2.SCROLLING_SPEED = exports2.SELECT_MULTIPLE_TYPE = exports2.SELECT_ONE_TYPE = exports2.TEXT_TYPE = exports2.KEY_CODES = exports2.ACTION_TYPES = exports2.EVENTS = void 0;
          exports2.EVENTS = {
            showDropdown: "showDropdown",
            hideDropdown: "hideDropdown",
            change: "change",
            choice: "choice",
            search: "search",
            addItem: "addItem",
            removeItem: "removeItem",
            highlightItem: "highlightItem",
            highlightChoice: "highlightChoice",
            unhighlightItem: "unhighlightItem"
          };
          exports2.ACTION_TYPES = {
            ADD_CHOICE: "ADD_CHOICE",
            FILTER_CHOICES: "FILTER_CHOICES",
            ACTIVATE_CHOICES: "ACTIVATE_CHOICES",
            CLEAR_CHOICES: "CLEAR_CHOICES",
            ADD_GROUP: "ADD_GROUP",
            ADD_ITEM: "ADD_ITEM",
            REMOVE_ITEM: "REMOVE_ITEM",
            HIGHLIGHT_ITEM: "HIGHLIGHT_ITEM",
            CLEAR_ALL: "CLEAR_ALL",
            RESET_TO: "RESET_TO",
            SET_IS_LOADING: "SET_IS_LOADING"
          };
          exports2.KEY_CODES = {
            BACK_KEY: 46,
            DELETE_KEY: 8,
            ENTER_KEY: 13,
            A_KEY: 65,
            ESC_KEY: 27,
            UP_KEY: 38,
            DOWN_KEY: 40,
            PAGE_UP_KEY: 33,
            PAGE_DOWN_KEY: 34
          };
          exports2.TEXT_TYPE = "text";
          exports2.SELECT_ONE_TYPE = "select-one";
          exports2.SELECT_MULTIPLE_TYPE = "select-multiple";
          exports2.SCROLLING_SPEED = 4;
        },
        789: function(__unused_webpack_module, exports2, __webpack_require__2) {
          Object.defineProperty(exports2, "__esModule", {
            value: true
          });
          exports2.DEFAULT_CONFIG = exports2.DEFAULT_CLASSNAMES = void 0;
          var utils_1 = __webpack_require__2(799);
          exports2.DEFAULT_CLASSNAMES = {
            containerOuter: "choices",
            containerInner: "choices__inner",
            input: "choices__input",
            inputCloned: "choices__input--cloned",
            list: "choices__list",
            listItems: "choices__list--multiple",
            listSingle: "choices__list--single",
            listDropdown: "choices__list--dropdown",
            item: "choices__item",
            itemSelectable: "choices__item--selectable",
            itemDisabled: "choices__item--disabled",
            itemChoice: "choices__item--choice",
            placeholder: "choices__placeholder",
            group: "choices__group",
            groupHeading: "choices__heading",
            button: "choices__button",
            activeState: "is-active",
            focusState: "is-focused",
            openState: "is-open",
            disabledState: "is-disabled",
            highlightedState: "is-highlighted",
            selectedState: "is-selected",
            flippedState: "is-flipped",
            loadingState: "is-loading",
            noResults: "has-no-results",
            noChoices: "has-no-choices"
          };
          exports2.DEFAULT_CONFIG = {
            items: [],
            choices: [],
            silent: false,
            renderChoiceLimit: -1,
            maxItemCount: -1,
            addItems: true,
            addItemFilter: null,
            removeItems: true,
            removeItemButton: false,
            editItems: false,
            allowHTML: true,
            duplicateItemsAllowed: true,
            delimiter: ",",
            paste: true,
            searchEnabled: true,
            searchChoices: true,
            searchFloor: 1,
            searchResultLimit: 4,
            searchFields: ["label", "value"],
            position: "auto",
            resetScrollPosition: true,
            shouldSort: true,
            shouldSortItems: false,
            sorter: utils_1.sortByAlpha,
            placeholder: true,
            placeholderValue: null,
            searchPlaceholderValue: null,
            prependValue: null,
            appendValue: null,
            renderSelectedChoices: "auto",
            loadingText: "Loading...",
            noResultsText: "No results found",
            noChoicesText: "No choices to choose from",
            itemSelectText: "Press to select",
            uniqueItemText: "Only unique values can be added",
            customAddItemText: "Only values matching specific conditions can be added",
            addItemText: function(value) {
              return 'Press Enter to add <b>"'.concat((0, utils_1.sanitise)(value), '"</b>');
            },
            maxItemText: function(maxItemCount) {
              return "Only ".concat(maxItemCount, " values can be added");
            },
            valueComparer: function(value1, value2) {
              return value1 === value2;
            },
            fuseOptions: {
              includeScore: true
            },
            labelId: "",
            callbackOnInit: null,
            callbackOnCreateTemplates: null,
            classNames: exports2.DEFAULT_CLASSNAMES
          };
        },
        18: function(__unused_webpack_module, exports2) {
          Object.defineProperty(exports2, "__esModule", {
            value: true
          });
        },
        978: function(__unused_webpack_module, exports2) {
          Object.defineProperty(exports2, "__esModule", {
            value: true
          });
        },
        948: function(__unused_webpack_module, exports2) {
          Object.defineProperty(exports2, "__esModule", {
            value: true
          });
        },
        359: function(__unused_webpack_module, exports2) {
          Object.defineProperty(exports2, "__esModule", {
            value: true
          });
        },
        285: function(__unused_webpack_module, exports2) {
          Object.defineProperty(exports2, "__esModule", {
            value: true
          });
        },
        533: function(__unused_webpack_module, exports2) {
          Object.defineProperty(exports2, "__esModule", {
            value: true
          });
        },
        187: function(__unused_webpack_module, exports2, __webpack_require__2) {
          var __createBinding = this && this.__createBinding || (Object.create ? function(o, m, k, k2) {
            if (k2 === void 0)
              k2 = k;
            Object.defineProperty(o, k2, {
              enumerable: true,
              get: function() {
                return m[k];
              }
            });
          } : function(o, m, k, k2) {
            if (k2 === void 0)
              k2 = k;
            o[k2] = m[k];
          });
          var __exportStar2 = this && this.__exportStar || function(m, exports3) {
            for (var p in m)
              if (p !== "default" && !Object.prototype.hasOwnProperty.call(exports3, p))
                __createBinding(exports3, m, p);
          };
          Object.defineProperty(exports2, "__esModule", {
            value: true
          });
          __exportStar2(__webpack_require__2(18), exports2);
          __exportStar2(__webpack_require__2(978), exports2);
          __exportStar2(__webpack_require__2(948), exports2);
          __exportStar2(__webpack_require__2(359), exports2);
          __exportStar2(__webpack_require__2(285), exports2);
          __exportStar2(__webpack_require__2(533), exports2);
          __exportStar2(__webpack_require__2(287), exports2);
          __exportStar2(__webpack_require__2(132), exports2);
          __exportStar2(__webpack_require__2(837), exports2);
          __exportStar2(__webpack_require__2(598), exports2);
          __exportStar2(__webpack_require__2(369), exports2);
          __exportStar2(__webpack_require__2(37), exports2);
          __exportStar2(__webpack_require__2(47), exports2);
          __exportStar2(__webpack_require__2(923), exports2);
          __exportStar2(__webpack_require__2(876), exports2);
        },
        287: function(__unused_webpack_module, exports2) {
          Object.defineProperty(exports2, "__esModule", {
            value: true
          });
        },
        132: function(__unused_webpack_module, exports2) {
          Object.defineProperty(exports2, "__esModule", {
            value: true
          });
        },
        837: function(__unused_webpack_module, exports2) {
          Object.defineProperty(exports2, "__esModule", {
            value: true
          });
        },
        598: function(__unused_webpack_module, exports2) {
          Object.defineProperty(exports2, "__esModule", {
            value: true
          });
        },
        37: function(__unused_webpack_module, exports2) {
          Object.defineProperty(exports2, "__esModule", {
            value: true
          });
        },
        369: function(__unused_webpack_module, exports2) {
          Object.defineProperty(exports2, "__esModule", {
            value: true
          });
        },
        47: function(__unused_webpack_module, exports2) {
          Object.defineProperty(exports2, "__esModule", {
            value: true
          });
        },
        923: function(__unused_webpack_module, exports2) {
          Object.defineProperty(exports2, "__esModule", {
            value: true
          });
        },
        876: function(__unused_webpack_module, exports2) {
          Object.defineProperty(exports2, "__esModule", {
            value: true
          });
        },
        799: function(__unused_webpack_module, exports2) {
          Object.defineProperty(exports2, "__esModule", {
            value: true
          });
          exports2.diff = exports2.cloneObject = exports2.existsInArray = exports2.dispatchEvent = exports2.sortByScore = exports2.sortByAlpha = exports2.strToEl = exports2.sanitise = exports2.isScrolledIntoView = exports2.getAdjacentEl = exports2.wrap = exports2.isType = exports2.getType = exports2.generateId = exports2.generateChars = exports2.getRandomNumber = void 0;
          var getRandomNumber = function(min, max) {
            return Math.floor(Math.random() * (max - min) + min);
          };
          exports2.getRandomNumber = getRandomNumber;
          var generateChars = function(length) {
            return Array.from({
              length
            }, function() {
              return (0, exports2.getRandomNumber)(0, 36).toString(36);
            }).join("");
          };
          exports2.generateChars = generateChars;
          var generateId = function(element, prefix) {
            var id = element.id || element.name && "".concat(element.name, "-").concat((0, exports2.generateChars)(2)) || (0, exports2.generateChars)(4);
            id = id.replace(/(:|\.|\[|\]|,)/g, "");
            id = "".concat(prefix, "-").concat(id);
            return id;
          };
          exports2.generateId = generateId;
          var getType = function(obj) {
            return Object.prototype.toString.call(obj).slice(8, -1);
          };
          exports2.getType = getType;
          var isType = function(type, obj) {
            return obj !== void 0 && obj !== null && (0, exports2.getType)(obj) === type;
          };
          exports2.isType = isType;
          var wrap2 = function(element, wrapper3) {
            if (wrapper3 === void 0) {
              wrapper3 = document.createElement("div");
            }
            if (element.parentNode) {
              if (element.nextSibling) {
                element.parentNode.insertBefore(wrapper3, element.nextSibling);
              } else {
                element.parentNode.appendChild(wrapper3);
              }
            }
            return wrapper3.appendChild(element);
          };
          exports2.wrap = wrap2;
          var getAdjacentEl = function(startEl, selector, direction) {
            if (direction === void 0) {
              direction = 1;
            }
            var prop = "".concat(direction > 0 ? "next" : "previous", "ElementSibling");
            var sibling = startEl[prop];
            while (sibling) {
              if (sibling.matches(selector)) {
                return sibling;
              }
              sibling = sibling[prop];
            }
            return sibling;
          };
          exports2.getAdjacentEl = getAdjacentEl;
          var isScrolledIntoView = function(element, parent, direction) {
            if (direction === void 0) {
              direction = 1;
            }
            if (!element) {
              return false;
            }
            var isVisible;
            if (direction > 0) {
              isVisible = parent.scrollTop + parent.offsetHeight >= element.offsetTop + element.offsetHeight;
            } else {
              isVisible = element.offsetTop >= parent.scrollTop;
            }
            return isVisible;
          };
          exports2.isScrolledIntoView = isScrolledIntoView;
          var sanitise = function(value) {
            if (typeof value !== "string") {
              return value;
            }
            return value.replace(/&/g, "&amp;").replace(/>/g, "&gt;").replace(/</g, "&lt;").replace(/"/g, "&quot;");
          };
          exports2.sanitise = sanitise;
          exports2.strToEl = function() {
            var tmpEl = document.createElement("div");
            return function(str) {
              var cleanedInput = str.trim();
              tmpEl.innerHTML = cleanedInput;
              var firldChild = tmpEl.children[0];
              while (tmpEl.firstChild) {
                tmpEl.removeChild(tmpEl.firstChild);
              }
              return firldChild;
            };
          }();
          var sortByAlpha = function(_a, _b) {
            var value = _a.value, _c = _a.label, label = _c === void 0 ? value : _c;
            var value2 = _b.value, _d = _b.label, label2 = _d === void 0 ? value2 : _d;
            return label.localeCompare(label2, [], {
              sensitivity: "base",
              ignorePunctuation: true,
              numeric: true
            });
          };
          exports2.sortByAlpha = sortByAlpha;
          var sortByScore = function(a, b) {
            var _a = a.score, scoreA = _a === void 0 ? 0 : _a;
            var _b = b.score, scoreB = _b === void 0 ? 0 : _b;
            return scoreA - scoreB;
          };
          exports2.sortByScore = sortByScore;
          var dispatchEvent = function(element, type, customArgs) {
            if (customArgs === void 0) {
              customArgs = null;
            }
            var event = new CustomEvent(type, {
              detail: customArgs,
              bubbles: true,
              cancelable: true
            });
            return element.dispatchEvent(event);
          };
          exports2.dispatchEvent = dispatchEvent;
          var existsInArray = function(array, value, key) {
            if (key === void 0) {
              key = "value";
            }
            return array.some(function(item) {
              if (typeof value === "string") {
                return item[key] === value.trim();
              }
              return item[key] === value;
            });
          };
          exports2.existsInArray = existsInArray;
          var cloneObject = function(obj) {
            return JSON.parse(JSON.stringify(obj));
          };
          exports2.cloneObject = cloneObject;
          var diff = function(a, b) {
            var aKeys = Object.keys(a).sort();
            var bKeys = Object.keys(b).sort();
            return aKeys.filter(function(i) {
              return bKeys.indexOf(i) < 0;
            });
          };
          exports2.diff = diff;
        },
        273: function(__unused_webpack_module, exports2) {
          var __spreadArray = this && this.__spreadArray || function(to, from, pack) {
            if (pack || arguments.length === 2)
              for (var i = 0, l = from.length, ar; i < l; i++) {
                if (ar || !(i in from)) {
                  if (!ar)
                    ar = Array.prototype.slice.call(from, 0, i);
                  ar[i] = from[i];
                }
              }
            return to.concat(ar || Array.prototype.slice.call(from));
          };
          Object.defineProperty(exports2, "__esModule", {
            value: true
          });
          exports2.defaultState = void 0;
          exports2.defaultState = [];
          function choices(state, action) {
            if (state === void 0) {
              state = exports2.defaultState;
            }
            if (action === void 0) {
              action = {};
            }
            switch (action.type) {
              case "ADD_CHOICE": {
                var addChoiceAction = action;
                var choice = {
                  id: addChoiceAction.id,
                  elementId: addChoiceAction.elementId,
                  groupId: addChoiceAction.groupId,
                  value: addChoiceAction.value,
                  label: addChoiceAction.label || addChoiceAction.value,
                  disabled: addChoiceAction.disabled || false,
                  selected: false,
                  active: true,
                  score: 9999,
                  customProperties: addChoiceAction.customProperties,
                  placeholder: addChoiceAction.placeholder || false
                };
                return __spreadArray(__spreadArray([], state, true), [choice], false);
              }
              case "ADD_ITEM": {
                var addItemAction_1 = action;
                if (addItemAction_1.choiceId > -1) {
                  return state.map(function(obj) {
                    var choice2 = obj;
                    if (choice2.id === parseInt("".concat(addItemAction_1.choiceId), 10)) {
                      choice2.selected = true;
                    }
                    return choice2;
                  });
                }
                return state;
              }
              case "REMOVE_ITEM": {
                var removeItemAction_1 = action;
                if (removeItemAction_1.choiceId && removeItemAction_1.choiceId > -1) {
                  return state.map(function(obj) {
                    var choice2 = obj;
                    if (choice2.id === parseInt("".concat(removeItemAction_1.choiceId), 10)) {
                      choice2.selected = false;
                    }
                    return choice2;
                  });
                }
                return state;
              }
              case "FILTER_CHOICES": {
                var filterChoicesAction_1 = action;
                return state.map(function(obj) {
                  var choice2 = obj;
                  choice2.active = filterChoicesAction_1.results.some(function(_a) {
                    var item = _a.item, score = _a.score;
                    if (item.id === choice2.id) {
                      choice2.score = score;
                      return true;
                    }
                    return false;
                  });
                  return choice2;
                });
              }
              case "ACTIVATE_CHOICES": {
                var activateChoicesAction_1 = action;
                return state.map(function(obj) {
                  var choice2 = obj;
                  choice2.active = activateChoicesAction_1.active;
                  return choice2;
                });
              }
              case "CLEAR_CHOICES": {
                return exports2.defaultState;
              }
              default: {
                return state;
              }
            }
          }
          exports2["default"] = choices;
        },
        871: function(__unused_webpack_module, exports2) {
          var __spreadArray = this && this.__spreadArray || function(to, from, pack) {
            if (pack || arguments.length === 2)
              for (var i = 0, l = from.length, ar; i < l; i++) {
                if (ar || !(i in from)) {
                  if (!ar)
                    ar = Array.prototype.slice.call(from, 0, i);
                  ar[i] = from[i];
                }
              }
            return to.concat(ar || Array.prototype.slice.call(from));
          };
          Object.defineProperty(exports2, "__esModule", {
            value: true
          });
          exports2.defaultState = void 0;
          exports2.defaultState = [];
          function groups(state, action) {
            if (state === void 0) {
              state = exports2.defaultState;
            }
            if (action === void 0) {
              action = {};
            }
            switch (action.type) {
              case "ADD_GROUP": {
                var addGroupAction = action;
                return __spreadArray(__spreadArray([], state, true), [{
                  id: addGroupAction.id,
                  value: addGroupAction.value,
                  active: addGroupAction.active,
                  disabled: addGroupAction.disabled
                }], false);
              }
              case "CLEAR_CHOICES": {
                return [];
              }
              default: {
                return state;
              }
            }
          }
          exports2["default"] = groups;
        },
        655: function(__unused_webpack_module, exports2, __webpack_require__2) {
          var __importDefault = this && this.__importDefault || function(mod) {
            return mod && mod.__esModule ? mod : {
              default: mod
            };
          };
          Object.defineProperty(exports2, "__esModule", {
            value: true
          });
          exports2.defaultState = void 0;
          var redux_1 = __webpack_require__2(857);
          var items_1 = __importDefault(__webpack_require__2(52));
          var groups_1 = __importDefault(__webpack_require__2(871));
          var choices_1 = __importDefault(__webpack_require__2(273));
          var loading_1 = __importDefault(__webpack_require__2(502));
          var utils_1 = __webpack_require__2(799);
          exports2.defaultState = {
            groups: [],
            items: [],
            choices: [],
            loading: false
          };
          var appReducer = (0, redux_1.combineReducers)({
            items: items_1.default,
            groups: groups_1.default,
            choices: choices_1.default,
            loading: loading_1.default
          });
          var rootReducer = function(passedState, action) {
            var state = passedState;
            if (action.type === "CLEAR_ALL") {
              state = exports2.defaultState;
            } else if (action.type === "RESET_TO") {
              return (0, utils_1.cloneObject)(action.state);
            }
            return appReducer(state, action);
          };
          exports2["default"] = rootReducer;
        },
        52: function(__unused_webpack_module, exports2) {
          var __spreadArray = this && this.__spreadArray || function(to, from, pack) {
            if (pack || arguments.length === 2)
              for (var i = 0, l = from.length, ar; i < l; i++) {
                if (ar || !(i in from)) {
                  if (!ar)
                    ar = Array.prototype.slice.call(from, 0, i);
                  ar[i] = from[i];
                }
              }
            return to.concat(ar || Array.prototype.slice.call(from));
          };
          Object.defineProperty(exports2, "__esModule", {
            value: true
          });
          exports2.defaultState = void 0;
          exports2.defaultState = [];
          function items(state, action) {
            if (state === void 0) {
              state = exports2.defaultState;
            }
            if (action === void 0) {
              action = {};
            }
            switch (action.type) {
              case "ADD_ITEM": {
                var addItemAction = action;
                var newState = __spreadArray(__spreadArray([], state, true), [{
                  id: addItemAction.id,
                  choiceId: addItemAction.choiceId,
                  groupId: addItemAction.groupId,
                  value: addItemAction.value,
                  label: addItemAction.label,
                  active: true,
                  highlighted: false,
                  customProperties: addItemAction.customProperties,
                  placeholder: addItemAction.placeholder || false,
                  keyCode: null
                }], false);
                return newState.map(function(obj) {
                  var item = obj;
                  item.highlighted = false;
                  return item;
                });
              }
              case "REMOVE_ITEM": {
                return state.map(function(obj) {
                  var item = obj;
                  if (item.id === action.id) {
                    item.active = false;
                  }
                  return item;
                });
              }
              case "HIGHLIGHT_ITEM": {
                var highlightItemAction_1 = action;
                return state.map(function(obj) {
                  var item = obj;
                  if (item.id === highlightItemAction_1.id) {
                    item.highlighted = highlightItemAction_1.highlighted;
                  }
                  return item;
                });
              }
              default: {
                return state;
              }
            }
          }
          exports2["default"] = items;
        },
        502: function(__unused_webpack_module, exports2) {
          Object.defineProperty(exports2, "__esModule", {
            value: true
          });
          exports2.defaultState = void 0;
          exports2.defaultState = false;
          var general = function(state, action) {
            if (state === void 0) {
              state = exports2.defaultState;
            }
            if (action === void 0) {
              action = {};
            }
            switch (action.type) {
              case "SET_IS_LOADING": {
                return action.isLoading;
              }
              default: {
                return state;
              }
            }
          };
          exports2["default"] = general;
        },
        744: function(__unused_webpack_module, exports2, __webpack_require__2) {
          var __spreadArray = this && this.__spreadArray || function(to, from, pack) {
            if (pack || arguments.length === 2)
              for (var i = 0, l = from.length, ar; i < l; i++) {
                if (ar || !(i in from)) {
                  if (!ar)
                    ar = Array.prototype.slice.call(from, 0, i);
                  ar[i] = from[i];
                }
              }
            return to.concat(ar || Array.prototype.slice.call(from));
          };
          var __importDefault = this && this.__importDefault || function(mod) {
            return mod && mod.__esModule ? mod : {
              default: mod
            };
          };
          Object.defineProperty(exports2, "__esModule", {
            value: true
          });
          var redux_1 = __webpack_require__2(857);
          var index_1 = __importDefault(__webpack_require__2(655));
          var Store = function() {
            function Store2() {
              this._store = (0, redux_1.createStore)(index_1.default, window.__REDUX_DEVTOOLS_EXTENSION__ && window.__REDUX_DEVTOOLS_EXTENSION__());
            }
            Store2.prototype.subscribe = function(onChange) {
              this._store.subscribe(onChange);
            };
            Store2.prototype.dispatch = function(action) {
              this._store.dispatch(action);
            };
            Object.defineProperty(Store2.prototype, "state", {
              get: function() {
                return this._store.getState();
              },
              enumerable: false,
              configurable: true
            });
            Object.defineProperty(Store2.prototype, "items", {
              get: function() {
                return this.state.items;
              },
              enumerable: false,
              configurable: true
            });
            Object.defineProperty(Store2.prototype, "activeItems", {
              get: function() {
                return this.items.filter(function(item) {
                  return item.active === true;
                });
              },
              enumerable: false,
              configurable: true
            });
            Object.defineProperty(Store2.prototype, "highlightedActiveItems", {
              get: function() {
                return this.items.filter(function(item) {
                  return item.active && item.highlighted;
                });
              },
              enumerable: false,
              configurable: true
            });
            Object.defineProperty(Store2.prototype, "choices", {
              get: function() {
                return this.state.choices;
              },
              enumerable: false,
              configurable: true
            });
            Object.defineProperty(Store2.prototype, "activeChoices", {
              get: function() {
                return this.choices.filter(function(choice) {
                  return choice.active === true;
                });
              },
              enumerable: false,
              configurable: true
            });
            Object.defineProperty(Store2.prototype, "selectableChoices", {
              get: function() {
                return this.choices.filter(function(choice) {
                  return choice.disabled !== true;
                });
              },
              enumerable: false,
              configurable: true
            });
            Object.defineProperty(Store2.prototype, "searchableChoices", {
              get: function() {
                return this.selectableChoices.filter(function(choice) {
                  return choice.placeholder !== true;
                });
              },
              enumerable: false,
              configurable: true
            });
            Object.defineProperty(Store2.prototype, "placeholderChoice", {
              get: function() {
                return __spreadArray([], this.choices, true).reverse().find(function(choice) {
                  return choice.placeholder === true;
                });
              },
              enumerable: false,
              configurable: true
            });
            Object.defineProperty(Store2.prototype, "groups", {
              get: function() {
                return this.state.groups;
              },
              enumerable: false,
              configurable: true
            });
            Object.defineProperty(Store2.prototype, "activeGroups", {
              get: function() {
                var _a = this, groups = _a.groups, choices = _a.choices;
                return groups.filter(function(group) {
                  var isActive = group.active === true && group.disabled === false;
                  var hasActiveOptions = choices.some(function(choice) {
                    return choice.active === true && choice.disabled === false;
                  });
                  return isActive && hasActiveOptions;
                }, []);
              },
              enumerable: false,
              configurable: true
            });
            Store2.prototype.isLoading = function() {
              return this.state.loading;
            };
            Store2.prototype.getChoiceById = function(id) {
              return this.activeChoices.find(function(choice) {
                return choice.id === parseInt(id, 10);
              });
            };
            Store2.prototype.getGroupById = function(id) {
              return this.groups.find(function(group) {
                return group.id === id;
              });
            };
            return Store2;
          }();
          exports2["default"] = Store;
        },
        686: function(__unused_webpack_module, exports2) {
          Object.defineProperty(exports2, "__esModule", {
            value: true
          });
          var templates = {
            containerOuter: function(_a, dir, isSelectElement, isSelectOneElement, searchEnabled, passedElementType, labelId) {
              var containerOuter = _a.classNames.containerOuter;
              var div = Object.assign(document.createElement("div"), {
                className: containerOuter
              });
              div.dataset.type = passedElementType;
              if (dir) {
                div.dir = dir;
              }
              if (isSelectOneElement) {
                div.tabIndex = 0;
              }
              if (isSelectElement) {
                div.setAttribute("role", searchEnabled ? "combobox" : "listbox");
                if (searchEnabled) {
                  div.setAttribute("aria-autocomplete", "list");
                }
              }
              div.setAttribute("aria-haspopup", "true");
              div.setAttribute("aria-expanded", "false");
              if (labelId) {
                div.setAttribute("aria-labeledby", labelId);
              }
              return div;
            },
            containerInner: function(_a) {
              var containerInner = _a.classNames.containerInner;
              return Object.assign(document.createElement("div"), {
                className: containerInner
              });
            },
            itemList: function(_a, isSelectOneElement) {
              var _b = _a.classNames, list = _b.list, listSingle = _b.listSingle, listItems = _b.listItems;
              return Object.assign(document.createElement("div"), {
                className: "".concat(list, " ").concat(isSelectOneElement ? listSingle : listItems)
              });
            },
            placeholder: function(_a, value) {
              var _b;
              var allowHTML = _a.allowHTML, placeholder = _a.classNames.placeholder;
              return Object.assign(document.createElement("div"), (_b = {
                className: placeholder
              }, _b[allowHTML ? "innerHTML" : "innerText"] = value, _b));
            },
            item: function(_a, _b, removeItemButton) {
              var _c, _d;
              var allowHTML = _a.allowHTML, _e = _a.classNames, item = _e.item, button = _e.button, highlightedState = _e.highlightedState, itemSelectable = _e.itemSelectable, placeholder = _e.placeholder;
              var id = _b.id, value = _b.value, label = _b.label, customProperties = _b.customProperties, active = _b.active, disabled = _b.disabled, highlighted = _b.highlighted, isPlaceholder = _b.placeholder;
              var div = Object.assign(document.createElement("div"), (_c = {
                className: item
              }, _c[allowHTML ? "innerHTML" : "innerText"] = label, _c));
              Object.assign(div.dataset, {
                item: "",
                id,
                value,
                customProperties
              });
              if (active) {
                div.setAttribute("aria-selected", "true");
              }
              if (disabled) {
                div.setAttribute("aria-disabled", "true");
              }
              if (isPlaceholder) {
                div.classList.add(placeholder);
              }
              div.classList.add(highlighted ? highlightedState : itemSelectable);
              if (removeItemButton) {
                if (disabled) {
                  div.classList.remove(itemSelectable);
                }
                div.dataset.deletable = "";
                var REMOVE_ITEM_TEXT = "Remove item";
                var removeButton = Object.assign(document.createElement("button"), (_d = {
                  type: "button",
                  className: button
                }, _d[allowHTML ? "innerHTML" : "innerText"] = REMOVE_ITEM_TEXT, _d));
                removeButton.setAttribute("aria-label", "".concat(REMOVE_ITEM_TEXT, ": '").concat(value, "'"));
                removeButton.dataset.button = "";
                div.appendChild(removeButton);
              }
              return div;
            },
            choiceList: function(_a, isSelectOneElement) {
              var list = _a.classNames.list;
              var div = Object.assign(document.createElement("div"), {
                className: list
              });
              if (!isSelectOneElement) {
                div.setAttribute("aria-multiselectable", "true");
              }
              div.setAttribute("role", "listbox");
              return div;
            },
            choiceGroup: function(_a, _b) {
              var _c;
              var allowHTML = _a.allowHTML, _d = _a.classNames, group = _d.group, groupHeading = _d.groupHeading, itemDisabled = _d.itemDisabled;
              var id = _b.id, value = _b.value, disabled = _b.disabled;
              var div = Object.assign(document.createElement("div"), {
                className: "".concat(group, " ").concat(disabled ? itemDisabled : "")
              });
              div.setAttribute("role", "group");
              Object.assign(div.dataset, {
                group: "",
                id,
                value
              });
              if (disabled) {
                div.setAttribute("aria-disabled", "true");
              }
              div.appendChild(Object.assign(document.createElement("div"), (_c = {
                className: groupHeading
              }, _c[allowHTML ? "innerHTML" : "innerText"] = value, _c)));
              return div;
            },
            choice: function(_a, _b, selectText) {
              var _c;
              var allowHTML = _a.allowHTML, _d = _a.classNames, item = _d.item, itemChoice = _d.itemChoice, itemSelectable = _d.itemSelectable, selectedState = _d.selectedState, itemDisabled = _d.itemDisabled, placeholder = _d.placeholder;
              var id = _b.id, value = _b.value, label = _b.label, groupId = _b.groupId, elementId = _b.elementId, isDisabled = _b.disabled, isSelected = _b.selected, isPlaceholder = _b.placeholder;
              var div = Object.assign(document.createElement("div"), (_c = {
                id: elementId
              }, _c[allowHTML ? "innerHTML" : "innerText"] = label, _c.className = "".concat(item, " ").concat(itemChoice), _c));
              if (isSelected) {
                div.classList.add(selectedState);
              }
              if (isPlaceholder) {
                div.classList.add(placeholder);
              }
              div.setAttribute("role", groupId && groupId > 0 ? "treeitem" : "option");
              Object.assign(div.dataset, {
                choice: "",
                id,
                value,
                selectText
              });
              if (isDisabled) {
                div.classList.add(itemDisabled);
                div.dataset.choiceDisabled = "";
                div.setAttribute("aria-disabled", "true");
              } else {
                div.classList.add(itemSelectable);
                div.dataset.choiceSelectable = "";
              }
              return div;
            },
            input: function(_a, placeholderValue) {
              var _b = _a.classNames, input = _b.input, inputCloned = _b.inputCloned;
              var inp = Object.assign(document.createElement("input"), {
                type: "search",
                name: "search_terms",
                className: "".concat(input, " ").concat(inputCloned),
                autocomplete: "off",
                autocapitalize: "off",
                spellcheck: false
              });
              inp.setAttribute("role", "textbox");
              inp.setAttribute("aria-autocomplete", "list");
              inp.setAttribute("aria-label", placeholderValue);
              return inp;
            },
            dropdown: function(_a) {
              var _b = _a.classNames, list = _b.list, listDropdown = _b.listDropdown;
              var div = document.createElement("div");
              div.classList.add(list, listDropdown);
              div.setAttribute("aria-expanded", "false");
              return div;
            },
            notice: function(_a, innerText, type) {
              var _b;
              var allowHTML = _a.allowHTML, _c = _a.classNames, item = _c.item, itemChoice = _c.itemChoice, noResults = _c.noResults, noChoices = _c.noChoices;
              if (type === void 0) {
                type = "";
              }
              var classes = [item, itemChoice];
              if (type === "no-choices") {
                classes.push(noChoices);
              } else if (type === "no-results") {
                classes.push(noResults);
              }
              return Object.assign(document.createElement("div"), (_b = {}, _b[allowHTML ? "innerHTML" : "innerText"] = innerText, _b.className = classes.join(" "), _b));
            },
            option: function(_a) {
              var label = _a.label, value = _a.value, customProperties = _a.customProperties, active = _a.active, disabled = _a.disabled;
              var opt = new Option(label, value, false, active);
              if (customProperties) {
                opt.dataset.customProperties = "".concat(customProperties);
              }
              opt.disabled = !!disabled;
              return opt;
            }
          };
          exports2["default"] = templates;
        },
        996: function(module2) {
          var isMergeableObject = function isMergeableObject2(value) {
            return isNonNullObject(value) && !isSpecial(value);
          };
          function isNonNullObject(value) {
            return !!value && typeof value === "object";
          }
          function isSpecial(value) {
            var stringValue = Object.prototype.toString.call(value);
            return stringValue === "[object RegExp]" || stringValue === "[object Date]" || isReactElement(value);
          }
          var canUseSymbol = typeof Symbol === "function" && Symbol.for;
          var REACT_ELEMENT_TYPE = canUseSymbol ? Symbol.for("react.element") : 60103;
          function isReactElement(value) {
            return value.$$typeof === REACT_ELEMENT_TYPE;
          }
          function emptyTarget(val) {
            return Array.isArray(val) ? [] : {};
          }
          function cloneUnlessOtherwiseSpecified(value, options) {
            return options.clone !== false && options.isMergeableObject(value) ? deepmerge(emptyTarget(value), value, options) : value;
          }
          function defaultArrayMerge(target, source, options) {
            return target.concat(source).map(function(element) {
              return cloneUnlessOtherwiseSpecified(element, options);
            });
          }
          function getMergeFunction(key, options) {
            if (!options.customMerge) {
              return deepmerge;
            }
            var customMerge = options.customMerge(key);
            return typeof customMerge === "function" ? customMerge : deepmerge;
          }
          function getEnumerableOwnPropertySymbols(target) {
            return Object.getOwnPropertySymbols ? Object.getOwnPropertySymbols(target).filter(function(symbol) {
              return target.propertyIsEnumerable(symbol);
            }) : [];
          }
          function getKeys(target) {
            return Object.keys(target).concat(getEnumerableOwnPropertySymbols(target));
          }
          function propertyIsOnObject(object, property) {
            try {
              return property in object;
            } catch (_) {
              return false;
            }
          }
          function propertyIsUnsafe(target, key) {
            return propertyIsOnObject(target, key) && !(Object.hasOwnProperty.call(target, key) && Object.propertyIsEnumerable.call(target, key));
          }
          function mergeObject(target, source, options) {
            var destination = {};
            if (options.isMergeableObject(target)) {
              getKeys(target).forEach(function(key) {
                destination[key] = cloneUnlessOtherwiseSpecified(target[key], options);
              });
            }
            getKeys(source).forEach(function(key) {
              if (propertyIsUnsafe(target, key)) {
                return;
              }
              if (propertyIsOnObject(target, key) && options.isMergeableObject(source[key])) {
                destination[key] = getMergeFunction(key, options)(target[key], source[key], options);
              } else {
                destination[key] = cloneUnlessOtherwiseSpecified(source[key], options);
              }
            });
            return destination;
          }
          function deepmerge(target, source, options) {
            options = options || {};
            options.arrayMerge = options.arrayMerge || defaultArrayMerge;
            options.isMergeableObject = options.isMergeableObject || isMergeableObject;
            options.cloneUnlessOtherwiseSpecified = cloneUnlessOtherwiseSpecified;
            var sourceIsArray = Array.isArray(source);
            var targetIsArray = Array.isArray(target);
            var sourceAndTargetTypesMatch = sourceIsArray === targetIsArray;
            if (!sourceAndTargetTypesMatch) {
              return cloneUnlessOtherwiseSpecified(source, options);
            } else if (sourceIsArray) {
              return options.arrayMerge(target, source, options);
            } else {
              return mergeObject(target, source, options);
            }
          }
          deepmerge.all = function deepmergeAll(array, options) {
            if (!Array.isArray(array)) {
              throw new Error("first argument should be an array");
            }
            return array.reduce(function(prev, next) {
              return deepmerge(prev, next, options);
            }, {});
          };
          var deepmerge_1 = deepmerge;
          module2.exports = deepmerge_1;
        },
        221: function(__unused_webpack_module, __webpack_exports__2, __webpack_require__2) {
          __webpack_require__2.r(__webpack_exports__2);
          __webpack_require__2.d(__webpack_exports__2, {
            default: function() {
              return Fuse;
            }
          });
          function isArray(value) {
            return !Array.isArray ? getTag(value) === "[object Array]" : Array.isArray(value);
          }
          const INFINITY = 1 / 0;
          function baseToString(value) {
            if (typeof value == "string") {
              return value;
            }
            let result = value + "";
            return result == "0" && 1 / value == -INFINITY ? "-0" : result;
          }
          function toString(value) {
            return value == null ? "" : baseToString(value);
          }
          function isString(value) {
            return typeof value === "string";
          }
          function isNumber(value) {
            return typeof value === "number";
          }
          function isBoolean(value) {
            return value === true || value === false || isObjectLike(value) && getTag(value) == "[object Boolean]";
          }
          function isObject(value) {
            return typeof value === "object";
          }
          function isObjectLike(value) {
            return isObject(value) && value !== null;
          }
          function isDefined(value) {
            return value !== void 0 && value !== null;
          }
          function isBlank(value) {
            return !value.trim().length;
          }
          function getTag(value) {
            return value == null ? value === void 0 ? "[object Undefined]" : "[object Null]" : Object.prototype.toString.call(value);
          }
          const EXTENDED_SEARCH_UNAVAILABLE = "Extended search is not available";
          const INCORRECT_INDEX_TYPE = "Incorrect 'index' type";
          const LOGICAL_SEARCH_INVALID_QUERY_FOR_KEY = (key) => `Invalid value for key ${key}`;
          const PATTERN_LENGTH_TOO_LARGE = (max) => `Pattern length exceeds max of ${max}.`;
          const MISSING_KEY_PROPERTY = (name) => `Missing ${name} property in key`;
          const INVALID_KEY_WEIGHT_VALUE = (key) => `Property 'weight' in key '${key}' must be a positive integer`;
          const hasOwn = Object.prototype.hasOwnProperty;
          class KeyStore {
            constructor(keys) {
              this._keys = [];
              this._keyMap = {};
              let totalWeight = 0;
              keys.forEach((key) => {
                let obj = createKey(key);
                totalWeight += obj.weight;
                this._keys.push(obj);
                this._keyMap[obj.id] = obj;
                totalWeight += obj.weight;
              });
              this._keys.forEach((key) => {
                key.weight /= totalWeight;
              });
            }
            get(keyId) {
              return this._keyMap[keyId];
            }
            keys() {
              return this._keys;
            }
            toJSON() {
              return JSON.stringify(this._keys);
            }
          }
          function createKey(key) {
            let path = null;
            let id = null;
            let src = null;
            let weight = 1;
            if (isString(key) || isArray(key)) {
              src = key;
              path = createKeyPath(key);
              id = createKeyId(key);
            } else {
              if (!hasOwn.call(key, "name")) {
                throw new Error(MISSING_KEY_PROPERTY("name"));
              }
              const name = key.name;
              src = name;
              if (hasOwn.call(key, "weight")) {
                weight = key.weight;
                if (weight <= 0) {
                  throw new Error(INVALID_KEY_WEIGHT_VALUE(name));
                }
              }
              path = createKeyPath(name);
              id = createKeyId(name);
            }
            return {path, id, weight, src};
          }
          function createKeyPath(key) {
            return isArray(key) ? key : key.split(".");
          }
          function createKeyId(key) {
            return isArray(key) ? key.join(".") : key;
          }
          function get(obj, path) {
            let list = [];
            let arr = false;
            const deepGet = (obj2, path2, index) => {
              if (!isDefined(obj2)) {
                return;
              }
              if (!path2[index]) {
                list.push(obj2);
              } else {
                let key = path2[index];
                const value = obj2[key];
                if (!isDefined(value)) {
                  return;
                }
                if (index === path2.length - 1 && (isString(value) || isNumber(value) || isBoolean(value))) {
                  list.push(toString(value));
                } else if (isArray(value)) {
                  arr = true;
                  for (let i = 0, len = value.length; i < len; i += 1) {
                    deepGet(value[i], path2, index + 1);
                  }
                } else if (path2.length) {
                  deepGet(value, path2, index + 1);
                }
              }
            };
            deepGet(obj, isString(path) ? path.split(".") : path, 0);
            return arr ? list : list[0];
          }
          const MatchOptions = {
            includeMatches: false,
            findAllMatches: false,
            minMatchCharLength: 1
          };
          const BasicOptions = {
            isCaseSensitive: false,
            includeScore: false,
            keys: [],
            shouldSort: true,
            sortFn: (a, b) => a.score === b.score ? a.idx < b.idx ? -1 : 1 : a.score < b.score ? -1 : 1
          };
          const FuzzyOptions = {
            location: 0,
            threshold: 0.6,
            distance: 100
          };
          const AdvancedOptions = {
            useExtendedSearch: false,
            getFn: get,
            ignoreLocation: false,
            ignoreFieldNorm: false,
            fieldNormWeight: 1
          };
          var Config = {
            ...BasicOptions,
            ...MatchOptions,
            ...FuzzyOptions,
            ...AdvancedOptions
          };
          const SPACE = /[^ ]+/g;
          function norm(weight = 1, mantissa = 3) {
            const cache2 = new Map();
            const m = Math.pow(10, mantissa);
            return {
              get(value) {
                const numTokens = value.match(SPACE).length;
                if (cache2.has(numTokens)) {
                  return cache2.get(numTokens);
                }
                const norm2 = 1 / Math.pow(numTokens, 0.5 * weight);
                const n = parseFloat(Math.round(norm2 * m) / m);
                cache2.set(numTokens, n);
                return n;
              },
              clear() {
                cache2.clear();
              }
            };
          }
          class FuseIndex {
            constructor({
              getFn = Config.getFn,
              fieldNormWeight = Config.fieldNormWeight
            } = {}) {
              this.norm = norm(fieldNormWeight, 3);
              this.getFn = getFn;
              this.isCreated = false;
              this.setIndexRecords();
            }
            setSources(docs = []) {
              this.docs = docs;
            }
            setIndexRecords(records = []) {
              this.records = records;
            }
            setKeys(keys = []) {
              this.keys = keys;
              this._keysMap = {};
              keys.forEach((key, idx) => {
                this._keysMap[key.id] = idx;
              });
            }
            create() {
              if (this.isCreated || !this.docs.length) {
                return;
              }
              this.isCreated = true;
              if (isString(this.docs[0])) {
                this.docs.forEach((doc, docIndex) => {
                  this._addString(doc, docIndex);
                });
              } else {
                this.docs.forEach((doc, docIndex) => {
                  this._addObject(doc, docIndex);
                });
              }
              this.norm.clear();
            }
            add(doc) {
              const idx = this.size();
              if (isString(doc)) {
                this._addString(doc, idx);
              } else {
                this._addObject(doc, idx);
              }
            }
            removeAt(idx) {
              this.records.splice(idx, 1);
              for (let i = idx, len = this.size(); i < len; i += 1) {
                this.records[i].i -= 1;
              }
            }
            getValueForItemAtKeyId(item, keyId) {
              return item[this._keysMap[keyId]];
            }
            size() {
              return this.records.length;
            }
            _addString(doc, docIndex) {
              if (!isDefined(doc) || isBlank(doc)) {
                return;
              }
              let record = {
                v: doc,
                i: docIndex,
                n: this.norm.get(doc)
              };
              this.records.push(record);
            }
            _addObject(doc, docIndex) {
              let record = {i: docIndex, $: {}};
              this.keys.forEach((key, keyIndex) => {
                let value = this.getFn(doc, key.path);
                if (!isDefined(value)) {
                  return;
                }
                if (isArray(value)) {
                  let subRecords = [];
                  const stack = [{nestedArrIndex: -1, value}];
                  while (stack.length) {
                    const {nestedArrIndex, value: value2} = stack.pop();
                    if (!isDefined(value2)) {
                      continue;
                    }
                    if (isString(value2) && !isBlank(value2)) {
                      let subRecord = {
                        v: value2,
                        i: nestedArrIndex,
                        n: this.norm.get(value2)
                      };
                      subRecords.push(subRecord);
                    } else if (isArray(value2)) {
                      value2.forEach((item, k) => {
                        stack.push({
                          nestedArrIndex: k,
                          value: item
                        });
                      });
                    } else
                      ;
                  }
                  record.$[keyIndex] = subRecords;
                } else if (!isBlank(value)) {
                  let subRecord = {
                    v: value,
                    n: this.norm.get(value)
                  };
                  record.$[keyIndex] = subRecord;
                }
              });
              this.records.push(record);
            }
            toJSON() {
              return {
                keys: this.keys,
                records: this.records
              };
            }
          }
          function createIndex(keys, docs, {getFn = Config.getFn, fieldNormWeight = Config.fieldNormWeight} = {}) {
            const myIndex = new FuseIndex({getFn, fieldNormWeight});
            myIndex.setKeys(keys.map(createKey));
            myIndex.setSources(docs);
            myIndex.create();
            return myIndex;
          }
          function parseIndex(data2, {getFn = Config.getFn, fieldNormWeight = Config.fieldNormWeight} = {}) {
            const {keys, records} = data2;
            const myIndex = new FuseIndex({getFn, fieldNormWeight});
            myIndex.setKeys(keys);
            myIndex.setIndexRecords(records);
            return myIndex;
          }
          function computeScore$1(pattern, {
            errors = 0,
            currentLocation = 0,
            expectedLocation = 0,
            distance = Config.distance,
            ignoreLocation = Config.ignoreLocation
          } = {}) {
            const accuracy = errors / pattern.length;
            if (ignoreLocation) {
              return accuracy;
            }
            const proximity = Math.abs(expectedLocation - currentLocation);
            if (!distance) {
              return proximity ? 1 : accuracy;
            }
            return accuracy + proximity / distance;
          }
          function convertMaskToIndices(matchmask = [], minMatchCharLength = Config.minMatchCharLength) {
            let indices = [];
            let start = -1;
            let end = -1;
            let i = 0;
            for (let len = matchmask.length; i < len; i += 1) {
              let match = matchmask[i];
              if (match && start === -1) {
                start = i;
              } else if (!match && start !== -1) {
                end = i - 1;
                if (end - start + 1 >= minMatchCharLength) {
                  indices.push([start, end]);
                }
                start = -1;
              }
            }
            if (matchmask[i - 1] && i - start >= minMatchCharLength) {
              indices.push([start, i - 1]);
            }
            return indices;
          }
          const MAX_BITS = 32;
          function search(text, pattern, patternAlphabet, {
            location: location2 = Config.location,
            distance = Config.distance,
            threshold = Config.threshold,
            findAllMatches = Config.findAllMatches,
            minMatchCharLength = Config.minMatchCharLength,
            includeMatches = Config.includeMatches,
            ignoreLocation = Config.ignoreLocation
          } = {}) {
            if (pattern.length > MAX_BITS) {
              throw new Error(PATTERN_LENGTH_TOO_LARGE(MAX_BITS));
            }
            const patternLen = pattern.length;
            const textLen = text.length;
            const expectedLocation = Math.max(0, Math.min(location2, textLen));
            let currentThreshold = threshold;
            let bestLocation = expectedLocation;
            const computeMatches = minMatchCharLength > 1 || includeMatches;
            const matchMask = computeMatches ? Array(textLen) : [];
            let index;
            while ((index = text.indexOf(pattern, bestLocation)) > -1) {
              let score = computeScore$1(pattern, {
                currentLocation: index,
                expectedLocation,
                distance,
                ignoreLocation
              });
              currentThreshold = Math.min(score, currentThreshold);
              bestLocation = index + patternLen;
              if (computeMatches) {
                let i = 0;
                while (i < patternLen) {
                  matchMask[index + i] = 1;
                  i += 1;
                }
              }
            }
            bestLocation = -1;
            let lastBitArr = [];
            let finalScore = 1;
            let binMax = patternLen + textLen;
            const mask = 1 << patternLen - 1;
            for (let i = 0; i < patternLen; i += 1) {
              let binMin = 0;
              let binMid = binMax;
              while (binMin < binMid) {
                const score2 = computeScore$1(pattern, {
                  errors: i,
                  currentLocation: expectedLocation + binMid,
                  expectedLocation,
                  distance,
                  ignoreLocation
                });
                if (score2 <= currentThreshold) {
                  binMin = binMid;
                } else {
                  binMax = binMid;
                }
                binMid = Math.floor((binMax - binMin) / 2 + binMin);
              }
              binMax = binMid;
              let start = Math.max(1, expectedLocation - binMid + 1);
              let finish = findAllMatches ? textLen : Math.min(expectedLocation + binMid, textLen) + patternLen;
              let bitArr = Array(finish + 2);
              bitArr[finish + 1] = (1 << i) - 1;
              for (let j = finish; j >= start; j -= 1) {
                let currentLocation = j - 1;
                let charMatch = patternAlphabet[text.charAt(currentLocation)];
                if (computeMatches) {
                  matchMask[currentLocation] = +!!charMatch;
                }
                bitArr[j] = (bitArr[j + 1] << 1 | 1) & charMatch;
                if (i) {
                  bitArr[j] |= (lastBitArr[j + 1] | lastBitArr[j]) << 1 | 1 | lastBitArr[j + 1];
                }
                if (bitArr[j] & mask) {
                  finalScore = computeScore$1(pattern, {
                    errors: i,
                    currentLocation,
                    expectedLocation,
                    distance,
                    ignoreLocation
                  });
                  if (finalScore <= currentThreshold) {
                    currentThreshold = finalScore;
                    bestLocation = currentLocation;
                    if (bestLocation <= expectedLocation) {
                      break;
                    }
                    start = Math.max(1, 2 * expectedLocation - bestLocation);
                  }
                }
              }
              const score = computeScore$1(pattern, {
                errors: i + 1,
                currentLocation: expectedLocation,
                expectedLocation,
                distance,
                ignoreLocation
              });
              if (score > currentThreshold) {
                break;
              }
              lastBitArr = bitArr;
            }
            const result = {
              isMatch: bestLocation >= 0,
              score: Math.max(1e-3, finalScore)
            };
            if (computeMatches) {
              const indices = convertMaskToIndices(matchMask, minMatchCharLength);
              if (!indices.length) {
                result.isMatch = false;
              } else if (includeMatches) {
                result.indices = indices;
              }
            }
            return result;
          }
          function createPatternAlphabet(pattern) {
            let mask = {};
            for (let i = 0, len = pattern.length; i < len; i += 1) {
              const char = pattern.charAt(i);
              mask[char] = (mask[char] || 0) | 1 << len - i - 1;
            }
            return mask;
          }
          class BitapSearch {
            constructor(pattern, {
              location: location2 = Config.location,
              threshold = Config.threshold,
              distance = Config.distance,
              includeMatches = Config.includeMatches,
              findAllMatches = Config.findAllMatches,
              minMatchCharLength = Config.minMatchCharLength,
              isCaseSensitive = Config.isCaseSensitive,
              ignoreLocation = Config.ignoreLocation
            } = {}) {
              this.options = {
                location: location2,
                threshold,
                distance,
                includeMatches,
                findAllMatches,
                minMatchCharLength,
                isCaseSensitive,
                ignoreLocation
              };
              this.pattern = isCaseSensitive ? pattern : pattern.toLowerCase();
              this.chunks = [];
              if (!this.pattern.length) {
                return;
              }
              const addChunk = (pattern2, startIndex) => {
                this.chunks.push({
                  pattern: pattern2,
                  alphabet: createPatternAlphabet(pattern2),
                  startIndex
                });
              };
              const len = this.pattern.length;
              if (len > MAX_BITS) {
                let i = 0;
                const remainder = len % MAX_BITS;
                const end = len - remainder;
                while (i < end) {
                  addChunk(this.pattern.substr(i, MAX_BITS), i);
                  i += MAX_BITS;
                }
                if (remainder) {
                  const startIndex = len - MAX_BITS;
                  addChunk(this.pattern.substr(startIndex), startIndex);
                }
              } else {
                addChunk(this.pattern, 0);
              }
            }
            searchIn(text) {
              const {isCaseSensitive, includeMatches} = this.options;
              if (!isCaseSensitive) {
                text = text.toLowerCase();
              }
              if (this.pattern === text) {
                let result2 = {
                  isMatch: true,
                  score: 0
                };
                if (includeMatches) {
                  result2.indices = [[0, text.length - 1]];
                }
                return result2;
              }
              const {
                location: location2,
                distance,
                threshold,
                findAllMatches,
                minMatchCharLength,
                ignoreLocation
              } = this.options;
              let allIndices = [];
              let totalScore = 0;
              let hasMatches = false;
              this.chunks.forEach(({pattern, alphabet, startIndex}) => {
                const {isMatch, score, indices} = search(text, pattern, alphabet, {
                  location: location2 + startIndex,
                  distance,
                  threshold,
                  findAllMatches,
                  minMatchCharLength,
                  includeMatches,
                  ignoreLocation
                });
                if (isMatch) {
                  hasMatches = true;
                }
                totalScore += score;
                if (isMatch && indices) {
                  allIndices = [...allIndices, ...indices];
                }
              });
              let result = {
                isMatch: hasMatches,
                score: hasMatches ? totalScore / this.chunks.length : 1
              };
              if (hasMatches && includeMatches) {
                result.indices = allIndices;
              }
              return result;
            }
          }
          class BaseMatch {
            constructor(pattern) {
              this.pattern = pattern;
            }
            static isMultiMatch(pattern) {
              return getMatch(pattern, this.multiRegex);
            }
            static isSingleMatch(pattern) {
              return getMatch(pattern, this.singleRegex);
            }
            search() {
            }
          }
          function getMatch(pattern, exp) {
            const matches = pattern.match(exp);
            return matches ? matches[1] : null;
          }
          class ExactMatch extends BaseMatch {
            constructor(pattern) {
              super(pattern);
            }
            static get type() {
              return "exact";
            }
            static get multiRegex() {
              return /^="(.*)"$/;
            }
            static get singleRegex() {
              return /^=(.*)$/;
            }
            search(text) {
              const isMatch = text === this.pattern;
              return {
                isMatch,
                score: isMatch ? 0 : 1,
                indices: [0, this.pattern.length - 1]
              };
            }
          }
          class InverseExactMatch extends BaseMatch {
            constructor(pattern) {
              super(pattern);
            }
            static get type() {
              return "inverse-exact";
            }
            static get multiRegex() {
              return /^!"(.*)"$/;
            }
            static get singleRegex() {
              return /^!(.*)$/;
            }
            search(text) {
              const index = text.indexOf(this.pattern);
              const isMatch = index === -1;
              return {
                isMatch,
                score: isMatch ? 0 : 1,
                indices: [0, text.length - 1]
              };
            }
          }
          class PrefixExactMatch extends BaseMatch {
            constructor(pattern) {
              super(pattern);
            }
            static get type() {
              return "prefix-exact";
            }
            static get multiRegex() {
              return /^\^"(.*)"$/;
            }
            static get singleRegex() {
              return /^\^(.*)$/;
            }
            search(text) {
              const isMatch = text.startsWith(this.pattern);
              return {
                isMatch,
                score: isMatch ? 0 : 1,
                indices: [0, this.pattern.length - 1]
              };
            }
          }
          class InversePrefixExactMatch extends BaseMatch {
            constructor(pattern) {
              super(pattern);
            }
            static get type() {
              return "inverse-prefix-exact";
            }
            static get multiRegex() {
              return /^!\^"(.*)"$/;
            }
            static get singleRegex() {
              return /^!\^(.*)$/;
            }
            search(text) {
              const isMatch = !text.startsWith(this.pattern);
              return {
                isMatch,
                score: isMatch ? 0 : 1,
                indices: [0, text.length - 1]
              };
            }
          }
          class SuffixExactMatch extends BaseMatch {
            constructor(pattern) {
              super(pattern);
            }
            static get type() {
              return "suffix-exact";
            }
            static get multiRegex() {
              return /^"(.*)"\$$/;
            }
            static get singleRegex() {
              return /^(.*)\$$/;
            }
            search(text) {
              const isMatch = text.endsWith(this.pattern);
              return {
                isMatch,
                score: isMatch ? 0 : 1,
                indices: [text.length - this.pattern.length, text.length - 1]
              };
            }
          }
          class InverseSuffixExactMatch extends BaseMatch {
            constructor(pattern) {
              super(pattern);
            }
            static get type() {
              return "inverse-suffix-exact";
            }
            static get multiRegex() {
              return /^!"(.*)"\$$/;
            }
            static get singleRegex() {
              return /^!(.*)\$$/;
            }
            search(text) {
              const isMatch = !text.endsWith(this.pattern);
              return {
                isMatch,
                score: isMatch ? 0 : 1,
                indices: [0, text.length - 1]
              };
            }
          }
          class FuzzyMatch extends BaseMatch {
            constructor(pattern, {
              location: location2 = Config.location,
              threshold = Config.threshold,
              distance = Config.distance,
              includeMatches = Config.includeMatches,
              findAllMatches = Config.findAllMatches,
              minMatchCharLength = Config.minMatchCharLength,
              isCaseSensitive = Config.isCaseSensitive,
              ignoreLocation = Config.ignoreLocation
            } = {}) {
              super(pattern);
              this._bitapSearch = new BitapSearch(pattern, {
                location: location2,
                threshold,
                distance,
                includeMatches,
                findAllMatches,
                minMatchCharLength,
                isCaseSensitive,
                ignoreLocation
              });
            }
            static get type() {
              return "fuzzy";
            }
            static get multiRegex() {
              return /^"(.*)"$/;
            }
            static get singleRegex() {
              return /^(.*)$/;
            }
            search(text) {
              return this._bitapSearch.searchIn(text);
            }
          }
          class IncludeMatch extends BaseMatch {
            constructor(pattern) {
              super(pattern);
            }
            static get type() {
              return "include";
            }
            static get multiRegex() {
              return /^'"(.*)"$/;
            }
            static get singleRegex() {
              return /^'(.*)$/;
            }
            search(text) {
              let location2 = 0;
              let index;
              const indices = [];
              const patternLen = this.pattern.length;
              while ((index = text.indexOf(this.pattern, location2)) > -1) {
                location2 = index + patternLen;
                indices.push([index, location2 - 1]);
              }
              const isMatch = !!indices.length;
              return {
                isMatch,
                score: isMatch ? 0 : 1,
                indices
              };
            }
          }
          const searchers = [
            ExactMatch,
            IncludeMatch,
            PrefixExactMatch,
            InversePrefixExactMatch,
            InverseSuffixExactMatch,
            SuffixExactMatch,
            InverseExactMatch,
            FuzzyMatch
          ];
          const searchersLen = searchers.length;
          const SPACE_RE = / +(?=([^\"]*\"[^\"]*\")*[^\"]*$)/;
          const OR_TOKEN = "|";
          function parseQuery(pattern, options = {}) {
            return pattern.split(OR_TOKEN).map((item) => {
              let query = item.trim().split(SPACE_RE).filter((item2) => item2 && !!item2.trim());
              let results = [];
              for (let i = 0, len = query.length; i < len; i += 1) {
                const queryItem = query[i];
                let found = false;
                let idx = -1;
                while (!found && ++idx < searchersLen) {
                  const searcher = searchers[idx];
                  let token = searcher.isMultiMatch(queryItem);
                  if (token) {
                    results.push(new searcher(token, options));
                    found = true;
                  }
                }
                if (found) {
                  continue;
                }
                idx = -1;
                while (++idx < searchersLen) {
                  const searcher = searchers[idx];
                  let token = searcher.isSingleMatch(queryItem);
                  if (token) {
                    results.push(new searcher(token, options));
                    break;
                  }
                }
              }
              return results;
            });
          }
          const MultiMatchSet = new Set([FuzzyMatch.type, IncludeMatch.type]);
          class ExtendedSearch {
            constructor(pattern, {
              isCaseSensitive = Config.isCaseSensitive,
              includeMatches = Config.includeMatches,
              minMatchCharLength = Config.minMatchCharLength,
              ignoreLocation = Config.ignoreLocation,
              findAllMatches = Config.findAllMatches,
              location: location2 = Config.location,
              threshold = Config.threshold,
              distance = Config.distance
            } = {}) {
              this.query = null;
              this.options = {
                isCaseSensitive,
                includeMatches,
                minMatchCharLength,
                findAllMatches,
                ignoreLocation,
                location: location2,
                threshold,
                distance
              };
              this.pattern = isCaseSensitive ? pattern : pattern.toLowerCase();
              this.query = parseQuery(this.pattern, this.options);
            }
            static condition(_, options) {
              return options.useExtendedSearch;
            }
            searchIn(text) {
              const query = this.query;
              if (!query) {
                return {
                  isMatch: false,
                  score: 1
                };
              }
              const {includeMatches, isCaseSensitive} = this.options;
              text = isCaseSensitive ? text : text.toLowerCase();
              let numMatches = 0;
              let allIndices = [];
              let totalScore = 0;
              for (let i = 0, qLen = query.length; i < qLen; i += 1) {
                const searchers2 = query[i];
                allIndices.length = 0;
                numMatches = 0;
                for (let j = 0, pLen = searchers2.length; j < pLen; j += 1) {
                  const searcher = searchers2[j];
                  const {isMatch, indices, score} = searcher.search(text);
                  if (isMatch) {
                    numMatches += 1;
                    totalScore += score;
                    if (includeMatches) {
                      const type = searcher.constructor.type;
                      if (MultiMatchSet.has(type)) {
                        allIndices = [...allIndices, ...indices];
                      } else {
                        allIndices.push(indices);
                      }
                    }
                  } else {
                    totalScore = 0;
                    numMatches = 0;
                    allIndices.length = 0;
                    break;
                  }
                }
                if (numMatches) {
                  let result = {
                    isMatch: true,
                    score: totalScore / numMatches
                  };
                  if (includeMatches) {
                    result.indices = allIndices;
                  }
                  return result;
                }
              }
              return {
                isMatch: false,
                score: 1
              };
            }
          }
          const registeredSearchers = [];
          function register(...args) {
            registeredSearchers.push(...args);
          }
          function createSearcher(pattern, options) {
            for (let i = 0, len = registeredSearchers.length; i < len; i += 1) {
              let searcherClass = registeredSearchers[i];
              if (searcherClass.condition(pattern, options)) {
                return new searcherClass(pattern, options);
              }
            }
            return new BitapSearch(pattern, options);
          }
          const LogicalOperator = {
            AND: "$and",
            OR: "$or"
          };
          const KeyType = {
            PATH: "$path",
            PATTERN: "$val"
          };
          const isExpression = (query) => !!(query[LogicalOperator.AND] || query[LogicalOperator.OR]);
          const isPath = (query) => !!query[KeyType.PATH];
          const isLeaf = (query) => !isArray(query) && isObject(query) && !isExpression(query);
          const convertToExplicit = (query) => ({
            [LogicalOperator.AND]: Object.keys(query).map((key) => ({
              [key]: query[key]
            }))
          });
          function parse(query, options, {auto = true} = {}) {
            const next = (query2) => {
              let keys = Object.keys(query2);
              const isQueryPath = isPath(query2);
              if (!isQueryPath && keys.length > 1 && !isExpression(query2)) {
                return next(convertToExplicit(query2));
              }
              if (isLeaf(query2)) {
                const key = isQueryPath ? query2[KeyType.PATH] : keys[0];
                const pattern = isQueryPath ? query2[KeyType.PATTERN] : query2[key];
                if (!isString(pattern)) {
                  throw new Error(LOGICAL_SEARCH_INVALID_QUERY_FOR_KEY(key));
                }
                const obj = {
                  keyId: createKeyId(key),
                  pattern
                };
                if (auto) {
                  obj.searcher = createSearcher(pattern, options);
                }
                return obj;
              }
              let node = {
                children: [],
                operator: keys[0]
              };
              keys.forEach((key) => {
                const value = query2[key];
                if (isArray(value)) {
                  value.forEach((item) => {
                    node.children.push(next(item));
                  });
                }
              });
              return node;
            };
            if (!isExpression(query)) {
              query = convertToExplicit(query);
            }
            return next(query);
          }
          function computeScore(results, {ignoreFieldNorm = Config.ignoreFieldNorm}) {
            results.forEach((result) => {
              let totalScore = 1;
              result.matches.forEach(({key, norm: norm2, score}) => {
                const weight = key ? key.weight : null;
                totalScore *= Math.pow(score === 0 && weight ? Number.EPSILON : score, (weight || 1) * (ignoreFieldNorm ? 1 : norm2));
              });
              result.score = totalScore;
            });
          }
          function transformMatches(result, data2) {
            const matches = result.matches;
            data2.matches = [];
            if (!isDefined(matches)) {
              return;
            }
            matches.forEach((match) => {
              if (!isDefined(match.indices) || !match.indices.length) {
                return;
              }
              const {indices, value} = match;
              let obj = {
                indices,
                value
              };
              if (match.key) {
                obj.key = match.key.src;
              }
              if (match.idx > -1) {
                obj.refIndex = match.idx;
              }
              data2.matches.push(obj);
            });
          }
          function transformScore(result, data2) {
            data2.score = result.score;
          }
          function format2(results, docs, {
            includeMatches = Config.includeMatches,
            includeScore = Config.includeScore
          } = {}) {
            const transformers = [];
            if (includeMatches)
              transformers.push(transformMatches);
            if (includeScore)
              transformers.push(transformScore);
            return results.map((result) => {
              const {idx} = result;
              const data2 = {
                item: docs[idx],
                refIndex: idx
              };
              if (transformers.length) {
                transformers.forEach((transformer) => {
                  transformer(result, data2);
                });
              }
              return data2;
            });
          }
          class Fuse {
            constructor(docs, options = {}, index) {
              this.options = {...Config, ...options};
              if (this.options.useExtendedSearch && false) {
              }
              this._keyStore = new KeyStore(this.options.keys);
              this.setCollection(docs, index);
            }
            setCollection(docs, index) {
              this._docs = docs;
              if (index && !(index instanceof FuseIndex)) {
                throw new Error(INCORRECT_INDEX_TYPE);
              }
              this._myIndex = index || createIndex(this.options.keys, this._docs, {
                getFn: this.options.getFn,
                fieldNormWeight: this.options.fieldNormWeight
              });
            }
            add(doc) {
              if (!isDefined(doc)) {
                return;
              }
              this._docs.push(doc);
              this._myIndex.add(doc);
            }
            remove(predicate = () => false) {
              const results = [];
              for (let i = 0, len = this._docs.length; i < len; i += 1) {
                const doc = this._docs[i];
                if (predicate(doc, i)) {
                  this.removeAt(i);
                  i -= 1;
                  len -= 1;
                  results.push(doc);
                }
              }
              return results;
            }
            removeAt(idx) {
              this._docs.splice(idx, 1);
              this._myIndex.removeAt(idx);
            }
            getIndex() {
              return this._myIndex;
            }
            search(query, {limit = -1} = {}) {
              const {
                includeMatches,
                includeScore,
                shouldSort,
                sortFn,
                ignoreFieldNorm
              } = this.options;
              let results = isString(query) ? isString(this._docs[0]) ? this._searchStringList(query) : this._searchObjectList(query) : this._searchLogical(query);
              computeScore(results, {ignoreFieldNorm});
              if (shouldSort) {
                results.sort(sortFn);
              }
              if (isNumber(limit) && limit > -1) {
                results = results.slice(0, limit);
              }
              return format2(results, this._docs, {
                includeMatches,
                includeScore
              });
            }
            _searchStringList(query) {
              const searcher = createSearcher(query, this.options);
              const {records} = this._myIndex;
              const results = [];
              records.forEach(({v: text, i: idx, n: norm2}) => {
                if (!isDefined(text)) {
                  return;
                }
                const {isMatch, score, indices} = searcher.searchIn(text);
                if (isMatch) {
                  results.push({
                    item: text,
                    idx,
                    matches: [{score, value: text, norm: norm2, indices}]
                  });
                }
              });
              return results;
            }
            _searchLogical(query) {
              const expression = parse(query, this.options);
              const evaluate = (node, item, idx) => {
                if (!node.children) {
                  const {keyId, searcher} = node;
                  const matches = this._findMatches({
                    key: this._keyStore.get(keyId),
                    value: this._myIndex.getValueForItemAtKeyId(item, keyId),
                    searcher
                  });
                  if (matches && matches.length) {
                    return [
                      {
                        idx,
                        item,
                        matches
                      }
                    ];
                  }
                  return [];
                }
                const res = [];
                for (let i = 0, len = node.children.length; i < len; i += 1) {
                  const child = node.children[i];
                  const result = evaluate(child, item, idx);
                  if (result.length) {
                    res.push(...result);
                  } else if (node.operator === LogicalOperator.AND) {
                    return [];
                  }
                }
                return res;
              };
              const records = this._myIndex.records;
              const resultMap = {};
              const results = [];
              records.forEach(({$: item, i: idx}) => {
                if (isDefined(item)) {
                  let expResults = evaluate(expression, item, idx);
                  if (expResults.length) {
                    if (!resultMap[idx]) {
                      resultMap[idx] = {idx, item, matches: []};
                      results.push(resultMap[idx]);
                    }
                    expResults.forEach(({matches}) => {
                      resultMap[idx].matches.push(...matches);
                    });
                  }
                }
              });
              return results;
            }
            _searchObjectList(query) {
              const searcher = createSearcher(query, this.options);
              const {keys, records} = this._myIndex;
              const results = [];
              records.forEach(({$: item, i: idx}) => {
                if (!isDefined(item)) {
                  return;
                }
                let matches = [];
                keys.forEach((key, keyIndex) => {
                  matches.push(...this._findMatches({
                    key,
                    value: item[keyIndex],
                    searcher
                  }));
                });
                if (matches.length) {
                  results.push({
                    idx,
                    item,
                    matches
                  });
                }
              });
              return results;
            }
            _findMatches({key, value, searcher}) {
              if (!isDefined(value)) {
                return [];
              }
              let matches = [];
              if (isArray(value)) {
                value.forEach(({v: text, i: idx, n: norm2}) => {
                  if (!isDefined(text)) {
                    return;
                  }
                  const {isMatch, score, indices} = searcher.searchIn(text);
                  if (isMatch) {
                    matches.push({
                      score,
                      key,
                      value: text,
                      idx,
                      norm: norm2,
                      indices
                    });
                  }
                });
              } else {
                const {v: text, n: norm2} = value;
                const {isMatch, score, indices} = searcher.searchIn(text);
                if (isMatch) {
                  matches.push({score, key, value: text, norm: norm2, indices});
                }
              }
              return matches;
            }
          }
          Fuse.version = "6.5.3";
          Fuse.createIndex = createIndex;
          Fuse.parseIndex = parseIndex;
          Fuse.config = Config;
          {
            Fuse.parseQuery = parse;
          }
          {
            register(ExtendedSearch);
          }
        },
        857: function(__unused_webpack_module, __webpack_exports__2, __webpack_require__2) {
          __webpack_require__2.r(__webpack_exports__2);
          __webpack_require__2.d(__webpack_exports__2, {
            __DO_NOT_USE__ActionTypes: function() {
              return ActionTypes;
            },
            applyMiddleware: function() {
              return applyMiddleware;
            },
            bindActionCreators: function() {
              return bindActionCreators;
            },
            combineReducers: function() {
              return combineReducers;
            },
            compose: function() {
              return compose;
            },
            createStore: function() {
              return createStore;
            }
          });
          ;
          function _defineProperty(obj, key, value) {
            if (key in obj) {
              Object.defineProperty(obj, key, {
                value,
                enumerable: true,
                configurable: true,
                writable: true
              });
            } else {
              obj[key] = value;
            }
            return obj;
          }
          ;
          function ownKeys(object, enumerableOnly) {
            var keys = Object.keys(object);
            if (Object.getOwnPropertySymbols) {
              var symbols = Object.getOwnPropertySymbols(object);
              enumerableOnly && (symbols = symbols.filter(function(sym) {
                return Object.getOwnPropertyDescriptor(object, sym).enumerable;
              })), keys.push.apply(keys, symbols);
            }
            return keys;
          }
          function _objectSpread2(target) {
            for (var i = 1; i < arguments.length; i++) {
              var source = arguments[i] != null ? arguments[i] : {};
              i % 2 ? ownKeys(Object(source), true).forEach(function(key) {
                _defineProperty(target, key, source[key]);
              }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function(key) {
                Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));
              });
            }
            return target;
          }
          ;
          function formatProdErrorMessage(code) {
            return "Minified Redux error #" + code + "; visit https://redux.js.org/Errors?code=" + code + " for the full message or use the non-minified dev environment for full errors. ";
          }
          var $$observable = function() {
            return typeof Symbol === "function" && Symbol.observable || "@@observable";
          }();
          var randomString = function randomString2() {
            return Math.random().toString(36).substring(7).split("").join(".");
          };
          var ActionTypes = {
            INIT: "@@redux/INIT" + randomString(),
            REPLACE: "@@redux/REPLACE" + randomString(),
            PROBE_UNKNOWN_ACTION: function PROBE_UNKNOWN_ACTION() {
              return "@@redux/PROBE_UNKNOWN_ACTION" + randomString();
            }
          };
          function isPlainObject(obj) {
            if (typeof obj !== "object" || obj === null)
              return false;
            var proto2 = obj;
            while (Object.getPrototypeOf(proto2) !== null) {
              proto2 = Object.getPrototypeOf(proto2);
            }
            return Object.getPrototypeOf(obj) === proto2;
          }
          function miniKindOf(val) {
            if (val === void 0)
              return "undefined";
            if (val === null)
              return "null";
            var type = typeof val;
            switch (type) {
              case "boolean":
              case "string":
              case "number":
              case "symbol":
              case "function": {
                return type;
              }
            }
            if (Array.isArray(val))
              return "array";
            if (isDate(val))
              return "date";
            if (isError(val))
              return "error";
            var constructorName = ctorName(val);
            switch (constructorName) {
              case "Symbol":
              case "Promise":
              case "WeakMap":
              case "WeakSet":
              case "Map":
              case "Set":
                return constructorName;
            }
            return type.slice(8, -1).toLowerCase().replace(/\s/g, "");
          }
          function ctorName(val) {
            return typeof val.constructor === "function" ? val.constructor.name : null;
          }
          function isError(val) {
            return val instanceof Error || typeof val.message === "string" && val.constructor && typeof val.constructor.stackTraceLimit === "number";
          }
          function isDate(val) {
            if (val instanceof Date)
              return true;
            return typeof val.toDateString === "function" && typeof val.getDate === "function" && typeof val.setDate === "function";
          }
          function kindOf(val) {
            var typeOfVal = typeof val;
            if (false) {
            }
            return typeOfVal;
          }
          function createStore(reducer, preloadedState, enhancer) {
            var _ref2;
            if (typeof preloadedState === "function" && typeof enhancer === "function" || typeof enhancer === "function" && typeof arguments[3] === "function") {
              throw new Error(true ? formatProdErrorMessage(0) : 0);
            }
            if (typeof preloadedState === "function" && typeof enhancer === "undefined") {
              enhancer = preloadedState;
              preloadedState = void 0;
            }
            if (typeof enhancer !== "undefined") {
              if (typeof enhancer !== "function") {
                throw new Error(true ? formatProdErrorMessage(1) : 0);
              }
              return enhancer(createStore)(reducer, preloadedState);
            }
            if (typeof reducer !== "function") {
              throw new Error(true ? formatProdErrorMessage(2) : 0);
            }
            var currentReducer = reducer;
            var currentState = preloadedState;
            var currentListeners = [];
            var nextListeners = currentListeners;
            var isDispatching = false;
            function ensureCanMutateNextListeners() {
              if (nextListeners === currentListeners) {
                nextListeners = currentListeners.slice();
              }
            }
            function getState() {
              if (isDispatching) {
                throw new Error(true ? formatProdErrorMessage(3) : 0);
              }
              return currentState;
            }
            function subscribe(listener) {
              if (typeof listener !== "function") {
                throw new Error(true ? formatProdErrorMessage(4) : 0);
              }
              if (isDispatching) {
                throw new Error(true ? formatProdErrorMessage(5) : 0);
              }
              var isSubscribed = true;
              ensureCanMutateNextListeners();
              nextListeners.push(listener);
              return function unsubscribe() {
                if (!isSubscribed) {
                  return;
                }
                if (isDispatching) {
                  throw new Error(true ? formatProdErrorMessage(6) : 0);
                }
                isSubscribed = false;
                ensureCanMutateNextListeners();
                var index = nextListeners.indexOf(listener);
                nextListeners.splice(index, 1);
                currentListeners = null;
              };
            }
            function dispatch(action) {
              if (!isPlainObject(action)) {
                throw new Error(true ? formatProdErrorMessage(7) : 0);
              }
              if (typeof action.type === "undefined") {
                throw new Error(true ? formatProdErrorMessage(8) : 0);
              }
              if (isDispatching) {
                throw new Error(true ? formatProdErrorMessage(9) : 0);
              }
              try {
                isDispatching = true;
                currentState = currentReducer(currentState, action);
              } finally {
                isDispatching = false;
              }
              var listeners = currentListeners = nextListeners;
              for (var i = 0; i < listeners.length; i++) {
                var listener = listeners[i];
                listener();
              }
              return action;
            }
            function replaceReducer(nextReducer) {
              if (typeof nextReducer !== "function") {
                throw new Error(true ? formatProdErrorMessage(10) : 0);
              }
              currentReducer = nextReducer;
              dispatch({
                type: ActionTypes.REPLACE
              });
            }
            function observable() {
              var _ref;
              var outerSubscribe = subscribe;
              return _ref = {
                subscribe: function subscribe2(observer) {
                  if (typeof observer !== "object" || observer === null) {
                    throw new Error(true ? formatProdErrorMessage(11) : 0);
                  }
                  function observeState() {
                    if (observer.next) {
                      observer.next(getState());
                    }
                  }
                  observeState();
                  var unsubscribe = outerSubscribe(observeState);
                  return {
                    unsubscribe
                  };
                }
              }, _ref[$$observable] = function() {
                return this;
              }, _ref;
            }
            dispatch({
              type: ActionTypes.INIT
            });
            return _ref2 = {
              dispatch,
              subscribe,
              getState,
              replaceReducer
            }, _ref2[$$observable] = observable, _ref2;
          }
          function warning(message) {
            if (typeof console !== "undefined" && typeof console.error === "function") {
              console.error(message);
            }
            try {
              throw new Error(message);
            } catch (e) {
            }
          }
          function getUnexpectedStateShapeWarningMessage(inputState, reducers, action, unexpectedKeyCache) {
            var reducerKeys = Object.keys(reducers);
            var argumentName = action && action.type === ActionTypes.INIT ? "preloadedState argument passed to createStore" : "previous state received by the reducer";
            if (reducerKeys.length === 0) {
              return "Store does not have a valid reducer. Make sure the argument passed to combineReducers is an object whose values are reducers.";
            }
            if (!isPlainObject(inputState)) {
              return "The " + argumentName + ' has unexpected type of "' + kindOf(inputState) + '". Expected argument to be an object with the following ' + ('keys: "' + reducerKeys.join('", "') + '"');
            }
            var unexpectedKeys = Object.keys(inputState).filter(function(key) {
              return !reducers.hasOwnProperty(key) && !unexpectedKeyCache[key];
            });
            unexpectedKeys.forEach(function(key) {
              unexpectedKeyCache[key] = true;
            });
            if (action && action.type === ActionTypes.REPLACE)
              return;
            if (unexpectedKeys.length > 0) {
              return "Unexpected " + (unexpectedKeys.length > 1 ? "keys" : "key") + " " + ('"' + unexpectedKeys.join('", "') + '" found in ' + argumentName + ". ") + "Expected to find one of the known reducer keys instead: " + ('"' + reducerKeys.join('", "') + '". Unexpected keys will be ignored.');
            }
          }
          function assertReducerShape(reducers) {
            Object.keys(reducers).forEach(function(key) {
              var reducer = reducers[key];
              var initialState = reducer(void 0, {
                type: ActionTypes.INIT
              });
              if (typeof initialState === "undefined") {
                throw new Error(true ? formatProdErrorMessage(12) : 0);
              }
              if (typeof reducer(void 0, {
                type: ActionTypes.PROBE_UNKNOWN_ACTION()
              }) === "undefined") {
                throw new Error(true ? formatProdErrorMessage(13) : 0);
              }
            });
          }
          function combineReducers(reducers) {
            var reducerKeys = Object.keys(reducers);
            var finalReducers = {};
            for (var i = 0; i < reducerKeys.length; i++) {
              var key = reducerKeys[i];
              if (false) {
              }
              if (typeof reducers[key] === "function") {
                finalReducers[key] = reducers[key];
              }
            }
            var finalReducerKeys = Object.keys(finalReducers);
            var unexpectedKeyCache;
            if (false) {
            }
            var shapeAssertionError;
            try {
              assertReducerShape(finalReducers);
            } catch (e) {
              shapeAssertionError = e;
            }
            return function combination(state, action) {
              if (state === void 0) {
                state = {};
              }
              if (shapeAssertionError) {
                throw shapeAssertionError;
              }
              if (false) {
                var warningMessage;
              }
              var hasChanged = false;
              var nextState = {};
              for (var _i = 0; _i < finalReducerKeys.length; _i++) {
                var _key = finalReducerKeys[_i];
                var reducer = finalReducers[_key];
                var previousStateForKey = state[_key];
                var nextStateForKey = reducer(previousStateForKey, action);
                if (typeof nextStateForKey === "undefined") {
                  var actionType = action && action.type;
                  throw new Error(true ? formatProdErrorMessage(14) : 0);
                }
                nextState[_key] = nextStateForKey;
                hasChanged = hasChanged || nextStateForKey !== previousStateForKey;
              }
              hasChanged = hasChanged || finalReducerKeys.length !== Object.keys(state).length;
              return hasChanged ? nextState : state;
            };
          }
          function bindActionCreator(actionCreator, dispatch) {
            return function() {
              return dispatch(actionCreator.apply(this, arguments));
            };
          }
          function bindActionCreators(actionCreators, dispatch) {
            if (typeof actionCreators === "function") {
              return bindActionCreator(actionCreators, dispatch);
            }
            if (typeof actionCreators !== "object" || actionCreators === null) {
              throw new Error(true ? formatProdErrorMessage(16) : 0);
            }
            var boundActionCreators = {};
            for (var key in actionCreators) {
              var actionCreator = actionCreators[key];
              if (typeof actionCreator === "function") {
                boundActionCreators[key] = bindActionCreator(actionCreator, dispatch);
              }
            }
            return boundActionCreators;
          }
          function compose() {
            for (var _len = arguments.length, funcs = new Array(_len), _key = 0; _key < _len; _key++) {
              funcs[_key] = arguments[_key];
            }
            if (funcs.length === 0) {
              return function(arg) {
                return arg;
              };
            }
            if (funcs.length === 1) {
              return funcs[0];
            }
            return funcs.reduce(function(a, b) {
              return function() {
                return a(b.apply(void 0, arguments));
              };
            });
          }
          function applyMiddleware() {
            for (var _len = arguments.length, middlewares = new Array(_len), _key = 0; _key < _len; _key++) {
              middlewares[_key] = arguments[_key];
            }
            return function(createStore2) {
              return function() {
                var store = createStore2.apply(void 0, arguments);
                var _dispatch = function dispatch() {
                  throw new Error(true ? formatProdErrorMessage(15) : 0);
                };
                var middlewareAPI = {
                  getState: store.getState,
                  dispatch: function dispatch() {
                    return _dispatch.apply(void 0, arguments);
                  }
                };
                var chain = middlewares.map(function(middleware) {
                  return middleware(middlewareAPI);
                });
                _dispatch = compose.apply(void 0, chain)(store.dispatch);
                return _objectSpread2(_objectSpread2({}, store), {}, {
                  dispatch: _dispatch
                });
              };
            };
          }
          function isCrushed() {
          }
          if (false) {
          }
        }
      };
      var __webpack_module_cache__ = {};
      function __webpack_require__(moduleId) {
        var cachedModule = __webpack_module_cache__[moduleId];
        if (cachedModule !== void 0) {
          return cachedModule.exports;
        }
        var module2 = __webpack_module_cache__[moduleId] = {
          exports: {}
        };
        __webpack_modules__[moduleId].call(module2.exports, module2, module2.exports, __webpack_require__);
        return module2.exports;
      }
      !function() {
        __webpack_require__.n = function(module2) {
          var getter = module2 && module2.__esModule ? function() {
            return module2["default"];
          } : function() {
            return module2;
          };
          __webpack_require__.d(getter, {a: getter});
          return getter;
        };
      }();
      !function() {
        __webpack_require__.d = function(exports2, definition) {
          for (var key in definition) {
            if (__webpack_require__.o(definition, key) && !__webpack_require__.o(exports2, key)) {
              Object.defineProperty(exports2, key, {enumerable: true, get: definition[key]});
            }
          }
        };
      }();
      !function() {
        __webpack_require__.o = function(obj, prop) {
          return Object.prototype.hasOwnProperty.call(obj, prop);
        };
      }();
      !function() {
        __webpack_require__.r = function(exports2) {
          if (typeof Symbol !== "undefined" && Symbol.toStringTag) {
            Object.defineProperty(exports2, Symbol.toStringTag, {value: "Module"});
          }
          Object.defineProperty(exports2, "__esModule", {value: true});
        };
      }();
      var __webpack_exports__ = {};
      !function() {
        var _scripts_choices__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(373);
        var _scripts_choices__WEBPACK_IMPORTED_MODULE_0___default = /* @__PURE__ */ __webpack_require__.n(_scripts_choices__WEBPACK_IMPORTED_MODULE_0__);
        var _scripts_interfaces__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(187);
        var _scripts_interfaces__WEBPACK_IMPORTED_MODULE_1___default = /* @__PURE__ */ __webpack_require__.n(_scripts_interfaces__WEBPACK_IMPORTED_MODULE_1__);
        var _scripts_constants__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(883);
        var _scripts_defaults__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(789);
        var _scripts_templates__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(686);
        __webpack_exports__["default"] = _scripts_choices__WEBPACK_IMPORTED_MODULE_0___default();
      }();
      __webpack_exports__ = __webpack_exports__["default"];
      return __webpack_exports__;
    }();
  });
});

// node_modules/imask/dist/imask.js
var require_imask = __commonJS((exports, module) => {
  (function(global2, factory) {
    typeof exports === "object" && typeof module !== "undefined" ? factory(exports) : typeof define === "function" && define.amd ? define(["exports"], factory) : (global2 = typeof globalThis !== "undefined" ? globalThis : global2 || self, factory(global2.IMask = {}));
  })(exports, function(exports2) {
    "use strict";
    var commonjsGlobal = typeof globalThis !== "undefined" ? globalThis : typeof window !== "undefined" ? window : typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : {};
    var check = function(it) {
      return it && it.Math == Math && it;
    };
    var global$p = check(typeof globalThis == "object" && globalThis) || check(typeof window == "object" && window) || check(typeof self == "object" && self) || check(typeof commonjsGlobal == "object" && commonjsGlobal) || function() {
      return this;
    }() || Function("return this")();
    var objectGetOwnPropertyDescriptor = {};
    var fails$8 = function(exec) {
      try {
        return !!exec();
      } catch (error) {
        return true;
      }
    };
    var fails$7 = fails$8;
    var descriptors = !fails$7(function() {
      return Object.defineProperty({}, 1, {
        get: function() {
          return 7;
        }
      })[1] != 7;
    });
    var fails$6 = fails$8;
    var functionBindNative = !fails$6(function() {
      var test2 = function() {
      }.bind();
      return typeof test2 != "function" || test2.hasOwnProperty("prototype");
    });
    var NATIVE_BIND$1 = functionBindNative;
    var call$5 = Function.prototype.call;
    var functionCall = NATIVE_BIND$1 ? call$5.bind(call$5) : function() {
      return call$5.apply(call$5, arguments);
    };
    var objectPropertyIsEnumerable = {};
    var $propertyIsEnumerable = {}.propertyIsEnumerable;
    var getOwnPropertyDescriptor$1 = Object.getOwnPropertyDescriptor;
    var NASHORN_BUG = getOwnPropertyDescriptor$1 && !$propertyIsEnumerable.call({
      1: 2
    }, 1);
    objectPropertyIsEnumerable.f = NASHORN_BUG ? function propertyIsEnumerable(V) {
      var descriptor = getOwnPropertyDescriptor$1(this, V);
      return !!descriptor && descriptor.enumerable;
    } : $propertyIsEnumerable;
    var createPropertyDescriptor$2 = function(bitmap, value) {
      return {
        enumerable: !(bitmap & 1),
        configurable: !(bitmap & 2),
        writable: !(bitmap & 4),
        value
      };
    };
    var NATIVE_BIND = functionBindNative;
    var FunctionPrototype$1 = Function.prototype;
    var bind = FunctionPrototype$1.bind;
    var call$4 = FunctionPrototype$1.call;
    var uncurryThis$b = NATIVE_BIND && bind.bind(call$4, call$4);
    var functionUncurryThis = NATIVE_BIND ? function(fn) {
      return fn && uncurryThis$b(fn);
    } : function(fn) {
      return fn && function() {
        return call$4.apply(fn, arguments);
      };
    };
    var uncurryThis$a = functionUncurryThis;
    var toString$4 = uncurryThis$a({}.toString);
    var stringSlice$1 = uncurryThis$a("".slice);
    var classofRaw$1 = function(it) {
      return stringSlice$1(toString$4(it), 8, -1);
    };
    var global$o = global$p;
    var uncurryThis$9 = functionUncurryThis;
    var fails$5 = fails$8;
    var classof$2 = classofRaw$1;
    var Object$4 = global$o.Object;
    var split = uncurryThis$9("".split);
    var indexedObject = fails$5(function() {
      return !Object$4("z").propertyIsEnumerable(0);
    }) ? function(it) {
      return classof$2(it) == "String" ? split(it, "") : Object$4(it);
    } : Object$4;
    var global$n = global$p;
    var TypeError$7 = global$n.TypeError;
    var requireObjectCoercible$4 = function(it) {
      if (it == void 0)
        throw TypeError$7("Can't call method on " + it);
      return it;
    };
    var IndexedObject$1 = indexedObject;
    var requireObjectCoercible$3 = requireObjectCoercible$4;
    var toIndexedObject$3 = function(it) {
      return IndexedObject$1(requireObjectCoercible$3(it));
    };
    var isCallable$a = function(argument) {
      return typeof argument == "function";
    };
    var isCallable$9 = isCallable$a;
    var isObject$5 = function(it) {
      return typeof it == "object" ? it !== null : isCallable$9(it);
    };
    var global$m = global$p;
    var isCallable$8 = isCallable$a;
    var aFunction = function(argument) {
      return isCallable$8(argument) ? argument : void 0;
    };
    var getBuiltIn$3 = function(namespace, method) {
      return arguments.length < 2 ? aFunction(global$m[namespace]) : global$m[namespace] && global$m[namespace][method];
    };
    var uncurryThis$8 = functionUncurryThis;
    var objectIsPrototypeOf = uncurryThis$8({}.isPrototypeOf);
    var getBuiltIn$2 = getBuiltIn$3;
    var engineUserAgent = getBuiltIn$2("navigator", "userAgent") || "";
    var global$l = global$p;
    var userAgent$1 = engineUserAgent;
    var process = global$l.process;
    var Deno = global$l.Deno;
    var versions = process && process.versions || Deno && Deno.version;
    var v8 = versions && versions.v8;
    var match, version;
    if (v8) {
      match = v8.split(".");
      version = match[0] > 0 && match[0] < 4 ? 1 : +(match[0] + match[1]);
    }
    if (!version && userAgent$1) {
      match = userAgent$1.match(/Edge\/(\d+)/);
      if (!match || match[1] >= 74) {
        match = userAgent$1.match(/Chrome\/(\d+)/);
        if (match)
          version = +match[1];
      }
    }
    var engineV8Version = version;
    var V8_VERSION = engineV8Version;
    var fails$4 = fails$8;
    var nativeSymbol = !!Object.getOwnPropertySymbols && !fails$4(function() {
      var symbol = Symbol();
      return !String(symbol) || !(Object(symbol) instanceof Symbol) || !Symbol.sham && V8_VERSION && V8_VERSION < 41;
    });
    var NATIVE_SYMBOL$1 = nativeSymbol;
    var useSymbolAsUid = NATIVE_SYMBOL$1 && !Symbol.sham && typeof Symbol.iterator == "symbol";
    var global$k = global$p;
    var getBuiltIn$1 = getBuiltIn$3;
    var isCallable$7 = isCallable$a;
    var isPrototypeOf = objectIsPrototypeOf;
    var USE_SYMBOL_AS_UID$1 = useSymbolAsUid;
    var Object$3 = global$k.Object;
    var isSymbol$2 = USE_SYMBOL_AS_UID$1 ? function(it) {
      return typeof it == "symbol";
    } : function(it) {
      var $Symbol = getBuiltIn$1("Symbol");
      return isCallable$7($Symbol) && isPrototypeOf($Symbol.prototype, Object$3(it));
    };
    var global$j = global$p;
    var String$3 = global$j.String;
    var tryToString$1 = function(argument) {
      try {
        return String$3(argument);
      } catch (error) {
        return "Object";
      }
    };
    var global$i = global$p;
    var isCallable$6 = isCallable$a;
    var tryToString = tryToString$1;
    var TypeError$6 = global$i.TypeError;
    var aCallable$1 = function(argument) {
      if (isCallable$6(argument))
        return argument;
      throw TypeError$6(tryToString(argument) + " is not a function");
    };
    var aCallable = aCallable$1;
    var getMethod$1 = function(V, P) {
      var func = V[P];
      return func == null ? void 0 : aCallable(func);
    };
    var global$h = global$p;
    var call$3 = functionCall;
    var isCallable$5 = isCallable$a;
    var isObject$4 = isObject$5;
    var TypeError$5 = global$h.TypeError;
    var ordinaryToPrimitive$1 = function(input, pref) {
      var fn, val;
      if (pref === "string" && isCallable$5(fn = input.toString) && !isObject$4(val = call$3(fn, input)))
        return val;
      if (isCallable$5(fn = input.valueOf) && !isObject$4(val = call$3(fn, input)))
        return val;
      if (pref !== "string" && isCallable$5(fn = input.toString) && !isObject$4(val = call$3(fn, input)))
        return val;
      throw TypeError$5("Can't convert object to primitive value");
    };
    var shared$3 = {exports: {}};
    var global$g = global$p;
    var defineProperty$1 = Object.defineProperty;
    var setGlobal$3 = function(key, value) {
      try {
        defineProperty$1(global$g, key, {
          value,
          configurable: true,
          writable: true
        });
      } catch (error) {
        global$g[key] = value;
      }
      return value;
    };
    var global$f = global$p;
    var setGlobal$2 = setGlobal$3;
    var SHARED = "__core-js_shared__";
    var store$3 = global$f[SHARED] || setGlobal$2(SHARED, {});
    var sharedStore = store$3;
    var store$2 = sharedStore;
    (shared$3.exports = function(key, value) {
      return store$2[key] || (store$2[key] = value !== void 0 ? value : {});
    })("versions", []).push({
      version: "3.21.0",
      mode: "global",
      copyright: "\xA9 2014-2022 Denis Pushkarev (zloirock.ru)",
      license: "https://github.com/zloirock/core-js/blob/v3.21.0/LICENSE",
      source: "https://github.com/zloirock/core-js"
    });
    var global$e = global$p;
    var requireObjectCoercible$2 = requireObjectCoercible$4;
    var Object$2 = global$e.Object;
    var toObject$2 = function(argument) {
      return Object$2(requireObjectCoercible$2(argument));
    };
    var uncurryThis$7 = functionUncurryThis;
    var toObject$1 = toObject$2;
    var hasOwnProperty = uncurryThis$7({}.hasOwnProperty);
    var hasOwnProperty_1 = Object.hasOwn || function hasOwn2(it, key) {
      return hasOwnProperty(toObject$1(it), key);
    };
    var uncurryThis$6 = functionUncurryThis;
    var id = 0;
    var postfix = Math.random();
    var toString$3 = uncurryThis$6(1 .toString);
    var uid$2 = function(key) {
      return "Symbol(" + (key === void 0 ? "" : key) + ")_" + toString$3(++id + postfix, 36);
    };
    var global$d = global$p;
    var shared$2 = shared$3.exports;
    var hasOwn$6 = hasOwnProperty_1;
    var uid$1 = uid$2;
    var NATIVE_SYMBOL = nativeSymbol;
    var USE_SYMBOL_AS_UID = useSymbolAsUid;
    var WellKnownSymbolsStore = shared$2("wks");
    var Symbol$1 = global$d.Symbol;
    var symbolFor = Symbol$1 && Symbol$1["for"];
    var createWellKnownSymbol = USE_SYMBOL_AS_UID ? Symbol$1 : Symbol$1 && Symbol$1.withoutSetter || uid$1;
    var wellKnownSymbol$3 = function(name) {
      if (!hasOwn$6(WellKnownSymbolsStore, name) || !(NATIVE_SYMBOL || typeof WellKnownSymbolsStore[name] == "string")) {
        var description = "Symbol." + name;
        if (NATIVE_SYMBOL && hasOwn$6(Symbol$1, name)) {
          WellKnownSymbolsStore[name] = Symbol$1[name];
        } else if (USE_SYMBOL_AS_UID && symbolFor) {
          WellKnownSymbolsStore[name] = symbolFor(description);
        } else {
          WellKnownSymbolsStore[name] = createWellKnownSymbol(description);
        }
      }
      return WellKnownSymbolsStore[name];
    };
    var global$c = global$p;
    var call$2 = functionCall;
    var isObject$3 = isObject$5;
    var isSymbol$1 = isSymbol$2;
    var getMethod = getMethod$1;
    var ordinaryToPrimitive = ordinaryToPrimitive$1;
    var wellKnownSymbol$2 = wellKnownSymbol$3;
    var TypeError$4 = global$c.TypeError;
    var TO_PRIMITIVE = wellKnownSymbol$2("toPrimitive");
    var toPrimitive$1 = function(input, pref) {
      if (!isObject$3(input) || isSymbol$1(input))
        return input;
      var exoticToPrim = getMethod(input, TO_PRIMITIVE);
      var result;
      if (exoticToPrim) {
        if (pref === void 0)
          pref = "default";
        result = call$2(exoticToPrim, input, pref);
        if (!isObject$3(result) || isSymbol$1(result))
          return result;
        throw TypeError$4("Can't convert object to primitive value");
      }
      if (pref === void 0)
        pref = "number";
      return ordinaryToPrimitive(input, pref);
    };
    var toPrimitive = toPrimitive$1;
    var isSymbol = isSymbol$2;
    var toPropertyKey$2 = function(argument) {
      var key = toPrimitive(argument, "string");
      return isSymbol(key) ? key : key + "";
    };
    var global$b = global$p;
    var isObject$2 = isObject$5;
    var document$1 = global$b.document;
    var EXISTS$1 = isObject$2(document$1) && isObject$2(document$1.createElement);
    var documentCreateElement = function(it) {
      return EXISTS$1 ? document$1.createElement(it) : {};
    };
    var DESCRIPTORS$6 = descriptors;
    var fails$3 = fails$8;
    var createElement = documentCreateElement;
    var ie8DomDefine = !DESCRIPTORS$6 && !fails$3(function() {
      return Object.defineProperty(createElement("div"), "a", {
        get: function() {
          return 7;
        }
      }).a != 7;
    });
    var DESCRIPTORS$5 = descriptors;
    var call$1 = functionCall;
    var propertyIsEnumerableModule$1 = objectPropertyIsEnumerable;
    var createPropertyDescriptor$1 = createPropertyDescriptor$2;
    var toIndexedObject$2 = toIndexedObject$3;
    var toPropertyKey$1 = toPropertyKey$2;
    var hasOwn$5 = hasOwnProperty_1;
    var IE8_DOM_DEFINE$1 = ie8DomDefine;
    var $getOwnPropertyDescriptor$1 = Object.getOwnPropertyDescriptor;
    objectGetOwnPropertyDescriptor.f = DESCRIPTORS$5 ? $getOwnPropertyDescriptor$1 : function getOwnPropertyDescriptor2(O, P) {
      O = toIndexedObject$2(O);
      P = toPropertyKey$1(P);
      if (IE8_DOM_DEFINE$1)
        try {
          return $getOwnPropertyDescriptor$1(O, P);
        } catch (error) {
        }
      if (hasOwn$5(O, P))
        return createPropertyDescriptor$1(!call$1(propertyIsEnumerableModule$1.f, O, P), O[P]);
    };
    var objectDefineProperty = {};
    var DESCRIPTORS$4 = descriptors;
    var fails$2 = fails$8;
    var v8PrototypeDefineBug = DESCRIPTORS$4 && fails$2(function() {
      return Object.defineProperty(function() {
      }, "prototype", {
        value: 42,
        writable: false
      }).prototype != 42;
    });
    var global$a = global$p;
    var isObject$1 = isObject$5;
    var String$2 = global$a.String;
    var TypeError$3 = global$a.TypeError;
    var anObject$2 = function(argument) {
      if (isObject$1(argument))
        return argument;
      throw TypeError$3(String$2(argument) + " is not an object");
    };
    var global$9 = global$p;
    var DESCRIPTORS$3 = descriptors;
    var IE8_DOM_DEFINE = ie8DomDefine;
    var V8_PROTOTYPE_DEFINE_BUG = v8PrototypeDefineBug;
    var anObject$1 = anObject$2;
    var toPropertyKey = toPropertyKey$2;
    var TypeError$2 = global$9.TypeError;
    var $defineProperty = Object.defineProperty;
    var $getOwnPropertyDescriptor = Object.getOwnPropertyDescriptor;
    var ENUMERABLE = "enumerable";
    var CONFIGURABLE$1 = "configurable";
    var WRITABLE = "writable";
    objectDefineProperty.f = DESCRIPTORS$3 ? V8_PROTOTYPE_DEFINE_BUG ? function defineProperty2(O, P, Attributes) {
      anObject$1(O);
      P = toPropertyKey(P);
      anObject$1(Attributes);
      if (typeof O === "function" && P === "prototype" && "value" in Attributes && WRITABLE in Attributes && !Attributes[WRITABLE]) {
        var current = $getOwnPropertyDescriptor(O, P);
        if (current && current[WRITABLE]) {
          O[P] = Attributes.value;
          Attributes = {
            configurable: CONFIGURABLE$1 in Attributes ? Attributes[CONFIGURABLE$1] : current[CONFIGURABLE$1],
            enumerable: ENUMERABLE in Attributes ? Attributes[ENUMERABLE] : current[ENUMERABLE],
            writable: false
          };
        }
      }
      return $defineProperty(O, P, Attributes);
    } : $defineProperty : function defineProperty2(O, P, Attributes) {
      anObject$1(O);
      P = toPropertyKey(P);
      anObject$1(Attributes);
      if (IE8_DOM_DEFINE)
        try {
          return $defineProperty(O, P, Attributes);
        } catch (error) {
        }
      if ("get" in Attributes || "set" in Attributes)
        throw TypeError$2("Accessors not supported");
      if ("value" in Attributes)
        O[P] = Attributes.value;
      return O;
    };
    var DESCRIPTORS$2 = descriptors;
    var definePropertyModule$1 = objectDefineProperty;
    var createPropertyDescriptor = createPropertyDescriptor$2;
    var createNonEnumerableProperty$3 = DESCRIPTORS$2 ? function(object, key, value) {
      return definePropertyModule$1.f(object, key, createPropertyDescriptor(1, value));
    } : function(object, key, value) {
      object[key] = value;
      return object;
    };
    var redefine$1 = {exports: {}};
    var uncurryThis$5 = functionUncurryThis;
    var isCallable$4 = isCallable$a;
    var store$1 = sharedStore;
    var functionToString = uncurryThis$5(Function.toString);
    if (!isCallable$4(store$1.inspectSource)) {
      store$1.inspectSource = function(it) {
        return functionToString(it);
      };
    }
    var inspectSource$2 = store$1.inspectSource;
    var global$8 = global$p;
    var isCallable$3 = isCallable$a;
    var inspectSource$1 = inspectSource$2;
    var WeakMap$1 = global$8.WeakMap;
    var nativeWeakMap = isCallable$3(WeakMap$1) && /native code/.test(inspectSource$1(WeakMap$1));
    var shared$1 = shared$3.exports;
    var uid = uid$2;
    var keys = shared$1("keys");
    var sharedKey$1 = function(key) {
      return keys[key] || (keys[key] = uid(key));
    };
    var hiddenKeys$3 = {};
    var NATIVE_WEAK_MAP = nativeWeakMap;
    var global$7 = global$p;
    var uncurryThis$4 = functionUncurryThis;
    var isObject = isObject$5;
    var createNonEnumerableProperty$2 = createNonEnumerableProperty$3;
    var hasOwn$4 = hasOwnProperty_1;
    var shared = sharedStore;
    var sharedKey = sharedKey$1;
    var hiddenKeys$2 = hiddenKeys$3;
    var OBJECT_ALREADY_INITIALIZED = "Object already initialized";
    var TypeError$1 = global$7.TypeError;
    var WeakMap2 = global$7.WeakMap;
    var set$1, get, has;
    var enforce = function(it) {
      return has(it) ? get(it) : set$1(it, {});
    };
    var getterFor = function(TYPE) {
      return function(it) {
        var state;
        if (!isObject(it) || (state = get(it)).type !== TYPE) {
          throw TypeError$1("Incompatible receiver, " + TYPE + " required");
        }
        return state;
      };
    };
    if (NATIVE_WEAK_MAP || shared.state) {
      var store = shared.state || (shared.state = new WeakMap2());
      var wmget = uncurryThis$4(store.get);
      var wmhas = uncurryThis$4(store.has);
      var wmset = uncurryThis$4(store.set);
      set$1 = function(it, metadata) {
        if (wmhas(store, it))
          throw new TypeError$1(OBJECT_ALREADY_INITIALIZED);
        metadata.facade = it;
        wmset(store, it, metadata);
        return metadata;
      };
      get = function(it) {
        return wmget(store, it) || {};
      };
      has = function(it) {
        return wmhas(store, it);
      };
    } else {
      var STATE = sharedKey("state");
      hiddenKeys$2[STATE] = true;
      set$1 = function(it, metadata) {
        if (hasOwn$4(it, STATE))
          throw new TypeError$1(OBJECT_ALREADY_INITIALIZED);
        metadata.facade = it;
        createNonEnumerableProperty$2(it, STATE, metadata);
        return metadata;
      };
      get = function(it) {
        return hasOwn$4(it, STATE) ? it[STATE] : {};
      };
      has = function(it) {
        return hasOwn$4(it, STATE);
      };
    }
    var internalState = {
      set: set$1,
      get,
      has,
      enforce,
      getterFor
    };
    var DESCRIPTORS$1 = descriptors;
    var hasOwn$3 = hasOwnProperty_1;
    var FunctionPrototype = Function.prototype;
    var getDescriptor = DESCRIPTORS$1 && Object.getOwnPropertyDescriptor;
    var EXISTS = hasOwn$3(FunctionPrototype, "name");
    var PROPER = EXISTS && function something() {
    }.name === "something";
    var CONFIGURABLE = EXISTS && (!DESCRIPTORS$1 || DESCRIPTORS$1 && getDescriptor(FunctionPrototype, "name").configurable);
    var functionName = {
      EXISTS,
      PROPER,
      CONFIGURABLE
    };
    var global$6 = global$p;
    var isCallable$2 = isCallable$a;
    var hasOwn$2 = hasOwnProperty_1;
    var createNonEnumerableProperty$1 = createNonEnumerableProperty$3;
    var setGlobal$1 = setGlobal$3;
    var inspectSource = inspectSource$2;
    var InternalStateModule = internalState;
    var CONFIGURABLE_FUNCTION_NAME = functionName.CONFIGURABLE;
    var getInternalState = InternalStateModule.get;
    var enforceInternalState = InternalStateModule.enforce;
    var TEMPLATE = String(String).split("String");
    (redefine$1.exports = function(O, key, value, options) {
      var unsafe = options ? !!options.unsafe : false;
      var simple = options ? !!options.enumerable : false;
      var noTargetGet = options ? !!options.noTargetGet : false;
      var name = options && options.name !== void 0 ? options.name : key;
      var state;
      if (isCallable$2(value)) {
        if (String(name).slice(0, 7) === "Symbol(") {
          name = "[" + String(name).replace(/^Symbol\(([^)]*)\)/, "$1") + "]";
        }
        if (!hasOwn$2(value, "name") || CONFIGURABLE_FUNCTION_NAME && value.name !== name) {
          createNonEnumerableProperty$1(value, "name", name);
        }
        state = enforceInternalState(value);
        if (!state.source) {
          state.source = TEMPLATE.join(typeof name == "string" ? name : "");
        }
      }
      if (O === global$6) {
        if (simple)
          O[key] = value;
        else
          setGlobal$1(key, value);
        return;
      } else if (!unsafe) {
        delete O[key];
      } else if (!noTargetGet && O[key]) {
        simple = true;
      }
      if (simple)
        O[key] = value;
      else
        createNonEnumerableProperty$1(O, key, value);
    })(Function.prototype, "toString", function toString2() {
      return isCallable$2(this) && getInternalState(this).source || inspectSource(this);
    });
    var objectGetOwnPropertyNames = {};
    var ceil$1 = Math.ceil;
    var floor = Math.floor;
    var toIntegerOrInfinity$3 = function(argument) {
      var number = +argument;
      return number !== number || number === 0 ? 0 : (number > 0 ? floor : ceil$1)(number);
    };
    var toIntegerOrInfinity$2 = toIntegerOrInfinity$3;
    var max = Math.max;
    var min$1 = Math.min;
    var toAbsoluteIndex$1 = function(index, length) {
      var integer = toIntegerOrInfinity$2(index);
      return integer < 0 ? max(integer + length, 0) : min$1(integer, length);
    };
    var toIntegerOrInfinity$1 = toIntegerOrInfinity$3;
    var min = Math.min;
    var toLength$2 = function(argument) {
      return argument > 0 ? min(toIntegerOrInfinity$1(argument), 9007199254740991) : 0;
    };
    var toLength$1 = toLength$2;
    var lengthOfArrayLike$1 = function(obj) {
      return toLength$1(obj.length);
    };
    var toIndexedObject$1 = toIndexedObject$3;
    var toAbsoluteIndex = toAbsoluteIndex$1;
    var lengthOfArrayLike = lengthOfArrayLike$1;
    var createMethod$1 = function(IS_INCLUDES) {
      return function($this, el, fromIndex) {
        var O = toIndexedObject$1($this);
        var length = lengthOfArrayLike(O);
        var index = toAbsoluteIndex(fromIndex, length);
        var value;
        if (IS_INCLUDES && el != el)
          while (length > index) {
            value = O[index++];
            if (value != value)
              return true;
          }
        else
          for (; length > index; index++) {
            if ((IS_INCLUDES || index in O) && O[index] === el)
              return IS_INCLUDES || index || 0;
          }
        return !IS_INCLUDES && -1;
      };
    };
    var arrayIncludes = {
      includes: createMethod$1(true),
      indexOf: createMethod$1(false)
    };
    var uncurryThis$3 = functionUncurryThis;
    var hasOwn$1 = hasOwnProperty_1;
    var toIndexedObject = toIndexedObject$3;
    var indexOf = arrayIncludes.indexOf;
    var hiddenKeys$1 = hiddenKeys$3;
    var push = uncurryThis$3([].push);
    var objectKeysInternal = function(object, names) {
      var O = toIndexedObject(object);
      var i = 0;
      var result = [];
      var key;
      for (key in O)
        !hasOwn$1(hiddenKeys$1, key) && hasOwn$1(O, key) && push(result, key);
      while (names.length > i)
        if (hasOwn$1(O, key = names[i++])) {
          ~indexOf(result, key) || push(result, key);
        }
      return result;
    };
    var enumBugKeys$2 = ["constructor", "hasOwnProperty", "isPrototypeOf", "propertyIsEnumerable", "toLocaleString", "toString", "valueOf"];
    var internalObjectKeys$1 = objectKeysInternal;
    var enumBugKeys$1 = enumBugKeys$2;
    var hiddenKeys = enumBugKeys$1.concat("length", "prototype");
    objectGetOwnPropertyNames.f = Object.getOwnPropertyNames || function getOwnPropertyNames(O) {
      return internalObjectKeys$1(O, hiddenKeys);
    };
    var objectGetOwnPropertySymbols = {};
    objectGetOwnPropertySymbols.f = Object.getOwnPropertySymbols;
    var getBuiltIn = getBuiltIn$3;
    var uncurryThis$2 = functionUncurryThis;
    var getOwnPropertyNamesModule = objectGetOwnPropertyNames;
    var getOwnPropertySymbolsModule$1 = objectGetOwnPropertySymbols;
    var anObject = anObject$2;
    var concat$1 = uncurryThis$2([].concat);
    var ownKeys$1 = getBuiltIn("Reflect", "ownKeys") || function ownKeys2(it) {
      var keys2 = getOwnPropertyNamesModule.f(anObject(it));
      var getOwnPropertySymbols = getOwnPropertySymbolsModule$1.f;
      return getOwnPropertySymbols ? concat$1(keys2, getOwnPropertySymbols(it)) : keys2;
    };
    var hasOwn = hasOwnProperty_1;
    var ownKeys = ownKeys$1;
    var getOwnPropertyDescriptorModule = objectGetOwnPropertyDescriptor;
    var definePropertyModule = objectDefineProperty;
    var copyConstructorProperties$1 = function(target, source, exceptions) {
      var keys2 = ownKeys(source);
      var defineProperty2 = definePropertyModule.f;
      var getOwnPropertyDescriptor2 = getOwnPropertyDescriptorModule.f;
      for (var i = 0; i < keys2.length; i++) {
        var key = keys2[i];
        if (!hasOwn(target, key) && !(exceptions && hasOwn(exceptions, key))) {
          defineProperty2(target, key, getOwnPropertyDescriptor2(source, key));
        }
      }
    };
    var fails$1 = fails$8;
    var isCallable$1 = isCallable$a;
    var replacement = /#|\.prototype\./;
    var isForced$1 = function(feature, detection) {
      var value = data2[normalize(feature)];
      return value == POLYFILL ? true : value == NATIVE ? false : isCallable$1(detection) ? fails$1(detection) : !!detection;
    };
    var normalize = isForced$1.normalize = function(string) {
      return String(string).replace(replacement, ".").toLowerCase();
    };
    var data2 = isForced$1.data = {};
    var NATIVE = isForced$1.NATIVE = "N";
    var POLYFILL = isForced$1.POLYFILL = "P";
    var isForced_1 = isForced$1;
    var global$5 = global$p;
    var getOwnPropertyDescriptor = objectGetOwnPropertyDescriptor.f;
    var createNonEnumerableProperty = createNonEnumerableProperty$3;
    var redefine = redefine$1.exports;
    var setGlobal = setGlobal$3;
    var copyConstructorProperties = copyConstructorProperties$1;
    var isForced = isForced_1;
    var _export = function(options, source) {
      var TARGET = options.target;
      var GLOBAL = options.global;
      var STATIC = options.stat;
      var FORCED, target, key, targetProperty, sourceProperty, descriptor;
      if (GLOBAL) {
        target = global$5;
      } else if (STATIC) {
        target = global$5[TARGET] || setGlobal(TARGET, {});
      } else {
        target = (global$5[TARGET] || {}).prototype;
      }
      if (target)
        for (key in source) {
          sourceProperty = source[key];
          if (options.noTargetGet) {
            descriptor = getOwnPropertyDescriptor(target, key);
            targetProperty = descriptor && descriptor.value;
          } else
            targetProperty = target[key];
          FORCED = isForced(GLOBAL ? key : TARGET + (STATIC ? "." : "#") + key, options.forced);
          if (!FORCED && targetProperty !== void 0) {
            if (typeof sourceProperty == typeof targetProperty)
              continue;
            copyConstructorProperties(sourceProperty, targetProperty);
          }
          if (options.sham || targetProperty && targetProperty.sham) {
            createNonEnumerableProperty(sourceProperty, "sham", true);
          }
          redefine(target, key, sourceProperty, options);
        }
    };
    var internalObjectKeys = objectKeysInternal;
    var enumBugKeys = enumBugKeys$2;
    var objectKeys$1 = Object.keys || function keys2(O) {
      return internalObjectKeys(O, enumBugKeys);
    };
    var DESCRIPTORS = descriptors;
    var uncurryThis$1 = functionUncurryThis;
    var call = functionCall;
    var fails = fails$8;
    var objectKeys = objectKeys$1;
    var getOwnPropertySymbolsModule = objectGetOwnPropertySymbols;
    var propertyIsEnumerableModule = objectPropertyIsEnumerable;
    var toObject = toObject$2;
    var IndexedObject = indexedObject;
    var $assign = Object.assign;
    var defineProperty = Object.defineProperty;
    var concat = uncurryThis$1([].concat);
    var objectAssign = !$assign || fails(function() {
      if (DESCRIPTORS && $assign({
        b: 1
      }, $assign(defineProperty({}, "a", {
        enumerable: true,
        get: function() {
          defineProperty(this, "b", {
            value: 3,
            enumerable: false
          });
        }
      }), {
        b: 2
      })).b !== 1)
        return true;
      var A = {};
      var B = {};
      var symbol = Symbol();
      var alphabet = "abcdefghijklmnopqrst";
      A[symbol] = 7;
      alphabet.split("").forEach(function(chr) {
        B[chr] = chr;
      });
      return $assign({}, A)[symbol] != 7 || objectKeys($assign({}, B)).join("") != alphabet;
    }) ? function assign2(target, source) {
      var T = toObject(target);
      var argumentsLength = arguments.length;
      var index = 1;
      var getOwnPropertySymbols = getOwnPropertySymbolsModule.f;
      var propertyIsEnumerable = propertyIsEnumerableModule.f;
      while (argumentsLength > index) {
        var S2 = IndexedObject(arguments[index++]);
        var keys2 = getOwnPropertySymbols ? concat(objectKeys(S2), getOwnPropertySymbols(S2)) : objectKeys(S2);
        var length = keys2.length;
        var j = 0;
        var key;
        while (length > j) {
          key = keys2[j++];
          if (!DESCRIPTORS || call(propertyIsEnumerable, S2, key))
            T[key] = S2[key];
        }
      }
      return T;
    } : $assign;
    var $$4 = _export;
    var assign = objectAssign;
    $$4({
      target: "Object",
      stat: true,
      forced: Object.assign !== assign
    }, {
      assign
    });
    var wellKnownSymbol$1 = wellKnownSymbol$3;
    var TO_STRING_TAG$1 = wellKnownSymbol$1("toStringTag");
    var test = {};
    test[TO_STRING_TAG$1] = "z";
    var toStringTagSupport = String(test) === "[object z]";
    var global$4 = global$p;
    var TO_STRING_TAG_SUPPORT = toStringTagSupport;
    var isCallable = isCallable$a;
    var classofRaw = classofRaw$1;
    var wellKnownSymbol = wellKnownSymbol$3;
    var TO_STRING_TAG = wellKnownSymbol("toStringTag");
    var Object$1 = global$4.Object;
    var CORRECT_ARGUMENTS = classofRaw(function() {
      return arguments;
    }()) == "Arguments";
    var tryGet = function(it, key) {
      try {
        return it[key];
      } catch (error) {
      }
    };
    var classof$1 = TO_STRING_TAG_SUPPORT ? classofRaw : function(it) {
      var O, tag, result;
      return it === void 0 ? "Undefined" : it === null ? "Null" : typeof (tag = tryGet(O = Object$1(it), TO_STRING_TAG)) == "string" ? tag : CORRECT_ARGUMENTS ? classofRaw(O) : (result = classofRaw(O)) == "Object" && isCallable(O.callee) ? "Arguments" : result;
    };
    var global$3 = global$p;
    var classof = classof$1;
    var String$1 = global$3.String;
    var toString$2 = function(argument) {
      if (classof(argument) === "Symbol")
        throw TypeError("Cannot convert a Symbol value to a string");
      return String$1(argument);
    };
    var global$2 = global$p;
    var toIntegerOrInfinity = toIntegerOrInfinity$3;
    var toString$1 = toString$2;
    var requireObjectCoercible$1 = requireObjectCoercible$4;
    var RangeError = global$2.RangeError;
    var stringRepeat = function repeat3(count) {
      var str = toString$1(requireObjectCoercible$1(this));
      var result = "";
      var n = toIntegerOrInfinity(count);
      if (n < 0 || n == Infinity)
        throw RangeError("Wrong number of repetitions");
      for (; n > 0; (n >>>= 1) && (str += str))
        if (n & 1)
          result += str;
      return result;
    };
    var $$3 = _export;
    var repeat$1 = stringRepeat;
    $$3({
      target: "String",
      proto: true
    }, {
      repeat: repeat$1
    });
    var uncurryThis = functionUncurryThis;
    var toLength = toLength$2;
    var toString = toString$2;
    var $repeat = stringRepeat;
    var requireObjectCoercible = requireObjectCoercible$4;
    var repeat2 = uncurryThis($repeat);
    var stringSlice = uncurryThis("".slice);
    var ceil = Math.ceil;
    var createMethod = function(IS_END) {
      return function($this, maxLength, fillString) {
        var S2 = toString(requireObjectCoercible($this));
        var intMaxLength = toLength(maxLength);
        var stringLength = S2.length;
        var fillStr = fillString === void 0 ? " " : toString(fillString);
        var fillLen, stringFiller;
        if (intMaxLength <= stringLength || fillStr == "")
          return S2;
        fillLen = intMaxLength - stringLength;
        stringFiller = repeat2(fillStr, ceil(fillLen / fillStr.length));
        if (stringFiller.length > fillLen)
          stringFiller = stringSlice(stringFiller, 0, fillLen);
        return IS_END ? S2 + stringFiller : stringFiller + S2;
      };
    };
    var stringPad = {
      start: createMethod(false),
      end: createMethod(true)
    };
    var userAgent = engineUserAgent;
    var stringPadWebkitBug = /Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(userAgent);
    var $$2 = _export;
    var $padStart = stringPad.start;
    var WEBKIT_BUG$1 = stringPadWebkitBug;
    $$2({
      target: "String",
      proto: true,
      forced: WEBKIT_BUG$1
    }, {
      padStart: function padStart3(maxLength) {
        return $padStart(this, maxLength, arguments.length > 1 ? arguments[1] : void 0);
      }
    });
    var $$1 = _export;
    var $padEnd = stringPad.end;
    var WEBKIT_BUG = stringPadWebkitBug;
    $$1({
      target: "String",
      proto: true,
      forced: WEBKIT_BUG
    }, {
      padEnd: function padEnd(maxLength) {
        return $padEnd(this, maxLength, arguments.length > 1 ? arguments[1] : void 0);
      }
    });
    var $ = _export;
    var global$1 = global$p;
    $({
      global: true
    }, {
      globalThis: global$1
    });
    function _typeof(obj) {
      "@babel/helpers - typeof";
      return _typeof = typeof Symbol == "function" && typeof Symbol.iterator == "symbol" ? function(obj2) {
        return typeof obj2;
      } : function(obj2) {
        return obj2 && typeof Symbol == "function" && obj2.constructor === Symbol && obj2 !== Symbol.prototype ? "symbol" : typeof obj2;
      }, _typeof(obj);
    }
    function _classCallCheck(instance, Constructor) {
      if (!(instance instanceof Constructor)) {
        throw new TypeError("Cannot call a class as a function");
      }
    }
    function _defineProperties(target, props) {
      for (var i = 0; i < props.length; i++) {
        var descriptor = props[i];
        descriptor.enumerable = descriptor.enumerable || false;
        descriptor.configurable = true;
        if ("value" in descriptor)
          descriptor.writable = true;
        Object.defineProperty(target, descriptor.key, descriptor);
      }
    }
    function _createClass(Constructor, protoProps, staticProps) {
      if (protoProps)
        _defineProperties(Constructor.prototype, protoProps);
      if (staticProps)
        _defineProperties(Constructor, staticProps);
      Object.defineProperty(Constructor, "prototype", {
        writable: false
      });
      return Constructor;
    }
    function _defineProperty(obj, key, value) {
      if (key in obj) {
        Object.defineProperty(obj, key, {
          value,
          enumerable: true,
          configurable: true,
          writable: true
        });
      } else {
        obj[key] = value;
      }
      return obj;
    }
    function _inherits(subClass, superClass) {
      if (typeof superClass !== "function" && superClass !== null) {
        throw new TypeError("Super expression must either be null or a function");
      }
      subClass.prototype = Object.create(superClass && superClass.prototype, {
        constructor: {
          value: subClass,
          writable: true,
          configurable: true
        }
      });
      Object.defineProperty(subClass, "prototype", {
        writable: false
      });
      if (superClass)
        _setPrototypeOf(subClass, superClass);
    }
    function _getPrototypeOf(o) {
      _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf2(o2) {
        return o2.__proto__ || Object.getPrototypeOf(o2);
      };
      return _getPrototypeOf(o);
    }
    function _setPrototypeOf(o, p) {
      _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf2(o2, p2) {
        o2.__proto__ = p2;
        return o2;
      };
      return _setPrototypeOf(o, p);
    }
    function _isNativeReflectConstruct() {
      if (typeof Reflect === "undefined" || !Reflect.construct)
        return false;
      if (Reflect.construct.sham)
        return false;
      if (typeof Proxy === "function")
        return true;
      try {
        Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function() {
        }));
        return true;
      } catch (e) {
        return false;
      }
    }
    function _objectWithoutPropertiesLoose(source, excluded) {
      if (source == null)
        return {};
      var target = {};
      var sourceKeys = Object.keys(source);
      var key, i;
      for (i = 0; i < sourceKeys.length; i++) {
        key = sourceKeys[i];
        if (excluded.indexOf(key) >= 0)
          continue;
        target[key] = source[key];
      }
      return target;
    }
    function _objectWithoutProperties(source, excluded) {
      if (source == null)
        return {};
      var target = _objectWithoutPropertiesLoose(source, excluded);
      var key, i;
      if (Object.getOwnPropertySymbols) {
        var sourceSymbolKeys = Object.getOwnPropertySymbols(source);
        for (i = 0; i < sourceSymbolKeys.length; i++) {
          key = sourceSymbolKeys[i];
          if (excluded.indexOf(key) >= 0)
            continue;
          if (!Object.prototype.propertyIsEnumerable.call(source, key))
            continue;
          target[key] = source[key];
        }
      }
      return target;
    }
    function _assertThisInitialized(self2) {
      if (self2 === void 0) {
        throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
      }
      return self2;
    }
    function _possibleConstructorReturn(self2, call2) {
      if (call2 && (typeof call2 === "object" || typeof call2 === "function")) {
        return call2;
      } else if (call2 !== void 0) {
        throw new TypeError("Derived constructors may only return object or undefined");
      }
      return _assertThisInitialized(self2);
    }
    function _createSuper(Derived) {
      var hasNativeReflectConstruct = _isNativeReflectConstruct();
      return function _createSuperInternal() {
        var Super = _getPrototypeOf(Derived), result;
        if (hasNativeReflectConstruct) {
          var NewTarget = _getPrototypeOf(this).constructor;
          result = Reflect.construct(Super, arguments, NewTarget);
        } else {
          result = Super.apply(this, arguments);
        }
        return _possibleConstructorReturn(this, result);
      };
    }
    function _superPropBase(object, property) {
      while (!Object.prototype.hasOwnProperty.call(object, property)) {
        object = _getPrototypeOf(object);
        if (object === null)
          break;
      }
      return object;
    }
    function _get() {
      if (typeof Reflect !== "undefined" && Reflect.get) {
        _get = Reflect.get;
      } else {
        _get = function _get2(target, property, receiver) {
          var base = _superPropBase(target, property);
          if (!base)
            return;
          var desc = Object.getOwnPropertyDescriptor(base, property);
          if (desc.get) {
            return desc.get.call(arguments.length < 3 ? target : receiver);
          }
          return desc.value;
        };
      }
      return _get.apply(this, arguments);
    }
    function set(target, property, value, receiver) {
      if (typeof Reflect !== "undefined" && Reflect.set) {
        set = Reflect.set;
      } else {
        set = function set2(target2, property2, value2, receiver2) {
          var base = _superPropBase(target2, property2);
          var desc;
          if (base) {
            desc = Object.getOwnPropertyDescriptor(base, property2);
            if (desc.set) {
              desc.set.call(receiver2, value2);
              return true;
            } else if (!desc.writable) {
              return false;
            }
          }
          desc = Object.getOwnPropertyDescriptor(receiver2, property2);
          if (desc) {
            if (!desc.writable) {
              return false;
            }
            desc.value = value2;
            Object.defineProperty(receiver2, property2, desc);
          } else {
            _defineProperty(receiver2, property2, value2);
          }
          return true;
        };
      }
      return set(target, property, value, receiver);
    }
    function _set(target, property, value, receiver, isStrict) {
      var s = set(target, property, value, receiver || target);
      if (!s && isStrict) {
        throw new Error("failed to set property");
      }
      return value;
    }
    function _slicedToArray(arr, i) {
      return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest();
    }
    function _arrayWithHoles(arr) {
      if (Array.isArray(arr))
        return arr;
    }
    function _iterableToArrayLimit(arr, i) {
      var _i = arr == null ? null : typeof Symbol !== "undefined" && arr[Symbol.iterator] || arr["@@iterator"];
      if (_i == null)
        return;
      var _arr = [];
      var _n = true;
      var _d = false;
      var _s, _e;
      try {
        for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) {
          _arr.push(_s.value);
          if (i && _arr.length === i)
            break;
        }
      } catch (err) {
        _d = true;
        _e = err;
      } finally {
        try {
          if (!_n && _i["return"] != null)
            _i["return"]();
        } finally {
          if (_d)
            throw _e;
        }
      }
      return _arr;
    }
    function _unsupportedIterableToArray(o, minLen) {
      if (!o)
        return;
      if (typeof o === "string")
        return _arrayLikeToArray(o, minLen);
      var n = Object.prototype.toString.call(o).slice(8, -1);
      if (n === "Object" && o.constructor)
        n = o.constructor.name;
      if (n === "Map" || n === "Set")
        return Array.from(o);
      if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))
        return _arrayLikeToArray(o, minLen);
    }
    function _arrayLikeToArray(arr, len) {
      if (len == null || len > arr.length)
        len = arr.length;
      for (var i = 0, arr2 = new Array(len); i < len; i++)
        arr2[i] = arr[i];
      return arr2;
    }
    function _nonIterableRest() {
      throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");
    }
    var ChangeDetails = /* @__PURE__ */ function() {
      function ChangeDetails2(details) {
        _classCallCheck(this, ChangeDetails2);
        Object.assign(this, {
          inserted: "",
          rawInserted: "",
          skip: false,
          tailShift: 0
        }, details);
      }
      _createClass(ChangeDetails2, [{
        key: "aggregate",
        value: function aggregate(details) {
          this.rawInserted += details.rawInserted;
          this.skip = this.skip || details.skip;
          this.inserted += details.inserted;
          this.tailShift += details.tailShift;
          return this;
        }
      }, {
        key: "offset",
        get: function get2() {
          return this.tailShift + this.inserted.length;
        }
      }]);
      return ChangeDetails2;
    }();
    function isString(str) {
      return typeof str === "string" || str instanceof String;
    }
    var DIRECTION = {
      NONE: "NONE",
      LEFT: "LEFT",
      FORCE_LEFT: "FORCE_LEFT",
      RIGHT: "RIGHT",
      FORCE_RIGHT: "FORCE_RIGHT"
    };
    function forceDirection(direction) {
      switch (direction) {
        case DIRECTION.LEFT:
          return DIRECTION.FORCE_LEFT;
        case DIRECTION.RIGHT:
          return DIRECTION.FORCE_RIGHT;
        default:
          return direction;
      }
    }
    function escapeRegExp(str) {
      return str.replace(/([.*+?^=!:${}()|[\]\/\\])/g, "\\$1");
    }
    function normalizePrepare(prep) {
      return Array.isArray(prep) ? prep : [prep, new ChangeDetails()];
    }
    function objectIncludes(b, a) {
      if (a === b)
        return true;
      var arrA = Array.isArray(a), arrB = Array.isArray(b), i;
      if (arrA && arrB) {
        if (a.length != b.length)
          return false;
        for (i = 0; i < a.length; i++) {
          if (!objectIncludes(a[i], b[i]))
            return false;
        }
        return true;
      }
      if (arrA != arrB)
        return false;
      if (a && b && _typeof(a) === "object" && _typeof(b) === "object") {
        var dateA = a instanceof Date, dateB = b instanceof Date;
        if (dateA && dateB)
          return a.getTime() == b.getTime();
        if (dateA != dateB)
          return false;
        var regexpA = a instanceof RegExp, regexpB = b instanceof RegExp;
        if (regexpA && regexpB)
          return a.toString() == b.toString();
        if (regexpA != regexpB)
          return false;
        var keys2 = Object.keys(a);
        for (i = 0; i < keys2.length; i++) {
          if (!Object.prototype.hasOwnProperty.call(b, keys2[i]))
            return false;
        }
        for (i = 0; i < keys2.length; i++) {
          if (!objectIncludes(b[keys2[i]], a[keys2[i]]))
            return false;
        }
        return true;
      } else if (a && b && typeof a === "function" && typeof b === "function") {
        return a.toString() === b.toString();
      }
      return false;
    }
    var ActionDetails = /* @__PURE__ */ function() {
      function ActionDetails2(value, cursorPos, oldValue, oldSelection) {
        _classCallCheck(this, ActionDetails2);
        this.value = value;
        this.cursorPos = cursorPos;
        this.oldValue = oldValue;
        this.oldSelection = oldSelection;
        while (this.value.slice(0, this.startChangePos) !== this.oldValue.slice(0, this.startChangePos)) {
          --this.oldSelection.start;
        }
      }
      _createClass(ActionDetails2, [{
        key: "startChangePos",
        get: function get2() {
          return Math.min(this.cursorPos, this.oldSelection.start);
        }
      }, {
        key: "insertedCount",
        get: function get2() {
          return this.cursorPos - this.startChangePos;
        }
      }, {
        key: "inserted",
        get: function get2() {
          return this.value.substr(this.startChangePos, this.insertedCount);
        }
      }, {
        key: "removedCount",
        get: function get2() {
          return Math.max(this.oldSelection.end - this.startChangePos || this.oldValue.length - this.value.length, 0);
        }
      }, {
        key: "removed",
        get: function get2() {
          return this.oldValue.substr(this.startChangePos, this.removedCount);
        }
      }, {
        key: "head",
        get: function get2() {
          return this.value.substring(0, this.startChangePos);
        }
      }, {
        key: "tail",
        get: function get2() {
          return this.value.substring(this.startChangePos + this.insertedCount);
        }
      }, {
        key: "removeDirection",
        get: function get2() {
          if (!this.removedCount || this.insertedCount)
            return DIRECTION.NONE;
          return (this.oldSelection.end === this.cursorPos || this.oldSelection.start === this.cursorPos) && this.oldSelection.end === this.oldSelection.start ? DIRECTION.RIGHT : DIRECTION.LEFT;
        }
      }]);
      return ActionDetails2;
    }();
    var ContinuousTailDetails = /* @__PURE__ */ function() {
      function ContinuousTailDetails2() {
        var value = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : "";
        var from = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : 0;
        var stop = arguments.length > 2 ? arguments[2] : void 0;
        _classCallCheck(this, ContinuousTailDetails2);
        this.value = value;
        this.from = from;
        this.stop = stop;
      }
      _createClass(ContinuousTailDetails2, [{
        key: "toString",
        value: function toString2() {
          return this.value;
        }
      }, {
        key: "extend",
        value: function extend(tail) {
          this.value += String(tail);
        }
      }, {
        key: "appendTo",
        value: function appendTo(masked) {
          return masked.append(this.toString(), {
            tail: true
          }).aggregate(masked._appendPlaceholder());
        }
      }, {
        key: "state",
        get: function get2() {
          return {
            value: this.value,
            from: this.from,
            stop: this.stop
          };
        },
        set: function set2(state) {
          Object.assign(this, state);
        }
      }, {
        key: "unshift",
        value: function unshift(beforePos) {
          if (!this.value.length || beforePos != null && this.from >= beforePos)
            return "";
          var shiftChar = this.value[0];
          this.value = this.value.slice(1);
          return shiftChar;
        }
      }, {
        key: "shift",
        value: function shift() {
          if (!this.value.length)
            return "";
          var shiftChar = this.value[this.value.length - 1];
          this.value = this.value.slice(0, -1);
          return shiftChar;
        }
      }]);
      return ContinuousTailDetails2;
    }();
    function IMask2(el) {
      var opts = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : {};
      return new IMask2.InputMask(el, opts);
    }
    var Masked = /* @__PURE__ */ function() {
      function Masked2(opts) {
        _classCallCheck(this, Masked2);
        this._value = "";
        this._update(Object.assign({}, Masked2.DEFAULTS, opts));
        this.isInitialized = true;
      }
      _createClass(Masked2, [{
        key: "updateOptions",
        value: function updateOptions(opts) {
          if (!Object.keys(opts).length)
            return;
          this.withValueRefresh(this._update.bind(this, opts));
        }
      }, {
        key: "_update",
        value: function _update(opts) {
          Object.assign(this, opts);
        }
      }, {
        key: "state",
        get: function get2() {
          return {
            _value: this.value
          };
        },
        set: function set2(state) {
          this._value = state._value;
        }
      }, {
        key: "reset",
        value: function reset() {
          this._value = "";
        }
      }, {
        key: "value",
        get: function get2() {
          return this._value;
        },
        set: function set2(value) {
          this.resolve(value);
        }
      }, {
        key: "resolve",
        value: function resolve(value) {
          this.reset();
          this.append(value, {
            input: true
          }, "");
          this.doCommit();
          return this.value;
        }
      }, {
        key: "unmaskedValue",
        get: function get2() {
          return this.value;
        },
        set: function set2(value) {
          this.reset();
          this.append(value, {}, "");
          this.doCommit();
        }
      }, {
        key: "typedValue",
        get: function get2() {
          return this.doParse(this.value);
        },
        set: function set2(value) {
          this.value = this.doFormat(value);
        }
      }, {
        key: "rawInputValue",
        get: function get2() {
          return this.extractInput(0, this.value.length, {
            raw: true
          });
        },
        set: function set2(value) {
          this.reset();
          this.append(value, {
            raw: true
          }, "");
          this.doCommit();
        }
      }, {
        key: "isComplete",
        get: function get2() {
          return true;
        }
      }, {
        key: "isFilled",
        get: function get2() {
          return this.isComplete;
        }
      }, {
        key: "nearestInputPos",
        value: function nearestInputPos(cursorPos, direction) {
          return cursorPos;
        }
      }, {
        key: "extractInput",
        value: function extractInput() {
          var fromPos = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : 0;
          var toPos = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : this.value.length;
          return this.value.slice(fromPos, toPos);
        }
      }, {
        key: "extractTail",
        value: function extractTail() {
          var fromPos = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : 0;
          var toPos = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : this.value.length;
          return new ContinuousTailDetails(this.extractInput(fromPos, toPos), fromPos);
        }
      }, {
        key: "appendTail",
        value: function appendTail(tail) {
          if (isString(tail))
            tail = new ContinuousTailDetails(String(tail));
          return tail.appendTo(this);
        }
      }, {
        key: "_appendCharRaw",
        value: function _appendCharRaw(ch) {
          if (!ch)
            return new ChangeDetails();
          this._value += ch;
          return new ChangeDetails({
            inserted: ch,
            rawInserted: ch
          });
        }
      }, {
        key: "_appendChar",
        value: function _appendChar(ch) {
          var flags = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : {};
          var checkTail = arguments.length > 2 ? arguments[2] : void 0;
          var consistentState = this.state;
          var details;
          var _normalizePrepare = normalizePrepare(this.doPrepare(ch, flags));
          var _normalizePrepare2 = _slicedToArray(_normalizePrepare, 2);
          ch = _normalizePrepare2[0];
          details = _normalizePrepare2[1];
          details = details.aggregate(this._appendCharRaw(ch, flags));
          if (details.inserted) {
            var consistentTail;
            var appended = this.doValidate(flags) !== false;
            if (appended && checkTail != null) {
              var beforeTailState = this.state;
              if (this.overwrite === true) {
                consistentTail = checkTail.state;
                checkTail.unshift(this.value.length);
              }
              var tailDetails = this.appendTail(checkTail);
              appended = tailDetails.rawInserted === checkTail.toString();
              if (!(appended && tailDetails.inserted) && this.overwrite === "shift") {
                this.state = beforeTailState;
                consistentTail = checkTail.state;
                checkTail.shift();
                tailDetails = this.appendTail(checkTail);
                appended = tailDetails.rawInserted === checkTail.toString();
              }
              if (appended && tailDetails.inserted)
                this.state = beforeTailState;
            }
            if (!appended) {
              details = new ChangeDetails();
              this.state = consistentState;
              if (checkTail && consistentTail)
                checkTail.state = consistentTail;
            }
          }
          return details;
        }
      }, {
        key: "_appendPlaceholder",
        value: function _appendPlaceholder() {
          return new ChangeDetails();
        }
      }, {
        key: "_appendEager",
        value: function _appendEager() {
          return new ChangeDetails();
        }
      }, {
        key: "append",
        value: function append(str, flags, tail) {
          if (!isString(str))
            throw new Error("value should be string");
          var details = new ChangeDetails();
          var checkTail = isString(tail) ? new ContinuousTailDetails(String(tail)) : tail;
          if (flags && flags.tail)
            flags._beforeTailState = this.state;
          for (var ci = 0; ci < str.length; ++ci) {
            details.aggregate(this._appendChar(str[ci], flags, checkTail));
          }
          if (checkTail != null) {
            details.tailShift += this.appendTail(checkTail).tailShift;
          }
          if (this.eager && flags !== null && flags !== void 0 && flags.input && str) {
            details.aggregate(this._appendEager());
          }
          return details;
        }
      }, {
        key: "remove",
        value: function remove() {
          var fromPos = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : 0;
          var toPos = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : this.value.length;
          this._value = this.value.slice(0, fromPos) + this.value.slice(toPos);
          return new ChangeDetails();
        }
      }, {
        key: "withValueRefresh",
        value: function withValueRefresh(fn) {
          if (this._refreshing || !this.isInitialized)
            return fn();
          this._refreshing = true;
          var rawInput = this.rawInputValue;
          var value = this.value;
          var ret = fn();
          this.rawInputValue = rawInput;
          if (this.value && this.value !== value && value.indexOf(this.value) === 0) {
            this.append(value.slice(this.value.length), {}, "");
          }
          delete this._refreshing;
          return ret;
        }
      }, {
        key: "runIsolated",
        value: function runIsolated(fn) {
          if (this._isolated || !this.isInitialized)
            return fn(this);
          this._isolated = true;
          var state = this.state;
          var ret = fn(this);
          this.state = state;
          delete this._isolated;
          return ret;
        }
      }, {
        key: "doPrepare",
        value: function doPrepare(str) {
          var flags = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : {};
          return this.prepare ? this.prepare(str, this, flags) : str;
        }
      }, {
        key: "doValidate",
        value: function doValidate(flags) {
          return (!this.validate || this.validate(this.value, this, flags)) && (!this.parent || this.parent.doValidate(flags));
        }
      }, {
        key: "doCommit",
        value: function doCommit() {
          if (this.commit)
            this.commit(this.value, this);
        }
      }, {
        key: "doFormat",
        value: function doFormat(value) {
          return this.format ? this.format(value, this) : value;
        }
      }, {
        key: "doParse",
        value: function doParse(str) {
          return this.parse ? this.parse(str, this) : str;
        }
      }, {
        key: "splice",
        value: function splice(start, deleteCount, inserted, removeDirection) {
          var tailPos = start + deleteCount;
          var tail = this.extractTail(tailPos);
          var oldRawValue;
          if (this.eager) {
            removeDirection = forceDirection(removeDirection);
            oldRawValue = this.extractInput(0, tailPos, {
              raw: true
            });
          }
          var startChangePos = this.nearestInputPos(start, deleteCount > 1 && start !== 0 && !this.eager ? DIRECTION.NONE : removeDirection);
          var details = new ChangeDetails({
            tailShift: startChangePos - start
          }).aggregate(this.remove(startChangePos));
          if (this.eager && removeDirection !== DIRECTION.NONE && oldRawValue === this.rawInputValue) {
            if (removeDirection === DIRECTION.FORCE_LEFT) {
              var valLength;
              while (oldRawValue === this.rawInputValue && (valLength = this.value.length)) {
                details.aggregate(new ChangeDetails({
                  tailShift: -1
                })).aggregate(this.remove(valLength - 1));
              }
            } else if (removeDirection === DIRECTION.FORCE_RIGHT) {
              tail.unshift();
            }
          }
          return details.aggregate(this.append(inserted, {
            input: true
          }, tail));
        }
      }, {
        key: "maskEquals",
        value: function maskEquals(mask) {
          return this.mask === mask;
        }
      }]);
      return Masked2;
    }();
    Masked.DEFAULTS = {
      format: function format2(v) {
        return v;
      },
      parse: function parse(v) {
        return v;
      }
    };
    IMask2.Masked = Masked;
    function maskedClass(mask) {
      if (mask == null) {
        throw new Error("mask property should be defined");
      }
      if (mask instanceof RegExp)
        return IMask2.MaskedRegExp;
      if (isString(mask))
        return IMask2.MaskedPattern;
      if (mask instanceof Date || mask === Date)
        return IMask2.MaskedDate;
      if (mask instanceof Number || typeof mask === "number" || mask === Number)
        return IMask2.MaskedNumber;
      if (Array.isArray(mask) || mask === Array)
        return IMask2.MaskedDynamic;
      if (IMask2.Masked && mask.prototype instanceof IMask2.Masked)
        return mask;
      if (mask instanceof IMask2.Masked)
        return mask.constructor;
      if (mask instanceof Function)
        return IMask2.MaskedFunction;
      console.warn("Mask not found for mask", mask);
      return IMask2.Masked;
    }
    function createMask(opts) {
      if (IMask2.Masked && opts instanceof IMask2.Masked)
        return opts;
      opts = Object.assign({}, opts);
      var mask = opts.mask;
      if (IMask2.Masked && mask instanceof IMask2.Masked)
        return mask;
      var MaskedClass = maskedClass(mask);
      if (!MaskedClass)
        throw new Error("Masked class is not found for provided mask, appropriate module needs to be import manually before creating mask.");
      return new MaskedClass(opts);
    }
    IMask2.createMask = createMask;
    var _excluded$4 = ["mask"];
    var DEFAULT_INPUT_DEFINITIONS = {
      "0": /\d/,
      a: /[\u0041-\u005A\u0061-\u007A\u00AA\u00B5\u00BA\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u0527\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0\u08A2-\u08AC\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0977\u0979-\u097F\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C33\u0C35-\u0C39\u0C3D\u0C58\u0C59\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D60\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F4\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191C\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19C1-\u19C7\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FCC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA697\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA78E\uA790-\uA793\uA7A0-\uA7AA\uA7F8-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA80-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uABC0-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]/,
      "*": /./
    };
    var PatternInputDefinition = /* @__PURE__ */ function() {
      function PatternInputDefinition2(opts) {
        _classCallCheck(this, PatternInputDefinition2);
        var mask = opts.mask, blockOpts = _objectWithoutProperties(opts, _excluded$4);
        this.masked = createMask({
          mask
        });
        Object.assign(this, blockOpts);
      }
      _createClass(PatternInputDefinition2, [{
        key: "reset",
        value: function reset() {
          this.isFilled = false;
          this.masked.reset();
        }
      }, {
        key: "remove",
        value: function remove() {
          var fromPos = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : 0;
          var toPos = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : this.value.length;
          if (fromPos === 0 && toPos >= 1) {
            this.isFilled = false;
            return this.masked.remove(fromPos, toPos);
          }
          return new ChangeDetails();
        }
      }, {
        key: "value",
        get: function get2() {
          return this.masked.value || (this.isFilled && !this.isOptional ? this.placeholderChar : "");
        }
      }, {
        key: "unmaskedValue",
        get: function get2() {
          return this.masked.unmaskedValue;
        }
      }, {
        key: "isComplete",
        get: function get2() {
          return Boolean(this.masked.value) || this.isOptional;
        }
      }, {
        key: "_appendChar",
        value: function _appendChar(ch) {
          var flags = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : {};
          if (this.isFilled)
            return new ChangeDetails();
          var state = this.masked.state;
          var details = this.masked._appendChar(ch, flags);
          if (details.inserted && this.doValidate(flags) === false) {
            details.inserted = details.rawInserted = "";
            this.masked.state = state;
          }
          if (!details.inserted && !this.isOptional && !this.lazy && !flags.input) {
            details.inserted = this.placeholderChar;
          }
          details.skip = !details.inserted && !this.isOptional;
          this.isFilled = Boolean(details.inserted);
          return details;
        }
      }, {
        key: "append",
        value: function append() {
          var _this$masked;
          return (_this$masked = this.masked).append.apply(_this$masked, arguments);
        }
      }, {
        key: "_appendPlaceholder",
        value: function _appendPlaceholder() {
          var details = new ChangeDetails();
          if (this.isFilled || this.isOptional)
            return details;
          this.isFilled = true;
          details.inserted = this.placeholderChar;
          return details;
        }
      }, {
        key: "_appendEager",
        value: function _appendEager() {
          return new ChangeDetails();
        }
      }, {
        key: "extractTail",
        value: function extractTail() {
          var _this$masked2;
          return (_this$masked2 = this.masked).extractTail.apply(_this$masked2, arguments);
        }
      }, {
        key: "appendTail",
        value: function appendTail() {
          var _this$masked3;
          return (_this$masked3 = this.masked).appendTail.apply(_this$masked3, arguments);
        }
      }, {
        key: "extractInput",
        value: function extractInput() {
          var fromPos = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : 0;
          var toPos = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : this.value.length;
          var flags = arguments.length > 2 ? arguments[2] : void 0;
          return this.masked.extractInput(fromPos, toPos, flags);
        }
      }, {
        key: "nearestInputPos",
        value: function nearestInputPos(cursorPos) {
          var direction = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : DIRECTION.NONE;
          var minPos = 0;
          var maxPos = this.value.length;
          var boundPos = Math.min(Math.max(cursorPos, minPos), maxPos);
          switch (direction) {
            case DIRECTION.LEFT:
            case DIRECTION.FORCE_LEFT:
              return this.isComplete ? boundPos : minPos;
            case DIRECTION.RIGHT:
            case DIRECTION.FORCE_RIGHT:
              return this.isComplete ? boundPos : maxPos;
            case DIRECTION.NONE:
            default:
              return boundPos;
          }
        }
      }, {
        key: "doValidate",
        value: function doValidate() {
          var _this$masked4, _this$parent;
          return (_this$masked4 = this.masked).doValidate.apply(_this$masked4, arguments) && (!this.parent || (_this$parent = this.parent).doValidate.apply(_this$parent, arguments));
        }
      }, {
        key: "doCommit",
        value: function doCommit() {
          this.masked.doCommit();
        }
      }, {
        key: "state",
        get: function get2() {
          return {
            masked: this.masked.state,
            isFilled: this.isFilled
          };
        },
        set: function set2(state) {
          this.masked.state = state.masked;
          this.isFilled = state.isFilled;
        }
      }]);
      return PatternInputDefinition2;
    }();
    var PatternFixedDefinition = /* @__PURE__ */ function() {
      function PatternFixedDefinition2(opts) {
        _classCallCheck(this, PatternFixedDefinition2);
        Object.assign(this, opts);
        this._value = "";
        this.isFixed = true;
      }
      _createClass(PatternFixedDefinition2, [{
        key: "value",
        get: function get2() {
          return this._value;
        }
      }, {
        key: "unmaskedValue",
        get: function get2() {
          return this.isUnmasking ? this.value : "";
        }
      }, {
        key: "reset",
        value: function reset() {
          this._isRawInput = false;
          this._value = "";
        }
      }, {
        key: "remove",
        value: function remove() {
          var fromPos = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : 0;
          var toPos = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : this._value.length;
          this._value = this._value.slice(0, fromPos) + this._value.slice(toPos);
          if (!this._value)
            this._isRawInput = false;
          return new ChangeDetails();
        }
      }, {
        key: "nearestInputPos",
        value: function nearestInputPos(cursorPos) {
          var direction = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : DIRECTION.NONE;
          var minPos = 0;
          var maxPos = this._value.length;
          switch (direction) {
            case DIRECTION.LEFT:
            case DIRECTION.FORCE_LEFT:
              return minPos;
            case DIRECTION.NONE:
            case DIRECTION.RIGHT:
            case DIRECTION.FORCE_RIGHT:
            default:
              return maxPos;
          }
        }
      }, {
        key: "extractInput",
        value: function extractInput() {
          var fromPos = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : 0;
          var toPos = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : this._value.length;
          var flags = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : {};
          return flags.raw && this._isRawInput && this._value.slice(fromPos, toPos) || "";
        }
      }, {
        key: "isComplete",
        get: function get2() {
          return true;
        }
      }, {
        key: "isFilled",
        get: function get2() {
          return Boolean(this._value);
        }
      }, {
        key: "_appendChar",
        value: function _appendChar(ch) {
          var flags = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : {};
          var details = new ChangeDetails();
          if (this._value)
            return details;
          var appended = this.char === ch;
          var isResolved = appended && (this.isUnmasking || flags.input || flags.raw) && !this.eager && !flags.tail;
          if (isResolved)
            details.rawInserted = this.char;
          this._value = details.inserted = this.char;
          this._isRawInput = isResolved && (flags.raw || flags.input);
          return details;
        }
      }, {
        key: "_appendEager",
        value: function _appendEager() {
          return this._appendChar(this.char);
        }
      }, {
        key: "_appendPlaceholder",
        value: function _appendPlaceholder() {
          var details = new ChangeDetails();
          if (this._value)
            return details;
          this._value = details.inserted = this.char;
          return details;
        }
      }, {
        key: "extractTail",
        value: function extractTail() {
          arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : this.value.length;
          return new ContinuousTailDetails("");
        }
      }, {
        key: "appendTail",
        value: function appendTail(tail) {
          if (isString(tail))
            tail = new ContinuousTailDetails(String(tail));
          return tail.appendTo(this);
        }
      }, {
        key: "append",
        value: function append(str, flags, tail) {
          var details = this._appendChar(str[0], flags);
          if (tail != null) {
            details.tailShift += this.appendTail(tail).tailShift;
          }
          return details;
        }
      }, {
        key: "doCommit",
        value: function doCommit() {
        }
      }, {
        key: "state",
        get: function get2() {
          return {
            _value: this._value,
            _isRawInput: this._isRawInput
          };
        },
        set: function set2(state) {
          Object.assign(this, state);
        }
      }]);
      return PatternFixedDefinition2;
    }();
    var _excluded$3 = ["chunks"];
    var ChunksTailDetails = /* @__PURE__ */ function() {
      function ChunksTailDetails2() {
        var chunks = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : [];
        var from = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : 0;
        _classCallCheck(this, ChunksTailDetails2);
        this.chunks = chunks;
        this.from = from;
      }
      _createClass(ChunksTailDetails2, [{
        key: "toString",
        value: function toString2() {
          return this.chunks.map(String).join("");
        }
      }, {
        key: "extend",
        value: function extend(tailChunk) {
          if (!String(tailChunk))
            return;
          if (isString(tailChunk))
            tailChunk = new ContinuousTailDetails(String(tailChunk));
          var lastChunk = this.chunks[this.chunks.length - 1];
          var extendLast = lastChunk && (lastChunk.stop === tailChunk.stop || tailChunk.stop == null) && tailChunk.from === lastChunk.from + lastChunk.toString().length;
          if (tailChunk instanceof ContinuousTailDetails) {
            if (extendLast) {
              lastChunk.extend(tailChunk.toString());
            } else {
              this.chunks.push(tailChunk);
            }
          } else if (tailChunk instanceof ChunksTailDetails2) {
            if (tailChunk.stop == null) {
              var firstTailChunk;
              while (tailChunk.chunks.length && tailChunk.chunks[0].stop == null) {
                firstTailChunk = tailChunk.chunks.shift();
                firstTailChunk.from += tailChunk.from;
                this.extend(firstTailChunk);
              }
            }
            if (tailChunk.toString()) {
              tailChunk.stop = tailChunk.blockIndex;
              this.chunks.push(tailChunk);
            }
          }
        }
      }, {
        key: "appendTo",
        value: function appendTo(masked) {
          if (!(masked instanceof IMask2.MaskedPattern)) {
            var tail = new ContinuousTailDetails(this.toString());
            return tail.appendTo(masked);
          }
          var details = new ChangeDetails();
          for (var ci = 0; ci < this.chunks.length && !details.skip; ++ci) {
            var chunk = this.chunks[ci];
            var lastBlockIter = masked._mapPosToBlock(masked.value.length);
            var stop = chunk.stop;
            var chunkBlock = void 0;
            if (stop != null && (!lastBlockIter || lastBlockIter.index <= stop)) {
              if (chunk instanceof ChunksTailDetails2 || masked._stops.indexOf(stop) >= 0) {
                details.aggregate(masked._appendPlaceholder(stop));
              }
              chunkBlock = chunk instanceof ChunksTailDetails2 && masked._blocks[stop];
            }
            if (chunkBlock) {
              var tailDetails = chunkBlock.appendTail(chunk);
              tailDetails.skip = false;
              details.aggregate(tailDetails);
              masked._value += tailDetails.inserted;
              var remainChars = chunk.toString().slice(tailDetails.rawInserted.length);
              if (remainChars)
                details.aggregate(masked.append(remainChars, {
                  tail: true
                }));
            } else {
              details.aggregate(masked.append(chunk.toString(), {
                tail: true
              }));
            }
          }
          return details;
        }
      }, {
        key: "state",
        get: function get2() {
          return {
            chunks: this.chunks.map(function(c) {
              return c.state;
            }),
            from: this.from,
            stop: this.stop,
            blockIndex: this.blockIndex
          };
        },
        set: function set2(state) {
          var chunks = state.chunks, props = _objectWithoutProperties(state, _excluded$3);
          Object.assign(this, props);
          this.chunks = chunks.map(function(cstate) {
            var chunk = "chunks" in cstate ? new ChunksTailDetails2() : new ContinuousTailDetails();
            chunk.state = cstate;
            return chunk;
          });
        }
      }, {
        key: "unshift",
        value: function unshift(beforePos) {
          if (!this.chunks.length || beforePos != null && this.from >= beforePos)
            return "";
          var chunkShiftPos = beforePos != null ? beforePos - this.from : beforePos;
          var ci = 0;
          while (ci < this.chunks.length) {
            var chunk = this.chunks[ci];
            var shiftChar = chunk.unshift(chunkShiftPos);
            if (chunk.toString()) {
              if (!shiftChar)
                break;
              ++ci;
            } else {
              this.chunks.splice(ci, 1);
            }
            if (shiftChar)
              return shiftChar;
          }
          return "";
        }
      }, {
        key: "shift",
        value: function shift() {
          if (!this.chunks.length)
            return "";
          var ci = this.chunks.length - 1;
          while (0 <= ci) {
            var chunk = this.chunks[ci];
            var shiftChar = chunk.shift();
            if (chunk.toString()) {
              if (!shiftChar)
                break;
              --ci;
            } else {
              this.chunks.splice(ci, 1);
            }
            if (shiftChar)
              return shiftChar;
          }
          return "";
        }
      }]);
      return ChunksTailDetails2;
    }();
    var PatternCursor = /* @__PURE__ */ function() {
      function PatternCursor2(masked, pos) {
        _classCallCheck(this, PatternCursor2);
        this.masked = masked;
        this._log = [];
        var _ref = masked._mapPosToBlock(pos) || (pos < 0 ? {
          index: 0,
          offset: 0
        } : {
          index: this.masked._blocks.length,
          offset: 0
        }), offset = _ref.offset, index = _ref.index;
        this.offset = offset;
        this.index = index;
        this.ok = false;
      }
      _createClass(PatternCursor2, [{
        key: "block",
        get: function get2() {
          return this.masked._blocks[this.index];
        }
      }, {
        key: "pos",
        get: function get2() {
          return this.masked._blockStartPos(this.index) + this.offset;
        }
      }, {
        key: "state",
        get: function get2() {
          return {
            index: this.index,
            offset: this.offset,
            ok: this.ok
          };
        },
        set: function set2(s) {
          Object.assign(this, s);
        }
      }, {
        key: "pushState",
        value: function pushState() {
          this._log.push(this.state);
        }
      }, {
        key: "popState",
        value: function popState() {
          var s = this._log.pop();
          this.state = s;
          return s;
        }
      }, {
        key: "bindBlock",
        value: function bindBlock() {
          if (this.block)
            return;
          if (this.index < 0) {
            this.index = 0;
            this.offset = 0;
          }
          if (this.index >= this.masked._blocks.length) {
            this.index = this.masked._blocks.length - 1;
            this.offset = this.block.value.length;
          }
        }
      }, {
        key: "_pushLeft",
        value: function _pushLeft(fn) {
          this.pushState();
          for (this.bindBlock(); 0 <= this.index; --this.index, this.offset = ((_this$block = this.block) === null || _this$block === void 0 ? void 0 : _this$block.value.length) || 0) {
            var _this$block;
            if (fn())
              return this.ok = true;
          }
          return this.ok = false;
        }
      }, {
        key: "_pushRight",
        value: function _pushRight(fn) {
          this.pushState();
          for (this.bindBlock(); this.index < this.masked._blocks.length; ++this.index, this.offset = 0) {
            if (fn())
              return this.ok = true;
          }
          return this.ok = false;
        }
      }, {
        key: "pushLeftBeforeFilled",
        value: function pushLeftBeforeFilled() {
          var _this = this;
          return this._pushLeft(function() {
            if (_this.block.isFixed || !_this.block.value)
              return;
            _this.offset = _this.block.nearestInputPos(_this.offset, DIRECTION.FORCE_LEFT);
            if (_this.offset !== 0)
              return true;
          });
        }
      }, {
        key: "pushLeftBeforeInput",
        value: function pushLeftBeforeInput() {
          var _this2 = this;
          return this._pushLeft(function() {
            if (_this2.block.isFixed)
              return;
            _this2.offset = _this2.block.nearestInputPos(_this2.offset, DIRECTION.LEFT);
            return true;
          });
        }
      }, {
        key: "pushLeftBeforeRequired",
        value: function pushLeftBeforeRequired() {
          var _this3 = this;
          return this._pushLeft(function() {
            if (_this3.block.isFixed || _this3.block.isOptional && !_this3.block.value)
              return;
            _this3.offset = _this3.block.nearestInputPos(_this3.offset, DIRECTION.LEFT);
            return true;
          });
        }
      }, {
        key: "pushRightBeforeFilled",
        value: function pushRightBeforeFilled() {
          var _this4 = this;
          return this._pushRight(function() {
            if (_this4.block.isFixed || !_this4.block.value)
              return;
            _this4.offset = _this4.block.nearestInputPos(_this4.offset, DIRECTION.FORCE_RIGHT);
            if (_this4.offset !== _this4.block.value.length)
              return true;
          });
        }
      }, {
        key: "pushRightBeforeInput",
        value: function pushRightBeforeInput() {
          var _this5 = this;
          return this._pushRight(function() {
            if (_this5.block.isFixed)
              return;
            _this5.offset = _this5.block.nearestInputPos(_this5.offset, DIRECTION.NONE);
            return true;
          });
        }
      }, {
        key: "pushRightBeforeRequired",
        value: function pushRightBeforeRequired() {
          var _this6 = this;
          return this._pushRight(function() {
            if (_this6.block.isFixed || _this6.block.isOptional && !_this6.block.value)
              return;
            _this6.offset = _this6.block.nearestInputPos(_this6.offset, DIRECTION.NONE);
            return true;
          });
        }
      }]);
      return PatternCursor2;
    }();
    var MaskedRegExp = /* @__PURE__ */ function(_Masked) {
      _inherits(MaskedRegExp2, _Masked);
      var _super = _createSuper(MaskedRegExp2);
      function MaskedRegExp2() {
        _classCallCheck(this, MaskedRegExp2);
        return _super.apply(this, arguments);
      }
      _createClass(MaskedRegExp2, [{
        key: "_update",
        value: function _update(opts) {
          if (opts.mask)
            opts.validate = function(value) {
              return value.search(opts.mask) >= 0;
            };
          _get(_getPrototypeOf(MaskedRegExp2.prototype), "_update", this).call(this, opts);
        }
      }]);
      return MaskedRegExp2;
    }(Masked);
    IMask2.MaskedRegExp = MaskedRegExp;
    var _excluded$2 = ["_blocks"];
    var MaskedPattern = /* @__PURE__ */ function(_Masked) {
      _inherits(MaskedPattern2, _Masked);
      var _super = _createSuper(MaskedPattern2);
      function MaskedPattern2() {
        var opts = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : {};
        _classCallCheck(this, MaskedPattern2);
        opts.definitions = Object.assign({}, DEFAULT_INPUT_DEFINITIONS, opts.definitions);
        return _super.call(this, Object.assign({}, MaskedPattern2.DEFAULTS, opts));
      }
      _createClass(MaskedPattern2, [{
        key: "_update",
        value: function _update() {
          var opts = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : {};
          opts.definitions = Object.assign({}, this.definitions, opts.definitions);
          _get(_getPrototypeOf(MaskedPattern2.prototype), "_update", this).call(this, opts);
          this._rebuildMask();
        }
      }, {
        key: "_rebuildMask",
        value: function _rebuildMask() {
          var _this = this;
          var defs = this.definitions;
          this._blocks = [];
          this._stops = [];
          this._maskedBlocks = {};
          var pattern = this.mask;
          if (!pattern || !defs)
            return;
          var unmaskingBlock = false;
          var optionalBlock = false;
          for (var i = 0; i < pattern.length; ++i) {
            if (this.blocks) {
              var _ret = function() {
                var p = pattern.slice(i);
                var bNames = Object.keys(_this.blocks).filter(function(bName2) {
                  return p.indexOf(bName2) === 0;
                });
                bNames.sort(function(a, b) {
                  return b.length - a.length;
                });
                var bName = bNames[0];
                if (bName) {
                  var maskedBlock = createMask(Object.assign({
                    parent: _this,
                    lazy: _this.lazy,
                    eager: _this.eager,
                    placeholderChar: _this.placeholderChar,
                    overwrite: _this.overwrite
                  }, _this.blocks[bName]));
                  if (maskedBlock) {
                    _this._blocks.push(maskedBlock);
                    if (!_this._maskedBlocks[bName])
                      _this._maskedBlocks[bName] = [];
                    _this._maskedBlocks[bName].push(_this._blocks.length - 1);
                  }
                  i += bName.length - 1;
                  return "continue";
                }
              }();
              if (_ret === "continue")
                continue;
            }
            var char = pattern[i];
            var isInput = char in defs;
            if (char === MaskedPattern2.STOP_CHAR) {
              this._stops.push(this._blocks.length);
              continue;
            }
            if (char === "{" || char === "}") {
              unmaskingBlock = !unmaskingBlock;
              continue;
            }
            if (char === "[" || char === "]") {
              optionalBlock = !optionalBlock;
              continue;
            }
            if (char === MaskedPattern2.ESCAPE_CHAR) {
              ++i;
              char = pattern[i];
              if (!char)
                break;
              isInput = false;
            }
            var def = isInput ? new PatternInputDefinition({
              parent: this,
              lazy: this.lazy,
              eager: this.eager,
              placeholderChar: this.placeholderChar,
              mask: defs[char],
              isOptional: optionalBlock
            }) : new PatternFixedDefinition({
              char,
              eager: this.eager,
              isUnmasking: unmaskingBlock
            });
            this._blocks.push(def);
          }
        }
      }, {
        key: "state",
        get: function get2() {
          return Object.assign({}, _get(_getPrototypeOf(MaskedPattern2.prototype), "state", this), {
            _blocks: this._blocks.map(function(b) {
              return b.state;
            })
          });
        },
        set: function set2(state) {
          var _blocks = state._blocks, maskedState = _objectWithoutProperties(state, _excluded$2);
          this._blocks.forEach(function(b, bi) {
            return b.state = _blocks[bi];
          });
          _set(_getPrototypeOf(MaskedPattern2.prototype), "state", maskedState, this, true);
        }
      }, {
        key: "reset",
        value: function reset() {
          _get(_getPrototypeOf(MaskedPattern2.prototype), "reset", this).call(this);
          this._blocks.forEach(function(b) {
            return b.reset();
          });
        }
      }, {
        key: "isComplete",
        get: function get2() {
          return this._blocks.every(function(b) {
            return b.isComplete;
          });
        }
      }, {
        key: "isFilled",
        get: function get2() {
          return this._blocks.every(function(b) {
            return b.isFilled;
          });
        }
      }, {
        key: "isFixed",
        get: function get2() {
          return this._blocks.every(function(b) {
            return b.isFixed;
          });
        }
      }, {
        key: "isOptional",
        get: function get2() {
          return this._blocks.every(function(b) {
            return b.isOptional;
          });
        }
      }, {
        key: "doCommit",
        value: function doCommit() {
          this._blocks.forEach(function(b) {
            return b.doCommit();
          });
          _get(_getPrototypeOf(MaskedPattern2.prototype), "doCommit", this).call(this);
        }
      }, {
        key: "unmaskedValue",
        get: function get2() {
          return this._blocks.reduce(function(str, b) {
            return str += b.unmaskedValue;
          }, "");
        },
        set: function set2(unmaskedValue) {
          _set(_getPrototypeOf(MaskedPattern2.prototype), "unmaskedValue", unmaskedValue, this, true);
        }
      }, {
        key: "value",
        get: function get2() {
          return this._blocks.reduce(function(str, b) {
            return str += b.value;
          }, "");
        },
        set: function set2(value) {
          _set(_getPrototypeOf(MaskedPattern2.prototype), "value", value, this, true);
        }
      }, {
        key: "appendTail",
        value: function appendTail(tail) {
          return _get(_getPrototypeOf(MaskedPattern2.prototype), "appendTail", this).call(this, tail).aggregate(this._appendPlaceholder());
        }
      }, {
        key: "_appendEager",
        value: function _appendEager() {
          var _this$_mapPosToBlock;
          var details = new ChangeDetails();
          var startBlockIndex = (_this$_mapPosToBlock = this._mapPosToBlock(this.value.length)) === null || _this$_mapPosToBlock === void 0 ? void 0 : _this$_mapPosToBlock.index;
          if (startBlockIndex == null)
            return details;
          if (this._blocks[startBlockIndex].isFilled)
            ++startBlockIndex;
          for (var bi = startBlockIndex; bi < this._blocks.length; ++bi) {
            var d = this._blocks[bi]._appendEager();
            if (!d.inserted)
              break;
            details.aggregate(d);
          }
          return details;
        }
      }, {
        key: "_appendCharRaw",
        value: function _appendCharRaw(ch) {
          var flags = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : {};
          var blockIter = this._mapPosToBlock(this.value.length);
          var details = new ChangeDetails();
          if (!blockIter)
            return details;
          for (var bi = blockIter.index; ; ++bi) {
            var _flags$_beforeTailSta;
            var _block = this._blocks[bi];
            if (!_block)
              break;
            var blockDetails = _block._appendChar(ch, Object.assign({}, flags, {
              _beforeTailState: (_flags$_beforeTailSta = flags._beforeTailState) === null || _flags$_beforeTailSta === void 0 ? void 0 : _flags$_beforeTailSta._blocks[bi]
            }));
            var skip = blockDetails.skip;
            details.aggregate(blockDetails);
            if (skip || blockDetails.rawInserted)
              break;
          }
          return details;
        }
      }, {
        key: "extractTail",
        value: function extractTail() {
          var _this2 = this;
          var fromPos = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : 0;
          var toPos = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : this.value.length;
          var chunkTail = new ChunksTailDetails();
          if (fromPos === toPos)
            return chunkTail;
          this._forEachBlocksInRange(fromPos, toPos, function(b, bi, bFromPos, bToPos) {
            var blockChunk = b.extractTail(bFromPos, bToPos);
            blockChunk.stop = _this2._findStopBefore(bi);
            blockChunk.from = _this2._blockStartPos(bi);
            if (blockChunk instanceof ChunksTailDetails)
              blockChunk.blockIndex = bi;
            chunkTail.extend(blockChunk);
          });
          return chunkTail;
        }
      }, {
        key: "extractInput",
        value: function extractInput() {
          var fromPos = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : 0;
          var toPos = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : this.value.length;
          var flags = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : {};
          if (fromPos === toPos)
            return "";
          var input = "";
          this._forEachBlocksInRange(fromPos, toPos, function(b, _, fromPos2, toPos2) {
            input += b.extractInput(fromPos2, toPos2, flags);
          });
          return input;
        }
      }, {
        key: "_findStopBefore",
        value: function _findStopBefore(blockIndex) {
          var stopBefore;
          for (var si = 0; si < this._stops.length; ++si) {
            var stop = this._stops[si];
            if (stop <= blockIndex)
              stopBefore = stop;
            else
              break;
          }
          return stopBefore;
        }
      }, {
        key: "_appendPlaceholder",
        value: function _appendPlaceholder(toBlockIndex) {
          var _this3 = this;
          var details = new ChangeDetails();
          if (this.lazy && toBlockIndex == null)
            return details;
          var startBlockIter = this._mapPosToBlock(this.value.length);
          if (!startBlockIter)
            return details;
          var startBlockIndex = startBlockIter.index;
          var endBlockIndex = toBlockIndex != null ? toBlockIndex : this._blocks.length;
          this._blocks.slice(startBlockIndex, endBlockIndex).forEach(function(b) {
            if (!b.lazy || toBlockIndex != null) {
              var args = b._blocks != null ? [b._blocks.length] : [];
              var bDetails = b._appendPlaceholder.apply(b, args);
              _this3._value += bDetails.inserted;
              details.aggregate(bDetails);
            }
          });
          return details;
        }
      }, {
        key: "_mapPosToBlock",
        value: function _mapPosToBlock(pos) {
          var accVal = "";
          for (var bi = 0; bi < this._blocks.length; ++bi) {
            var _block2 = this._blocks[bi];
            var blockStartPos = accVal.length;
            accVal += _block2.value;
            if (pos <= accVal.length) {
              return {
                index: bi,
                offset: pos - blockStartPos
              };
            }
          }
        }
      }, {
        key: "_blockStartPos",
        value: function _blockStartPos(blockIndex) {
          return this._blocks.slice(0, blockIndex).reduce(function(pos, b) {
            return pos += b.value.length;
          }, 0);
        }
      }, {
        key: "_forEachBlocksInRange",
        value: function _forEachBlocksInRange(fromPos) {
          var toPos = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : this.value.length;
          var fn = arguments.length > 2 ? arguments[2] : void 0;
          var fromBlockIter = this._mapPosToBlock(fromPos);
          if (fromBlockIter) {
            var toBlockIter = this._mapPosToBlock(toPos);
            var isSameBlock = toBlockIter && fromBlockIter.index === toBlockIter.index;
            var fromBlockStartPos = fromBlockIter.offset;
            var fromBlockEndPos = toBlockIter && isSameBlock ? toBlockIter.offset : this._blocks[fromBlockIter.index].value.length;
            fn(this._blocks[fromBlockIter.index], fromBlockIter.index, fromBlockStartPos, fromBlockEndPos);
            if (toBlockIter && !isSameBlock) {
              for (var bi = fromBlockIter.index + 1; bi < toBlockIter.index; ++bi) {
                fn(this._blocks[bi], bi, 0, this._blocks[bi].value.length);
              }
              fn(this._blocks[toBlockIter.index], toBlockIter.index, 0, toBlockIter.offset);
            }
          }
        }
      }, {
        key: "remove",
        value: function remove() {
          var fromPos = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : 0;
          var toPos = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : this.value.length;
          var removeDetails = _get(_getPrototypeOf(MaskedPattern2.prototype), "remove", this).call(this, fromPos, toPos);
          this._forEachBlocksInRange(fromPos, toPos, function(b, _, bFromPos, bToPos) {
            removeDetails.aggregate(b.remove(bFromPos, bToPos));
          });
          return removeDetails;
        }
      }, {
        key: "nearestInputPos",
        value: function nearestInputPos(cursorPos) {
          var direction = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : DIRECTION.NONE;
          if (!this._blocks.length)
            return 0;
          var cursor = new PatternCursor(this, cursorPos);
          if (direction === DIRECTION.NONE) {
            if (cursor.pushRightBeforeInput())
              return cursor.pos;
            cursor.popState();
            if (cursor.pushLeftBeforeInput())
              return cursor.pos;
            return this.value.length;
          }
          if (direction === DIRECTION.LEFT || direction === DIRECTION.FORCE_LEFT) {
            if (direction === DIRECTION.LEFT) {
              cursor.pushRightBeforeFilled();
              if (cursor.ok && cursor.pos === cursorPos)
                return cursorPos;
              cursor.popState();
            }
            cursor.pushLeftBeforeInput();
            cursor.pushLeftBeforeRequired();
            cursor.pushLeftBeforeFilled();
            if (direction === DIRECTION.LEFT) {
              cursor.pushRightBeforeInput();
              cursor.pushRightBeforeRequired();
              if (cursor.ok && cursor.pos <= cursorPos)
                return cursor.pos;
              cursor.popState();
              if (cursor.ok && cursor.pos <= cursorPos)
                return cursor.pos;
              cursor.popState();
            }
            if (cursor.ok)
              return cursor.pos;
            if (direction === DIRECTION.FORCE_LEFT)
              return 0;
            cursor.popState();
            if (cursor.ok)
              return cursor.pos;
            cursor.popState();
            if (cursor.ok)
              return cursor.pos;
            return 0;
          }
          if (direction === DIRECTION.RIGHT || direction === DIRECTION.FORCE_RIGHT) {
            cursor.pushRightBeforeInput();
            cursor.pushRightBeforeRequired();
            if (cursor.pushRightBeforeFilled())
              return cursor.pos;
            if (direction === DIRECTION.FORCE_RIGHT)
              return this.value.length;
            cursor.popState();
            if (cursor.ok)
              return cursor.pos;
            cursor.popState();
            if (cursor.ok)
              return cursor.pos;
            return this.nearestInputPos(cursorPos, DIRECTION.LEFT);
          }
          return cursorPos;
        }
      }, {
        key: "maskedBlock",
        value: function maskedBlock(name) {
          return this.maskedBlocks(name)[0];
        }
      }, {
        key: "maskedBlocks",
        value: function maskedBlocks(name) {
          var _this4 = this;
          var indices = this._maskedBlocks[name];
          if (!indices)
            return [];
          return indices.map(function(gi) {
            return _this4._blocks[gi];
          });
        }
      }]);
      return MaskedPattern2;
    }(Masked);
    MaskedPattern.DEFAULTS = {
      lazy: true,
      placeholderChar: "_"
    };
    MaskedPattern.STOP_CHAR = "`";
    MaskedPattern.ESCAPE_CHAR = "\\";
    MaskedPattern.InputDefinition = PatternInputDefinition;
    MaskedPattern.FixedDefinition = PatternFixedDefinition;
    IMask2.MaskedPattern = MaskedPattern;
    var MaskedRange = /* @__PURE__ */ function(_MaskedPattern) {
      _inherits(MaskedRange2, _MaskedPattern);
      var _super = _createSuper(MaskedRange2);
      function MaskedRange2() {
        _classCallCheck(this, MaskedRange2);
        return _super.apply(this, arguments);
      }
      _createClass(MaskedRange2, [{
        key: "_matchFrom",
        get: function get2() {
          return this.maxLength - String(this.from).length;
        }
      }, {
        key: "_update",
        value: function _update(opts) {
          opts = Object.assign({
            to: this.to || 0,
            from: this.from || 0,
            maxLength: this.maxLength || 0
          }, opts);
          var maxLength = String(opts.to).length;
          if (opts.maxLength != null)
            maxLength = Math.max(maxLength, opts.maxLength);
          opts.maxLength = maxLength;
          var fromStr = String(opts.from).padStart(maxLength, "0");
          var toStr = String(opts.to).padStart(maxLength, "0");
          var sameCharsCount = 0;
          while (sameCharsCount < toStr.length && toStr[sameCharsCount] === fromStr[sameCharsCount]) {
            ++sameCharsCount;
          }
          opts.mask = toStr.slice(0, sameCharsCount).replace(/0/g, "\\0") + "0".repeat(maxLength - sameCharsCount);
          _get(_getPrototypeOf(MaskedRange2.prototype), "_update", this).call(this, opts);
        }
      }, {
        key: "isComplete",
        get: function get2() {
          return _get(_getPrototypeOf(MaskedRange2.prototype), "isComplete", this) && Boolean(this.value);
        }
      }, {
        key: "boundaries",
        value: function boundaries(str) {
          var minstr = "";
          var maxstr = "";
          var _ref = str.match(/^(\D*)(\d*)(\D*)/) || [], _ref2 = _slicedToArray(_ref, 3), placeholder = _ref2[1], num = _ref2[2];
          if (num) {
            minstr = "0".repeat(placeholder.length) + num;
            maxstr = "9".repeat(placeholder.length) + num;
          }
          minstr = minstr.padEnd(this.maxLength, "0");
          maxstr = maxstr.padEnd(this.maxLength, "9");
          return [minstr, maxstr];
        }
      }, {
        key: "doPrepare",
        value: function doPrepare(ch) {
          var flags = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : {};
          var details;
          var _normalizePrepare = normalizePrepare(_get(_getPrototypeOf(MaskedRange2.prototype), "doPrepare", this).call(this, ch.replace(/\D/g, ""), flags));
          var _normalizePrepare2 = _slicedToArray(_normalizePrepare, 2);
          ch = _normalizePrepare2[0];
          details = _normalizePrepare2[1];
          if (!this.autofix || !ch)
            return ch;
          var fromStr = String(this.from).padStart(this.maxLength, "0");
          var toStr = String(this.to).padStart(this.maxLength, "0");
          var nextVal = this.value + ch;
          if (nextVal.length > this.maxLength)
            return "";
          var _this$boundaries = this.boundaries(nextVal), _this$boundaries2 = _slicedToArray(_this$boundaries, 2), minstr = _this$boundaries2[0], maxstr = _this$boundaries2[1];
          if (Number(maxstr) < this.from)
            return fromStr[nextVal.length - 1];
          if (Number(minstr) > this.to) {
            if (this.autofix === "pad" && nextVal.length < this.maxLength) {
              return ["", details.aggregate(this.append(fromStr[nextVal.length - 1] + ch, flags))];
            }
            return toStr[nextVal.length - 1];
          }
          return ch;
        }
      }, {
        key: "doValidate",
        value: function doValidate() {
          var _get2;
          var str = this.value;
          var firstNonZero = str.search(/[^0]/);
          if (firstNonZero === -1 && str.length <= this._matchFrom)
            return true;
          var _this$boundaries3 = this.boundaries(str), _this$boundaries4 = _slicedToArray(_this$boundaries3, 2), minstr = _this$boundaries4[0], maxstr = _this$boundaries4[1];
          for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
            args[_key] = arguments[_key];
          }
          return this.from <= Number(maxstr) && Number(minstr) <= this.to && (_get2 = _get(_getPrototypeOf(MaskedRange2.prototype), "doValidate", this)).call.apply(_get2, [this].concat(args));
        }
      }]);
      return MaskedRange2;
    }(MaskedPattern);
    IMask2.MaskedRange = MaskedRange;
    var MaskedDate = /* @__PURE__ */ function(_MaskedPattern) {
      _inherits(MaskedDate2, _MaskedPattern);
      var _super = _createSuper(MaskedDate2);
      function MaskedDate2(opts) {
        _classCallCheck(this, MaskedDate2);
        return _super.call(this, Object.assign({}, MaskedDate2.DEFAULTS, opts));
      }
      _createClass(MaskedDate2, [{
        key: "_update",
        value: function _update(opts) {
          if (opts.mask === Date)
            delete opts.mask;
          if (opts.pattern)
            opts.mask = opts.pattern;
          var blocks = opts.blocks;
          opts.blocks = Object.assign({}, MaskedDate2.GET_DEFAULT_BLOCKS());
          if (opts.min)
            opts.blocks.Y.from = opts.min.getFullYear();
          if (opts.max)
            opts.blocks.Y.to = opts.max.getFullYear();
          if (opts.min && opts.max && opts.blocks.Y.from === opts.blocks.Y.to) {
            opts.blocks.m.from = opts.min.getMonth() + 1;
            opts.blocks.m.to = opts.max.getMonth() + 1;
            if (opts.blocks.m.from === opts.blocks.m.to) {
              opts.blocks.d.from = opts.min.getDate();
              opts.blocks.d.to = opts.max.getDate();
            }
          }
          Object.assign(opts.blocks, this.blocks, blocks);
          Object.keys(opts.blocks).forEach(function(bk) {
            var b = opts.blocks[bk];
            if (!("autofix" in b) && "autofix" in opts)
              b.autofix = opts.autofix;
          });
          _get(_getPrototypeOf(MaskedDate2.prototype), "_update", this).call(this, opts);
        }
      }, {
        key: "doValidate",
        value: function doValidate() {
          var _get2;
          var date = this.date;
          for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
            args[_key] = arguments[_key];
          }
          return (_get2 = _get(_getPrototypeOf(MaskedDate2.prototype), "doValidate", this)).call.apply(_get2, [this].concat(args)) && (!this.isComplete || this.isDateExist(this.value) && date != null && (this.min == null || this.min <= date) && (this.max == null || date <= this.max));
        }
      }, {
        key: "isDateExist",
        value: function isDateExist(str) {
          return this.format(this.parse(str, this), this).indexOf(str) >= 0;
        }
      }, {
        key: "date",
        get: function get2() {
          return this.typedValue;
        },
        set: function set2(date) {
          this.typedValue = date;
        }
      }, {
        key: "typedValue",
        get: function get2() {
          return this.isComplete ? _get(_getPrototypeOf(MaskedDate2.prototype), "typedValue", this) : null;
        },
        set: function set2(value) {
          _set(_getPrototypeOf(MaskedDate2.prototype), "typedValue", value, this, true);
        }
      }, {
        key: "maskEquals",
        value: function maskEquals(mask) {
          return mask === Date || _get(_getPrototypeOf(MaskedDate2.prototype), "maskEquals", this).call(this, mask);
        }
      }]);
      return MaskedDate2;
    }(MaskedPattern);
    MaskedDate.DEFAULTS = {
      pattern: "d{.}`m{.}`Y",
      format: function format2(date) {
        if (!date)
          return "";
        var day = String(date.getDate()).padStart(2, "0");
        var month = String(date.getMonth() + 1).padStart(2, "0");
        var year = date.getFullYear();
        return [day, month, year].join(".");
      },
      parse: function parse(str) {
        var _str$split = str.split("."), _str$split2 = _slicedToArray(_str$split, 3), day = _str$split2[0], month = _str$split2[1], year = _str$split2[2];
        return new Date(year, month - 1, day);
      }
    };
    MaskedDate.GET_DEFAULT_BLOCKS = function() {
      return {
        d: {
          mask: MaskedRange,
          from: 1,
          to: 31,
          maxLength: 2
        },
        m: {
          mask: MaskedRange,
          from: 1,
          to: 12,
          maxLength: 2
        },
        Y: {
          mask: MaskedRange,
          from: 1900,
          to: 9999
        }
      };
    };
    IMask2.MaskedDate = MaskedDate;
    var MaskElement = /* @__PURE__ */ function() {
      function MaskElement2() {
        _classCallCheck(this, MaskElement2);
      }
      _createClass(MaskElement2, [{
        key: "selectionStart",
        get: function get2() {
          var start;
          try {
            start = this._unsafeSelectionStart;
          } catch (e) {
          }
          return start != null ? start : this.value.length;
        }
      }, {
        key: "selectionEnd",
        get: function get2() {
          var end;
          try {
            end = this._unsafeSelectionEnd;
          } catch (e) {
          }
          return end != null ? end : this.value.length;
        }
      }, {
        key: "select",
        value: function select(start, end) {
          if (start == null || end == null || start === this.selectionStart && end === this.selectionEnd)
            return;
          try {
            this._unsafeSelect(start, end);
          } catch (e) {
          }
        }
      }, {
        key: "_unsafeSelect",
        value: function _unsafeSelect(start, end) {
        }
      }, {
        key: "isActive",
        get: function get2() {
          return false;
        }
      }, {
        key: "bindEvents",
        value: function bindEvents(handlers) {
        }
      }, {
        key: "unbindEvents",
        value: function unbindEvents() {
        }
      }]);
      return MaskElement2;
    }();
    IMask2.MaskElement = MaskElement;
    var HTMLMaskElement = /* @__PURE__ */ function(_MaskElement) {
      _inherits(HTMLMaskElement2, _MaskElement);
      var _super = _createSuper(HTMLMaskElement2);
      function HTMLMaskElement2(input) {
        var _this;
        _classCallCheck(this, HTMLMaskElement2);
        _this = _super.call(this);
        _this.input = input;
        _this._handlers = {};
        return _this;
      }
      _createClass(HTMLMaskElement2, [{
        key: "rootElement",
        get: function get2() {
          var _this$input$getRootNo, _this$input$getRootNo2, _this$input;
          return (_this$input$getRootNo = (_this$input$getRootNo2 = (_this$input = this.input).getRootNode) === null || _this$input$getRootNo2 === void 0 ? void 0 : _this$input$getRootNo2.call(_this$input)) !== null && _this$input$getRootNo !== void 0 ? _this$input$getRootNo : document;
        }
      }, {
        key: "isActive",
        get: function get2() {
          return this.input === this.rootElement.activeElement;
        }
      }, {
        key: "_unsafeSelectionStart",
        get: function get2() {
          return this.input.selectionStart;
        }
      }, {
        key: "_unsafeSelectionEnd",
        get: function get2() {
          return this.input.selectionEnd;
        }
      }, {
        key: "_unsafeSelect",
        value: function _unsafeSelect(start, end) {
          this.input.setSelectionRange(start, end);
        }
      }, {
        key: "value",
        get: function get2() {
          return this.input.value;
        },
        set: function set2(value) {
          this.input.value = value;
        }
      }, {
        key: "bindEvents",
        value: function bindEvents(handlers) {
          var _this2 = this;
          Object.keys(handlers).forEach(function(event) {
            return _this2._toggleEventHandler(HTMLMaskElement2.EVENTS_MAP[event], handlers[event]);
          });
        }
      }, {
        key: "unbindEvents",
        value: function unbindEvents() {
          var _this3 = this;
          Object.keys(this._handlers).forEach(function(event) {
            return _this3._toggleEventHandler(event);
          });
        }
      }, {
        key: "_toggleEventHandler",
        value: function _toggleEventHandler(event, handler) {
          if (this._handlers[event]) {
            this.input.removeEventListener(event, this._handlers[event]);
            delete this._handlers[event];
          }
          if (handler) {
            this.input.addEventListener(event, handler);
            this._handlers[event] = handler;
          }
        }
      }]);
      return HTMLMaskElement2;
    }(MaskElement);
    HTMLMaskElement.EVENTS_MAP = {
      selectionChange: "keydown",
      input: "input",
      drop: "drop",
      click: "click",
      focus: "focus",
      commit: "blur"
    };
    IMask2.HTMLMaskElement = HTMLMaskElement;
    var HTMLContenteditableMaskElement = /* @__PURE__ */ function(_HTMLMaskElement) {
      _inherits(HTMLContenteditableMaskElement2, _HTMLMaskElement);
      var _super = _createSuper(HTMLContenteditableMaskElement2);
      function HTMLContenteditableMaskElement2() {
        _classCallCheck(this, HTMLContenteditableMaskElement2);
        return _super.apply(this, arguments);
      }
      _createClass(HTMLContenteditableMaskElement2, [{
        key: "_unsafeSelectionStart",
        get: function get2() {
          var root = this.rootElement;
          var selection = root.getSelection && root.getSelection();
          var anchorOffset = selection && selection.anchorOffset;
          var focusOffset = selection && selection.focusOffset;
          if (focusOffset == null || anchorOffset == null || anchorOffset < focusOffset) {
            return anchorOffset;
          }
          return focusOffset;
        }
      }, {
        key: "_unsafeSelectionEnd",
        get: function get2() {
          var root = this.rootElement;
          var selection = root.getSelection && root.getSelection();
          var anchorOffset = selection && selection.anchorOffset;
          var focusOffset = selection && selection.focusOffset;
          if (focusOffset == null || anchorOffset == null || anchorOffset > focusOffset) {
            return anchorOffset;
          }
          return focusOffset;
        }
      }, {
        key: "_unsafeSelect",
        value: function _unsafeSelect(start, end) {
          if (!this.rootElement.createRange)
            return;
          var range = this.rootElement.createRange();
          range.setStart(this.input.firstChild || this.input, start);
          range.setEnd(this.input.lastChild || this.input, end);
          var root = this.rootElement;
          var selection = root.getSelection && root.getSelection();
          if (selection) {
            selection.removeAllRanges();
            selection.addRange(range);
          }
        }
      }, {
        key: "value",
        get: function get2() {
          return this.input.textContent;
        },
        set: function set2(value) {
          this.input.textContent = value;
        }
      }]);
      return HTMLContenteditableMaskElement2;
    }(HTMLMaskElement);
    IMask2.HTMLContenteditableMaskElement = HTMLContenteditableMaskElement;
    var _excluded$1 = ["mask"];
    var InputMask = /* @__PURE__ */ function() {
      function InputMask2(el, opts) {
        _classCallCheck(this, InputMask2);
        this.el = el instanceof MaskElement ? el : el.isContentEditable && el.tagName !== "INPUT" && el.tagName !== "TEXTAREA" ? new HTMLContenteditableMaskElement(el) : new HTMLMaskElement(el);
        this.masked = createMask(opts);
        this._listeners = {};
        this._value = "";
        this._unmaskedValue = "";
        this._saveSelection = this._saveSelection.bind(this);
        this._onInput = this._onInput.bind(this);
        this._onChange = this._onChange.bind(this);
        this._onDrop = this._onDrop.bind(this);
        this._onFocus = this._onFocus.bind(this);
        this._onClick = this._onClick.bind(this);
        this.alignCursor = this.alignCursor.bind(this);
        this.alignCursorFriendly = this.alignCursorFriendly.bind(this);
        this._bindEvents();
        this.updateValue();
        this._onChange();
      }
      _createClass(InputMask2, [{
        key: "mask",
        get: function get2() {
          return this.masked.mask;
        },
        set: function set2(mask) {
          if (this.maskEquals(mask))
            return;
          if (!(mask instanceof IMask2.Masked) && this.masked.constructor === maskedClass(mask)) {
            this.masked.updateOptions({
              mask
            });
            return;
          }
          var masked = createMask({
            mask
          });
          masked.unmaskedValue = this.masked.unmaskedValue;
          this.masked = masked;
        }
      }, {
        key: "maskEquals",
        value: function maskEquals(mask) {
          var _this$masked;
          return mask == null || ((_this$masked = this.masked) === null || _this$masked === void 0 ? void 0 : _this$masked.maskEquals(mask));
        }
      }, {
        key: "value",
        get: function get2() {
          return this._value;
        },
        set: function set2(str) {
          this.masked.value = str;
          this.updateControl();
          this.alignCursor();
        }
      }, {
        key: "unmaskedValue",
        get: function get2() {
          return this._unmaskedValue;
        },
        set: function set2(str) {
          this.masked.unmaskedValue = str;
          this.updateControl();
          this.alignCursor();
        }
      }, {
        key: "typedValue",
        get: function get2() {
          return this.masked.typedValue;
        },
        set: function set2(val) {
          this.masked.typedValue = val;
          this.updateControl();
          this.alignCursor();
        }
      }, {
        key: "_bindEvents",
        value: function _bindEvents() {
          this.el.bindEvents({
            selectionChange: this._saveSelection,
            input: this._onInput,
            drop: this._onDrop,
            click: this._onClick,
            focus: this._onFocus,
            commit: this._onChange
          });
        }
      }, {
        key: "_unbindEvents",
        value: function _unbindEvents() {
          if (this.el)
            this.el.unbindEvents();
        }
      }, {
        key: "_fireEvent",
        value: function _fireEvent(ev) {
          for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
            args[_key - 1] = arguments[_key];
          }
          var listeners = this._listeners[ev];
          if (!listeners)
            return;
          listeners.forEach(function(l) {
            return l.apply(void 0, args);
          });
        }
      }, {
        key: "selectionStart",
        get: function get2() {
          return this._cursorChanging ? this._changingCursorPos : this.el.selectionStart;
        }
      }, {
        key: "cursorPos",
        get: function get2() {
          return this._cursorChanging ? this._changingCursorPos : this.el.selectionEnd;
        },
        set: function set2(pos) {
          if (!this.el || !this.el.isActive)
            return;
          this.el.select(pos, pos);
          this._saveSelection();
        }
      }, {
        key: "_saveSelection",
        value: function _saveSelection() {
          if (this.value !== this.el.value) {
            console.warn("Element value was changed outside of mask. Syncronize mask using `mask.updateValue()` to work properly.");
          }
          this._selection = {
            start: this.selectionStart,
            end: this.cursorPos
          };
        }
      }, {
        key: "updateValue",
        value: function updateValue() {
          this.masked.value = this.el.value;
          this._value = this.masked.value;
        }
      }, {
        key: "updateControl",
        value: function updateControl() {
          var newUnmaskedValue = this.masked.unmaskedValue;
          var newValue = this.masked.value;
          var isChanged = this.unmaskedValue !== newUnmaskedValue || this.value !== newValue;
          this._unmaskedValue = newUnmaskedValue;
          this._value = newValue;
          if (this.el.value !== newValue)
            this.el.value = newValue;
          if (isChanged)
            this._fireChangeEvents();
        }
      }, {
        key: "updateOptions",
        value: function updateOptions(opts) {
          var mask = opts.mask, restOpts = _objectWithoutProperties(opts, _excluded$1);
          var updateMask = !this.maskEquals(mask);
          var updateOpts = !objectIncludes(this.masked, restOpts);
          if (updateMask)
            this.mask = mask;
          if (updateOpts)
            this.masked.updateOptions(restOpts);
          if (updateMask || updateOpts)
            this.updateControl();
        }
      }, {
        key: "updateCursor",
        value: function updateCursor(cursorPos) {
          if (cursorPos == null)
            return;
          this.cursorPos = cursorPos;
          this._delayUpdateCursor(cursorPos);
        }
      }, {
        key: "_delayUpdateCursor",
        value: function _delayUpdateCursor(cursorPos) {
          var _this = this;
          this._abortUpdateCursor();
          this._changingCursorPos = cursorPos;
          this._cursorChanging = setTimeout(function() {
            if (!_this.el)
              return;
            _this.cursorPos = _this._changingCursorPos;
            _this._abortUpdateCursor();
          }, 10);
        }
      }, {
        key: "_fireChangeEvents",
        value: function _fireChangeEvents() {
          this._fireEvent("accept", this._inputEvent);
          if (this.masked.isComplete)
            this._fireEvent("complete", this._inputEvent);
        }
      }, {
        key: "_abortUpdateCursor",
        value: function _abortUpdateCursor() {
          if (this._cursorChanging) {
            clearTimeout(this._cursorChanging);
            delete this._cursorChanging;
          }
        }
      }, {
        key: "alignCursor",
        value: function alignCursor() {
          this.cursorPos = this.masked.nearestInputPos(this.masked.nearestInputPos(this.cursorPos, DIRECTION.LEFT));
        }
      }, {
        key: "alignCursorFriendly",
        value: function alignCursorFriendly() {
          if (this.selectionStart !== this.cursorPos)
            return;
          this.alignCursor();
        }
      }, {
        key: "on",
        value: function on(ev, handler) {
          if (!this._listeners[ev])
            this._listeners[ev] = [];
          this._listeners[ev].push(handler);
          return this;
        }
      }, {
        key: "off",
        value: function off(ev, handler) {
          if (!this._listeners[ev])
            return this;
          if (!handler) {
            delete this._listeners[ev];
            return this;
          }
          var hIndex = this._listeners[ev].indexOf(handler);
          if (hIndex >= 0)
            this._listeners[ev].splice(hIndex, 1);
          return this;
        }
      }, {
        key: "_onInput",
        value: function _onInput(e) {
          this._inputEvent = e;
          this._abortUpdateCursor();
          if (!this._selection)
            return this.updateValue();
          var details = new ActionDetails(this.el.value, this.cursorPos, this.value, this._selection);
          var oldRawValue = this.masked.rawInputValue;
          var offset = this.masked.splice(details.startChangePos, details.removed.length, details.inserted, details.removeDirection).offset;
          var removeDirection = oldRawValue === this.masked.rawInputValue ? details.removeDirection : DIRECTION.NONE;
          var cursorPos = this.masked.nearestInputPos(details.startChangePos + offset, removeDirection);
          if (removeDirection !== DIRECTION.NONE)
            cursorPos = this.masked.nearestInputPos(cursorPos, DIRECTION.NONE);
          this.updateControl();
          this.updateCursor(cursorPos);
          delete this._inputEvent;
        }
      }, {
        key: "_onChange",
        value: function _onChange() {
          if (this.value !== this.el.value) {
            this.updateValue();
          }
          this.masked.doCommit();
          this.updateControl();
          this._saveSelection();
        }
      }, {
        key: "_onDrop",
        value: function _onDrop(ev) {
          ev.preventDefault();
          ev.stopPropagation();
        }
      }, {
        key: "_onFocus",
        value: function _onFocus(ev) {
          this.alignCursorFriendly();
        }
      }, {
        key: "_onClick",
        value: function _onClick(ev) {
          this.alignCursorFriendly();
        }
      }, {
        key: "destroy",
        value: function destroy() {
          this._unbindEvents();
          this._listeners.length = 0;
          delete this.el;
        }
      }]);
      return InputMask2;
    }();
    IMask2.InputMask = InputMask;
    var MaskedEnum = /* @__PURE__ */ function(_MaskedPattern) {
      _inherits(MaskedEnum2, _MaskedPattern);
      var _super = _createSuper(MaskedEnum2);
      function MaskedEnum2() {
        _classCallCheck(this, MaskedEnum2);
        return _super.apply(this, arguments);
      }
      _createClass(MaskedEnum2, [{
        key: "_update",
        value: function _update(opts) {
          if (opts.enum)
            opts.mask = "*".repeat(opts.enum[0].length);
          _get(_getPrototypeOf(MaskedEnum2.prototype), "_update", this).call(this, opts);
        }
      }, {
        key: "doValidate",
        value: function doValidate() {
          var _this = this, _get2;
          for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
            args[_key] = arguments[_key];
          }
          return this.enum.some(function(e) {
            return e.indexOf(_this.unmaskedValue) >= 0;
          }) && (_get2 = _get(_getPrototypeOf(MaskedEnum2.prototype), "doValidate", this)).call.apply(_get2, [this].concat(args));
        }
      }]);
      return MaskedEnum2;
    }(MaskedPattern);
    IMask2.MaskedEnum = MaskedEnum;
    var MaskedNumber = /* @__PURE__ */ function(_Masked) {
      _inherits(MaskedNumber2, _Masked);
      var _super = _createSuper(MaskedNumber2);
      function MaskedNumber2(opts) {
        _classCallCheck(this, MaskedNumber2);
        return _super.call(this, Object.assign({}, MaskedNumber2.DEFAULTS, opts));
      }
      _createClass(MaskedNumber2, [{
        key: "_update",
        value: function _update(opts) {
          _get(_getPrototypeOf(MaskedNumber2.prototype), "_update", this).call(this, opts);
          this._updateRegExps();
        }
      }, {
        key: "_updateRegExps",
        value: function _updateRegExps() {
          var start = "^" + (this.allowNegative ? "[+|\\-]?" : "");
          var midInput = "(0|([1-9]+\\d*))?";
          var mid = "\\d*";
          var end = (this.scale ? "(" + escapeRegExp(this.radix) + "\\d{0," + this.scale + "})?" : "") + "$";
          this._numberRegExpInput = new RegExp(start + midInput + end);
          this._numberRegExp = new RegExp(start + mid + end);
          this._mapToRadixRegExp = new RegExp("[" + this.mapToRadix.map(escapeRegExp).join("") + "]", "g");
          this._thousandsSeparatorRegExp = new RegExp(escapeRegExp(this.thousandsSeparator), "g");
        }
      }, {
        key: "_removeThousandsSeparators",
        value: function _removeThousandsSeparators(value) {
          return value.replace(this._thousandsSeparatorRegExp, "");
        }
      }, {
        key: "_insertThousandsSeparators",
        value: function _insertThousandsSeparators(value) {
          var parts = value.split(this.radix);
          parts[0] = parts[0].replace(/\B(?=(\d{3})+(?!\d))/g, this.thousandsSeparator);
          return parts.join(this.radix);
        }
      }, {
        key: "doPrepare",
        value: function doPrepare(ch) {
          var _get2;
          ch = ch.replace(this._mapToRadixRegExp, this.radix);
          var noSepCh = this._removeThousandsSeparators(ch);
          for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
            args[_key - 1] = arguments[_key];
          }
          var _normalizePrepare = normalizePrepare((_get2 = _get(_getPrototypeOf(MaskedNumber2.prototype), "doPrepare", this)).call.apply(_get2, [this, noSepCh].concat(args))), _normalizePrepare2 = _slicedToArray(_normalizePrepare, 2), prepCh = _normalizePrepare2[0], details = _normalizePrepare2[1];
          if (ch && !noSepCh)
            details.skip = true;
          return [prepCh, details];
        }
      }, {
        key: "_separatorsCount",
        value: function _separatorsCount(to) {
          var extendOnSeparators = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : false;
          var count = 0;
          for (var pos = 0; pos < to; ++pos) {
            if (this._value.indexOf(this.thousandsSeparator, pos) === pos) {
              ++count;
              if (extendOnSeparators)
                to += this.thousandsSeparator.length;
            }
          }
          return count;
        }
      }, {
        key: "_separatorsCountFromSlice",
        value: function _separatorsCountFromSlice() {
          var slice = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : this._value;
          return this._separatorsCount(this._removeThousandsSeparators(slice).length, true);
        }
      }, {
        key: "extractInput",
        value: function extractInput() {
          var fromPos = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : 0;
          var toPos = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : this.value.length;
          var flags = arguments.length > 2 ? arguments[2] : void 0;
          var _this$_adjustRangeWit = this._adjustRangeWithSeparators(fromPos, toPos);
          var _this$_adjustRangeWit2 = _slicedToArray(_this$_adjustRangeWit, 2);
          fromPos = _this$_adjustRangeWit2[0];
          toPos = _this$_adjustRangeWit2[1];
          return this._removeThousandsSeparators(_get(_getPrototypeOf(MaskedNumber2.prototype), "extractInput", this).call(this, fromPos, toPos, flags));
        }
      }, {
        key: "_appendCharRaw",
        value: function _appendCharRaw(ch) {
          var flags = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : {};
          if (!this.thousandsSeparator)
            return _get(_getPrototypeOf(MaskedNumber2.prototype), "_appendCharRaw", this).call(this, ch, flags);
          var prevBeforeTailValue = flags.tail && flags._beforeTailState ? flags._beforeTailState._value : this._value;
          var prevBeforeTailSeparatorsCount = this._separatorsCountFromSlice(prevBeforeTailValue);
          this._value = this._removeThousandsSeparators(this.value);
          var appendDetails = _get(_getPrototypeOf(MaskedNumber2.prototype), "_appendCharRaw", this).call(this, ch, flags);
          this._value = this._insertThousandsSeparators(this._value);
          var beforeTailValue = flags.tail && flags._beforeTailState ? flags._beforeTailState._value : this._value;
          var beforeTailSeparatorsCount = this._separatorsCountFromSlice(beforeTailValue);
          appendDetails.tailShift += (beforeTailSeparatorsCount - prevBeforeTailSeparatorsCount) * this.thousandsSeparator.length;
          appendDetails.skip = !appendDetails.rawInserted && ch === this.thousandsSeparator;
          return appendDetails;
        }
      }, {
        key: "_findSeparatorAround",
        value: function _findSeparatorAround(pos) {
          if (this.thousandsSeparator) {
            var searchFrom = pos - this.thousandsSeparator.length + 1;
            var separatorPos = this.value.indexOf(this.thousandsSeparator, searchFrom);
            if (separatorPos <= pos)
              return separatorPos;
          }
          return -1;
        }
      }, {
        key: "_adjustRangeWithSeparators",
        value: function _adjustRangeWithSeparators(from, to) {
          var separatorAroundFromPos = this._findSeparatorAround(from);
          if (separatorAroundFromPos >= 0)
            from = separatorAroundFromPos;
          var separatorAroundToPos = this._findSeparatorAround(to);
          if (separatorAroundToPos >= 0)
            to = separatorAroundToPos + this.thousandsSeparator.length;
          return [from, to];
        }
      }, {
        key: "remove",
        value: function remove() {
          var fromPos = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : 0;
          var toPos = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : this.value.length;
          var _this$_adjustRangeWit3 = this._adjustRangeWithSeparators(fromPos, toPos);
          var _this$_adjustRangeWit4 = _slicedToArray(_this$_adjustRangeWit3, 2);
          fromPos = _this$_adjustRangeWit4[0];
          toPos = _this$_adjustRangeWit4[1];
          var valueBeforePos = this.value.slice(0, fromPos);
          var valueAfterPos = this.value.slice(toPos);
          var prevBeforeTailSeparatorsCount = this._separatorsCount(valueBeforePos.length);
          this._value = this._insertThousandsSeparators(this._removeThousandsSeparators(valueBeforePos + valueAfterPos));
          var beforeTailSeparatorsCount = this._separatorsCountFromSlice(valueBeforePos);
          return new ChangeDetails({
            tailShift: (beforeTailSeparatorsCount - prevBeforeTailSeparatorsCount) * this.thousandsSeparator.length
          });
        }
      }, {
        key: "nearestInputPos",
        value: function nearestInputPos(cursorPos, direction) {
          if (!this.thousandsSeparator)
            return cursorPos;
          switch (direction) {
            case DIRECTION.NONE:
            case DIRECTION.LEFT:
            case DIRECTION.FORCE_LEFT: {
              var separatorAtLeftPos = this._findSeparatorAround(cursorPos - 1);
              if (separatorAtLeftPos >= 0) {
                var separatorAtLeftEndPos = separatorAtLeftPos + this.thousandsSeparator.length;
                if (cursorPos < separatorAtLeftEndPos || this.value.length <= separatorAtLeftEndPos || direction === DIRECTION.FORCE_LEFT) {
                  return separatorAtLeftPos;
                }
              }
              break;
            }
            case DIRECTION.RIGHT:
            case DIRECTION.FORCE_RIGHT: {
              var separatorAtRightPos = this._findSeparatorAround(cursorPos);
              if (separatorAtRightPos >= 0) {
                return separatorAtRightPos + this.thousandsSeparator.length;
              }
            }
          }
          return cursorPos;
        }
      }, {
        key: "doValidate",
        value: function doValidate(flags) {
          var regexp = flags.input ? this._numberRegExpInput : this._numberRegExp;
          var valid = regexp.test(this._removeThousandsSeparators(this.value));
          if (valid) {
            var number = this.number;
            valid = valid && !isNaN(number) && (this.min == null || this.min >= 0 || this.min <= this.number) && (this.max == null || this.max <= 0 || this.number <= this.max);
          }
          return valid && _get(_getPrototypeOf(MaskedNumber2.prototype), "doValidate", this).call(this, flags);
        }
      }, {
        key: "doCommit",
        value: function doCommit() {
          if (this.value) {
            var number = this.number;
            var validnum = number;
            if (this.min != null)
              validnum = Math.max(validnum, this.min);
            if (this.max != null)
              validnum = Math.min(validnum, this.max);
            if (validnum !== number)
              this.unmaskedValue = String(validnum);
            var formatted = this.value;
            if (this.normalizeZeros)
              formatted = this._normalizeZeros(formatted);
            if (this.padFractionalZeros && this.scale > 0)
              formatted = this._padFractionalZeros(formatted);
            this._value = formatted;
          }
          _get(_getPrototypeOf(MaskedNumber2.prototype), "doCommit", this).call(this);
        }
      }, {
        key: "_normalizeZeros",
        value: function _normalizeZeros(value) {
          var parts = this._removeThousandsSeparators(value).split(this.radix);
          parts[0] = parts[0].replace(/^(\D*)(0*)(\d*)/, function(match2, sign, zeros, num) {
            return sign + num;
          });
          if (value.length && !/\d$/.test(parts[0]))
            parts[0] = parts[0] + "0";
          if (parts.length > 1) {
            parts[1] = parts[1].replace(/0*$/, "");
            if (!parts[1].length)
              parts.length = 1;
          }
          return this._insertThousandsSeparators(parts.join(this.radix));
        }
      }, {
        key: "_padFractionalZeros",
        value: function _padFractionalZeros(value) {
          if (!value)
            return value;
          var parts = value.split(this.radix);
          if (parts.length < 2)
            parts.push("");
          parts[1] = parts[1].padEnd(this.scale, "0");
          return parts.join(this.radix);
        }
      }, {
        key: "unmaskedValue",
        get: function get2() {
          return this._removeThousandsSeparators(this._normalizeZeros(this.value)).replace(this.radix, ".");
        },
        set: function set2(unmaskedValue) {
          _set(_getPrototypeOf(MaskedNumber2.prototype), "unmaskedValue", unmaskedValue.replace(".", this.radix), this, true);
        }
      }, {
        key: "typedValue",
        get: function get2() {
          return Number(this.unmaskedValue);
        },
        set: function set2(n) {
          _set(_getPrototypeOf(MaskedNumber2.prototype), "unmaskedValue", String(n), this, true);
        }
      }, {
        key: "number",
        get: function get2() {
          return this.typedValue;
        },
        set: function set2(number) {
          this.typedValue = number;
        }
      }, {
        key: "allowNegative",
        get: function get2() {
          return this.signed || this.min != null && this.min < 0 || this.max != null && this.max < 0;
        }
      }]);
      return MaskedNumber2;
    }(Masked);
    MaskedNumber.DEFAULTS = {
      radix: ",",
      thousandsSeparator: "",
      mapToRadix: ["."],
      scale: 2,
      signed: false,
      normalizeZeros: true,
      padFractionalZeros: false
    };
    IMask2.MaskedNumber = MaskedNumber;
    var MaskedFunction = /* @__PURE__ */ function(_Masked) {
      _inherits(MaskedFunction2, _Masked);
      var _super = _createSuper(MaskedFunction2);
      function MaskedFunction2() {
        _classCallCheck(this, MaskedFunction2);
        return _super.apply(this, arguments);
      }
      _createClass(MaskedFunction2, [{
        key: "_update",
        value: function _update(opts) {
          if (opts.mask)
            opts.validate = opts.mask;
          _get(_getPrototypeOf(MaskedFunction2.prototype), "_update", this).call(this, opts);
        }
      }]);
      return MaskedFunction2;
    }(Masked);
    IMask2.MaskedFunction = MaskedFunction;
    var _excluded = ["compiledMasks", "currentMaskRef", "currentMask"];
    var MaskedDynamic = /* @__PURE__ */ function(_Masked) {
      _inherits(MaskedDynamic2, _Masked);
      var _super = _createSuper(MaskedDynamic2);
      function MaskedDynamic2(opts) {
        var _this;
        _classCallCheck(this, MaskedDynamic2);
        _this = _super.call(this, Object.assign({}, MaskedDynamic2.DEFAULTS, opts));
        _this.currentMask = null;
        return _this;
      }
      _createClass(MaskedDynamic2, [{
        key: "_update",
        value: function _update(opts) {
          _get(_getPrototypeOf(MaskedDynamic2.prototype), "_update", this).call(this, opts);
          if ("mask" in opts) {
            this.compiledMasks = Array.isArray(opts.mask) ? opts.mask.map(function(m) {
              return createMask(m);
            }) : [];
          }
        }
      }, {
        key: "_appendCharRaw",
        value: function _appendCharRaw(ch) {
          var flags = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : {};
          var details = this._applyDispatch(ch, flags);
          if (this.currentMask) {
            details.aggregate(this.currentMask._appendChar(ch, flags));
          }
          return details;
        }
      }, {
        key: "_applyDispatch",
        value: function _applyDispatch() {
          var appended = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : "";
          var flags = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : {};
          var prevValueBeforeTail = flags.tail && flags._beforeTailState != null ? flags._beforeTailState._value : this.value;
          var inputValue = this.rawInputValue;
          var insertValue = flags.tail && flags._beforeTailState != null ? flags._beforeTailState._rawInputValue : inputValue;
          var tailValue = inputValue.slice(insertValue.length);
          var prevMask = this.currentMask;
          var details = new ChangeDetails();
          var prevMaskState = prevMask && prevMask.state;
          this.currentMask = this.doDispatch(appended, Object.assign({}, flags));
          if (this.currentMask) {
            if (this.currentMask !== prevMask) {
              this.currentMask.reset();
              if (insertValue) {
                var d = this.currentMask.append(insertValue, {
                  raw: true
                });
                details.tailShift = d.inserted.length - prevValueBeforeTail.length;
              }
              if (tailValue) {
                details.tailShift += this.currentMask.append(tailValue, {
                  raw: true,
                  tail: true
                }).tailShift;
              }
            } else {
              this.currentMask.state = prevMaskState;
            }
          }
          return details;
        }
      }, {
        key: "_appendPlaceholder",
        value: function _appendPlaceholder() {
          var details = this._applyDispatch.apply(this, arguments);
          if (this.currentMask) {
            details.aggregate(this.currentMask._appendPlaceholder());
          }
          return details;
        }
      }, {
        key: "_appendEager",
        value: function _appendEager() {
          var details = this._applyDispatch.apply(this, arguments);
          if (this.currentMask) {
            details.aggregate(this.currentMask._appendEager());
          }
          return details;
        }
      }, {
        key: "doDispatch",
        value: function doDispatch(appended) {
          var flags = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : {};
          return this.dispatch(appended, this, flags);
        }
      }, {
        key: "doValidate",
        value: function doValidate() {
          var _get2, _this$currentMask;
          for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
            args[_key] = arguments[_key];
          }
          return (_get2 = _get(_getPrototypeOf(MaskedDynamic2.prototype), "doValidate", this)).call.apply(_get2, [this].concat(args)) && (!this.currentMask || (_this$currentMask = this.currentMask).doValidate.apply(_this$currentMask, args));
        }
      }, {
        key: "reset",
        value: function reset() {
          var _this$currentMask2;
          (_this$currentMask2 = this.currentMask) === null || _this$currentMask2 === void 0 ? void 0 : _this$currentMask2.reset();
          this.compiledMasks.forEach(function(m) {
            return m.reset();
          });
        }
      }, {
        key: "value",
        get: function get2() {
          return this.currentMask ? this.currentMask.value : "";
        },
        set: function set2(value) {
          _set(_getPrototypeOf(MaskedDynamic2.prototype), "value", value, this, true);
        }
      }, {
        key: "unmaskedValue",
        get: function get2() {
          return this.currentMask ? this.currentMask.unmaskedValue : "";
        },
        set: function set2(unmaskedValue) {
          _set(_getPrototypeOf(MaskedDynamic2.prototype), "unmaskedValue", unmaskedValue, this, true);
        }
      }, {
        key: "typedValue",
        get: function get2() {
          return this.currentMask ? this.currentMask.typedValue : "";
        },
        set: function set2(value) {
          var unmaskedValue = String(value);
          if (this.currentMask) {
            this.currentMask.typedValue = value;
            unmaskedValue = this.currentMask.unmaskedValue;
          }
          this.unmaskedValue = unmaskedValue;
        }
      }, {
        key: "isComplete",
        get: function get2() {
          var _this$currentMask3;
          return Boolean((_this$currentMask3 = this.currentMask) === null || _this$currentMask3 === void 0 ? void 0 : _this$currentMask3.isComplete);
        }
      }, {
        key: "isFilled",
        get: function get2() {
          var _this$currentMask4;
          return Boolean((_this$currentMask4 = this.currentMask) === null || _this$currentMask4 === void 0 ? void 0 : _this$currentMask4.isFilled);
        }
      }, {
        key: "remove",
        value: function remove() {
          var details = new ChangeDetails();
          if (this.currentMask) {
            var _this$currentMask5;
            details.aggregate((_this$currentMask5 = this.currentMask).remove.apply(_this$currentMask5, arguments)).aggregate(this._applyDispatch());
          }
          return details;
        }
      }, {
        key: "state",
        get: function get2() {
          return Object.assign({}, _get(_getPrototypeOf(MaskedDynamic2.prototype), "state", this), {
            _rawInputValue: this.rawInputValue,
            compiledMasks: this.compiledMasks.map(function(m) {
              return m.state;
            }),
            currentMaskRef: this.currentMask,
            currentMask: this.currentMask && this.currentMask.state
          });
        },
        set: function set2(state) {
          var compiledMasks = state.compiledMasks, currentMaskRef = state.currentMaskRef, currentMask = state.currentMask, maskedState = _objectWithoutProperties(state, _excluded);
          this.compiledMasks.forEach(function(m, mi) {
            return m.state = compiledMasks[mi];
          });
          if (currentMaskRef != null) {
            this.currentMask = currentMaskRef;
            this.currentMask.state = currentMask;
          }
          _set(_getPrototypeOf(MaskedDynamic2.prototype), "state", maskedState, this, true);
        }
      }, {
        key: "extractInput",
        value: function extractInput() {
          var _this$currentMask6;
          return this.currentMask ? (_this$currentMask6 = this.currentMask).extractInput.apply(_this$currentMask6, arguments) : "";
        }
      }, {
        key: "extractTail",
        value: function extractTail() {
          var _this$currentMask7, _get3;
          for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
            args[_key2] = arguments[_key2];
          }
          return this.currentMask ? (_this$currentMask7 = this.currentMask).extractTail.apply(_this$currentMask7, args) : (_get3 = _get(_getPrototypeOf(MaskedDynamic2.prototype), "extractTail", this)).call.apply(_get3, [this].concat(args));
        }
      }, {
        key: "doCommit",
        value: function doCommit() {
          if (this.currentMask)
            this.currentMask.doCommit();
          _get(_getPrototypeOf(MaskedDynamic2.prototype), "doCommit", this).call(this);
        }
      }, {
        key: "nearestInputPos",
        value: function nearestInputPos() {
          var _this$currentMask8, _get4;
          for (var _len3 = arguments.length, args = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {
            args[_key3] = arguments[_key3];
          }
          return this.currentMask ? (_this$currentMask8 = this.currentMask).nearestInputPos.apply(_this$currentMask8, args) : (_get4 = _get(_getPrototypeOf(MaskedDynamic2.prototype), "nearestInputPos", this)).call.apply(_get4, [this].concat(args));
        }
      }, {
        key: "overwrite",
        get: function get2() {
          return this.currentMask ? this.currentMask.overwrite : _get(_getPrototypeOf(MaskedDynamic2.prototype), "overwrite", this);
        },
        set: function set2(overwrite) {
          console.warn('"overwrite" option is not available in dynamic mask, use this option in siblings');
        }
      }, {
        key: "eager",
        get: function get2() {
          return this.currentMask ? this.currentMask.eager : _get(_getPrototypeOf(MaskedDynamic2.prototype), "eager", this);
        },
        set: function set2(eager) {
          console.warn('"eager" option is not available in dynamic mask, use this option in siblings');
        }
      }, {
        key: "maskEquals",
        value: function maskEquals(mask) {
          return Array.isArray(mask) && this.compiledMasks.every(function(m, mi) {
            var _mask$mi;
            return m.maskEquals((_mask$mi = mask[mi]) === null || _mask$mi === void 0 ? void 0 : _mask$mi.mask);
          });
        }
      }]);
      return MaskedDynamic2;
    }(Masked);
    MaskedDynamic.DEFAULTS = {
      dispatch: function dispatch(appended, masked, flags) {
        if (!masked.compiledMasks.length)
          return;
        var inputValue = masked.rawInputValue;
        var inputs = masked.compiledMasks.map(function(m, index) {
          m.reset();
          m.append(inputValue, {
            raw: true
          });
          m.append(appended, flags);
          var weight = m.rawInputValue.length;
          return {
            weight,
            index
          };
        });
        inputs.sort(function(i1, i2) {
          return i2.weight - i1.weight;
        });
        return masked.compiledMasks[inputs[0].index];
      }
    };
    IMask2.MaskedDynamic = MaskedDynamic;
    var PIPE_TYPE = {
      MASKED: "value",
      UNMASKED: "unmaskedValue",
      TYPED: "typedValue"
    };
    function createPipe(mask) {
      var from = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : PIPE_TYPE.MASKED;
      var to = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : PIPE_TYPE.MASKED;
      var masked = createMask(mask);
      return function(value) {
        return masked.runIsolated(function(m) {
          m[from] = value;
          return m[to];
        });
      };
    }
    function pipe(value) {
      for (var _len = arguments.length, pipeArgs = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
        pipeArgs[_key - 1] = arguments[_key];
      }
      return createPipe.apply(void 0, pipeArgs)(value);
    }
    IMask2.PIPE_TYPE = PIPE_TYPE;
    IMask2.createPipe = createPipe;
    IMask2.pipe = pipe;
    try {
      globalThis.IMask = IMask2;
    } catch (e) {
    }
    exports2.HTMLContenteditableMaskElement = HTMLContenteditableMaskElement;
    exports2.HTMLMaskElement = HTMLMaskElement;
    exports2.InputMask = InputMask;
    exports2.MaskElement = MaskElement;
    exports2.Masked = Masked;
    exports2.MaskedDate = MaskedDate;
    exports2.MaskedDynamic = MaskedDynamic;
    exports2.MaskedEnum = MaskedEnum;
    exports2.MaskedFunction = MaskedFunction;
    exports2.MaskedNumber = MaskedNumber;
    exports2.MaskedPattern = MaskedPattern;
    exports2.MaskedRange = MaskedRange;
    exports2.MaskedRegExp = MaskedRegExp;
    exports2.PIPE_TYPE = PIPE_TYPE;
    exports2.createMask = createMask;
    exports2.createPipe = createPipe;
    exports2["default"] = IMask2;
    exports2.pipe = pipe;
    Object.defineProperty(exports2, "__esModule", {value: true});
  });
});

// node_modules/sortablejs/Sortable.min.js
var require_Sortable_min = __commonJS((exports, module) => {
  /*! Sortable 1.15.0 - MIT | git://github.com/SortableJS/Sortable.git */
  !function(t, e) {
    typeof exports == "object" && typeof module != "undefined" ? module.exports = e() : typeof define == "function" && define.amd ? define(e) : (t = t || self).Sortable = e();
  }(exports, function() {
    "use strict";
    function e(e2, t2) {
      var n2, o2 = Object.keys(e2);
      return Object.getOwnPropertySymbols && (n2 = Object.getOwnPropertySymbols(e2), t2 && (n2 = n2.filter(function(t3) {
        return Object.getOwnPropertyDescriptor(e2, t3).enumerable;
      })), o2.push.apply(o2, n2)), o2;
    }
    function M2(o2) {
      for (var t2 = 1; t2 < arguments.length; t2++) {
        var i2 = arguments[t2] != null ? arguments[t2] : {};
        t2 % 2 ? e(Object(i2), true).forEach(function(t3) {
          var e2, n2;
          e2 = o2, t3 = i2[n2 = t3], n2 in e2 ? Object.defineProperty(e2, n2, {value: t3, enumerable: true, configurable: true, writable: true}) : e2[n2] = t3;
        }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(o2, Object.getOwnPropertyDescriptors(i2)) : e(Object(i2)).forEach(function(t3) {
          Object.defineProperty(o2, t3, Object.getOwnPropertyDescriptor(i2, t3));
        });
      }
      return o2;
    }
    function o(t2) {
      return (o = typeof Symbol == "function" && typeof Symbol.iterator == "symbol" ? function(t3) {
        return typeof t3;
      } : function(t3) {
        return t3 && typeof Symbol == "function" && t3.constructor === Symbol && t3 !== Symbol.prototype ? "symbol" : typeof t3;
      })(t2);
    }
    function a() {
      return (a = Object.assign || function(t2) {
        for (var e2 = 1; e2 < arguments.length; e2++) {
          var n2, o2 = arguments[e2];
          for (n2 in o2)
            Object.prototype.hasOwnProperty.call(o2, n2) && (t2[n2] = o2[n2]);
        }
        return t2;
      }).apply(this, arguments);
    }
    function i(t2, e2) {
      if (t2 == null)
        return {};
      var n2, o2 = function(t3, e3) {
        if (t3 == null)
          return {};
        for (var n3, o3 = {}, i3 = Object.keys(t3), r3 = 0; r3 < i3.length; r3++)
          n3 = i3[r3], 0 <= e3.indexOf(n3) || (o3[n3] = t3[n3]);
        return o3;
      }(t2, e2);
      if (Object.getOwnPropertySymbols)
        for (var i2 = Object.getOwnPropertySymbols(t2), r2 = 0; r2 < i2.length; r2++)
          n2 = i2[r2], 0 <= e2.indexOf(n2) || Object.prototype.propertyIsEnumerable.call(t2, n2) && (o2[n2] = t2[n2]);
      return o2;
    }
    function r(t2) {
      return function(t3) {
        if (Array.isArray(t3))
          return l(t3);
      }(t2) || function(t3) {
        if (typeof Symbol != "undefined" && t3[Symbol.iterator] != null || t3["@@iterator"] != null)
          return Array.from(t3);
      }(t2) || function(t3, e2) {
        if (t3) {
          if (typeof t3 == "string")
            return l(t3, e2);
          var n2 = Object.prototype.toString.call(t3).slice(8, -1);
          return (n2 = n2 === "Object" && t3.constructor ? t3.constructor.name : n2) === "Map" || n2 === "Set" ? Array.from(t3) : n2 === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n2) ? l(t3, e2) : void 0;
        }
      }(t2) || function() {
        throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");
      }();
    }
    function l(t2, e2) {
      (e2 == null || e2 > t2.length) && (e2 = t2.length);
      for (var n2 = 0, o2 = new Array(e2); n2 < e2; n2++)
        o2[n2] = t2[n2];
      return o2;
    }
    function t(t2) {
      if (typeof window != "undefined" && window.navigator)
        return !!navigator.userAgent.match(t2);
    }
    var y = t(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i), w = t(/Edge/i), s = t(/firefox/i), u = t(/safari/i) && !t(/chrome/i) && !t(/android/i), n = t(/iP(ad|od|hone)/i), c = t(/chrome/i) && t(/android/i), d = {capture: false, passive: false};
    function h(t2, e2, n2) {
      t2.addEventListener(e2, n2, !y && d);
    }
    function f(t2, e2, n2) {
      t2.removeEventListener(e2, n2, !y && d);
    }
    function p(t2, e2) {
      if (e2 && (e2[0] === ">" && (e2 = e2.substring(1)), t2))
        try {
          if (t2.matches)
            return t2.matches(e2);
          if (t2.msMatchesSelector)
            return t2.msMatchesSelector(e2);
          if (t2.webkitMatchesSelector)
            return t2.webkitMatchesSelector(e2);
        } catch (t3) {
          return;
        }
    }
    function N(t2, e2, n2, o2) {
      if (t2) {
        n2 = n2 || document;
        do {
          if (e2 != null && (e2[0] !== ">" || t2.parentNode === n2) && p(t2, e2) || o2 && t2 === n2)
            return t2;
        } while (t2 !== n2 && (t2 = (i2 = t2).host && i2 !== document && i2.host.nodeType ? i2.host : i2.parentNode));
      }
      var i2;
      return null;
    }
    var g, m = /\s+/g;
    function I(t2, e2, n2) {
      var o2;
      t2 && e2 && (t2.classList ? t2.classList[n2 ? "add" : "remove"](e2) : (o2 = (" " + t2.className + " ").replace(m, " ").replace(" " + e2 + " ", " "), t2.className = (o2 + (n2 ? " " + e2 : "")).replace(m, " ")));
    }
    function P(t2, e2, n2) {
      var o2 = t2 && t2.style;
      if (o2) {
        if (n2 === void 0)
          return document.defaultView && document.defaultView.getComputedStyle ? n2 = document.defaultView.getComputedStyle(t2, "") : t2.currentStyle && (n2 = t2.currentStyle), e2 === void 0 ? n2 : n2[e2];
        o2[e2 = !(e2 in o2 || e2.indexOf("webkit") !== -1) ? "-webkit-" + e2 : e2] = n2 + (typeof n2 == "string" ? "" : "px");
      }
    }
    function v(t2, e2) {
      var n2 = "";
      if (typeof t2 == "string")
        n2 = t2;
      else
        do {
          var o2 = P(t2, "transform");
        } while (o2 && o2 !== "none" && (n2 = o2 + " " + n2), !e2 && (t2 = t2.parentNode));
      var i2 = window.DOMMatrix || window.WebKitCSSMatrix || window.CSSMatrix || window.MSCSSMatrix;
      return i2 && new i2(n2);
    }
    function b(t2, e2, n2) {
      if (t2) {
        var o2 = t2.getElementsByTagName(e2), i2 = 0, r2 = o2.length;
        if (n2)
          for (; i2 < r2; i2++)
            n2(o2[i2], i2);
        return o2;
      }
      return [];
    }
    function O() {
      var t2 = document.scrollingElement;
      return t2 || document.documentElement;
    }
    function k(t2, e2, n2, o2, i2) {
      if (t2.getBoundingClientRect || t2 === window) {
        var r2, a2, l2, s2, c2, u2, d2 = t2 !== window && t2.parentNode && t2 !== O() ? (a2 = (r2 = t2.getBoundingClientRect()).top, l2 = r2.left, s2 = r2.bottom, c2 = r2.right, u2 = r2.height, r2.width) : (l2 = a2 = 0, s2 = window.innerHeight, c2 = window.innerWidth, u2 = window.innerHeight, window.innerWidth);
        if ((e2 || n2) && t2 !== window && (i2 = i2 || t2.parentNode, !y))
          do {
            if (i2 && i2.getBoundingClientRect && (P(i2, "transform") !== "none" || n2 && P(i2, "position") !== "static")) {
              var h2 = i2.getBoundingClientRect();
              a2 -= h2.top + parseInt(P(i2, "border-top-width")), l2 -= h2.left + parseInt(P(i2, "border-left-width")), s2 = a2 + r2.height, c2 = l2 + r2.width;
              break;
            }
          } while (i2 = i2.parentNode);
        return o2 && t2 !== window && (o2 = (e2 = v(i2 || t2)) && e2.a, t2 = e2 && e2.d, e2 && (s2 = (a2 /= t2) + (u2 /= t2), c2 = (l2 /= o2) + (d2 /= o2))), {top: a2, left: l2, bottom: s2, right: c2, width: d2, height: u2};
      }
    }
    function R(t2, e2, n2) {
      for (var o2 = A(t2, true), i2 = k(t2)[e2]; o2; ) {
        var r2 = k(o2)[n2];
        if (!(n2 === "top" || n2 === "left" ? r2 <= i2 : i2 <= r2))
          return o2;
        if (o2 === O())
          break;
        o2 = A(o2, false);
      }
      return false;
    }
    function X(t2, e2, n2, o2) {
      for (var i2 = 0, r2 = 0, a2 = t2.children; r2 < a2.length; ) {
        if (a2[r2].style.display !== "none" && a2[r2] !== Bt.ghost && (o2 || a2[r2] !== Bt.dragged) && N(a2[r2], n2.draggable, t2, false)) {
          if (i2 === e2)
            return a2[r2];
          i2++;
        }
        r2++;
      }
      return null;
    }
    function Y2(t2, e2) {
      for (var n2 = t2.lastElementChild; n2 && (n2 === Bt.ghost || P(n2, "display") === "none" || e2 && !p(n2, e2)); )
        n2 = n2.previousElementSibling;
      return n2 || null;
    }
    function B(t2, e2) {
      var n2 = 0;
      if (!t2 || !t2.parentNode)
        return -1;
      for (; t2 = t2.previousElementSibling; )
        t2.nodeName.toUpperCase() === "TEMPLATE" || t2 === Bt.clone || e2 && !p(t2, e2) || n2++;
      return n2;
    }
    function E(t2) {
      var e2 = 0, n2 = 0, o2 = O();
      if (t2)
        do {
          var i2 = v(t2), r2 = i2.a, i2 = i2.d;
        } while (e2 += t2.scrollLeft * r2, n2 += t2.scrollTop * i2, t2 !== o2 && (t2 = t2.parentNode));
      return [e2, n2];
    }
    function A(t2, e2) {
      if (!t2 || !t2.getBoundingClientRect)
        return O();
      var n2 = t2, o2 = false;
      do {
        if (n2.clientWidth < n2.scrollWidth || n2.clientHeight < n2.scrollHeight) {
          var i2 = P(n2);
          if (n2.clientWidth < n2.scrollWidth && (i2.overflowX == "auto" || i2.overflowX == "scroll") || n2.clientHeight < n2.scrollHeight && (i2.overflowY == "auto" || i2.overflowY == "scroll")) {
            if (!n2.getBoundingClientRect || n2 === document.body)
              return O();
            if (o2 || e2)
              return n2;
            o2 = true;
          }
        }
      } while (n2 = n2.parentNode);
      return O();
    }
    function D2(t2, e2) {
      return Math.round(t2.top) === Math.round(e2.top) && Math.round(t2.left) === Math.round(e2.left) && Math.round(t2.height) === Math.round(e2.height) && Math.round(t2.width) === Math.round(e2.width);
    }
    function S2(e2, n2) {
      return function() {
        var t2;
        g || ((t2 = arguments).length === 1 ? e2.call(this, t2[0]) : e2.apply(this, t2), g = setTimeout(function() {
          g = void 0;
        }, n2));
      };
    }
    function F(t2, e2, n2) {
      t2.scrollLeft += e2, t2.scrollTop += n2;
    }
    function _(t2) {
      var e2 = window.Polymer, n2 = window.jQuery || window.Zepto;
      return e2 && e2.dom ? e2.dom(t2).cloneNode(true) : n2 ? n2(t2).clone(true)[0] : t2.cloneNode(true);
    }
    function C3(t2, e2) {
      P(t2, "position", "absolute"), P(t2, "top", e2.top), P(t2, "left", e2.left), P(t2, "width", e2.width), P(t2, "height", e2.height);
    }
    function T(t2) {
      P(t2, "position", ""), P(t2, "top", ""), P(t2, "left", ""), P(t2, "width", ""), P(t2, "height", "");
    }
    var j = "Sortable" + new Date().getTime();
    function x() {
      var e2, o2 = [];
      return {captureAnimationState: function() {
        o2 = [], this.options.animation && [].slice.call(this.el.children).forEach(function(t2) {
          var e3, n2;
          P(t2, "display") !== "none" && t2 !== Bt.ghost && (o2.push({target: t2, rect: k(t2)}), e3 = M2({}, o2[o2.length - 1].rect), !t2.thisAnimationDuration || (n2 = v(t2, true)) && (e3.top -= n2.f, e3.left -= n2.e), t2.fromRect = e3);
        });
      }, addAnimationState: function(t2) {
        o2.push(t2);
      }, removeAnimationState: function(t2) {
        o2.splice(function(t3, e3) {
          for (var n2 in t3)
            if (t3.hasOwnProperty(n2)) {
              for (var o3 in e3)
                if (e3.hasOwnProperty(o3) && e3[o3] === t3[n2][o3])
                  return Number(n2);
            }
          return -1;
        }(o2, {target: t2}), 1);
      }, animateAll: function(t2) {
        var c2 = this;
        if (!this.options.animation)
          return clearTimeout(e2), void (typeof t2 == "function" && t2());
        var u2 = false, d2 = 0;
        o2.forEach(function(t3) {
          var e3 = 0, n2 = t3.target, o3 = n2.fromRect, i2 = k(n2), r2 = n2.prevFromRect, a2 = n2.prevToRect, l2 = t3.rect, s2 = v(n2, true);
          s2 && (i2.top -= s2.f, i2.left -= s2.e), n2.toRect = i2, n2.thisAnimationDuration && D2(r2, i2) && !D2(o3, i2) && (l2.top - i2.top) / (l2.left - i2.left) == (o3.top - i2.top) / (o3.left - i2.left) && (t3 = l2, s2 = r2, r2 = a2, a2 = c2.options, e3 = Math.sqrt(Math.pow(s2.top - t3.top, 2) + Math.pow(s2.left - t3.left, 2)) / Math.sqrt(Math.pow(s2.top - r2.top, 2) + Math.pow(s2.left - r2.left, 2)) * a2.animation), D2(i2, o3) || (n2.prevFromRect = o3, n2.prevToRect = i2, e3 = e3 || c2.options.animation, c2.animate(n2, l2, i2, e3)), e3 && (u2 = true, d2 = Math.max(d2, e3), clearTimeout(n2.animationResetTimer), n2.animationResetTimer = setTimeout(function() {
            n2.animationTime = 0, n2.prevFromRect = null, n2.fromRect = null, n2.prevToRect = null, n2.thisAnimationDuration = null;
          }, e3), n2.thisAnimationDuration = e3);
        }), clearTimeout(e2), u2 ? e2 = setTimeout(function() {
          typeof t2 == "function" && t2();
        }, d2) : typeof t2 == "function" && t2(), o2 = [];
      }, animate: function(t2, e3, n2, o3) {
        var i2, r2;
        o3 && (P(t2, "transition", ""), P(t2, "transform", ""), i2 = (r2 = v(this.el)) && r2.a, r2 = r2 && r2.d, i2 = (e3.left - n2.left) / (i2 || 1), r2 = (e3.top - n2.top) / (r2 || 1), t2.animatingX = !!i2, t2.animatingY = !!r2, P(t2, "transform", "translate3d(" + i2 + "px," + r2 + "px,0)"), this.forRepaintDummy = t2.offsetWidth, P(t2, "transition", "transform " + o3 + "ms" + (this.options.easing ? " " + this.options.easing : "")), P(t2, "transform", "translate3d(0,0,0)"), typeof t2.animated == "number" && clearTimeout(t2.animated), t2.animated = setTimeout(function() {
          P(t2, "transition", ""), P(t2, "transform", ""), t2.animated = false, t2.animatingX = false, t2.animatingY = false;
        }, o3));
      }};
    }
    var H2 = [], L2 = {initializeByDefault: true}, K = {mount: function(e2) {
      for (var t2 in L2)
        !L2.hasOwnProperty(t2) || t2 in e2 || (e2[t2] = L2[t2]);
      H2.forEach(function(t3) {
        if (t3.pluginName === e2.pluginName)
          throw "Sortable: Cannot mount plugin ".concat(e2.pluginName, " more than once");
      }), H2.push(e2);
    }, pluginEvent: function(e2, n2, o2) {
      var t2 = this;
      this.eventCanceled = false, o2.cancel = function() {
        t2.eventCanceled = true;
      };
      var i2 = e2 + "Global";
      H2.forEach(function(t3) {
        n2[t3.pluginName] && (n2[t3.pluginName][i2] && n2[t3.pluginName][i2](M2({sortable: n2}, o2)), n2.options[t3.pluginName] && n2[t3.pluginName][e2] && n2[t3.pluginName][e2](M2({sortable: n2}, o2)));
      });
    }, initializePlugins: function(n2, o2, i2, t2) {
      for (var e2 in H2.forEach(function(t3) {
        var e3 = t3.pluginName;
        (n2.options[e3] || t3.initializeByDefault) && ((t3 = new t3(n2, o2, n2.options)).sortable = n2, t3.options = n2.options, n2[e3] = t3, a(i2, t3.defaults));
      }), n2.options) {
        var r2;
        n2.options.hasOwnProperty(e2) && ((r2 = this.modifyOption(n2, e2, n2.options[e2])) !== void 0 && (n2.options[e2] = r2));
      }
    }, getEventProperties: function(e2, n2) {
      var o2 = {};
      return H2.forEach(function(t2) {
        typeof t2.eventProperties == "function" && a(o2, t2.eventProperties.call(n2[t2.pluginName], e2));
      }), o2;
    }, modifyOption: function(e2, n2, o2) {
      var i2;
      return H2.forEach(function(t2) {
        e2[t2.pluginName] && t2.optionListeners && typeof t2.optionListeners[n2] == "function" && (i2 = t2.optionListeners[n2].call(e2[t2.pluginName], o2));
      }), i2;
    }};
    function W2(t2) {
      var e2 = t2.sortable, n2 = t2.rootEl, o2 = t2.name, i2 = t2.targetEl, r2 = t2.cloneEl, a2 = t2.toEl, l2 = t2.fromEl, s2 = t2.oldIndex, c2 = t2.newIndex, u2 = t2.oldDraggableIndex, d2 = t2.newDraggableIndex, h2 = t2.originalEvent, f2 = t2.putSortable, p2 = t2.extraEventProperties;
      if (e2 = e2 || n2 && n2[j]) {
        var g2, m2 = e2.options, t2 = "on" + o2.charAt(0).toUpperCase() + o2.substr(1);
        !window.CustomEvent || y || w ? (g2 = document.createEvent("Event")).initEvent(o2, true, true) : g2 = new CustomEvent(o2, {bubbles: true, cancelable: true}), g2.to = a2 || n2, g2.from = l2 || n2, g2.item = i2 || n2, g2.clone = r2, g2.oldIndex = s2, g2.newIndex = c2, g2.oldDraggableIndex = u2, g2.newDraggableIndex = d2, g2.originalEvent = h2, g2.pullMode = f2 ? f2.lastPutMode : void 0;
        var v2, b2 = M2(M2({}, p2), K.getEventProperties(o2, e2));
        for (v2 in b2)
          g2[v2] = b2[v2];
        n2 && n2.dispatchEvent(g2), m2[t2] && m2[t2].call(e2, g2);
      }
    }
    function z(t2, e2) {
      var n2 = (o2 = 2 < arguments.length && arguments[2] !== void 0 ? arguments[2] : {}).evt, o2 = i(o2, G);
      K.pluginEvent.bind(Bt)(t2, e2, M2({dragEl: q, parentEl: V, ghostEl: Z, rootEl: $, nextEl: Q2, lastDownEl: J, cloneEl: tt, cloneHidden: et, dragStarted: pt, putSortable: lt, activeSortable: Bt.active, originalEvent: n2, oldIndex: nt, oldDraggableIndex: it, newIndex: ot, newDraggableIndex: rt, hideGhostForTarget: kt, unhideGhostForTarget: Rt, cloneNowHidden: function() {
        et = true;
      }, cloneNowShown: function() {
        et = false;
      }, dispatchSortableEvent: function(t3) {
        U({sortable: e2, name: t3, originalEvent: n2});
      }}, o2));
    }
    var G = ["evt"];
    function U(t2) {
      W2(M2({putSortable: lt, cloneEl: tt, targetEl: q, rootEl: $, oldIndex: nt, oldDraggableIndex: it, newIndex: ot, newDraggableIndex: rt}, t2));
    }
    var q, V, Z, $, Q2, J, tt, et, nt, ot, it, rt, at, lt, st, ct, ut, dt, ht, ft, pt, gt, mt, vt, bt, yt = false, wt = false, Et = [], Dt = false, St = false, _t = [], Ct = false, Tt = [], xt = typeof document != "undefined", Ot = n, At = w || y ? "cssFloat" : "float", Mt = xt && !c && !n && "draggable" in document.createElement("div"), Nt = function() {
      if (xt) {
        if (y)
          return false;
        var t2 = document.createElement("x");
        return t2.style.cssText = "pointer-events:auto", t2.style.pointerEvents === "auto";
      }
    }(), It = function(t2, e2) {
      var n2 = P(t2), o2 = parseInt(n2.width) - parseInt(n2.paddingLeft) - parseInt(n2.paddingRight) - parseInt(n2.borderLeftWidth) - parseInt(n2.borderRightWidth), i2 = X(t2, 0, e2), r2 = X(t2, 1, e2), a2 = i2 && P(i2), l2 = r2 && P(r2), s2 = a2 && parseInt(a2.marginLeft) + parseInt(a2.marginRight) + k(i2).width, t2 = l2 && parseInt(l2.marginLeft) + parseInt(l2.marginRight) + k(r2).width;
      if (n2.display === "flex")
        return n2.flexDirection === "column" || n2.flexDirection === "column-reverse" ? "vertical" : "horizontal";
      if (n2.display === "grid")
        return n2.gridTemplateColumns.split(" ").length <= 1 ? "vertical" : "horizontal";
      if (i2 && a2.float && a2.float !== "none") {
        e2 = a2.float === "left" ? "left" : "right";
        return !r2 || l2.clear !== "both" && l2.clear !== e2 ? "horizontal" : "vertical";
      }
      return i2 && (a2.display === "block" || a2.display === "flex" || a2.display === "table" || a2.display === "grid" || o2 <= s2 && n2[At] === "none" || r2 && n2[At] === "none" && o2 < s2 + t2) ? "vertical" : "horizontal";
    }, Pt = function(t2) {
      function l2(r2, a2) {
        return function(t3, e3, n3, o2) {
          var i2 = t3.options.group.name && e3.options.group.name && t3.options.group.name === e3.options.group.name;
          if (r2 == null && (a2 || i2))
            return true;
          if (r2 == null || r2 === false)
            return false;
          if (a2 && r2 === "clone")
            return r2;
          if (typeof r2 == "function")
            return l2(r2(t3, e3, n3, o2), a2)(t3, e3, n3, o2);
          e3 = (a2 ? t3 : e3).options.group.name;
          return r2 === true || typeof r2 == "string" && r2 === e3 || r2.join && -1 < r2.indexOf(e3);
        };
      }
      var e2 = {}, n2 = t2.group;
      n2 && o(n2) == "object" || (n2 = {name: n2}), e2.name = n2.name, e2.checkPull = l2(n2.pull, true), e2.checkPut = l2(n2.put), e2.revertClone = n2.revertClone, t2.group = e2;
    }, kt = function() {
      !Nt && Z && P(Z, "display", "none");
    }, Rt = function() {
      !Nt && Z && P(Z, "display", "");
    };
    xt && !c && document.addEventListener("click", function(t2) {
      if (wt)
        return t2.preventDefault(), t2.stopPropagation && t2.stopPropagation(), t2.stopImmediatePropagation && t2.stopImmediatePropagation(), wt = false;
    }, true);
    function Xt(t2) {
      if (q) {
        t2 = t2.touches ? t2.touches[0] : t2;
        var e2 = (i2 = t2.clientX, r2 = t2.clientY, Et.some(function(t3) {
          var e3 = t3[j].options.emptyInsertThreshold;
          if (e3 && !Y2(t3)) {
            var n3 = k(t3), o3 = i2 >= n3.left - e3 && i2 <= n3.right + e3, e3 = r2 >= n3.top - e3 && r2 <= n3.bottom + e3;
            return o3 && e3 ? a2 = t3 : void 0;
          }
        }), a2);
        if (e2) {
          var n2, o2 = {};
          for (n2 in t2)
            t2.hasOwnProperty(n2) && (o2[n2] = t2[n2]);
          o2.target = o2.rootEl = e2, o2.preventDefault = void 0, o2.stopPropagation = void 0, e2[j]._onDragOver(o2);
        }
      }
      var i2, r2, a2;
    }
    function Yt(t2) {
      q && q.parentNode[j]._isOutsideThisEl(t2.target);
    }
    function Bt(t2, e2) {
      if (!t2 || !t2.nodeType || t2.nodeType !== 1)
        throw "Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(t2));
      this.el = t2, this.options = e2 = a({}, e2), t2[j] = this;
      var n2, o2, i2 = {group: null, sort: true, disabled: false, store: null, handle: null, draggable: /^[uo]l$/i.test(t2.nodeName) ? ">li" : ">*", swapThreshold: 1, invertSwap: false, invertedSwapThreshold: null, removeCloneOnHide: true, direction: function() {
        return It(t2, this.options);
      }, ghostClass: "sortable-ghost", chosenClass: "sortable-chosen", dragClass: "sortable-drag", ignore: "a, img", filter: null, preventOnFilter: true, animation: 0, easing: null, setData: function(t3, e3) {
        t3.setData("Text", e3.textContent);
      }, dropBubble: false, dragoverBubble: false, dataIdAttr: "data-id", delay: 0, delayOnTouchOnly: false, touchStartThreshold: (Number.parseInt ? Number : window).parseInt(window.devicePixelRatio, 10) || 1, forceFallback: false, fallbackClass: "sortable-fallback", fallbackOnBody: false, fallbackTolerance: 0, fallbackOffset: {x: 0, y: 0}, supportPointer: Bt.supportPointer !== false && "PointerEvent" in window && !u, emptyInsertThreshold: 5};
      for (n2 in K.initializePlugins(this, t2, i2), i2)
        n2 in e2 || (e2[n2] = i2[n2]);
      for (o2 in Pt(e2), this)
        o2.charAt(0) === "_" && typeof this[o2] == "function" && (this[o2] = this[o2].bind(this));
      this.nativeDraggable = !e2.forceFallback && Mt, this.nativeDraggable && (this.options.touchStartThreshold = 1), e2.supportPointer ? h(t2, "pointerdown", this._onTapStart) : (h(t2, "mousedown", this._onTapStart), h(t2, "touchstart", this._onTapStart)), this.nativeDraggable && (h(t2, "dragover", this), h(t2, "dragenter", this)), Et.push(this.el), e2.store && e2.store.get && this.sort(e2.store.get(this) || []), a(this, x());
    }
    function Ft(t2, e2, n2, o2, i2, r2, a2, l2) {
      var s2, c2, u2 = t2[j], d2 = u2.options.onMove;
      return !window.CustomEvent || y || w ? (s2 = document.createEvent("Event")).initEvent("move", true, true) : s2 = new CustomEvent("move", {bubbles: true, cancelable: true}), s2.to = e2, s2.from = t2, s2.dragged = n2, s2.draggedRect = o2, s2.related = i2 || e2, s2.relatedRect = r2 || k(e2), s2.willInsertAfter = l2, s2.originalEvent = a2, t2.dispatchEvent(s2), c2 = d2 ? d2.call(u2, s2, a2) : c2;
    }
    function jt(t2) {
      t2.draggable = false;
    }
    function Ht() {
      Ct = false;
    }
    function Lt(t2) {
      return setTimeout(t2, 0);
    }
    function Kt(t2) {
      return clearTimeout(t2);
    }
    Bt.prototype = {constructor: Bt, _isOutsideThisEl: function(t2) {
      this.el.contains(t2) || t2 === this.el || (gt = null);
    }, _getDirection: function(t2, e2) {
      return typeof this.options.direction == "function" ? this.options.direction.call(this, t2, e2, q) : this.options.direction;
    }, _onTapStart: function(e2) {
      if (e2.cancelable) {
        var n2 = this, o2 = this.el, t2 = this.options, i2 = t2.preventOnFilter, r2 = e2.type, a2 = e2.touches && e2.touches[0] || e2.pointerType && e2.pointerType === "touch" && e2, l2 = (a2 || e2).target, s2 = e2.target.shadowRoot && (e2.path && e2.path[0] || e2.composedPath && e2.composedPath()[0]) || l2, c2 = t2.filter;
        if (!function(t3) {
          Tt.length = 0;
          var e3 = t3.getElementsByTagName("input"), n3 = e3.length;
          for (; n3--; ) {
            var o3 = e3[n3];
            o3.checked && Tt.push(o3);
          }
        }(o2), !q && !(/mousedown|pointerdown/.test(r2) && e2.button !== 0 || t2.disabled) && !s2.isContentEditable && (this.nativeDraggable || !u || !l2 || l2.tagName.toUpperCase() !== "SELECT") && !((l2 = N(l2, t2.draggable, o2, false)) && l2.animated || J === l2)) {
          if (nt = B(l2), it = B(l2, t2.draggable), typeof c2 == "function") {
            if (c2.call(this, e2, l2, this))
              return U({sortable: n2, rootEl: s2, name: "filter", targetEl: l2, toEl: o2, fromEl: o2}), z("filter", n2, {evt: e2}), void (i2 && e2.cancelable && e2.preventDefault());
          } else if (c2 = c2 && c2.split(",").some(function(t3) {
            if (t3 = N(s2, t3.trim(), o2, false))
              return U({sortable: n2, rootEl: t3, name: "filter", targetEl: l2, fromEl: o2, toEl: o2}), z("filter", n2, {evt: e2}), true;
          }))
            return void (i2 && e2.cancelable && e2.preventDefault());
          t2.handle && !N(s2, t2.handle, o2, false) || this._prepareDragStart(e2, a2, l2);
        }
      }
    }, _prepareDragStart: function(t2, e2, n2) {
      var o2, i2 = this, r2 = i2.el, a2 = i2.options, l2 = r2.ownerDocument;
      n2 && !q && n2.parentNode === r2 && (o2 = k(n2), $ = r2, V = (q = n2).parentNode, Q2 = q.nextSibling, J = n2, at = a2.group, st = {target: Bt.dragged = q, clientX: (e2 || t2).clientX, clientY: (e2 || t2).clientY}, ht = st.clientX - o2.left, ft = st.clientY - o2.top, this._lastX = (e2 || t2).clientX, this._lastY = (e2 || t2).clientY, q.style["will-change"] = "all", o2 = function() {
        z("delayEnded", i2, {evt: t2}), Bt.eventCanceled ? i2._onDrop() : (i2._disableDelayedDragEvents(), !s && i2.nativeDraggable && (q.draggable = true), i2._triggerDragStart(t2, e2), U({sortable: i2, name: "choose", originalEvent: t2}), I(q, a2.chosenClass, true));
      }, a2.ignore.split(",").forEach(function(t3) {
        b(q, t3.trim(), jt);
      }), h(l2, "dragover", Xt), h(l2, "mousemove", Xt), h(l2, "touchmove", Xt), h(l2, "mouseup", i2._onDrop), h(l2, "touchend", i2._onDrop), h(l2, "touchcancel", i2._onDrop), s && this.nativeDraggable && (this.options.touchStartThreshold = 4, q.draggable = true), z("delayStart", this, {evt: t2}), !a2.delay || a2.delayOnTouchOnly && !e2 || this.nativeDraggable && (w || y) ? o2() : Bt.eventCanceled ? this._onDrop() : (h(l2, "mouseup", i2._disableDelayedDrag), h(l2, "touchend", i2._disableDelayedDrag), h(l2, "touchcancel", i2._disableDelayedDrag), h(l2, "mousemove", i2._delayedDragTouchMoveHandler), h(l2, "touchmove", i2._delayedDragTouchMoveHandler), a2.supportPointer && h(l2, "pointermove", i2._delayedDragTouchMoveHandler), i2._dragStartTimer = setTimeout(o2, a2.delay)));
    }, _delayedDragTouchMoveHandler: function(t2) {
      t2 = t2.touches ? t2.touches[0] : t2;
      Math.max(Math.abs(t2.clientX - this._lastX), Math.abs(t2.clientY - this._lastY)) >= Math.floor(this.options.touchStartThreshold / (this.nativeDraggable && window.devicePixelRatio || 1)) && this._disableDelayedDrag();
    }, _disableDelayedDrag: function() {
      q && jt(q), clearTimeout(this._dragStartTimer), this._disableDelayedDragEvents();
    }, _disableDelayedDragEvents: function() {
      var t2 = this.el.ownerDocument;
      f(t2, "mouseup", this._disableDelayedDrag), f(t2, "touchend", this._disableDelayedDrag), f(t2, "touchcancel", this._disableDelayedDrag), f(t2, "mousemove", this._delayedDragTouchMoveHandler), f(t2, "touchmove", this._delayedDragTouchMoveHandler), f(t2, "pointermove", this._delayedDragTouchMoveHandler);
    }, _triggerDragStart: function(t2, e2) {
      e2 = e2 || t2.pointerType == "touch" && t2, !this.nativeDraggable || e2 ? this.options.supportPointer ? h(document, "pointermove", this._onTouchMove) : h(document, e2 ? "touchmove" : "mousemove", this._onTouchMove) : (h(q, "dragend", this), h($, "dragstart", this._onDragStart));
      try {
        document.selection ? Lt(function() {
          document.selection.empty();
        }) : window.getSelection().removeAllRanges();
      } catch (t3) {
      }
    }, _dragStarted: function(t2, e2) {
      var n2;
      yt = false, $ && q ? (z("dragStarted", this, {evt: e2}), this.nativeDraggable && h(document, "dragover", Yt), n2 = this.options, t2 || I(q, n2.dragClass, false), I(q, n2.ghostClass, true), Bt.active = this, t2 && this._appendGhost(), U({sortable: this, name: "start", originalEvent: e2})) : this._nulling();
    }, _emulateDragOver: function() {
      if (ct) {
        this._lastX = ct.clientX, this._lastY = ct.clientY, kt();
        for (var t2 = document.elementFromPoint(ct.clientX, ct.clientY), e2 = t2; t2 && t2.shadowRoot && (t2 = t2.shadowRoot.elementFromPoint(ct.clientX, ct.clientY)) !== e2; )
          e2 = t2;
        if (q.parentNode[j]._isOutsideThisEl(t2), e2)
          do {
            if (e2[j]) {
              if (e2[j]._onDragOver({clientX: ct.clientX, clientY: ct.clientY, target: t2, rootEl: e2}) && !this.options.dragoverBubble)
                break;
            }
          } while (e2 = (t2 = e2).parentNode);
        Rt();
      }
    }, _onTouchMove: function(t2) {
      if (st) {
        var e2 = this.options, n2 = e2.fallbackTolerance, o2 = e2.fallbackOffset, i2 = t2.touches ? t2.touches[0] : t2, r2 = Z && v(Z, true), a2 = Z && r2 && r2.a, l2 = Z && r2 && r2.d, e2 = Ot && bt && E(bt), a2 = (i2.clientX - st.clientX + o2.x) / (a2 || 1) + (e2 ? e2[0] - _t[0] : 0) / (a2 || 1), l2 = (i2.clientY - st.clientY + o2.y) / (l2 || 1) + (e2 ? e2[1] - _t[1] : 0) / (l2 || 1);
        if (!Bt.active && !yt) {
          if (n2 && Math.max(Math.abs(i2.clientX - this._lastX), Math.abs(i2.clientY - this._lastY)) < n2)
            return;
          this._onDragStart(t2, true);
        }
        Z && (r2 ? (r2.e += a2 - (ut || 0), r2.f += l2 - (dt || 0)) : r2 = {a: 1, b: 0, c: 0, d: 1, e: a2, f: l2}, r2 = "matrix(".concat(r2.a, ",").concat(r2.b, ",").concat(r2.c, ",").concat(r2.d, ",").concat(r2.e, ",").concat(r2.f, ")"), P(Z, "webkitTransform", r2), P(Z, "mozTransform", r2), P(Z, "msTransform", r2), P(Z, "transform", r2), ut = a2, dt = l2, ct = i2), t2.cancelable && t2.preventDefault();
      }
    }, _appendGhost: function() {
      if (!Z) {
        var t2 = this.options.fallbackOnBody ? document.body : $, e2 = k(q, true, Ot, true, t2), n2 = this.options;
        if (Ot) {
          for (bt = t2; P(bt, "position") === "static" && P(bt, "transform") === "none" && bt !== document; )
            bt = bt.parentNode;
          bt !== document.body && bt !== document.documentElement ? (bt === document && (bt = O()), e2.top += bt.scrollTop, e2.left += bt.scrollLeft) : bt = O(), _t = E(bt);
        }
        I(Z = q.cloneNode(true), n2.ghostClass, false), I(Z, n2.fallbackClass, true), I(Z, n2.dragClass, true), P(Z, "transition", ""), P(Z, "transform", ""), P(Z, "box-sizing", "border-box"), P(Z, "margin", 0), P(Z, "top", e2.top), P(Z, "left", e2.left), P(Z, "width", e2.width), P(Z, "height", e2.height), P(Z, "opacity", "0.8"), P(Z, "position", Ot ? "absolute" : "fixed"), P(Z, "zIndex", "100000"), P(Z, "pointerEvents", "none"), Bt.ghost = Z, t2.appendChild(Z), P(Z, "transform-origin", ht / parseInt(Z.style.width) * 100 + "% " + ft / parseInt(Z.style.height) * 100 + "%");
      }
    }, _onDragStart: function(t2, e2) {
      var n2 = this, o2 = t2.dataTransfer, i2 = n2.options;
      z("dragStart", this, {evt: t2}), Bt.eventCanceled ? this._onDrop() : (z("setupClone", this), Bt.eventCanceled || ((tt = _(q)).removeAttribute("id"), tt.draggable = false, tt.style["will-change"] = "", this._hideClone(), I(tt, this.options.chosenClass, false), Bt.clone = tt), n2.cloneId = Lt(function() {
        z("clone", n2), Bt.eventCanceled || (n2.options.removeCloneOnHide || $.insertBefore(tt, q), n2._hideClone(), U({sortable: n2, name: "clone"}));
      }), e2 || I(q, i2.dragClass, true), e2 ? (wt = true, n2._loopId = setInterval(n2._emulateDragOver, 50)) : (f(document, "mouseup", n2._onDrop), f(document, "touchend", n2._onDrop), f(document, "touchcancel", n2._onDrop), o2 && (o2.effectAllowed = "move", i2.setData && i2.setData.call(n2, o2, q)), h(document, "drop", n2), P(q, "transform", "translateZ(0)")), yt = true, n2._dragStartId = Lt(n2._dragStarted.bind(n2, e2, t2)), h(document, "selectstart", n2), pt = true, u && P(document.body, "user-select", "none"));
    }, _onDragOver: function(n2) {
      var o2, i2, r2, t2, a2 = this.el, l2 = n2.target, e2 = this.options, s2 = e2.group, c2 = Bt.active, u2 = at === s2, d2 = e2.sort, h2 = lt || c2, f2 = this, p2 = false;
      if (!Ct) {
        if (n2.preventDefault !== void 0 && n2.cancelable && n2.preventDefault(), l2 = N(l2, e2.draggable, a2, true), T2("dragOver"), Bt.eventCanceled)
          return p2;
        if (q.contains(n2.target) || l2.animated && l2.animatingX && l2.animatingY || f2._ignoreWhileAnimating === l2)
          return O2(false);
        if (wt = false, c2 && !e2.disabled && (u2 ? d2 || (i2 = V !== $) : lt === this || (this.lastPutMode = at.checkPull(this, c2, q, n2)) && s2.checkPut(this, c2, q, n2))) {
          if (r2 = this._getDirection(n2, l2) === "vertical", o2 = k(q), T2("dragOverValid"), Bt.eventCanceled)
            return p2;
          if (i2)
            return V = $, x2(), this._hideClone(), T2("revert"), Bt.eventCanceled || (Q2 ? $.insertBefore(q, Q2) : $.appendChild(q)), O2(true);
          var g2 = Y2(a2, e2.draggable);
          if (!g2 || function(t3, e3, n3) {
            n3 = k(Y2(n3.el, n3.options.draggable));
            return e3 ? t3.clientX > n3.right + 10 || t3.clientX <= n3.right && t3.clientY > n3.bottom && t3.clientX >= n3.left : t3.clientX > n3.right && t3.clientY > n3.top || t3.clientX <= n3.right && t3.clientY > n3.bottom + 10;
          }(n2, r2, this) && !g2.animated) {
            if (g2 === q)
              return O2(false);
            if ((l2 = g2 && a2 === n2.target ? g2 : l2) && (w2 = k(l2)), Ft($, a2, q, o2, l2, w2, n2, !!l2) !== false)
              return x2(), g2 && g2.nextSibling ? a2.insertBefore(q, g2.nextSibling) : a2.appendChild(q), V = a2, A2(), O2(true);
          } else if (g2 && function(t3, e3, n3) {
            n3 = k(X(n3.el, 0, n3.options, true));
            return e3 ? t3.clientX < n3.left - 10 || t3.clientY < n3.top && t3.clientX < n3.right : t3.clientY < n3.top - 10 || t3.clientY < n3.bottom && t3.clientX < n3.left;
          }(n2, r2, this)) {
            var m2 = X(a2, 0, e2, true);
            if (m2 === q)
              return O2(false);
            if (w2 = k(l2 = m2), Ft($, a2, q, o2, l2, w2, n2, false) !== false)
              return x2(), a2.insertBefore(q, m2), V = a2, A2(), O2(true);
          } else if (l2.parentNode === a2) {
            var v2, b2, y2, w2 = k(l2), E2 = q.parentNode !== a2, D3 = (D3 = q.animated && q.toRect || o2, C4 = l2.animated && l2.toRect || w2, S3 = (t2 = r2) ? D3.left : D3.top, s2 = t2 ? D3.right : D3.bottom, g2 = t2 ? D3.width : D3.height, m2 = t2 ? C4.left : C4.top, D3 = t2 ? C4.right : C4.bottom, C4 = t2 ? C4.width : C4.height, !(S3 === m2 || s2 === D3 || S3 + g2 / 2 === m2 + C4 / 2)), S3 = r2 ? "top" : "left", g2 = R(l2, "top", "top") || R(q, "top", "top"), m2 = g2 ? g2.scrollTop : void 0;
            if (gt !== l2 && (b2 = w2[S3], Dt = false, St = !D3 && e2.invertSwap || E2), (v2 = function(t3, e3, n3, o3, i3, r3, a3, l3) {
              var s3 = o3 ? t3.clientY : t3.clientX, c3 = o3 ? n3.height : n3.width, t3 = o3 ? n3.top : n3.left, o3 = o3 ? n3.bottom : n3.right, n3 = false;
              if (!a3) {
                if (l3 && vt < c3 * i3) {
                  if (Dt = !Dt && (mt === 1 ? t3 + c3 * r3 / 2 < s3 : s3 < o3 - c3 * r3 / 2) ? true : Dt)
                    n3 = true;
                  else if (mt === 1 ? s3 < t3 + vt : o3 - vt < s3)
                    return -mt;
                } else if (t3 + c3 * (1 - i3) / 2 < s3 && s3 < o3 - c3 * (1 - i3) / 2)
                  return function(t4) {
                    return B(q) < B(t4) ? 1 : -1;
                  }(e3);
              }
              if ((n3 = n3 || a3) && (s3 < t3 + c3 * r3 / 2 || o3 - c3 * r3 / 2 < s3))
                return t3 + c3 / 2 < s3 ? 1 : -1;
              return 0;
            }(n2, l2, w2, r2, D3 ? 1 : e2.swapThreshold, e2.invertedSwapThreshold == null ? e2.swapThreshold : e2.invertedSwapThreshold, St, gt === l2)) !== 0)
              for (var _2 = B(q); (y2 = V.children[_2 -= v2]) && (P(y2, "display") === "none" || y2 === Z); )
                ;
            if (v2 === 0 || y2 === l2)
              return O2(false);
            mt = v2;
            var C4 = (gt = l2).nextElementSibling, E2 = false, D3 = Ft($, a2, q, o2, l2, w2, n2, E2 = v2 === 1);
            if (D3 !== false)
              return D3 !== 1 && D3 !== -1 || (E2 = D3 === 1), Ct = true, setTimeout(Ht, 30), x2(), E2 && !C4 ? a2.appendChild(q) : l2.parentNode.insertBefore(q, E2 ? C4 : l2), g2 && F(g2, 0, m2 - g2.scrollTop), V = q.parentNode, b2 === void 0 || St || (vt = Math.abs(b2 - k(l2)[S3])), A2(), O2(true);
          }
          if (a2.contains(q))
            return O2(false);
        }
        return false;
      }
      function T2(t3, e3) {
        z(t3, f2, M2({evt: n2, isOwner: u2, axis: r2 ? "vertical" : "horizontal", revert: i2, dragRect: o2, targetRect: w2, canSort: d2, fromSortable: h2, target: l2, completed: O2, onMove: function(t4, e4) {
          return Ft($, a2, q, o2, t4, k(t4), n2, e4);
        }, changed: A2}, e3));
      }
      function x2() {
        T2("dragOverAnimationCapture"), f2.captureAnimationState(), f2 !== h2 && h2.captureAnimationState();
      }
      function O2(t3) {
        return T2("dragOverCompleted", {insertion: t3}), t3 && (u2 ? c2._hideClone() : c2._showClone(f2), f2 !== h2 && (I(q, (lt || c2).options.ghostClass, false), I(q, e2.ghostClass, true)), lt !== f2 && f2 !== Bt.active ? lt = f2 : f2 === Bt.active && lt && (lt = null), h2 === f2 && (f2._ignoreWhileAnimating = l2), f2.animateAll(function() {
          T2("dragOverAnimationComplete"), f2._ignoreWhileAnimating = null;
        }), f2 !== h2 && (h2.animateAll(), h2._ignoreWhileAnimating = null)), (l2 === q && !q.animated || l2 === a2 && !l2.animated) && (gt = null), e2.dragoverBubble || n2.rootEl || l2 === document || (q.parentNode[j]._isOutsideThisEl(n2.target), t3 || Xt(n2)), !e2.dragoverBubble && n2.stopPropagation && n2.stopPropagation(), p2 = true;
      }
      function A2() {
        ot = B(q), rt = B(q, e2.draggable), U({sortable: f2, name: "change", toEl: a2, newIndex: ot, newDraggableIndex: rt, originalEvent: n2});
      }
    }, _ignoreWhileAnimating: null, _offMoveEvents: function() {
      f(document, "mousemove", this._onTouchMove), f(document, "touchmove", this._onTouchMove), f(document, "pointermove", this._onTouchMove), f(document, "dragover", Xt), f(document, "mousemove", Xt), f(document, "touchmove", Xt);
    }, _offUpEvents: function() {
      var t2 = this.el.ownerDocument;
      f(t2, "mouseup", this._onDrop), f(t2, "touchend", this._onDrop), f(t2, "pointerup", this._onDrop), f(t2, "touchcancel", this._onDrop), f(document, "selectstart", this);
    }, _onDrop: function(t2) {
      var e2 = this.el, n2 = this.options;
      ot = B(q), rt = B(q, n2.draggable), z("drop", this, {evt: t2}), V = q && q.parentNode, ot = B(q), rt = B(q, n2.draggable), Bt.eventCanceled || (Dt = St = yt = false, clearInterval(this._loopId), clearTimeout(this._dragStartTimer), Kt(this.cloneId), Kt(this._dragStartId), this.nativeDraggable && (f(document, "drop", this), f(e2, "dragstart", this._onDragStart)), this._offMoveEvents(), this._offUpEvents(), u && P(document.body, "user-select", ""), P(q, "transform", ""), t2 && (pt && (t2.cancelable && t2.preventDefault(), n2.dropBubble || t2.stopPropagation()), Z && Z.parentNode && Z.parentNode.removeChild(Z), ($ === V || lt && lt.lastPutMode !== "clone") && tt && tt.parentNode && tt.parentNode.removeChild(tt), q && (this.nativeDraggable && f(q, "dragend", this), jt(q), q.style["will-change"] = "", pt && !yt && I(q, (lt || this).options.ghostClass, false), I(q, this.options.chosenClass, false), U({sortable: this, name: "unchoose", toEl: V, newIndex: null, newDraggableIndex: null, originalEvent: t2}), $ !== V ? (0 <= ot && (U({rootEl: V, name: "add", toEl: V, fromEl: $, originalEvent: t2}), U({sortable: this, name: "remove", toEl: V, originalEvent: t2}), U({rootEl: V, name: "sort", toEl: V, fromEl: $, originalEvent: t2}), U({sortable: this, name: "sort", toEl: V, originalEvent: t2})), lt && lt.save()) : ot !== nt && 0 <= ot && (U({sortable: this, name: "update", toEl: V, originalEvent: t2}), U({sortable: this, name: "sort", toEl: V, originalEvent: t2})), Bt.active && (ot != null && ot !== -1 || (ot = nt, rt = it), U({sortable: this, name: "end", toEl: V, originalEvent: t2}), this.save())))), this._nulling();
    }, _nulling: function() {
      z("nulling", this), $ = q = V = Z = Q2 = tt = J = et = st = ct = pt = ot = rt = nt = it = gt = mt = lt = at = Bt.dragged = Bt.ghost = Bt.clone = Bt.active = null, Tt.forEach(function(t2) {
        t2.checked = true;
      }), Tt.length = ut = dt = 0;
    }, handleEvent: function(t2) {
      switch (t2.type) {
        case "drop":
        case "dragend":
          this._onDrop(t2);
          break;
        case "dragenter":
        case "dragover":
          q && (this._onDragOver(t2), function(t3) {
            t3.dataTransfer && (t3.dataTransfer.dropEffect = "move");
            t3.cancelable && t3.preventDefault();
          }(t2));
          break;
        case "selectstart":
          t2.preventDefault();
      }
    }, toArray: function() {
      for (var t2, e2 = [], n2 = this.el.children, o2 = 0, i2 = n2.length, r2 = this.options; o2 < i2; o2++)
        N(t2 = n2[o2], r2.draggable, this.el, false) && e2.push(t2.getAttribute(r2.dataIdAttr) || function(t3) {
          var e3 = t3.tagName + t3.className + t3.src + t3.href + t3.textContent, n3 = e3.length, o3 = 0;
          for (; n3--; )
            o3 += e3.charCodeAt(n3);
          return o3.toString(36);
        }(t2));
      return e2;
    }, sort: function(t2, e2) {
      var n2 = {}, o2 = this.el;
      this.toArray().forEach(function(t3, e3) {
        e3 = o2.children[e3];
        N(e3, this.options.draggable, o2, false) && (n2[t3] = e3);
      }, this), e2 && this.captureAnimationState(), t2.forEach(function(t3) {
        n2[t3] && (o2.removeChild(n2[t3]), o2.appendChild(n2[t3]));
      }), e2 && this.animateAll();
    }, save: function() {
      var t2 = this.options.store;
      t2 && t2.set && t2.set(this);
    }, closest: function(t2, e2) {
      return N(t2, e2 || this.options.draggable, this.el, false);
    }, option: function(t2, e2) {
      var n2 = this.options;
      if (e2 === void 0)
        return n2[t2];
      var o2 = K.modifyOption(this, t2, e2);
      n2[t2] = o2 !== void 0 ? o2 : e2, t2 === "group" && Pt(n2);
    }, destroy: function() {
      z("destroy", this);
      var t2 = this.el;
      t2[j] = null, f(t2, "mousedown", this._onTapStart), f(t2, "touchstart", this._onTapStart), f(t2, "pointerdown", this._onTapStart), this.nativeDraggable && (f(t2, "dragover", this), f(t2, "dragenter", this)), Array.prototype.forEach.call(t2.querySelectorAll("[draggable]"), function(t3) {
        t3.removeAttribute("draggable");
      }), this._onDrop(), this._disableDelayedDragEvents(), Et.splice(Et.indexOf(this.el), 1), this.el = t2 = null;
    }, _hideClone: function() {
      et || (z("hideClone", this), Bt.eventCanceled || (P(tt, "display", "none"), this.options.removeCloneOnHide && tt.parentNode && tt.parentNode.removeChild(tt), et = true));
    }, _showClone: function(t2) {
      t2.lastPutMode === "clone" ? et && (z("showClone", this), Bt.eventCanceled || (q.parentNode != $ || this.options.group.revertClone ? Q2 ? $.insertBefore(tt, Q2) : $.appendChild(tt) : $.insertBefore(tt, q), this.options.group.revertClone && this.animate(q, tt), P(tt, "display", ""), et = false)) : this._hideClone();
    }}, xt && h(document, "touchmove", function(t2) {
      (Bt.active || yt) && t2.cancelable && t2.preventDefault();
    }), Bt.utils = {on: h, off: f, css: P, find: b, is: function(t2, e2) {
      return !!N(t2, e2, t2, false);
    }, extend: function(t2, e2) {
      if (t2 && e2)
        for (var n2 in e2)
          e2.hasOwnProperty(n2) && (t2[n2] = e2[n2]);
      return t2;
    }, throttle: S2, closest: N, toggleClass: I, clone: _, index: B, nextTick: Lt, cancelNextTick: Kt, detectDirection: It, getChild: X}, Bt.get = function(t2) {
      return t2[j];
    }, Bt.mount = function() {
      for (var t2 = arguments.length, e2 = new Array(t2), n2 = 0; n2 < t2; n2++)
        e2[n2] = arguments[n2];
      (e2 = e2[0].constructor === Array ? e2[0] : e2).forEach(function(t3) {
        if (!t3.prototype || !t3.prototype.constructor)
          throw "Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(t3));
        t3.utils && (Bt.utils = M2(M2({}, Bt.utils), t3.utils)), K.mount(t3);
      });
    }, Bt.create = function(t2, e2) {
      return new Bt(t2, e2);
    };
    var Wt, zt, Gt, Ut, qt, Vt, Zt = [], $t = !(Bt.version = "1.15.0");
    function Qt() {
      Zt.forEach(function(t2) {
        clearInterval(t2.pid);
      }), Zt = [];
    }
    function Jt() {
      clearInterval(Vt);
    }
    var te, ee = S2(function(n2, t2, e2, o2) {
      if (t2.scroll) {
        var i2, r2 = (n2.touches ? n2.touches[0] : n2).clientX, a2 = (n2.touches ? n2.touches[0] : n2).clientY, l2 = t2.scrollSensitivity, s2 = t2.scrollSpeed, c2 = O(), u2 = false;
        zt !== e2 && (zt = e2, Qt(), Wt = t2.scroll, i2 = t2.scrollFn, Wt === true && (Wt = A(e2, true)));
        var d2 = 0, h2 = Wt;
        do {
          var f2 = h2, p2 = k(f2), g2 = p2.top, m2 = p2.bottom, v2 = p2.left, b2 = p2.right, y2 = p2.width, w2 = p2.height, E2 = void 0, D3 = void 0, S3 = f2.scrollWidth, _2 = f2.scrollHeight, C4 = P(f2), T2 = f2.scrollLeft, p2 = f2.scrollTop, D3 = f2 === c2 ? (E2 = y2 < S3 && (C4.overflowX === "auto" || C4.overflowX === "scroll" || C4.overflowX === "visible"), w2 < _2 && (C4.overflowY === "auto" || C4.overflowY === "scroll" || C4.overflowY === "visible")) : (E2 = y2 < S3 && (C4.overflowX === "auto" || C4.overflowX === "scroll"), w2 < _2 && (C4.overflowY === "auto" || C4.overflowY === "scroll")), T2 = E2 && (Math.abs(b2 - r2) <= l2 && T2 + y2 < S3) - (Math.abs(v2 - r2) <= l2 && !!T2), p2 = D3 && (Math.abs(m2 - a2) <= l2 && p2 + w2 < _2) - (Math.abs(g2 - a2) <= l2 && !!p2);
          if (!Zt[d2])
            for (var x2 = 0; x2 <= d2; x2++)
              Zt[x2] || (Zt[x2] = {});
          Zt[d2].vx == T2 && Zt[d2].vy == p2 && Zt[d2].el === f2 || (Zt[d2].el = f2, Zt[d2].vx = T2, Zt[d2].vy = p2, clearInterval(Zt[d2].pid), T2 == 0 && p2 == 0 || (u2 = true, Zt[d2].pid = setInterval(function() {
            o2 && this.layer === 0 && Bt.active._onTouchMove(qt);
            var t3 = Zt[this.layer].vy ? Zt[this.layer].vy * s2 : 0, e3 = Zt[this.layer].vx ? Zt[this.layer].vx * s2 : 0;
            typeof i2 == "function" && i2.call(Bt.dragged.parentNode[j], e3, t3, n2, qt, Zt[this.layer].el) !== "continue" || F(Zt[this.layer].el, e3, t3);
          }.bind({layer: d2}), 24))), d2++;
        } while (t2.bubbleScroll && h2 !== c2 && (h2 = A(h2, false)));
        $t = u2;
      }
    }, 30), c = function(t2) {
      var e2 = t2.originalEvent, n2 = t2.putSortable, o2 = t2.dragEl, i2 = t2.activeSortable, r2 = t2.dispatchSortableEvent, a2 = t2.hideGhostForTarget, t2 = t2.unhideGhostForTarget;
      e2 && (i2 = n2 || i2, a2(), e2 = e2.changedTouches && e2.changedTouches.length ? e2.changedTouches[0] : e2, e2 = document.elementFromPoint(e2.clientX, e2.clientY), t2(), i2 && !i2.el.contains(e2) && (r2("spill"), this.onSpill({dragEl: o2, putSortable: n2})));
    };
    function ne() {
    }
    function oe() {
    }
    ne.prototype = {startIndex: null, dragStart: function(t2) {
      t2 = t2.oldDraggableIndex;
      this.startIndex = t2;
    }, onSpill: function(t2) {
      var e2 = t2.dragEl, n2 = t2.putSortable;
      this.sortable.captureAnimationState(), n2 && n2.captureAnimationState();
      t2 = X(this.sortable.el, this.startIndex, this.options);
      t2 ? this.sortable.el.insertBefore(e2, t2) : this.sortable.el.appendChild(e2), this.sortable.animateAll(), n2 && n2.animateAll();
    }, drop: c}, a(ne, {pluginName: "revertOnSpill"}), oe.prototype = {onSpill: function(t2) {
      var e2 = t2.dragEl, t2 = t2.putSortable || this.sortable;
      t2.captureAnimationState(), e2.parentNode && e2.parentNode.removeChild(e2), t2.animateAll();
    }, drop: c}, a(oe, {pluginName: "removeOnSpill"});
    var ie, re, ae, le, se, ce = [], ue = [], de = false, he = false, fe = false;
    function pe(n2, o2) {
      ue.forEach(function(t2, e2) {
        e2 = o2.children[t2.sortableIndex + (n2 ? Number(e2) : 0)];
        e2 ? o2.insertBefore(t2, e2) : o2.appendChild(t2);
      });
    }
    function ge() {
      ce.forEach(function(t2) {
        t2 !== ae && t2.parentNode && t2.parentNode.removeChild(t2);
      });
    }
    return Bt.mount(new function() {
      function t2() {
        for (var t3 in this.defaults = {scroll: true, forceAutoScrollFallback: false, scrollSensitivity: 30, scrollSpeed: 10, bubbleScroll: true}, this)
          t3.charAt(0) === "_" && typeof this[t3] == "function" && (this[t3] = this[t3].bind(this));
      }
      return t2.prototype = {dragStarted: function(t3) {
        t3 = t3.originalEvent;
        this.sortable.nativeDraggable ? h(document, "dragover", this._handleAutoScroll) : this.options.supportPointer ? h(document, "pointermove", this._handleFallbackAutoScroll) : t3.touches ? h(document, "touchmove", this._handleFallbackAutoScroll) : h(document, "mousemove", this._handleFallbackAutoScroll);
      }, dragOverCompleted: function(t3) {
        t3 = t3.originalEvent;
        this.options.dragOverBubble || t3.rootEl || this._handleAutoScroll(t3);
      }, drop: function() {
        this.sortable.nativeDraggable ? f(document, "dragover", this._handleAutoScroll) : (f(document, "pointermove", this._handleFallbackAutoScroll), f(document, "touchmove", this._handleFallbackAutoScroll), f(document, "mousemove", this._handleFallbackAutoScroll)), Jt(), Qt(), clearTimeout(g), g = void 0;
      }, nulling: function() {
        qt = zt = Wt = $t = Vt = Gt = Ut = null, Zt.length = 0;
      }, _handleFallbackAutoScroll: function(t3) {
        this._handleAutoScroll(t3, true);
      }, _handleAutoScroll: function(e2, n2) {
        var o2, i2 = this, r2 = (e2.touches ? e2.touches[0] : e2).clientX, a2 = (e2.touches ? e2.touches[0] : e2).clientY, t3 = document.elementFromPoint(r2, a2);
        qt = e2, n2 || this.options.forceAutoScrollFallback || w || y || u ? (ee(e2, this.options, t3, n2), o2 = A(t3, true), !$t || Vt && r2 === Gt && a2 === Ut || (Vt && Jt(), Vt = setInterval(function() {
          var t4 = A(document.elementFromPoint(r2, a2), true);
          t4 !== o2 && (o2 = t4, Qt()), ee(e2, i2.options, t4, n2);
        }, 10), Gt = r2, Ut = a2)) : this.options.bubbleScroll && A(t3, true) !== O() ? ee(e2, this.options, A(t3, false), false) : Qt();
      }}, a(t2, {pluginName: "scroll", initializeByDefault: true});
    }()), Bt.mount(oe, ne), Bt.mount(new function() {
      function t2() {
        this.defaults = {swapClass: "sortable-swap-highlight"};
      }
      return t2.prototype = {dragStart: function(t3) {
        t3 = t3.dragEl;
        te = t3;
      }, dragOverValid: function(t3) {
        var e2 = t3.completed, n2 = t3.target, o2 = t3.onMove, i2 = t3.activeSortable, r2 = t3.changed, a2 = t3.cancel;
        i2.options.swap && (t3 = this.sortable.el, i2 = this.options, n2 && n2 !== t3 && (t3 = te, te = o2(n2) !== false ? (I(n2, i2.swapClass, true), n2) : null, t3 && t3 !== te && I(t3, i2.swapClass, false)), r2(), e2(true), a2());
      }, drop: function(t3) {
        var e2, n2, o2 = t3.activeSortable, i2 = t3.putSortable, r2 = t3.dragEl, a2 = i2 || this.sortable, l2 = this.options;
        te && I(te, l2.swapClass, false), te && (l2.swap || i2 && i2.options.swap) && r2 !== te && (a2.captureAnimationState(), a2 !== o2 && o2.captureAnimationState(), n2 = te, t3 = (e2 = r2).parentNode, l2 = n2.parentNode, t3 && l2 && !t3.isEqualNode(n2) && !l2.isEqualNode(e2) && (i2 = B(e2), r2 = B(n2), t3.isEqualNode(l2) && i2 < r2 && r2++, t3.insertBefore(n2, t3.children[i2]), l2.insertBefore(e2, l2.children[r2])), a2.animateAll(), a2 !== o2 && o2.animateAll());
      }, nulling: function() {
        te = null;
      }}, a(t2, {pluginName: "swap", eventProperties: function() {
        return {swapItem: te};
      }});
    }()), Bt.mount(new function() {
      function t2(o2) {
        for (var t3 in this)
          t3.charAt(0) === "_" && typeof this[t3] == "function" && (this[t3] = this[t3].bind(this));
        o2.options.avoidImplicitDeselect || (o2.options.supportPointer ? h(document, "pointerup", this._deselectMultiDrag) : (h(document, "mouseup", this._deselectMultiDrag), h(document, "touchend", this._deselectMultiDrag))), h(document, "keydown", this._checkKeyDown), h(document, "keyup", this._checkKeyUp), this.defaults = {selectedClass: "sortable-selected", multiDragKey: null, avoidImplicitDeselect: false, setData: function(t4, e2) {
          var n2 = "";
          ce.length && re === o2 ? ce.forEach(function(t5, e3) {
            n2 += (e3 ? ", " : "") + t5.textContent;
          }) : n2 = e2.textContent, t4.setData("Text", n2);
        }};
      }
      return t2.prototype = {multiDragKeyDown: false, isMultiDrag: false, delayStartGlobal: function(t3) {
        t3 = t3.dragEl;
        ae = t3;
      }, delayEnded: function() {
        this.isMultiDrag = ~ce.indexOf(ae);
      }, setupClone: function(t3) {
        var e2 = t3.sortable, t3 = t3.cancel;
        if (this.isMultiDrag) {
          for (var n2 = 0; n2 < ce.length; n2++)
            ue.push(_(ce[n2])), ue[n2].sortableIndex = ce[n2].sortableIndex, ue[n2].draggable = false, ue[n2].style["will-change"] = "", I(ue[n2], this.options.selectedClass, false), ce[n2] === ae && I(ue[n2], this.options.chosenClass, false);
          e2._hideClone(), t3();
        }
      }, clone: function(t3) {
        var e2 = t3.sortable, n2 = t3.rootEl, o2 = t3.dispatchSortableEvent, t3 = t3.cancel;
        this.isMultiDrag && (this.options.removeCloneOnHide || ce.length && re === e2 && (pe(true, n2), o2("clone"), t3()));
      }, showClone: function(t3) {
        var e2 = t3.cloneNowShown, n2 = t3.rootEl, t3 = t3.cancel;
        this.isMultiDrag && (pe(false, n2), ue.forEach(function(t4) {
          P(t4, "display", "");
        }), e2(), se = false, t3());
      }, hideClone: function(t3) {
        var e2 = this, n2 = (t3.sortable, t3.cloneNowHidden), t3 = t3.cancel;
        this.isMultiDrag && (ue.forEach(function(t4) {
          P(t4, "display", "none"), e2.options.removeCloneOnHide && t4.parentNode && t4.parentNode.removeChild(t4);
        }), n2(), se = true, t3());
      }, dragStartGlobal: function(t3) {
        t3.sortable;
        !this.isMultiDrag && re && re.multiDrag._deselectMultiDrag(), ce.forEach(function(t4) {
          t4.sortableIndex = B(t4);
        }), ce = ce.sort(function(t4, e2) {
          return t4.sortableIndex - e2.sortableIndex;
        }), fe = true;
      }, dragStarted: function(t3) {
        var e2, n2 = this, t3 = t3.sortable;
        this.isMultiDrag && (this.options.sort && (t3.captureAnimationState(), this.options.animation && (ce.forEach(function(t4) {
          t4 !== ae && P(t4, "position", "absolute");
        }), e2 = k(ae, false, true, true), ce.forEach(function(t4) {
          t4 !== ae && C3(t4, e2);
        }), de = he = true)), t3.animateAll(function() {
          de = he = false, n2.options.animation && ce.forEach(function(t4) {
            T(t4);
          }), n2.options.sort && ge();
        }));
      }, dragOver: function(t3) {
        var e2 = t3.target, n2 = t3.completed, t3 = t3.cancel;
        he && ~ce.indexOf(e2) && (n2(false), t3());
      }, revert: function(t3) {
        var n2, o2, e2 = t3.fromSortable, i2 = t3.rootEl, r2 = t3.sortable, a2 = t3.dragRect;
        1 < ce.length && (ce.forEach(function(t4) {
          r2.addAnimationState({target: t4, rect: he ? k(t4) : a2}), T(t4), t4.fromRect = a2, e2.removeAnimationState(t4);
        }), he = false, n2 = !this.options.removeCloneOnHide, o2 = i2, ce.forEach(function(t4, e3) {
          e3 = o2.children[t4.sortableIndex + (n2 ? Number(e3) : 0)];
          e3 ? o2.insertBefore(t4, e3) : o2.appendChild(t4);
        }));
      }, dragOverCompleted: function(t3) {
        var e2, n2 = t3.sortable, o2 = t3.isOwner, i2 = t3.insertion, r2 = t3.activeSortable, a2 = t3.parentEl, l2 = t3.putSortable, t3 = this.options;
        i2 && (o2 && r2._hideClone(), de = false, t3.animation && 1 < ce.length && (he || !o2 && !r2.options.sort && !l2) && (e2 = k(ae, false, true, true), ce.forEach(function(t4) {
          t4 !== ae && (C3(t4, e2), a2.appendChild(t4));
        }), he = true), o2 || (he || ge(), 1 < ce.length ? (o2 = se, r2._showClone(n2), r2.options.animation && !se && o2 && ue.forEach(function(t4) {
          r2.addAnimationState({target: t4, rect: le}), t4.fromRect = le, t4.thisAnimationDuration = null;
        })) : r2._showClone(n2)));
      }, dragOverAnimationCapture: function(t3) {
        var e2 = t3.dragRect, n2 = t3.isOwner, t3 = t3.activeSortable;
        ce.forEach(function(t4) {
          t4.thisAnimationDuration = null;
        }), t3.options.animation && !n2 && t3.multiDrag.isMultiDrag && (le = a({}, e2), e2 = v(ae, true), le.top -= e2.f, le.left -= e2.e);
      }, dragOverAnimationComplete: function() {
        he && (he = false, ge());
      }, drop: function(t3) {
        var e2 = t3.originalEvent, n2 = t3.rootEl, o2 = t3.parentEl, i2 = t3.sortable, r2 = t3.dispatchSortableEvent, a2 = t3.oldIndex, l2 = t3.putSortable, s2 = l2 || this.sortable;
        if (e2) {
          var c2, u2, d2, h2 = this.options, f2 = o2.children;
          if (!fe)
            if (h2.multiDragKey && !this.multiDragKeyDown && this._deselectMultiDrag(), I(ae, h2.selectedClass, !~ce.indexOf(ae)), ~ce.indexOf(ae))
              ce.splice(ce.indexOf(ae), 1), ie = null, W2({sortable: i2, rootEl: n2, name: "deselect", targetEl: ae, originalEvent: e2});
            else {
              if (ce.push(ae), W2({sortable: i2, rootEl: n2, name: "select", targetEl: ae, originalEvent: e2}), e2.shiftKey && ie && i2.el.contains(ie)) {
                var p2 = B(ie), t3 = B(ae);
                if (~p2 && ~t3 && p2 !== t3)
                  for (var g2, m2 = p2 < t3 ? (g2 = p2, t3) : (g2 = t3, p2 + 1); g2 < m2; g2++)
                    ~ce.indexOf(f2[g2]) || (I(f2[g2], h2.selectedClass, true), ce.push(f2[g2]), W2({sortable: i2, rootEl: n2, name: "select", targetEl: f2[g2], originalEvent: e2}));
              } else
                ie = ae;
              re = s2;
            }
          fe && this.isMultiDrag && (he = false, (o2[j].options.sort || o2 !== n2) && 1 < ce.length && (c2 = k(ae), u2 = B(ae, ":not(." + this.options.selectedClass + ")"), !de && h2.animation && (ae.thisAnimationDuration = null), s2.captureAnimationState(), de || (h2.animation && (ae.fromRect = c2, ce.forEach(function(t4) {
            var e3;
            t4.thisAnimationDuration = null, t4 !== ae && (e3 = he ? k(t4) : c2, t4.fromRect = e3, s2.addAnimationState({target: t4, rect: e3}));
          })), ge(), ce.forEach(function(t4) {
            f2[u2] ? o2.insertBefore(t4, f2[u2]) : o2.appendChild(t4), u2++;
          }), a2 === B(ae) && (d2 = false, ce.forEach(function(t4) {
            t4.sortableIndex !== B(t4) && (d2 = true);
          }), d2 && r2("update"))), ce.forEach(function(t4) {
            T(t4);
          }), s2.animateAll()), re = s2), (n2 === o2 || l2 && l2.lastPutMode !== "clone") && ue.forEach(function(t4) {
            t4.parentNode && t4.parentNode.removeChild(t4);
          });
        }
      }, nullingGlobal: function() {
        this.isMultiDrag = fe = false, ue.length = 0;
      }, destroyGlobal: function() {
        this._deselectMultiDrag(), f(document, "pointerup", this._deselectMultiDrag), f(document, "mouseup", this._deselectMultiDrag), f(document, "touchend", this._deselectMultiDrag), f(document, "keydown", this._checkKeyDown), f(document, "keyup", this._checkKeyUp);
      }, _deselectMultiDrag: function(t3) {
        if (!(fe !== void 0 && fe || re !== this.sortable || t3 && N(t3.target, this.options.draggable, this.sortable.el, false) || t3 && t3.button !== 0))
          for (; ce.length; ) {
            var e2 = ce[0];
            I(e2, this.options.selectedClass, false), ce.shift(), W2({sortable: this.sortable, rootEl: this.sortable.el, name: "deselect", targetEl: e2, originalEvent: t3});
          }
      }, _checkKeyDown: function(t3) {
        t3.key === this.options.multiDragKey && (this.multiDragKeyDown = true);
      }, _checkKeyUp: function(t3) {
        t3.key === this.options.multiDragKey && (this.multiDragKeyDown = false);
      }}, a(t2, {pluginName: "multiDrag", utils: {select: function(t3) {
        var e2 = t3.parentNode[j];
        e2 && e2.options.multiDrag && !~ce.indexOf(t3) && (re && re !== e2 && (re.multiDrag._deselectMultiDrag(), re = e2), I(t3, e2.options.selectedClass, true), ce.push(t3));
      }, deselect: function(t3) {
        var e2 = t3.parentNode[j], n2 = ce.indexOf(t3);
        e2 && e2.options.multiDrag && ~n2 && (I(t3, e2.options.selectedClass, false), ce.splice(n2, 1));
      }}, eventProperties: function() {
        var n2 = this, o2 = [], i2 = [];
        return ce.forEach(function(t3) {
          var e2;
          o2.push({multiDragElement: t3, index: t3.sortableIndex}), e2 = he && t3 !== ae ? -1 : he ? B(t3, ":not(." + n2.options.selectedClass + ")") : B(t3), i2.push({multiDragElement: t3, index: e2});
        }), {items: r(ce), clones: [].concat(ue), oldIndicies: o2, newIndicies: i2};
      }, optionListeners: {multiDragKey: function(t3) {
        return (t3 = t3.toLowerCase()) === "ctrl" ? t3 = "Control" : 1 < t3.length && (t3 = t3.charAt(0).toUpperCase() + t3.substr(1)), t3;
      }}});
    }()), Bt;
  });
});

// node_modules/vanilla-colorful/lib/utils/math.js
var clamp = (number, min = 0, max = 1) => {
  return number > max ? max : number < min ? min : number;
};
var round = (number, digits = 0, base = Math.pow(10, digits)) => {
  return Math.round(base * number) / base;
};

// node_modules/vanilla-colorful/lib/utils/convert.js
var angleUnits = {
  grad: 360 / 400,
  turn: 360,
  rad: 360 / (Math.PI * 2)
};
var hexToHsva = (hex) => rgbaToHsva(hexToRgba(hex));
var hexToRgba = (hex) => {
  if (hex[0] === "#")
    hex = hex.substr(1);
  if (hex.length < 6) {
    return {
      r: parseInt(hex[0] + hex[0], 16),
      g: parseInt(hex[1] + hex[1], 16),
      b: parseInt(hex[2] + hex[2], 16),
      a: 1
    };
  }
  return {
    r: parseInt(hex.substr(0, 2), 16),
    g: parseInt(hex.substr(2, 2), 16),
    b: parseInt(hex.substr(4, 2), 16),
    a: 1
  };
};
var parseHue = (value, unit = "deg") => {
  return Number(value) * (angleUnits[unit] || 1);
};
var hslaStringToHsva = (hslString) => {
  const matcher = /hsla?\(?\s*(-?\d*\.?\d+)(deg|rad|grad|turn)?[,\s]+(-?\d*\.?\d+)%?[,\s]+(-?\d*\.?\d+)%?,?\s*[/\s]*(-?\d*\.?\d+)?(%)?\s*\)?/i;
  const match = matcher.exec(hslString);
  if (!match)
    return {h: 0, s: 0, v: 0, a: 1};
  return hslaToHsva({
    h: parseHue(match[1], match[2]),
    s: Number(match[3]),
    l: Number(match[4]),
    a: match[5] === void 0 ? 1 : Number(match[5]) / (match[6] ? 100 : 1)
  });
};
var hslStringToHsva = hslaStringToHsva;
var hslaToHsva = ({h, s, l, a}) => {
  s *= (l < 50 ? l : 100 - l) / 100;
  return {
    h,
    s: s > 0 ? 2 * s / (l + s) * 100 : 0,
    v: l + s,
    a
  };
};
var hsvaToHex = (hsva) => rgbaToHex(hsvaToRgba(hsva));
var hsvaToHsla = ({h, s, v, a}) => {
  const hh = (200 - s) * v / 100;
  return {
    h: round(h),
    s: round(hh > 0 && hh < 200 ? s * v / 100 / (hh <= 100 ? hh : 200 - hh) * 100 : 0),
    l: round(hh / 2),
    a: round(a, 2)
  };
};
var hsvaToHslString = (hsva) => {
  const {h, s, l} = hsvaToHsla(hsva);
  return `hsl(${h}, ${s}%, ${l}%)`;
};
var hsvaToHslaString = (hsva) => {
  const {h, s, l, a} = hsvaToHsla(hsva);
  return `hsla(${h}, ${s}%, ${l}%, ${a})`;
};
var hsvaToRgba = ({h, s, v, a}) => {
  h = h / 360 * 6;
  s = s / 100;
  v = v / 100;
  const hh = Math.floor(h), b = v * (1 - s), c = v * (1 - (h - hh) * s), d = v * (1 - (1 - h + hh) * s), module = hh % 6;
  return {
    r: round([v, c, b, b, d, v][module] * 255),
    g: round([d, v, v, c, b, b][module] * 255),
    b: round([b, b, d, v, v, c][module] * 255),
    a: round(a, 2)
  };
};
var hsvaToRgbString = (hsva) => {
  const {r, g, b} = hsvaToRgba(hsva);
  return `rgb(${r}, ${g}, ${b})`;
};
var hsvaToRgbaString = (hsva) => {
  const {r, g, b, a} = hsvaToRgba(hsva);
  return `rgba(${r}, ${g}, ${b}, ${a})`;
};
var rgbaStringToHsva = (rgbaString) => {
  const matcher = /rgba?\(?\s*(-?\d*\.?\d+)(%)?[,\s]+(-?\d*\.?\d+)(%)?[,\s]+(-?\d*\.?\d+)(%)?,?\s*[/\s]*(-?\d*\.?\d+)?(%)?\s*\)?/i;
  const match = matcher.exec(rgbaString);
  if (!match)
    return {h: 0, s: 0, v: 0, a: 1};
  return rgbaToHsva({
    r: Number(match[1]) / (match[2] ? 100 / 255 : 1),
    g: Number(match[3]) / (match[4] ? 100 / 255 : 1),
    b: Number(match[5]) / (match[6] ? 100 / 255 : 1),
    a: match[7] === void 0 ? 1 : Number(match[7]) / (match[8] ? 100 : 1)
  });
};
var rgbStringToHsva = rgbaStringToHsva;
var format = (number) => {
  const hex = number.toString(16);
  return hex.length < 2 ? "0" + hex : hex;
};
var rgbaToHex = ({r, g, b}) => {
  return "#" + format(r) + format(g) + format(b);
};
var rgbaToHsva = ({r, g, b, a}) => {
  const max = Math.max(r, g, b);
  const delta = max - Math.min(r, g, b);
  const hh = delta ? max === r ? (g - b) / delta : max === g ? 2 + (b - r) / delta : 4 + (r - g) / delta : 0;
  return {
    h: round(60 * (hh < 0 ? hh + 6 : hh)),
    s: round(max ? delta / max * 100 : 0),
    v: round(max / 255 * 100),
    a
  };
};

// node_modules/vanilla-colorful/lib/utils/compare.js
var equalColorObjects = (first, second) => {
  if (first === second)
    return true;
  for (const prop in first) {
    if (first[prop] !== second[prop])
      return false;
  }
  return true;
};
var equalColorString = (first, second) => {
  return first.replace(/\s/g, "") === second.replace(/\s/g, "");
};
var equalHex = (first, second) => {
  if (first.toLowerCase() === second.toLowerCase())
    return true;
  return equalColorObjects(hexToRgba(first), hexToRgba(second));
};

// node_modules/vanilla-colorful/lib/utils/dom.js
var cache = {};
var tpl = (html) => {
  let template = cache[html];
  if (!template) {
    template = document.createElement("template");
    template.innerHTML = html;
    cache[html] = template;
  }
  return template;
};
var fire = (target, type, detail) => {
  target.dispatchEvent(new CustomEvent(type, {
    bubbles: true,
    detail
  }));
};

// node_modules/vanilla-colorful/lib/components/slider.js
var hasTouched = false;
var isTouch = (e) => "touches" in e;
var isValid = (event) => {
  if (hasTouched && !isTouch(event))
    return false;
  if (!hasTouched)
    hasTouched = isTouch(event);
  return true;
};
var pointerMove = (target, event) => {
  const pointer = isTouch(event) ? event.touches[0] : event;
  const rect = target.el.getBoundingClientRect();
  fire(target.el, "move", target.getMove({
    x: clamp((pointer.pageX - (rect.left + window.pageXOffset)) / rect.width),
    y: clamp((pointer.pageY - (rect.top + window.pageYOffset)) / rect.height)
  }));
};
var keyMove = (target, event) => {
  const keyCode = event.keyCode;
  if (keyCode > 40 || target.xy && keyCode < 37 || keyCode < 33)
    return;
  event.preventDefault();
  fire(target.el, "move", target.getMove({
    x: keyCode === 39 ? 0.01 : keyCode === 37 ? -0.01 : keyCode === 34 ? 0.05 : keyCode === 33 ? -0.05 : keyCode === 35 ? 1 : keyCode === 36 ? -1 : 0,
    y: keyCode === 40 ? 0.01 : keyCode === 38 ? -0.01 : 0
  }, true));
};
var Slider = class {
  constructor(root, part, aria, xy) {
    const template = tpl(`<div role="slider" tabindex="0" part="${part}" ${aria}><div part="${part}-pointer"></div></div>`);
    root.appendChild(template.content.cloneNode(true));
    const el = root.querySelector(`[part=${part}]`);
    el.addEventListener("mousedown", this);
    el.addEventListener("touchstart", this);
    el.addEventListener("keydown", this);
    this.el = el;
    this.xy = xy;
    this.nodes = [el.firstChild, el];
  }
  set dragging(state) {
    const toggleEvent = state ? document.addEventListener : document.removeEventListener;
    toggleEvent(hasTouched ? "touchmove" : "mousemove", this);
    toggleEvent(hasTouched ? "touchend" : "mouseup", this);
  }
  handleEvent(event) {
    switch (event.type) {
      case "mousedown":
      case "touchstart":
        event.preventDefault();
        if (!isValid(event) || !hasTouched && event.button != 0)
          return;
        this.el.focus();
        pointerMove(this, event);
        this.dragging = true;
        break;
      case "mousemove":
      case "touchmove":
        event.preventDefault();
        pointerMove(this, event);
        break;
      case "mouseup":
      case "touchend":
        this.dragging = false;
        break;
      case "keydown":
        keyMove(this, event);
        break;
    }
  }
  style(styles2) {
    styles2.forEach((style, i) => {
      for (const p in style) {
        this.nodes[i].style.setProperty(p, style[p]);
      }
    });
  }
};

// node_modules/vanilla-colorful/lib/components/hue.js
var Hue = class extends Slider {
  constructor(root) {
    super(root, "hue", 'aria-label="Hue" aria-valuemin="0" aria-valuemax="360"', false);
  }
  update({h}) {
    this.h = h;
    this.style([
      {
        left: `${h / 360 * 100}%`,
        color: hsvaToHslString({h, s: 100, v: 100, a: 1})
      }
    ]);
    this.el.setAttribute("aria-valuenow", `${round(h)}`);
  }
  getMove(offset, key) {
    return {h: key ? clamp(this.h + offset.x * 360, 0, 360) : 360 * offset.x};
  }
};

// node_modules/vanilla-colorful/lib/components/saturation.js
var Saturation = class extends Slider {
  constructor(root) {
    super(root, "saturation", 'aria-label="Color"', true);
  }
  update(hsva) {
    this.hsva = hsva;
    this.style([
      {
        top: `${100 - hsva.v}%`,
        left: `${hsva.s}%`,
        color: hsvaToHslString(hsva)
      },
      {
        "background-color": hsvaToHslString({h: hsva.h, s: 100, v: 100, a: 1})
      }
    ]);
    this.el.setAttribute("aria-valuetext", `Saturation ${round(hsva.s)}%, Brightness ${round(hsva.v)}%`);
  }
  getMove(offset, key) {
    return {
      s: key ? clamp(this.hsva.s + offset.x * 100, 0, 100) : offset.x * 100,
      v: key ? clamp(this.hsva.v - offset.y * 100, 0, 100) : Math.round(100 - offset.y * 100)
    };
  }
};

// node_modules/vanilla-colorful/lib/styles/color-picker.js
var color_picker_default = `:host{display:flex;flex-direction:column;position:relative;width:200px;height:200px;user-select:none;-webkit-user-select:none;cursor:default}:host([hidden]){display:none!important}[role=slider]{position:relative;touch-action:none;user-select:none;-webkit-user-select:none;outline:0}[role=slider]:last-child{border-radius:0 0 8px 8px}[part$=pointer]{position:absolute;z-index:1;box-sizing:border-box;width:28px;height:28px;transform:translate(-50%,-50%);background-color:#fff;border:2px solid #fff;border-radius:50%;box-shadow:0 2px 4px rgba(0,0,0,.2)}[part$=pointer]::after{display:block;content:'';position:absolute;left:0;top:0;right:0;bottom:0;border-radius:inherit;background-color:currentColor}[role=slider]:focus [part$=pointer]{transform:translate(-50%,-50%) scale(1.1)}`;

// node_modules/vanilla-colorful/lib/styles/hue.js
var hue_default = `[part=hue]{flex:0 0 24px;background:linear-gradient(to right,red 0,#ff0 17%,#0f0 33%,#0ff 50%,#00f 67%,#f0f 83%,red 100%)}[part=hue-pointer]{top:50%;z-index:2}`;

// node_modules/vanilla-colorful/lib/styles/saturation.js
var saturation_default = `[part=saturation]{flex-grow:1;border-color:transparent;border-bottom:12px solid #000;border-radius:8px 8px 0 0;background-image:linear-gradient(to top,#000,transparent),linear-gradient(to right,#fff,rgba(255,255,255,0));box-shadow:inset 0 0 0 1px rgba(0,0,0,.05)}[part=saturation-pointer]{z-index:3}`;

// node_modules/vanilla-colorful/lib/components/color-picker.js
var $isSame = Symbol("same");
var $color = Symbol("color");
var $hsva = Symbol("hsva");
var $change = Symbol("change");
var $update = Symbol("update");
var $parts = Symbol("parts");
var $css = Symbol("css");
var $sliders = Symbol("sliders");
var ColorPicker = class extends HTMLElement {
  static get observedAttributes() {
    return ["color"];
  }
  get [$css]() {
    return [color_picker_default, hue_default, saturation_default];
  }
  get [$sliders]() {
    return [Saturation, Hue];
  }
  get color() {
    return this[$color];
  }
  set color(newColor) {
    if (!this[$isSame](newColor)) {
      const newHsva = this.colorModel.toHsva(newColor);
      this[$update](newHsva);
      this[$change](newColor);
    }
  }
  constructor() {
    super();
    const template = tpl(`<style>${this[$css].join("")}</style>`);
    const root = this.attachShadow({mode: "open"});
    root.appendChild(template.content.cloneNode(true));
    root.addEventListener("move", this);
    this[$parts] = this[$sliders].map((slider) => new slider(root));
  }
  connectedCallback() {
    if (this.hasOwnProperty("color")) {
      const value = this.color;
      delete this["color"];
      this.color = value;
    } else if (!this.color) {
      this.color = this.colorModel.defaultColor;
    }
  }
  attributeChangedCallback(_attr, _oldVal, newVal) {
    const color = this.colorModel.fromAttr(newVal);
    if (!this[$isSame](color)) {
      this.color = color;
    }
  }
  handleEvent(event) {
    const oldHsva = this[$hsva];
    const newHsva = {...oldHsva, ...event.detail};
    this[$update](newHsva);
    let newColor;
    if (!equalColorObjects(newHsva, oldHsva) && !this[$isSame](newColor = this.colorModel.fromHsva(newHsva))) {
      this[$change](newColor);
    }
  }
  [$isSame](color) {
    return this.color && this.colorModel.equal(color, this.color);
  }
  [$update](hsva) {
    this[$hsva] = hsva;
    this[$parts].forEach((part) => part.update(hsva));
  }
  [$change](value) {
    this[$color] = value;
    fire(this, "color-changed", {value});
  }
};

// node_modules/vanilla-colorful/lib/entrypoints/hex.js
var colorModel = {
  defaultColor: "#000",
  toHsva: hexToHsva,
  fromHsva: hsvaToHex,
  equal: equalHex,
  fromAttr: (color) => color
};
var HexBase = class extends ColorPicker {
  get colorModel() {
    return colorModel;
  }
};

// node_modules/vanilla-colorful/hex-color-picker.js
var HexColorPicker = class extends HexBase {
};
customElements.define("hex-color-picker", HexColorPicker);

// node_modules/vanilla-colorful/lib/entrypoints/hsl-string.js
var colorModel2 = {
  defaultColor: "hsl(0, 0%, 0%)",
  toHsva: hslStringToHsva,
  fromHsva: hsvaToHslString,
  equal: equalColorString,
  fromAttr: (color) => color
};
var HslStringBase = class extends ColorPicker {
  get colorModel() {
    return colorModel2;
  }
};

// node_modules/vanilla-colorful/hsl-string-color-picker.js
var HslStringColorPicker = class extends HslStringBase {
};
customElements.define("hsl-string-color-picker", HslStringColorPicker);

// node_modules/vanilla-colorful/lib/entrypoints/rgb-string.js
var colorModel3 = {
  defaultColor: "rgb(0, 0, 0)",
  toHsva: rgbStringToHsva,
  fromHsva: hsvaToRgbString,
  equal: equalColorString,
  fromAttr: (color) => color
};
var RgbStringBase = class extends ColorPicker {
  get colorModel() {
    return colorModel3;
  }
};

// node_modules/vanilla-colorful/rgb-string-color-picker.js
var RgbStringColorPicker = class extends RgbStringBase {
};
customElements.define("rgb-string-color-picker", RgbStringColorPicker);

// node_modules/vanilla-colorful/lib/components/alpha.js
var Alpha = class extends Slider {
  constructor(root) {
    super(root, "alpha", 'aria-label="Alpha" aria-valuemin="0" aria-valuemax="1"', false);
  }
  update(hsva) {
    this.hsva = hsva;
    const colorFrom = hsvaToHslaString({...hsva, a: 0});
    const colorTo = hsvaToHslaString({...hsva, a: 1});
    const value = hsva.a * 100;
    this.style([
      {
        left: `${value}%`,
        color: hsvaToHslaString(hsva)
      },
      {
        "--gradient": `linear-gradient(90deg, ${colorFrom}, ${colorTo}`
      }
    ]);
    const v = round(value);
    this.el.setAttribute("aria-valuenow", `${v}`);
    this.el.setAttribute("aria-valuetext", `${v}%`);
  }
  getMove(offset, key) {
    return {a: key ? clamp(this.hsva.a + offset.x) : offset.x};
  }
};

// node_modules/vanilla-colorful/lib/styles/alpha.js
var alpha_default = `[part=alpha]{flex:0 0 24px}[part=alpha]::after{display:block;content:'';position:absolute;top:0;left:0;right:0;bottom:0;border-radius:inherit;background-image:var(--gradient);box-shadow:inset 0 0 0 1px rgba(0,0,0,.05)}[part^=alpha]{background-color:#fff;background-image:url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill-opacity=".05"><rect x="8" width="8" height="8"/><rect y="8" width="8" height="8"/></svg>')}[part=alpha-pointer]{top:50%}`;

// node_modules/vanilla-colorful/lib/components/alpha-color-picker.js
var AlphaColorPicker = class extends ColorPicker {
  get [$css]() {
    return [...super[$css], alpha_default];
  }
  get [$sliders]() {
    return [...super[$sliders], Alpha];
  }
};

// node_modules/vanilla-colorful/lib/entrypoints/rgba-string.js
var colorModel4 = {
  defaultColor: "rgba(0, 0, 0, 1)",
  toHsva: rgbaStringToHsva,
  fromHsva: hsvaToRgbaString,
  equal: equalColorString,
  fromAttr: (color) => color
};
var RgbaStringBase = class extends AlphaColorPicker {
  get colorModel() {
    return colorModel4;
  }
};

// node_modules/vanilla-colorful/rgba-string-color-picker.js
var RgbaStringColorPicker = class extends RgbaStringBase {
};
customElements.define("rgba-string-color-picker", RgbaStringColorPicker);

// packages/forms/resources/js/components/color-picker.js
var color_picker_default2 = (Alpine) => {
  Alpine.data("colorPickerFormComponent", ({
    isAutofocused,
    isDisabled,
    state
  }) => {
    return {
      isOpen: false,
      state,
      init: function() {
        if (!(this.state === null || this.state === "")) {
          this.setState(this.state);
        }
        if (isAutofocused) {
          this.openPicker();
        }
        this.$refs.input.addEventListener("change", (event) => {
          this.setState(event.target.value);
        });
        this.$refs.picker.addEventListener("color-changed", (event) => {
          this.setState(event.detail.value);
        });
      },
      openPicker: function() {
        if (isDisabled) {
          return;
        }
        this.isOpen = true;
      },
      closePicker: function() {
        this.isOpen = false;
      },
      setState: function(value) {
        this.state = value;
        this.$refs.input.value = value;
        this.$refs.picker.color = value;
      }
    };
  });
};

// node_modules/dayjs/esm/constant.js
var SECONDS_A_MINUTE = 60;
var SECONDS_A_HOUR = SECONDS_A_MINUTE * 60;
var SECONDS_A_DAY = SECONDS_A_HOUR * 24;
var SECONDS_A_WEEK = SECONDS_A_DAY * 7;
var MILLISECONDS_A_SECOND = 1e3;
var MILLISECONDS_A_MINUTE = SECONDS_A_MINUTE * MILLISECONDS_A_SECOND;
var MILLISECONDS_A_HOUR = SECONDS_A_HOUR * MILLISECONDS_A_SECOND;
var MILLISECONDS_A_DAY = SECONDS_A_DAY * MILLISECONDS_A_SECOND;
var MILLISECONDS_A_WEEK = SECONDS_A_WEEK * MILLISECONDS_A_SECOND;
var MS = "millisecond";
var S = "second";
var MIN = "minute";
var H = "hour";
var D = "day";
var W = "week";
var M = "month";
var Q = "quarter";
var Y = "year";
var DATE = "date";
var FORMAT_DEFAULT = "YYYY-MM-DDTHH:mm:ssZ";
var INVALID_DATE_STRING = "Invalid Date";
var REGEX_PARSE = /^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/;
var REGEX_FORMAT = /\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g;

// node_modules/dayjs/esm/locale/en.js
var en_default = {
  name: "en",
  weekdays: "Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),
  months: "January_February_March_April_May_June_July_August_September_October_November_December".split("_")
};

// node_modules/dayjs/esm/utils.js
var padStart = function padStart2(string, length, pad) {
  var s = String(string);
  if (!s || s.length >= length)
    return string;
  return "" + Array(length + 1 - s.length).join(pad) + string;
};
var padZoneStr = function padZoneStr2(instance) {
  var negMinutes = -instance.utcOffset();
  var minutes = Math.abs(negMinutes);
  var hourOffset = Math.floor(minutes / 60);
  var minuteOffset = minutes % 60;
  return "" + (negMinutes <= 0 ? "+" : "-") + padStart(hourOffset, 2, "0") + ":" + padStart(minuteOffset, 2, "0");
};
var monthDiff = function monthDiff2(a, b) {
  if (a.date() < b.date())
    return -monthDiff2(b, a);
  var wholeMonthDiff = (b.year() - a.year()) * 12 + (b.month() - a.month());
  var anchor = a.clone().add(wholeMonthDiff, M);
  var c = b - anchor < 0;
  var anchor2 = a.clone().add(wholeMonthDiff + (c ? -1 : 1), M);
  return +(-(wholeMonthDiff + (b - anchor) / (c ? anchor - anchor2 : anchor2 - anchor)) || 0);
};
var absFloor = function absFloor2(n) {
  return n < 0 ? Math.ceil(n) || 0 : Math.floor(n);
};
var prettyUnit = function prettyUnit2(u) {
  var special = {
    M,
    y: Y,
    w: W,
    d: D,
    D: DATE,
    h: H,
    m: MIN,
    s: S,
    ms: MS,
    Q
  };
  return special[u] || String(u || "").toLowerCase().replace(/s$/, "");
};
var isUndefined = function isUndefined2(s) {
  return s === void 0;
};
var utils_default = {
  s: padStart,
  z: padZoneStr,
  m: monthDiff,
  a: absFloor,
  p: prettyUnit,
  u: isUndefined
};

// node_modules/dayjs/esm/index.js
var L = "en";
var Ls = {};
Ls[L] = en_default;
var isDayjs = function isDayjs2(d) {
  return d instanceof Dayjs;
};
var parseLocale = function parseLocale2(preset, object, isLocal) {
  var l;
  if (!preset)
    return L;
  if (typeof preset === "string") {
    var presetLower = preset.toLowerCase();
    if (Ls[presetLower]) {
      l = presetLower;
    }
    if (object) {
      Ls[presetLower] = object;
      l = presetLower;
    }
    var presetSplit = preset.split("-");
    if (!l && presetSplit.length > 1) {
      return parseLocale2(presetSplit[0]);
    }
  } else {
    var name = preset.name;
    Ls[name] = preset;
    l = name;
  }
  if (!isLocal && l)
    L = l;
  return l || !isLocal && L;
};
var dayjs = function dayjs2(date, c) {
  if (isDayjs(date)) {
    return date.clone();
  }
  var cfg = typeof c === "object" ? c : {};
  cfg.date = date;
  cfg.args = arguments;
  return new Dayjs(cfg);
};
var wrapper = function wrapper2(date, instance) {
  return dayjs(date, {
    locale: instance.$L,
    utc: instance.$u,
    x: instance.$x,
    $offset: instance.$offset
  });
};
var Utils = utils_default;
Utils.l = parseLocale;
Utils.i = isDayjs;
Utils.w = wrapper;
var parseDate = function parseDate2(cfg) {
  var date = cfg.date, utc2 = cfg.utc;
  if (date === null)
    return new Date(NaN);
  if (Utils.u(date))
    return new Date();
  if (date instanceof Date)
    return new Date(date);
  if (typeof date === "string" && !/Z$/i.test(date)) {
    var d = date.match(REGEX_PARSE);
    if (d) {
      var m = d[2] - 1 || 0;
      var ms = (d[7] || "0").substring(0, 3);
      if (utc2) {
        return new Date(Date.UTC(d[1], m, d[3] || 1, d[4] || 0, d[5] || 0, d[6] || 0, ms));
      }
      return new Date(d[1], m, d[3] || 1, d[4] || 0, d[5] || 0, d[6] || 0, ms);
    }
  }
  return new Date(date);
};
var Dayjs = /* @__PURE__ */ function() {
  function Dayjs2(cfg) {
    this.$L = parseLocale(cfg.locale, null, true);
    this.parse(cfg);
  }
  var _proto = Dayjs2.prototype;
  _proto.parse = function parse(cfg) {
    this.$d = parseDate(cfg);
    this.$x = cfg.x || {};
    this.init();
  };
  _proto.init = function init() {
    var $d = this.$d;
    this.$y = $d.getFullYear();
    this.$M = $d.getMonth();
    this.$D = $d.getDate();
    this.$W = $d.getDay();
    this.$H = $d.getHours();
    this.$m = $d.getMinutes();
    this.$s = $d.getSeconds();
    this.$ms = $d.getMilliseconds();
  };
  _proto.$utils = function $utils() {
    return Utils;
  };
  _proto.isValid = function isValid2() {
    return !(this.$d.toString() === INVALID_DATE_STRING);
  };
  _proto.isSame = function isSame(that, units) {
    var other = dayjs(that);
    return this.startOf(units) <= other && other <= this.endOf(units);
  };
  _proto.isAfter = function isAfter(that, units) {
    return dayjs(that) < this.startOf(units);
  };
  _proto.isBefore = function isBefore(that, units) {
    return this.endOf(units) < dayjs(that);
  };
  _proto.$g = function $g(input, get, set) {
    if (Utils.u(input))
      return this[get];
    return this.set(set, input);
  };
  _proto.unix = function unix() {
    return Math.floor(this.valueOf() / 1e3);
  };
  _proto.valueOf = function valueOf() {
    return this.$d.getTime();
  };
  _proto.startOf = function startOf(units, _startOf) {
    var _this = this;
    var isStartOf = !Utils.u(_startOf) ? _startOf : true;
    var unit = Utils.p(units);
    var instanceFactory = function instanceFactory2(d, m) {
      var ins = Utils.w(_this.$u ? Date.UTC(_this.$y, m, d) : new Date(_this.$y, m, d), _this);
      return isStartOf ? ins : ins.endOf(D);
    };
    var instanceFactorySet = function instanceFactorySet2(method, slice) {
      var argumentStart = [0, 0, 0, 0];
      var argumentEnd = [23, 59, 59, 999];
      return Utils.w(_this.toDate()[method].apply(_this.toDate("s"), (isStartOf ? argumentStart : argumentEnd).slice(slice)), _this);
    };
    var $W = this.$W, $M = this.$M, $D = this.$D;
    var utcPad = "set" + (this.$u ? "UTC" : "");
    switch (unit) {
      case Y:
        return isStartOf ? instanceFactory(1, 0) : instanceFactory(31, 11);
      case M:
        return isStartOf ? instanceFactory(1, $M) : instanceFactory(0, $M + 1);
      case W: {
        var weekStart = this.$locale().weekStart || 0;
        var gap = ($W < weekStart ? $W + 7 : $W) - weekStart;
        return instanceFactory(isStartOf ? $D - gap : $D + (6 - gap), $M);
      }
      case D:
      case DATE:
        return instanceFactorySet(utcPad + "Hours", 0);
      case H:
        return instanceFactorySet(utcPad + "Minutes", 1);
      case MIN:
        return instanceFactorySet(utcPad + "Seconds", 2);
      case S:
        return instanceFactorySet(utcPad + "Milliseconds", 3);
      default:
        return this.clone();
    }
  };
  _proto.endOf = function endOf(arg) {
    return this.startOf(arg, false);
  };
  _proto.$set = function $set(units, _int) {
    var _C$D$C$DATE$C$M$C$Y$C;
    var unit = Utils.p(units);
    var utcPad = "set" + (this.$u ? "UTC" : "");
    var name = (_C$D$C$DATE$C$M$C$Y$C = {}, _C$D$C$DATE$C$M$C$Y$C[D] = utcPad + "Date", _C$D$C$DATE$C$M$C$Y$C[DATE] = utcPad + "Date", _C$D$C$DATE$C$M$C$Y$C[M] = utcPad + "Month", _C$D$C$DATE$C$M$C$Y$C[Y] = utcPad + "FullYear", _C$D$C$DATE$C$M$C$Y$C[H] = utcPad + "Hours", _C$D$C$DATE$C$M$C$Y$C[MIN] = utcPad + "Minutes", _C$D$C$DATE$C$M$C$Y$C[S] = utcPad + "Seconds", _C$D$C$DATE$C$M$C$Y$C[MS] = utcPad + "Milliseconds", _C$D$C$DATE$C$M$C$Y$C)[unit];
    var arg = unit === D ? this.$D + (_int - this.$W) : _int;
    if (unit === M || unit === Y) {
      var date = this.clone().set(DATE, 1);
      date.$d[name](arg);
      date.init();
      this.$d = date.set(DATE, Math.min(this.$D, date.daysInMonth())).$d;
    } else if (name)
      this.$d[name](arg);
    this.init();
    return this;
  };
  _proto.set = function set(string, _int2) {
    return this.clone().$set(string, _int2);
  };
  _proto.get = function get(unit) {
    return this[Utils.p(unit)]();
  };
  _proto.add = function add(number, units) {
    var _this2 = this, _C$MIN$C$H$C$S$unit;
    number = Number(number);
    var unit = Utils.p(units);
    var instanceFactorySet = function instanceFactorySet2(n) {
      var d = dayjs(_this2);
      return Utils.w(d.date(d.date() + Math.round(n * number)), _this2);
    };
    if (unit === M) {
      return this.set(M, this.$M + number);
    }
    if (unit === Y) {
      return this.set(Y, this.$y + number);
    }
    if (unit === D) {
      return instanceFactorySet(1);
    }
    if (unit === W) {
      return instanceFactorySet(7);
    }
    var step = (_C$MIN$C$H$C$S$unit = {}, _C$MIN$C$H$C$S$unit[MIN] = MILLISECONDS_A_MINUTE, _C$MIN$C$H$C$S$unit[H] = MILLISECONDS_A_HOUR, _C$MIN$C$H$C$S$unit[S] = MILLISECONDS_A_SECOND, _C$MIN$C$H$C$S$unit)[unit] || 1;
    var nextTimeStamp = this.$d.getTime() + number * step;
    return Utils.w(nextTimeStamp, this);
  };
  _proto.subtract = function subtract(number, string) {
    return this.add(number * -1, string);
  };
  _proto.format = function format2(formatStr) {
    var _this3 = this;
    var locale = this.$locale();
    if (!this.isValid())
      return locale.invalidDate || INVALID_DATE_STRING;
    var str = formatStr || FORMAT_DEFAULT;
    var zoneStr = Utils.z(this);
    var $H = this.$H, $m = this.$m, $M = this.$M;
    var weekdays = locale.weekdays, months = locale.months, meridiem = locale.meridiem;
    var getShort = function getShort2(arr, index, full, length) {
      return arr && (arr[index] || arr(_this3, str)) || full[index].slice(0, length);
    };
    var get$H = function get$H2(num) {
      return Utils.s($H % 12 || 12, num, "0");
    };
    var meridiemFunc = meridiem || function(hour, minute, isLowercase) {
      var m = hour < 12 ? "AM" : "PM";
      return isLowercase ? m.toLowerCase() : m;
    };
    var matches = {
      YY: String(this.$y).slice(-2),
      YYYY: this.$y,
      M: $M + 1,
      MM: Utils.s($M + 1, 2, "0"),
      MMM: getShort(locale.monthsShort, $M, months, 3),
      MMMM: getShort(months, $M),
      D: this.$D,
      DD: Utils.s(this.$D, 2, "0"),
      d: String(this.$W),
      dd: getShort(locale.weekdaysMin, this.$W, weekdays, 2),
      ddd: getShort(locale.weekdaysShort, this.$W, weekdays, 3),
      dddd: weekdays[this.$W],
      H: String($H),
      HH: Utils.s($H, 2, "0"),
      h: get$H(1),
      hh: get$H(2),
      a: meridiemFunc($H, $m, true),
      A: meridiemFunc($H, $m, false),
      m: String($m),
      mm: Utils.s($m, 2, "0"),
      s: String(this.$s),
      ss: Utils.s(this.$s, 2, "0"),
      SSS: Utils.s(this.$ms, 3, "0"),
      Z: zoneStr
    };
    return str.replace(REGEX_FORMAT, function(match, $1) {
      return $1 || matches[match] || zoneStr.replace(":", "");
    });
  };
  _proto.utcOffset = function utcOffset() {
    return -Math.round(this.$d.getTimezoneOffset() / 15) * 15;
  };
  _proto.diff = function diff(input, units, _float) {
    var _C$Y$C$M$C$Q$C$W$C$D$;
    var unit = Utils.p(units);
    var that = dayjs(input);
    var zoneDelta = (that.utcOffset() - this.utcOffset()) * MILLISECONDS_A_MINUTE;
    var diff2 = this - that;
    var result = Utils.m(this, that);
    result = (_C$Y$C$M$C$Q$C$W$C$D$ = {}, _C$Y$C$M$C$Q$C$W$C$D$[Y] = result / 12, _C$Y$C$M$C$Q$C$W$C$D$[M] = result, _C$Y$C$M$C$Q$C$W$C$D$[Q] = result / 3, _C$Y$C$M$C$Q$C$W$C$D$[W] = (diff2 - zoneDelta) / MILLISECONDS_A_WEEK, _C$Y$C$M$C$Q$C$W$C$D$[D] = (diff2 - zoneDelta) / MILLISECONDS_A_DAY, _C$Y$C$M$C$Q$C$W$C$D$[H] = diff2 / MILLISECONDS_A_HOUR, _C$Y$C$M$C$Q$C$W$C$D$[MIN] = diff2 / MILLISECONDS_A_MINUTE, _C$Y$C$M$C$Q$C$W$C$D$[S] = diff2 / MILLISECONDS_A_SECOND, _C$Y$C$M$C$Q$C$W$C$D$)[unit] || diff2;
    return _float ? result : Utils.a(result);
  };
  _proto.daysInMonth = function daysInMonth() {
    return this.endOf(M).$D;
  };
  _proto.$locale = function $locale() {
    return Ls[this.$L];
  };
  _proto.locale = function locale(preset, object) {
    if (!preset)
      return this.$L;
    var that = this.clone();
    var nextLocaleName = parseLocale(preset, object, true);
    if (nextLocaleName)
      that.$L = nextLocaleName;
    return that;
  };
  _proto.clone = function clone() {
    return Utils.w(this.$d, this);
  };
  _proto.toDate = function toDate() {
    return new Date(this.valueOf());
  };
  _proto.toJSON = function toJSON() {
    return this.isValid() ? this.toISOString() : null;
  };
  _proto.toISOString = function toISOString() {
    return this.$d.toISOString();
  };
  _proto.toString = function toString() {
    return this.$d.toUTCString();
  };
  return Dayjs2;
}();
var proto = Dayjs.prototype;
dayjs.prototype = proto;
[["$ms", MS], ["$s", S], ["$m", MIN], ["$H", H], ["$W", D], ["$M", M], ["$y", Y], ["$D", DATE]].forEach(function(g) {
  proto[g[1]] = function(input) {
    return this.$g(input, g[0], g[1]);
  };
});
dayjs.extend = function(plugin, option2) {
  if (!plugin.$i) {
    plugin(option2, Dayjs, dayjs);
    plugin.$i = true;
  }
  return dayjs;
};
dayjs.locale = parseLocale;
dayjs.isDayjs = isDayjs;
dayjs.unix = function(timestamp) {
  return dayjs(timestamp * 1e3);
};
dayjs.en = Ls[L];
dayjs.Ls = Ls;
dayjs.p = {};
var esm_default = dayjs;

// packages/forms/resources/js/components/date-time-picker.js
var import_customParseFormat = __toModule(require_customParseFormat());
var import_localeData = __toModule(require_localeData());
var import_timezone = __toModule(require_timezone());
var import_utc = __toModule(require_utc());
esm_default.extend(import_customParseFormat.default);
esm_default.extend(import_localeData.default);
esm_default.extend(import_timezone.default);
esm_default.extend(import_utc.default);
esm_default.extend((option2, Dayjs2, dayjs3) => {
  const listeners = [];
  dayjs3.addLocaleListeners = (listener) => listeners.push(listener);
  dayjs3.onLocaleUpdated = () => {
    listeners.forEach((listener) => listener());
  };
  dayjs3.updateLocale = (locale) => {
    dayjs3.locale(locale);
    dayjs3.onLocaleUpdated();
  };
});
window.dayjs = esm_default;
var date_time_picker_default = (Alpine) => {
  Alpine.data("dateTimePickerFormComponent", ({
    displayFormat,
    firstDayOfWeek,
    format: format2,
    isAutofocused,
    maxDate,
    minDate,
    state
  }) => {
    const timezone2 = esm_default.tz.guess();
    return {
      daysInFocusedMonth: [],
      displayText: "",
      emptyDaysInFocusedMonth: [],
      focusedDate: null,
      focusedMonth: null,
      focusedYear: null,
      hour: null,
      maxDate,
      minDate,
      minute: null,
      open: false,
      second: null,
      state,
      dayLabels: [],
      months: [],
      init: function() {
        this.focusedDate = esm_default().tz(timezone2);
        this.maxDate = esm_default(this.maxDate);
        if (!this.maxDate.isValid()) {
          this.maxDate = null;
        }
        this.minDate = esm_default(this.minDate);
        if (!this.minDate.isValid()) {
          this.minDate = null;
        }
        let date = this.getSelectedDate() ?? esm_default().tz(timezone2).hour(0).minute(0).second(0);
        if (this.maxDate !== null && date.isAfter(this.maxDate)) {
          date = null;
        } else if (this.minDate !== null && date.isBefore(this.minDate)) {
          date = null;
        }
        this.hour = date?.hour() ?? 0;
        this.minute = date?.minute() ?? 0;
        this.second = date?.second() ?? 0;
        this.setDisplayText();
        this.setMonths();
        this.setDayLabels();
        if (isAutofocused) {
          this.openPicker();
        }
        esm_default.addLocaleListeners(() => {
          this.setDisplayText();
          this.setMonths();
          this.setDayLabels();
        });
        this.$watch("focusedMonth", () => {
          this.focusedMonth = +this.focusedMonth;
          if (this.focusedDate.month() === this.focusedMonth) {
            return;
          }
          this.focusedDate = this.focusedDate.month(this.focusedMonth);
        });
        this.$watch("focusedYear", () => {
          if (this.focusedYear?.length > 4) {
            this.focusedYear = this.focusedYear.substring(0, 4);
          }
          if (!this.focusedYear || this.focusedYear?.length !== 4) {
            return;
          }
          let year = +this.focusedYear;
          if (!Number.isInteger(year)) {
            year = esm_default().tz(timezone2).year();
            this.focusedYear = year;
          }
          if (this.focusedDate.year() === year) {
            return;
          }
          this.focusedDate = this.focusedDate.year(year);
        });
        this.$watch("focusedDate", () => {
          let month = this.focusedDate.month();
          let year = this.focusedDate.year();
          if (this.focusedMonth !== month) {
            this.focusedMonth = month;
          }
          if (this.focusedYear !== year) {
            this.focusedYear = year;
          }
          this.setupDaysGrid();
          this.$nextTick(() => {
            this.evaluatePosition();
          });
        });
        this.$watch("hour", () => {
          let hour = +this.hour;
          if (!Number.isInteger(hour)) {
            this.hour = 0;
          } else if (hour > 23) {
            this.hour = 0;
          } else if (hour < 0) {
            this.hour = 23;
          } else {
            this.hour = hour;
          }
          let date2 = this.getSelectedDate() ?? this.focusedDate;
          this.setState(date2.hour(this.hour ?? 0));
        });
        this.$watch("minute", () => {
          let minute = +this.minute;
          if (!Number.isInteger(minute)) {
            this.minute = 0;
          } else if (minute > 59) {
            this.minute = 0;
          } else if (minute < 0) {
            this.minute = 59;
          } else {
            this.minute = minute;
          }
          let date2 = this.getSelectedDate() ?? this.focusedDate;
          this.setState(date2.minute(this.minute ?? 0));
        });
        this.$watch("second", () => {
          let second = +this.second;
          if (!Number.isInteger(second)) {
            this.second = 0;
          } else if (second > 59) {
            this.second = 0;
          } else if (second < 0) {
            this.second = 59;
          } else {
            this.second = second;
          }
          let date2 = this.getSelectedDate() ?? this.focusedDate;
          this.setState(date2.second(this.second ?? 0));
        });
        this.$watch("state", () => {
          let date2 = this.getSelectedDate();
          if (this.maxDate !== null && date2.isAfter(this.maxDate)) {
            date2 = null;
          }
          if (this.minDate !== null && date2.isBefore(this.minDate)) {
            date2 = null;
          }
          this.hour = date2?.hour() ?? 0;
          this.minute = date2?.minute() ?? 0;
          this.second = date2?.second() ?? 0;
          this.setDisplayText();
        });
      },
      clearState: function() {
        this.setState(null);
        this.closePicker();
      },
      closePicker: function() {
        this.open = false;
      },
      dateIsDisabled: function(date) {
        if (this.maxDate && date.isAfter(this.maxDate)) {
          return true;
        }
        if (this.minDate && date.isBefore(this.minDate)) {
          return true;
        }
        return false;
      },
      dayIsDisabled: function(day) {
        this.focusedDate ??= esm_default().tz(timezone2);
        return this.dateIsDisabled(this.focusedDate.date(day));
      },
      dayIsSelected: function(day) {
        let selectedDate = this.getSelectedDate();
        if (selectedDate === null) {
          return false;
        }
        this.focusedDate ??= esm_default().tz(timezone2);
        return selectedDate.date() === day && selectedDate.month() === this.focusedDate.month() && selectedDate.year() === this.focusedDate.year();
      },
      dayIsToday: function(day) {
        let date = esm_default().tz(timezone2);
        this.focusedDate ??= date;
        return date.date() === day && date.month() === this.focusedDate.month() && date.year() === this.focusedDate.year();
      },
      evaluatePosition: function() {
        let availableHeight = window.innerHeight - this.$refs.button.offsetHeight;
        let element = this.$refs.button;
        while (element) {
          availableHeight -= element.offsetTop;
          element = element.offsetParent;
        }
        if (this.$refs.picker.offsetHeight <= availableHeight) {
          this.$refs.picker.style.bottom = "auto";
          return;
        }
        this.$refs.picker.style.bottom = `${this.$refs.button.offsetHeight}px`;
      },
      focusPreviousDay: function() {
        this.focusedDate ??= esm_default().tz(timezone2);
        this.focusedDate = this.focusedDate.subtract(1, "day");
      },
      focusPreviousWeek: function() {
        this.focusedDate ??= esm_default().tz(timezone2);
        this.focusedDate = this.focusedDate.subtract(1, "week");
      },
      focusNextDay: function() {
        this.focusedDate ??= esm_default().tz(timezone2);
        this.focusedDate = this.focusedDate.add(1, "day");
      },
      focusNextWeek: function() {
        this.focusedDate ??= esm_default().tz(timezone2);
        this.focusedDate = this.focusedDate.add(1, "week");
      },
      getDayLabels: function() {
        const labels = esm_default.weekdaysShort();
        if (firstDayOfWeek === 0) {
          return labels;
        }
        return [
          ...labels.slice(firstDayOfWeek),
          ...labels.slice(0, firstDayOfWeek)
        ];
      },
      getSelectedDate: function() {
        let date = esm_default(this.state, format2);
        if (!date.isValid()) {
          return null;
        }
        return date;
      },
      openPicker: function() {
        this.focusedDate = this.getSelectedDate() ?? esm_default().tz(timezone2);
        this.setupDaysGrid();
        this.open = true;
        this.$nextTick(() => {
          this.evaluatePosition();
        });
      },
      selectDate: function(day = null) {
        if (day) {
          this.setFocusedDay(day);
        }
        this.focusedDate ??= esm_default().tz(timezone2);
        this.setState(this.focusedDate);
      },
      setDisplayText: function() {
        this.displayText = this.getSelectedDate() ? this.getSelectedDate().format(displayFormat) : "";
      },
      setMonths: function() {
        this.months = esm_default.months();
      },
      setDayLabels: function() {
        this.dayLabels = this.getDayLabels();
      },
      setupDaysGrid: function() {
        this.focusedDate ??= esm_default().tz(timezone2);
        this.emptyDaysInFocusedMonth = Array.from({
          length: this.focusedDate.date(8 - firstDayOfWeek).day()
        }, (_, i) => i + 1);
        this.daysInFocusedMonth = Array.from({
          length: this.focusedDate.daysInMonth()
        }, (_, i) => i + 1);
      },
      setFocusedDay: function(day) {
        this.focusedDate = (this.focusedDate ?? esm_default().tz(timezone2)).date(day);
      },
      setState: function(date) {
        if (date === null) {
          this.state = null;
          this.setDisplayText();
          return;
        } else {
          if (this.dateIsDisabled(date)) {
            return;
          }
        }
        this.state = date.hour(this.hour ?? 0).minute(this.minute ?? 0).second(this.second ?? 0).format(format2);
        this.setDisplayText();
      },
      togglePickerVisibility: function() {
        if (this.open) {
          this.closePicker();
          return;
        }
        this.openPicker();
      }
    };
  });
};

// packages/forms/resources/js/components/file-upload.js
var FilePond = __toModule(require_filepond());
var import_filepond_plugin_file_validate_size = __toModule(require_filepond_plugin_file_validate_size());
var import_filepond_plugin_file_validate_type = __toModule(require_filepond_plugin_file_validate_type());
var import_filepond_plugin_image_crop = __toModule(require_filepond_plugin_image_crop());
var import_filepond_plugin_image_exif_orientation = __toModule(require_filepond_plugin_image_exif_orientation());
var import_filepond_plugin_image_preview = __toModule(require_filepond_plugin_image_preview());
var import_filepond_plugin_image_resize = __toModule(require_filepond_plugin_image_resize());
var import_filepond_plugin_image_transform = __toModule(require_filepond_plugin_image_transform());
var import_filepond_plugin_media_preview = __toModule(require_filepond_plugin_media_preview());
FilePond.registerPlugin(import_filepond_plugin_file_validate_size.default);
FilePond.registerPlugin(import_filepond_plugin_file_validate_type.default);
FilePond.registerPlugin(import_filepond_plugin_image_crop.default);
FilePond.registerPlugin(import_filepond_plugin_image_exif_orientation.default);
FilePond.registerPlugin(import_filepond_plugin_image_preview.default);
FilePond.registerPlugin(import_filepond_plugin_image_resize.default);
FilePond.registerPlugin(import_filepond_plugin_image_transform.default);
FilePond.registerPlugin(import_filepond_plugin_media_preview.default);
window.FilePond = FilePond;
var file_upload_default = (Alpine) => {
  Alpine.data("fileUploadFormComponent", ({
    acceptedFileTypes,
    canReorder,
    canPreview,
    deleteUploadedFileUsing,
    getUploadedFileUrlsUsing,
    imageCropAspectRatio,
    imagePreviewHeight,
    imageResizeTargetHeight,
    imageResizeTargetWidth,
    loadingIndicatorPosition,
    panelAspectRatio,
    panelLayout,
    placeholder,
    maxSize,
    minSize,
    removeUploadedFileButtonPosition,
    removeUploadedFileUsing,
    reorderUploadedFilesUsing,
    shouldAppendFiles,
    state,
    uploadButtonPosition,
    uploadProgressIndicatorPosition,
    uploadUsing
  }) => {
    return {
      fileKeyIndex: {},
      pond: null,
      shouldUpdateState: true,
      state,
      uploadedFileUrlIndex: {},
      init: async function() {
        this.pond = FilePond.create(this.$refs.input, {
          acceptedFileTypes,
          allowReorder: canReorder,
          allowImagePreview: canPreview,
          allowVideoPreview: canPreview,
          allowAudioPreview: canPreview,
          credits: false,
          files: await this.getFiles(),
          imageCropAspectRatio,
          imagePreviewHeight,
          imageResizeTargetHeight,
          imageResizeTargetWidth,
          itemInsertLocation: shouldAppendFiles ? "after" : "before",
          ...placeholder && {labelIdle: placeholder},
          maxFileSize: maxSize,
          minFileSize: minSize,
          styleButtonProcessItemPosition: uploadButtonPosition,
          styleButtonRemoveItemPosition: removeUploadedFileButtonPosition,
          styleLoadIndicatorPosition: loadingIndicatorPosition,
          stylePanelAspectRatio: panelAspectRatio,
          stylePanelLayout: panelLayout,
          styleProgressIndicatorPosition: uploadProgressIndicatorPosition,
          server: {
            load: async (source, load) => {
              let response = await fetch(source);
              let blob = await response.blob();
              load(blob);
            },
            process: (fieldName, file, metadata, load, error, progress) => {
              this.shouldUpdateState = false;
              let fileKey = ([1e7] + -1e3 + -4e3 + -8e3 + -1e11).replace(/[018]/g, (c) => (c ^ crypto.getRandomValues(new Uint8Array(1))[0] & 15 >> c / 4).toString(16));
              uploadUsing(fileKey, file, (fileKey2) => {
                this.shouldUpdateState = true;
                load(fileKey2);
              }, error, progress);
            },
            remove: async (source, load) => {
              let fileKey = this.uploadedFileUrlIndex[source] ?? null;
              if (!fileKey) {
                return;
              }
              await deleteUploadedFileUsing(fileKey);
              load();
            },
            revert: async (uniqueFileId, load) => {
              await removeUploadedFileUsing(uniqueFileId);
              load();
            }
          }
        });
        this.$watch("state", async () => {
          if (!this.shouldUpdateState) {
            return;
          }
          if (Object.values(this.state).filter((file) => file.startsWith("livewire-file:")).length) {
            return;
          }
          this.pond.files = await this.getFiles();
        });
        this.pond.on("reorderfiles", async (files) => {
          const orderedFileKeys = files.map((file) => file.source instanceof File ? file.serverId : this.uploadedFileUrlIndex[file.source] ?? null).filter((fileKey) => fileKey);
          await reorderUploadedFilesUsing(shouldAppendFiles ? orderedFileKeys : orderedFileKeys.reverse());
        });
      },
      getUploadedFileUrls: async function() {
        const uploadedFileUrls = await getUploadedFileUrlsUsing();
        this.fileKeyIndex = uploadedFileUrls ?? {};
        this.uploadedFileUrlIndex = Object.entries(this.fileKeyIndex).filter((value) => value).reduce((obj, [key, value]) => {
          obj[value] = key;
          return obj;
        }, {});
      },
      getFiles: async function() {
        await this.getUploadedFileUrls();
        let files = [];
        for (const uploadedFileUrl of Object.values(this.fileKeyIndex)) {
          if (!uploadedFileUrl) {
            continue;
          }
          files.push({
            source: uploadedFileUrl,
            options: {
              type: "local"
            }
          });
        }
        return shouldAppendFiles ? files : files.reverse();
      }
    };
  });
};

// packages/forms/resources/js/components/key-value.js
var key_value_default = (Alpine) => {
  Alpine.data("keyValueFormComponent", ({
    state
  }) => ({
    state,
    rows: [],
    shouldUpdateRows: true,
    init: function() {
      this.updateRows();
      if (this.rows.length <= 0) {
        this.addRow();
      }
      this.$watch("state", () => {
        if (!this.shouldUpdateRows) {
          this.shouldUpdateRows = true;
          return;
        }
        this.updateRows();
      });
    },
    addRow: function() {
      this.rows.push({key: "", value: ""});
      this.updateState();
    },
    deleteRow: function(index) {
      this.rows.splice(index, 1);
      if (this.rows.length <= 0) {
        this.addRow();
      }
      this.updateState();
      this.shouldUpdateRows = true;
    },
    updateRows: function() {
      let rows = [];
      for (let [key, value] of Object.entries(this.state ?? {})) {
        rows.push({
          key,
          value
        });
      }
      this.rows = rows;
    },
    updateState: function() {
      let state2 = {};
      this.rows.forEach((row) => {
        if (row.key === "" || row.key === null) {
          return;
        }
        state2[row.key] = row.value;
      });
      this.shouldUpdateRows = false;
      this.state = state2;
    }
  }));
};

// packages/forms/resources/js/components/markdown-editor.js
var import_file_attachment_element = __toModule(require_index_umd());

// node_modules/@github/markdown-toolbar-element/dist/index.js
var buttonSelectors = [
  "[data-md-button]",
  "md-header",
  "md-bold",
  "md-italic",
  "md-quote",
  "md-code",
  "md-link",
  "md-image",
  "md-unordered-list",
  "md-ordered-list",
  "md-task-list",
  "md-mention",
  "md-ref",
  "md-strikethrough"
];
function getButtons(toolbar) {
  const els = [];
  for (const button of toolbar.querySelectorAll(buttonSelectors.join(", "))) {
    if (button.hidden || button.offsetWidth <= 0 && button.offsetHeight <= 0)
      continue;
    if (button.closest("markdown-toolbar") === toolbar)
      els.push(button);
  }
  return els;
}
function keydown(fn) {
  return function(event) {
    if (event.key === " " || event.key === "Enter") {
      event.preventDefault();
      fn(event);
    }
  };
}
var styles = new WeakMap();
var MarkdownButtonElement = class extends HTMLElement {
  constructor() {
    super();
    const apply = () => {
      const style = styles.get(this);
      if (!style)
        return;
      applyStyle(this, style);
    };
    this.addEventListener("keydown", keydown(apply));
    this.addEventListener("click", apply);
  }
  connectedCallback() {
    if (!this.hasAttribute("role")) {
      this.setAttribute("role", "button");
    }
  }
  click() {
    const style = styles.get(this);
    if (!style)
      return;
    applyStyle(this, style);
  }
};
var MarkdownHeaderButtonElement = class extends MarkdownButtonElement {
  constructor() {
    super();
    const level = parseInt(this.getAttribute("level") || "3", 10);
    if (level < 1 || level > 6) {
      return;
    }
    const prefix = `${"#".repeat(level)} `;
    styles.set(this, {
      prefix
    });
  }
};
if (!window.customElements.get("md-header")) {
  window.MarkdownHeaderButtonElement = MarkdownHeaderButtonElement;
  window.customElements.define("md-header", MarkdownHeaderButtonElement);
}
var MarkdownBoldButtonElement = class extends MarkdownButtonElement {
  constructor() {
    super();
    styles.set(this, {prefix: "**", suffix: "**", trimFirst: true});
  }
  connectedCallback() {
    super.connectedCallback();
    this.setAttribute("hotkey", "b");
  }
};
if (!window.customElements.get("md-bold")) {
  window.MarkdownBoldButtonElement = MarkdownBoldButtonElement;
  window.customElements.define("md-bold", MarkdownBoldButtonElement);
}
var MarkdownItalicButtonElement = class extends MarkdownButtonElement {
  constructor() {
    super();
    styles.set(this, {prefix: "_", suffix: "_", trimFirst: true});
  }
  connectedCallback() {
    super.connectedCallback();
    this.setAttribute("hotkey", "i");
  }
};
if (!window.customElements.get("md-italic")) {
  window.MarkdownItalicButtonElement = MarkdownItalicButtonElement;
  window.customElements.define("md-italic", MarkdownItalicButtonElement);
}
var MarkdownQuoteButtonElement = class extends MarkdownButtonElement {
  constructor() {
    super();
    styles.set(this, {prefix: "> ", multiline: true, surroundWithNewlines: true});
  }
  connectedCallback() {
    super.connectedCallback();
    this.setAttribute("hotkey", ".");
    this.setAttribute("hotkey-requires-shift", "true");
  }
};
if (!window.customElements.get("md-quote")) {
  window.MarkdownQuoteButtonElement = MarkdownQuoteButtonElement;
  window.customElements.define("md-quote", MarkdownQuoteButtonElement);
}
var MarkdownCodeButtonElement = class extends MarkdownButtonElement {
  constructor() {
    super();
    styles.set(this, {prefix: "`", suffix: "`", blockPrefix: "```", blockSuffix: "```"});
  }
  connectedCallback() {
    super.connectedCallback();
    this.setAttribute("hotkey", "e");
  }
};
if (!window.customElements.get("md-code")) {
  window.MarkdownCodeButtonElement = MarkdownCodeButtonElement;
  window.customElements.define("md-code", MarkdownCodeButtonElement);
}
var MarkdownLinkButtonElement = class extends MarkdownButtonElement {
  constructor() {
    super();
    styles.set(this, {prefix: "[", suffix: "](url)", replaceNext: "url", scanFor: "https?://"});
  }
  connectedCallback() {
    super.connectedCallback();
    this.setAttribute("hotkey", "k");
  }
};
if (!window.customElements.get("md-link")) {
  window.MarkdownLinkButtonElement = MarkdownLinkButtonElement;
  window.customElements.define("md-link", MarkdownLinkButtonElement);
}
var MarkdownImageButtonElement = class extends MarkdownButtonElement {
  constructor() {
    super();
    styles.set(this, {prefix: "![", suffix: "](url)", replaceNext: "url", scanFor: "https?://"});
  }
};
if (!window.customElements.get("md-image")) {
  window.MarkdownImageButtonElement = MarkdownImageButtonElement;
  window.customElements.define("md-image", MarkdownImageButtonElement);
}
var MarkdownUnorderedListButtonElement = class extends MarkdownButtonElement {
  constructor() {
    super();
    styles.set(this, {prefix: "- ", multiline: true, surroundWithNewlines: true});
  }
  connectedCallback() {
    super.connectedCallback();
    this.setAttribute("hotkey", "8");
    this.setAttribute("hotkey-requires-shift", "true");
  }
};
if (!window.customElements.get("md-unordered-list")) {
  window.MarkdownUnorderedListButtonElement = MarkdownUnorderedListButtonElement;
  window.customElements.define("md-unordered-list", MarkdownUnorderedListButtonElement);
}
var MarkdownOrderedListButtonElement = class extends MarkdownButtonElement {
  constructor() {
    super();
    styles.set(this, {prefix: "1. ", multiline: true, orderedList: true});
  }
  connectedCallback() {
    super.connectedCallback();
    this.setAttribute("hotkey", "7");
    this.setAttribute("hotkey-requires-shift", "true");
  }
};
if (!window.customElements.get("md-ordered-list")) {
  window.MarkdownOrderedListButtonElement = MarkdownOrderedListButtonElement;
  window.customElements.define("md-ordered-list", MarkdownOrderedListButtonElement);
}
var MarkdownTaskListButtonElement = class extends MarkdownButtonElement {
  constructor() {
    super();
    styles.set(this, {prefix: "- [ ] ", multiline: true, surroundWithNewlines: true});
  }
  connectedCallback() {
    super.connectedCallback();
    this.setAttribute("hotkey", "L");
  }
};
if (!window.customElements.get("md-task-list")) {
  window.MarkdownTaskListButtonElement = MarkdownTaskListButtonElement;
  window.customElements.define("md-task-list", MarkdownTaskListButtonElement);
}
var MarkdownMentionButtonElement = class extends MarkdownButtonElement {
  constructor() {
    super();
    styles.set(this, {prefix: "@", prefixSpace: true});
  }
};
if (!window.customElements.get("md-mention")) {
  window.MarkdownMentionButtonElement = MarkdownMentionButtonElement;
  window.customElements.define("md-mention", MarkdownMentionButtonElement);
}
var MarkdownRefButtonElement = class extends MarkdownButtonElement {
  constructor() {
    super();
    styles.set(this, {prefix: "#", prefixSpace: true});
  }
};
if (!window.customElements.get("md-ref")) {
  window.MarkdownRefButtonElement = MarkdownRefButtonElement;
  window.customElements.define("md-ref", MarkdownRefButtonElement);
}
var MarkdownStrikethroughButtonElement = class extends MarkdownButtonElement {
  constructor() {
    super();
    styles.set(this, {prefix: "~~", suffix: "~~", trimFirst: true});
  }
};
if (!window.customElements.get("md-strikethrough")) {
  window.MarkdownStrikethroughButtonElement = MarkdownStrikethroughButtonElement;
  window.customElements.define("md-strikethrough", MarkdownStrikethroughButtonElement);
}
var modifierKey = navigator.userAgent.match(/Macintosh/) ? "Meta" : "Control";
var MarkdownToolbarElement = class extends HTMLElement {
  constructor() {
    super();
  }
  connectedCallback() {
    if (!this.hasAttribute("role")) {
      this.setAttribute("role", "toolbar");
    }
    this.addEventListener("keydown", focusKeydown);
    const fn = shortcut.bind(null, this);
    if (this.field) {
      this.field.addEventListener("keydown", fn);
      shortcutListeners.set(this, fn);
    }
    this.setAttribute("tabindex", "0");
    this.addEventListener("focus", onToolbarFocus, {once: true});
  }
  disconnectedCallback() {
    const fn = shortcutListeners.get(this);
    if (fn && this.field) {
      this.field.removeEventListener("keydown", fn);
      shortcutListeners.delete(this);
    }
    this.removeEventListener("keydown", focusKeydown);
  }
  get field() {
    const id = this.getAttribute("for");
    if (!id)
      return null;
    const root = "getRootNode" in this ? this.getRootNode() : document;
    let field;
    if (root instanceof Document || root instanceof ShadowRoot) {
      field = root.getElementById(id);
    }
    return field instanceof HTMLTextAreaElement ? field : null;
  }
};
function onToolbarFocus({target}) {
  if (!(target instanceof Element))
    return;
  target.removeAttribute("tabindex");
  let tabindex = "0";
  for (const button of getButtons(target)) {
    button.setAttribute("tabindex", tabindex);
    if (tabindex === "0") {
      button.focus();
      tabindex = "-1";
    }
  }
}
function focusKeydown(event) {
  const key = event.key;
  if (key !== "ArrowRight" && key !== "ArrowLeft" && key !== "Home" && key !== "End")
    return;
  const toolbar = event.currentTarget;
  if (!(toolbar instanceof HTMLElement))
    return;
  const buttons = getButtons(toolbar);
  const index = buttons.indexOf(event.target);
  const length = buttons.length;
  if (index === -1)
    return;
  let n = 0;
  if (key === "ArrowLeft")
    n = index - 1;
  if (key === "ArrowRight")
    n = index + 1;
  if (key === "End")
    n = length - 1;
  if (n < 0)
    n = length - 1;
  if (n > length - 1)
    n = 0;
  for (let i = 0; i < length; i += 1) {
    buttons[i].setAttribute("tabindex", i === n ? "0" : "-1");
  }
  event.preventDefault();
  buttons[n].focus();
}
var shortcutListeners = new WeakMap();
function elementHotkeyRequiresShift(element) {
  return element.hasAttribute("hotkey-requires-shift") && element.getAttribute("hotkey-requires-shift") !== "false";
}
function findHotkey(toolbar, key, shiftPressed) {
  for (const el of toolbar.querySelectorAll("[hotkey]")) {
    if (el.getAttribute("hotkey") === key && (!elementHotkeyRequiresShift(el) || shiftPressed)) {
      return el;
    }
  }
  return null;
}
function shortcut(toolbar, event) {
  if (event.metaKey && modifierKey === "Meta" || event.ctrlKey && modifierKey === "Control") {
    const key = event.shiftKey ? event.key.toUpperCase() : event.key;
    const button = findHotkey(toolbar, key, event.shiftKey);
    if (button) {
      button.click();
      event.preventDefault();
    }
  }
}
if (!window.customElements.get("markdown-toolbar")) {
  window.MarkdownToolbarElement = MarkdownToolbarElement;
  window.customElements.define("markdown-toolbar", MarkdownToolbarElement);
}
function isMultipleLines(string) {
  return string.trim().split("\n").length > 1;
}
function repeat(string, n) {
  return Array(n + 1).join(string);
}
function wordSelectionStart(text, i) {
  let index = i;
  while (text[index] && text[index - 1] != null && !text[index - 1].match(/\s/)) {
    index--;
  }
  return index;
}
function wordSelectionEnd(text, i, multiline) {
  let index = i;
  const breakpoint = multiline ? /\n/ : /\s/;
  while (text[index] && !text[index].match(breakpoint)) {
    index++;
  }
  return index;
}
var canInsertText = null;
function insertText(textarea, {text, selectionStart, selectionEnd}) {
  const originalSelectionStart = textarea.selectionStart;
  const before = textarea.value.slice(0, originalSelectionStart);
  const after = textarea.value.slice(textarea.selectionEnd);
  if (canInsertText === null || canInsertText === true) {
    textarea.contentEditable = "true";
    try {
      canInsertText = document.execCommand("insertText", false, text);
    } catch (error) {
      canInsertText = false;
    }
    textarea.contentEditable = "false";
  }
  if (canInsertText && !textarea.value.slice(0, textarea.selectionStart).endsWith(text)) {
    canInsertText = false;
  }
  if (!canInsertText) {
    try {
      document.execCommand("ms-beginUndoUnit");
    } catch (e) {
    }
    textarea.value = before + text + after;
    try {
      document.execCommand("ms-endUndoUnit");
    } catch (e) {
    }
    textarea.dispatchEvent(new CustomEvent("input", {bubbles: true, cancelable: true}));
  }
  if (selectionStart != null && selectionEnd != null) {
    textarea.setSelectionRange(selectionStart, selectionEnd);
  } else {
    textarea.setSelectionRange(originalSelectionStart, textarea.selectionEnd);
  }
}
function styleSelectedText(textarea, styleArgs) {
  const text = textarea.value.slice(textarea.selectionStart, textarea.selectionEnd);
  let result;
  if (styleArgs.orderedList) {
    result = orderedList(textarea);
  } else if (styleArgs.multiline && isMultipleLines(text)) {
    result = multilineStyle(textarea, styleArgs);
  } else {
    result = blockStyle(textarea, styleArgs);
  }
  insertText(textarea, result);
}
function expandSelectedText(textarea, prefixToUse, suffixToUse, multiline = false) {
  if (textarea.selectionStart === textarea.selectionEnd) {
    textarea.selectionStart = wordSelectionStart(textarea.value, textarea.selectionStart);
    textarea.selectionEnd = wordSelectionEnd(textarea.value, textarea.selectionEnd, multiline);
  } else {
    const expandedSelectionStart = textarea.selectionStart - prefixToUse.length;
    const expandedSelectionEnd = textarea.selectionEnd + suffixToUse.length;
    const beginsWithPrefix = textarea.value.slice(expandedSelectionStart, textarea.selectionStart) === prefixToUse;
    const endsWithSuffix = textarea.value.slice(textarea.selectionEnd, expandedSelectionEnd) === suffixToUse;
    if (beginsWithPrefix && endsWithSuffix) {
      textarea.selectionStart = expandedSelectionStart;
      textarea.selectionEnd = expandedSelectionEnd;
    }
  }
  return textarea.value.slice(textarea.selectionStart, textarea.selectionEnd);
}
function newlinesToSurroundSelectedText(textarea) {
  const beforeSelection = textarea.value.slice(0, textarea.selectionStart);
  const afterSelection = textarea.value.slice(textarea.selectionEnd);
  const breaksBefore = beforeSelection.match(/\n*$/);
  const breaksAfter = afterSelection.match(/^\n*/);
  const newlinesBeforeSelection = breaksBefore ? breaksBefore[0].length : 0;
  const newlinesAfterSelection = breaksAfter ? breaksAfter[0].length : 0;
  let newlinesToAppend;
  let newlinesToPrepend;
  if (beforeSelection.match(/\S/) && newlinesBeforeSelection < 2) {
    newlinesToAppend = repeat("\n", 2 - newlinesBeforeSelection);
  }
  if (afterSelection.match(/\S/) && newlinesAfterSelection < 2) {
    newlinesToPrepend = repeat("\n", 2 - newlinesAfterSelection);
  }
  if (newlinesToAppend == null) {
    newlinesToAppend = "";
  }
  if (newlinesToPrepend == null) {
    newlinesToPrepend = "";
  }
  return {newlinesToAppend, newlinesToPrepend};
}
function blockStyle(textarea, arg) {
  let newlinesToAppend;
  let newlinesToPrepend;
  const {prefix, suffix, blockPrefix, blockSuffix, replaceNext, prefixSpace, scanFor, surroundWithNewlines} = arg;
  const originalSelectionStart = textarea.selectionStart;
  const originalSelectionEnd = textarea.selectionEnd;
  let selectedText = textarea.value.slice(textarea.selectionStart, textarea.selectionEnd);
  let prefixToUse = isMultipleLines(selectedText) && blockPrefix.length > 0 ? `${blockPrefix}
` : prefix;
  let suffixToUse = isMultipleLines(selectedText) && blockSuffix.length > 0 ? `
${blockSuffix}` : suffix;
  if (prefixSpace) {
    const beforeSelection = textarea.value[textarea.selectionStart - 1];
    if (textarea.selectionStart !== 0 && beforeSelection != null && !beforeSelection.match(/\s/)) {
      prefixToUse = ` ${prefixToUse}`;
    }
  }
  selectedText = expandSelectedText(textarea, prefixToUse, suffixToUse, arg.multiline);
  let selectionStart = textarea.selectionStart;
  let selectionEnd = textarea.selectionEnd;
  const hasReplaceNext = replaceNext.length > 0 && suffixToUse.indexOf(replaceNext) > -1 && selectedText.length > 0;
  if (surroundWithNewlines) {
    const ref = newlinesToSurroundSelectedText(textarea);
    newlinesToAppend = ref.newlinesToAppend;
    newlinesToPrepend = ref.newlinesToPrepend;
    prefixToUse = newlinesToAppend + prefix;
    suffixToUse += newlinesToPrepend;
  }
  if (selectedText.startsWith(prefixToUse) && selectedText.endsWith(suffixToUse)) {
    const replacementText = selectedText.slice(prefixToUse.length, selectedText.length - suffixToUse.length);
    if (originalSelectionStart === originalSelectionEnd) {
      let position = originalSelectionStart - prefixToUse.length;
      position = Math.max(position, selectionStart);
      position = Math.min(position, selectionStart + replacementText.length);
      selectionStart = selectionEnd = position;
    } else {
      selectionEnd = selectionStart + replacementText.length;
    }
    return {text: replacementText, selectionStart, selectionEnd};
  } else if (!hasReplaceNext) {
    let replacementText = prefixToUse + selectedText + suffixToUse;
    selectionStart = originalSelectionStart + prefixToUse.length;
    selectionEnd = originalSelectionEnd + prefixToUse.length;
    const whitespaceEdges = selectedText.match(/^\s*|\s*$/g);
    if (arg.trimFirst && whitespaceEdges) {
      const leadingWhitespace = whitespaceEdges[0] || "";
      const trailingWhitespace = whitespaceEdges[1] || "";
      replacementText = leadingWhitespace + prefixToUse + selectedText.trim() + suffixToUse + trailingWhitespace;
      selectionStart += leadingWhitespace.length;
      selectionEnd -= trailingWhitespace.length;
    }
    return {text: replacementText, selectionStart, selectionEnd};
  } else if (scanFor.length > 0 && selectedText.match(scanFor)) {
    suffixToUse = suffixToUse.replace(replaceNext, selectedText);
    const replacementText = prefixToUse + suffixToUse;
    selectionStart = selectionEnd = selectionStart + prefixToUse.length;
    return {text: replacementText, selectionStart, selectionEnd};
  } else {
    const replacementText = prefixToUse + selectedText + suffixToUse;
    selectionStart = selectionStart + prefixToUse.length + selectedText.length + suffixToUse.indexOf(replaceNext);
    selectionEnd = selectionStart + replaceNext.length;
    return {text: replacementText, selectionStart, selectionEnd};
  }
}
function multilineStyle(textarea, arg) {
  const {prefix, suffix, surroundWithNewlines} = arg;
  let text = textarea.value.slice(textarea.selectionStart, textarea.selectionEnd);
  let selectionStart = textarea.selectionStart;
  let selectionEnd = textarea.selectionEnd;
  const lines = text.split("\n");
  const undoStyle = lines.every((line) => line.startsWith(prefix) && line.endsWith(suffix));
  if (undoStyle) {
    text = lines.map((line) => line.slice(prefix.length, line.length - suffix.length)).join("\n");
    selectionEnd = selectionStart + text.length;
  } else {
    text = lines.map((line) => prefix + line + suffix).join("\n");
    if (surroundWithNewlines) {
      const {newlinesToAppend, newlinesToPrepend} = newlinesToSurroundSelectedText(textarea);
      selectionStart += newlinesToAppend.length;
      selectionEnd = selectionStart + text.length;
      text = newlinesToAppend + text + newlinesToPrepend;
    }
  }
  return {text, selectionStart, selectionEnd};
}
function orderedList(textarea) {
  const orderedListRegex = /^\d+\.\s+/;
  const noInitialSelection = textarea.selectionStart === textarea.selectionEnd;
  let selectionEnd;
  let selectionStart;
  let text = textarea.value.slice(textarea.selectionStart, textarea.selectionEnd);
  let textToUnstyle = text;
  let lines = text.split("\n");
  let startOfLine, endOfLine;
  if (noInitialSelection) {
    const linesBefore = textarea.value.slice(0, textarea.selectionStart).split(/\n/);
    startOfLine = textarea.selectionStart - linesBefore[linesBefore.length - 1].length;
    endOfLine = wordSelectionEnd(textarea.value, textarea.selectionStart, true);
    textToUnstyle = textarea.value.slice(startOfLine, endOfLine);
  }
  const linesToUnstyle = textToUnstyle.split("\n");
  const undoStyling = linesToUnstyle.every((line) => orderedListRegex.test(line));
  if (undoStyling) {
    lines = linesToUnstyle.map((line) => line.replace(orderedListRegex, ""));
    text = lines.join("\n");
    if (noInitialSelection && startOfLine && endOfLine) {
      const lengthDiff = linesToUnstyle[0].length - lines[0].length;
      selectionStart = selectionEnd = textarea.selectionStart - lengthDiff;
      textarea.selectionStart = startOfLine;
      textarea.selectionEnd = endOfLine;
    }
  } else {
    lines = numberedLines(lines);
    text = lines.join("\n");
    const {newlinesToAppend, newlinesToPrepend} = newlinesToSurroundSelectedText(textarea);
    selectionStart = textarea.selectionStart + newlinesToAppend.length;
    selectionEnd = selectionStart + text.length;
    if (noInitialSelection)
      selectionStart = selectionEnd;
    text = newlinesToAppend + text + newlinesToPrepend;
  }
  return {text, selectionStart, selectionEnd};
}
function numberedLines(lines) {
  let i;
  let len;
  let index;
  const results = [];
  for (index = i = 0, len = lines.length; i < len; index = ++i) {
    const line = lines[index];
    results.push(`${index + 1}. ${line}`);
  }
  return results;
}
function applyStyle(button, stylesToApply) {
  const toolbar = button.closest("markdown-toolbar");
  if (!(toolbar instanceof MarkdownToolbarElement))
    return;
  const defaults = {
    prefix: "",
    suffix: "",
    blockPrefix: "",
    blockSuffix: "",
    multiline: false,
    replaceNext: "",
    prefixSpace: false,
    scanFor: "",
    surroundWithNewlines: false,
    orderedList: false,
    trimFirst: false
  };
  const style = Object.assign(Object.assign({}, defaults), stylesToApply);
  const field = toolbar.field;
  if (field) {
    field.focus();
    styleSelectedText(field, style);
  }
}

// packages/forms/resources/js/components/markdown-editor.js
var import_marked = __toModule(require_marked());
var import_mdhl = __toModule(require_mdhl());
var markdown_editor_default = (Alpine) => {
  Alpine.data("markdownEditorFormComponent", ({
    state,
    tab
  }) => {
    return {
      attachment: null,
      overlay: null,
      preview: "",
      state,
      tab,
      init: function() {
        if (this.state !== null) {
          this.$nextTick(() => {
            this.render();
          });
        }
        this.$watch("state", () => {
          this.render();
        });
      },
      render: function() {
        if (this.$refs.textarea.scrollHeight > 0) {
          this.$refs.overlay.style.height = "150px";
          this.$refs.overlay.style.height = this.$refs.textarea.scrollHeight + "px";
        }
        this.overlay = null;
        this.overlay = (0, import_mdhl.highlight)(this.state);
        this.preview = null;
        this.preview = (0, import_marked.marked)(this.state);
      },
      checkForAutoInsertion($event) {
        const lines = this.$refs.textarea.value.split("\n");
        const currentLine = this.$refs.textarea.value.substring(0, this.$refs.textarea.value.selectionStart).split("\n").length;
        const previousLine = lines[currentLine - 2];
        if (!previousLine.match(/^(\*\s|-\s)|^(\d)+\./)) {
          return;
        }
        if (previousLine.match(/^(\*\s)/)) {
          if (previousLine.trim().length > 1) {
            lines[currentLine - 1] = "* ";
          } else {
            delete lines[currentLine - 2];
          }
        } else if (previousLine.match(/^(-\s)/)) {
          if (previousLine.trim().length > 1) {
            lines[currentLine - 1] = "- ";
          } else {
            delete lines[currentLine - 2];
          }
        } else {
          const matches = previousLine.match(/^(\d)+/);
          const number = matches[0];
          if (previousLine.trim().length > number.length + 2) {
            lines[currentLine - 1] = `${parseInt(number) + 1}. `;
          } else {
            delete lines[currentLine - 2];
          }
        }
        this.state = lines.join("\n");
        this.render();
      }
    };
  });
};

// packages/forms/resources/js/components/rich-editor.js
var import_trix = __toModule(require_trix());
import_trix.default.config.blockAttributes.default.tagName = "p";
import_trix.default.config.blockAttributes.default.breakOnReturn = true;
import_trix.default.config.blockAttributes.heading = {
  tagName: "h2",
  terminal: true,
  breakOnReturn: true,
  group: false
};
import_trix.default.config.blockAttributes.subHeading = {
  tagName: "h3",
  terminal: true,
  breakOnReturn: true,
  group: false
};
import_trix.default.Block.prototype.breaksOnReturn = function() {
  const lastAttribute = this.getLastAttribute();
  const blockConfig = import_trix.default.getBlockConfig(lastAttribute ? lastAttribute : "default");
  return blockConfig?.breakOnReturn ?? false;
};
import_trix.default.LineBreakInsertion.prototype.shouldInsertBlockBreak = function() {
  if (this.block.hasAttributes() && this.block.isListItem() && !this.block.isEmpty()) {
    return this.startLocation.offset > 0;
  } else {
    return !this.shouldBreakFormattedBlock() ? this.breaksOnReturn : false;
  }
};
var rich_editor_default = (Alpine) => {
  Alpine.data("richEditorFormComponent", ({
    state
  }) => {
    return {
      state,
      init: function() {
        this.$refs.trix?.editor?.loadHTML(this.state);
        this.$watch("state", () => {
          if (document.activeElement === this.$refs.trix) {
            return;
          }
          this.$refs.trix?.editor?.loadHTML(this.state);
        });
      }
    };
  });
};

// packages/forms/resources/js/components/select.js
var import_choices = __toModule(require_choices());
var select_default = (Alpine) => {
  Alpine.data("selectFormComponent", ({
    getOptionLabelUsing,
    getOptionLabelsUsing,
    getOptionsUsing,
    getSearchResultsUsing,
    isAutofocused,
    isMultiple,
    hasDynamicOptions,
    hasDynamicSearchResults,
    loadingMessage,
    maxItems,
    noSearchResultsMessage,
    options,
    placeholder,
    searchingMessage,
    searchPrompt,
    state
  }) => {
    return {
      isSearching: false,
      select: null,
      selectedOptions: [],
      isStateBeingUpdated: false,
      state,
      init: async function() {
        this.select = new import_choices.default(this.$refs.input, {
          allowHTML: false,
          duplicateItemsAllowed: false,
          itemSelectText: "",
          loadingText: loadingMessage,
          maxItemCount: maxItems ?? -1,
          noChoicesText: searchPrompt,
          noResultsText: noSearchResultsMessage,
          placeholderValue: placeholder,
          removeItemButton: true,
          renderChoiceLimit: 50,
          searchChoices: !hasDynamicSearchResults,
          searchFields: ["label"],
          searchResultLimit: 50
        });
        await this.refreshChoices({withInitialOptions: true});
        if (![null, void 0, ""].includes(this.state)) {
          this.select.setChoiceByValue(this.formatState(this.state));
        }
        if (isAutofocused) {
          this.select.showDropdown();
        }
        this.$refs.input.addEventListener("change", () => {
          if (this.isStateBeingUpdated) {
            return;
          }
          this.isStateBeingUpdated = true;
          this.state = this.select.getValue(true);
          this.$nextTick(() => this.isStateBeingUpdated = false);
        });
        if (hasDynamicOptions) {
          this.$refs.input.addEventListener("showDropdown", async () => {
            this.select.clearChoices();
            await this.select.setChoices([{value: "", label: loadingMessage, disabled: true}]);
            await this.refreshChoices();
          });
        }
        if (hasDynamicSearchResults) {
          this.$refs.input.addEventListener("search", async (event) => {
            let search = event.detail.value?.trim();
            if ([null, void 0, ""].includes(search)) {
              return;
            }
            this.isSearching = true;
            this.select.clearChoices();
            await this.select.setChoices([{value: "", label: searchingMessage, disabled: true}]);
          });
          this.$refs.input.addEventListener("search", Alpine.debounce(async (event) => {
            await this.refreshChoices({
              search: event.detail.value?.trim()
            });
            this.isSearching = false;
          }, 1e3));
        }
        this.$watch("state", async () => {
          if (this.isStateBeingUpdated) {
            return;
          }
          const choices = await this.getChoices({
            withInitialOptions: !hasDynamicOptions
          });
          this.select.clearStore();
          this.setChoices(choices);
          if (![null, void 0, ""].includes(this.state)) {
            this.select.setChoiceByValue(this.formatState(this.state));
          }
        });
      },
      refreshChoices: async function(config = {}) {
        this.setChoices(await this.getChoices(config));
      },
      setChoices: function(choices) {
        this.select.setChoices(choices, "value", "label", true);
      },
      getChoices: async function(config = {}) {
        const options2 = await this.getOptions(config);
        return this.transformOptionsIntoChoices({
          ...options2,
          ...await this.getMissingOptions(options2)
        });
      },
      getOptions: async function({search, withInitialOptions}) {
        if (withInitialOptions) {
          return options;
        }
        if (search !== "" && search !== null && search !== void 0) {
          return await getSearchResultsUsing(search);
        }
        return await getOptionsUsing();
      },
      transformOptionsIntoChoices: function(options2) {
        return Object.entries(options2).map(([value, label]) => ({
          label,
          value
        }));
      },
      formatState: function(state2) {
        if (isMultiple) {
          return (state2 ?? []).map((item) => item?.toString());
        }
        return state2?.toString();
      },
      getMissingOptions: async function(options2) {
        if ([null, void 0, "", [], {}].includes(this.state)) {
          return {};
        }
        if (!options2.length) {
          options2 = {};
        }
        if (isMultiple) {
          if (this.state.every((value) => value in options2)) {
            return {};
          }
          return await getOptionLabelsUsing();
        }
        if (this.state in options2) {
          return options2;
        }
        let missingOptions = {};
        missingOptions[this.state] = await getOptionLabelUsing();
        return missingOptions;
      }
    };
  });
};

// packages/forms/resources/js/components/tags-input.js
var tags_input_default = (Alpine) => {
  Alpine.data("tagsInputFormComponent", ({
    state
  }) => {
    return {
      newTag: "",
      state,
      createTag: function() {
        this.newTag = this.newTag.trim();
        if (this.newTag === "") {
          return;
        }
        if (this.state.includes(this.newTag)) {
          this.newTag = "";
          return;
        }
        this.state.push(this.newTag);
        this.newTag = "";
      },
      deleteTag: function(tagToDelete) {
        this.state = this.state.filter((tag) => tag !== tagToDelete);
      }
    };
  });
};

// packages/forms/resources/js/components/text-input.js
var import_imask = __toModule(require_imask());
var text_input_default = (Alpine) => {
  Alpine.data("textInputFormComponent", ({
    getMaskOptionsUsing,
    state
  }) => {
    return {
      mask: null,
      state,
      init: function() {
        if (!getMaskOptionsUsing) {
          return;
        }
        if (this.state) {
          this.$el.value = this.state?.valueOf();
        }
        this.mask = (0, import_imask.default)(this.$el, getMaskOptionsUsing(import_imask.default)).on("accept", () => {
          this.state = this.mask.unmaskedValue;
        });
        this.$watch("state", () => {
          this.mask.unmaskedValue = this.state?.valueOf() ?? "";
        });
      }
    };
  });
};

// packages/forms/resources/js/components/textarea.js
var textarea_default = (Alpine) => {
  Alpine.data("textareaFormComponent", () => ({
    init: function() {
      this.$nextTick(() => {
        this.render();
      });
    },
    render: function() {
      if (this.$el.scrollHeight > 0) {
        this.$el.style.height = "150px";
        this.$el.style.height = this.$el.scrollHeight + 2 + "px";
      }
    }
  }));
};

// packages/forms/resources/js/sortable.js
var import_sortablejs = __toModule(require_Sortable_min());
window.Livewire.directive("sortable", (el) => {
  el.sortable = import_sortablejs.default.create(el, {
    draggable: "[wire\\:sortable\\.item]",
    handle: "[wire\\:sortable\\.handle]",
    dataIdAttr: "wire:sortable.item"
  });
});

// packages/forms/resources/js/index.js
var js_default = (Alpine) => {
  Alpine.plugin(color_picker_default2);
  Alpine.plugin(date_time_picker_default);
  Alpine.plugin(file_upload_default);
  Alpine.plugin(key_value_default);
  Alpine.plugin(markdown_editor_default);
  Alpine.plugin(rich_editor_default);
  Alpine.plugin(select_default);
  Alpine.plugin(tags_input_default);
  Alpine.plugin(text_input_default);
  Alpine.plugin(textarea_default);
};
export {
  color_picker_default2 as ColorPickerFormComponentAlpinePlugin,
  date_time_picker_default as DateTimePickerFormComponentAlpinePlugin,
  file_upload_default as FileUploadFormComponentAlpinePlugin,
  key_value_default as KeyValueFormComponentAlpinePlugin,
  markdown_editor_default as MarkdownEditorFormComponentAlpinePlugin,
  rich_editor_default as RichEditorFormComponentAlpinePlugin,
  select_default as SelectFormComponentAlpinePlugin,
  tags_input_default as TagsInputFormComponentAlpinePlugin,
  text_input_default as TextInputFormComponentAlpinePlugin,
  textarea_default as TextareaFormComponentAlpinePlugin,
  js_default as default
};
